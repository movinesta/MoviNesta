import{j as e,L as j,f as m,a as d,g}from"./index-RmnKeFJ0.js";import{u as p,E as v}from"./ErrorBox-CT9uctWi.js";import{S as o,R as u,X as f,Y as b,T as N,B as _}from"./generateCategoricalChart-CBcHhIqz.js";import{C as n}from"./Card-BlxKcLs_.js";import{T as c,a as i,b as r}from"./Table-CrgI8WuL.js";import{B as y}from"./BarChart-CQHnCUN6.js";function w(a){return e.jsx("div",{className:"mb-4 text-xl font-semibold tracking-tight",children:a.children})}function z(){const a=p({queryKey:["overview"],queryFn:g});if(a.isLoading)return e.jsx(j,{});if(a.error)return e.jsx(v,{error:a.error});const t=a.data,x=t.active_profile?`${t.active_profile.provider} / ${t.active_profile.model} (${t.active_profile.dimensions})`:"—",h=t.coverage.map(s=>({name:`${s.provider} / ${s.model}`,count:s.count}));return e.jsxs("div",{className:"space-y-6",children:[e.jsx(w,{children:"Overview"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(o,{title:"Active embeddings",value:x,subtitle:t.active_profile?`task=${t.active_profile.task}`:void 0}),e.jsx(o,{title:"Providers stored",value:t.coverage.length,subtitle:"Distinct provider/model pairs"}),e.jsx(o,{title:"Job cursors",value:t.job_state.length,subtitle:"Saved pagination states"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-2",children:[e.jsxs(n,{title:"Embedding coverage",children:[e.jsx("div",{className:"h-64",children:e.jsx(u,{width:"100%",height:"100%",children:e.jsxs(y,{data:h,children:[e.jsx(f,{dataKey:"name",interval:0,angle:-20,textAnchor:"end",height:60,tickFormatter:s=>typeof s=="string"&&s.length>22?`${s.slice(0,22)}…`:s}),e.jsx(b,{}),e.jsx(N,{}),e.jsx(_,{dataKey:"count"})]})})}),e.jsx("div",{className:"mt-4",children:e.jsxs(c,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx(i,{children:"Provider"}),e.jsx(i,{children:"Model"}),e.jsx(i,{className:"text-right",children:"Count"})]})}),e.jsx("tbody",{children:t.coverage.map((s,l)=>e.jsxs("tr",{children:[e.jsx(r,{children:s.provider}),e.jsx(r,{className:"font-mono text-xs",children:s.model}),e.jsx(r,{className:"text-right",children:m(s.count)})]},l))})]})})]}),e.jsx(n,{title:"Recent errors (last 24h)",children:e.jsxs(c,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx(i,{children:"At"}),e.jsx(i,{children:"Code"}),e.jsx(i,{children:"Message"})]})}),e.jsx("tbody",{children:t.recent_errors.length?t.recent_errors.map(s=>e.jsxs("tr",{children:[e.jsx(r,{className:"whitespace-nowrap text-xs text-zinc-600",children:d(s.created_at)}),e.jsx(r,{className:"font-mono text-xs",children:s.error_code??"—"}),e.jsx(r,{className:"max-w-[28rem] truncate text-sm",children:s.error_message??"—"})]},s.id)):e.jsx("tr",{children:e.jsx(r,{colSpan:3,className:"text-zinc-500",children:"No recent errors."})})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-2",children:[e.jsx(n,{title:"Job cursors",children:e.jsxs(c,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx(i,{children:"Job"}),e.jsx(i,{children:"Cursor"}),e.jsx(i,{children:"Updated"})]})}),e.jsx("tbody",{children:t.job_state.map((s,l)=>e.jsxs("tr",{children:[e.jsx(r,{className:"font-mono text-xs",children:s.job_name}),e.jsx(r,{className:"font-mono text-xs",children:s.cursor??"—"}),e.jsx(r,{className:"whitespace-nowrap text-xs text-zinc-600",children:d(s.updated_at)})]},l))})]})}),e.jsx(n,{title:"Last job runs",children:e.jsxs(c,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx(i,{children:"At"}),e.jsx(i,{children:"Job"}),e.jsx(i,{children:"Status"})]})}),e.jsx("tbody",{children:t.last_job_runs.length?t.last_job_runs.map(s=>e.jsxs("tr",{children:[e.jsx(r,{className:"whitespace-nowrap text-xs text-zinc-600",children:d(s.started_at)}),e.jsx(r,{className:"font-mono text-xs",children:s.job_name}),e.jsx(r,{className:s.ok?"text-emerald-600":"text-red-600",children:s.ok?"OK":"FAIL"})]},s.id)):e.jsx("tr",{children:e.jsx(r,{colSpan:3,className:"text-zinc-500",children:"No job runs logged yet."})})})]})})]})]})}export{z as default};
