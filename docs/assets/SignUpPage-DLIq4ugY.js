import{r as d,u as L,a as A,j as r,L as q,s as B}from"./index-D8UbFo8l.js";import{u as T}from"./useDocumentTitle-DE2z2dc5.js";import{T as F,P as S}from"./PasswordField-B1_Zl6ez.js";import{A as D}from"./AuthLayout-D7SOiETi.js";import"./brand-DTIDtbc4.js";import"./film-E5LDX5VI.js";import"./heart-handshake-BSWC6PUm.js";const I=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,p=8;function u(t,m,o){const i={};return t?I.test(t)||(i.email="Please enter a valid email address."):i.email="Email is required.",m?m.length<p&&(i.password=`Password must be at least ${p} characters.`):i.password="Password is required.",o?m!==o&&(i.confirm="Passwords do not match."):i.confirm="Please confirm your password.",i}const z=()=>{var y,v;T("Create account");const[t,m]=d.useState(""),[o,i]=d.useState(""),[l,N]=d.useState(""),[c,g]=d.useState(!1),[a,n]=d.useState({}),[w,f]=d.useState(null),[b,x]=d.useState(null),C=L(),E=((v=(y=A().state)==null?void 0:y.from)==null?void 0:v.pathname)??"/",P=!!t&&!!o&&!!l&&Object.keys(u(t,o,l)).length===0,k=async e=>{e.preventDefault();const s=u(t,o,l);if(Object.keys(s).length>0){n(s),f(null),x(null);return}try{g(!0),f(null),x(null),n({});const{data:h,error:j}=await B.auth.signUp({email:t,password:o});if(j){f(j.message||"Sign-up failed. Please check your details and try again.");return}if(!h.session){x("Almost there! Check your email inbox for a confirmation link to activate your account.");return}C(E,{replace:!0})}catch(h){console.error(h),f("Something went wrong while creating your account.")}finally{g(!1)}};return r.jsxs(D,{kicker:"Join MoviNesta",title:"Create your account",description:"Track what you watch, swap recommendations, and keep a cozy cinematic diary.",footer:r.jsxs("span",{children:["Already have an account?"," ",r.jsx(q,{to:"/auth/signin",className:"font-medium text-mn-primary hover:underline",children:"Sign in instead"})]}),children:[w&&r.jsx("div",{role:"alert",className:"rounded-xl border border-mn-error/40 bg-mn-error/10 px-3 py-2 text-xs text-mn-error",children:w}),b&&r.jsx("div",{role:"status",className:"rounded-xl border border-emerald-400/40 bg-emerald-400/10 px-3 py-2 text-xs text-emerald-800",children:b}),r.jsxs("form",{onSubmit:k,className:"space-y-4",noValidate:!0,children:[r.jsx(F,{id:"signup-email",label:"Email address",type:"email",autoComplete:"email",required:!0,value:t,onChange:e=>{m(e.target.value),a.email&&n(s=>({...s,email:void 0}))},onBlur:()=>{const e=u(t,o,l);e.email&&n(s=>({...s,email:e.email}))},disabled:c,error:a.email}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(S,{id:"signup-password",label:"Password",ariaLabelBase:"password",autoComplete:"new-password",required:!0,minLength:p,value:o,onChange:e=>{i(e.target.value),a.password&&n(s=>({...s,password:void 0}))},onBlur:()=>{const e=u(t,o,l);e.password&&n(s=>({...s,password:e.password}))},disabled:c,"aria-invalid":!!a.password,"aria-describedby":a.password?"signup-password-error":"signup-password-hint"}),!a.password&&r.jsxs("p",{id:"signup-password-hint",className:"text-xs text-mn-text-muted",children:["At least ",p," characters."]}),a.password&&r.jsx("p",{id:"signup-password-error",className:"text-xs text-mn-error",children:a.password})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx(S,{id:"signup-confirm",label:"Confirm password",ariaLabelBase:"password confirmation",autoComplete:"new-password",required:!0,minLength:p,value:l,onChange:e=>{N(e.target.value),a.confirm&&n(s=>({...s,confirm:void 0}))},onBlur:()=>{const e=u(t,o,l);e.confirm&&n(s=>({...s,confirm:e.confirm}))},disabled:c,"aria-invalid":!!a.confirm,"aria-describedby":a.confirm?"signup-confirm-error":void 0}),a.confirm&&r.jsx("p",{id:"signup-confirm-error",className:"text-xs text-mn-error",children:a.confirm})]}),r.jsx("button",{type:"submit",disabled:c||!P,"aria-busy":c,className:"inline-flex w-full items-center justify-center rounded-lg bg-mn-primary px-4 py-2 text-sm font-medium text-white shadow-mn-soft hover:bg-mn-primary-soft disabled:cursor-not-allowed disabled:opacity-60",children:c?"Creating your accountâ€¦":"Create account"})]})]})};export{z as default};
