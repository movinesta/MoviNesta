import{c as S,j as e,W as R,R as g,r as C}from"./index-fug2llhW.js";import{C as N}from"./Chip-B1SIVa3M.js";import{Y as L}from"./index-DwcsHdQg.js";import{S as h}from"./sparkles-Bpg1Ayxy.js";import{B as w}from"./bookmark-plus-mIEtW8ef.js";import{S as y}from"./star-COq6dKFa.js";import"./index-Ab52zN-Q.js";const I=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],b=S("message-square",I),M={teal:"bg-primary/25 text-primary",violet:"bg-primary/25 text-primary",orange:"bg-primary/20 text-primary"},v=({children:s})=>e.jsx(N,{className:"gap-1 px-2 py-0.5 text-xs shadow-md",children:s}),n=({title:s})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-12 w-8 overflow-hidden rounded-lg bg-muted shadow-lg",children:s.posterUrl?e.jsx("img",{src:s.posterUrl,alt:s.name,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full bg-gradient-to-br from-primary/45 via-background/40 to-primary/75"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"truncate text-[12px] font-medium text-foreground",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.year})]})]}),i=({children:s})=>e.jsx("article",{className:"space-y-2 rounded-2xl border border-border bg-card/85 p-3 text-xs shadow-lg",children:s}),l=({item:s})=>e.jsxs("header",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`flex h-8 w-8 items-center justify-center rounded-full text-xs font-semibold ${M[s.user.avatarColor]}`,"aria-hidden":!0,children:s.user.avatarInitials}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"truncate text-[12px] font-semibold text-foreground",children:s.user.displayName}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.createdAtLabel})]})]}),s.kind==="friend-rating"&&e.jsxs(v,{children:[e.jsx(y,{className:"h-3 w-3","aria-hidden":!0}),e.jsx("span",{children:s.rating.toFixed(1)})]}),s.kind==="recommendation"&&s.score!==void 0&&e.jsxs(v,{children:[e.jsx(h,{className:"h-3 w-3","aria-hidden":!0}),e.jsx("span",{children:s.score.toFixed(1)})]})]}),A=({item:s})=>{switch(s.kind){case"friend-rating":return e.jsxs(i,{children:[e.jsx(l,{item:s}),e.jsx(n,{title:s.title}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Rated ",s.rating.toFixed(1)," ",s.emoji??"⭐️"]}),s.reviewSnippet&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["“",s.reviewSnippet,"”"]})]});case"friend-review":return e.jsxs(i,{children:[e.jsx(l,{item:s}),e.jsx(n,{title:s.title}),s.rating&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Rated ",s.rating.toFixed(1)]}),s.reviewSnippet&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["“",s.reviewSnippet,"”"]})]});case"watchlist-add":return e.jsxs(i,{children:[e.jsx(l,{item:s}),e.jsx(n,{title:s.title}),e.jsxs("div",{className:"inline-flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(w,{className:"h-3 w-3","aria-hidden":!0}),"Added to watchlist"]}),s.note&&e.jsx("p",{className:"text-xs text-muted-foreground",children:s.note})]});case"recommendation":return e.jsxs(i,{children:[e.jsx(l,{item:s}),e.jsx(n,{title:s.title}),e.jsxs("div",{className:"inline-flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(h,{className:"h-3 w-3","aria-hidden":!0}),"Recommendation"]}),s.reason&&e.jsx("p",{className:"text-xs text-muted-foreground",children:s.reason})]});default:return null}},E=[{key:"all",label:"All",icon:b},{key:"ratings",label:"Ratings",icon:y},{key:"reviews",label:"Reviews",icon:b},{key:"watchlist",label:"Watchlist",icon:w},{key:"recommendations",label:"Recs",icon:h}],H=(s,t,d)=>(()=>{switch(t){case"ratings":return s.kind==="friend-rating";case"reviews":return s.kind==="friend-review";case"watchlist":return s.kind==="watchlist-add";case"recommendations":return s.kind==="recommendation";case"all":default:return!0}})()?d==="reviews"?s.kind==="friend-review":d==="follows"?s.kind==="friend-rating"||s.kind==="friend-review"||s.kind==="watchlist-add":!0:!1,m=()=>e.jsx("div",{className:"space-y-2",children:[0,1,2].map(s=>e.jsxs("div",{className:"space-y-2 rounded-2xl border border-border bg-card/70 p-3 text-xs shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-8 w-8 animate-pulse rounded-full bg-border/60"}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("div",{className:"h-3 w-24 animate-pulse rounded bg-border/60"}),e.jsx("div",{className:"h-2.5 w-16 animate-pulse rounded bg-border/50"})]})]}),e.jsx("div",{className:"h-12 w-20 animate-pulse rounded bg-border/60"}),e.jsx("div",{className:"h-3 w-full animate-pulse rounded bg-border/40"})]},`feed-skeleton-${s}`))}),Y=()=>e.jsx("div",{className:"rounded-2xl border border-dashed border-border bg-card/60 p-4 text-center text-xs text-muted-foreground",children:"Your friends’ activity will show up here once they start rating and reviewing titles."}),z=({quickFilter:s})=>{const{items:t,isLoading:d,hasMore:o,isLoadingMore:c,loadMore:k,error:p}=R(),[x,F]=g.useState("all"),f=C.useMemo(()=>t.filter(r=>H(r,x,s)),[t,x,s]),j=()=>{o&&!c&&k()};return e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:E.map(r=>{const a=x===r.key,u=r.icon;return e.jsx("button",{type:"button",onClick:()=>F(r.key),"aria-pressed":a,className:"focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/60 focus-visible:ring-offset-2 focus-visible:ring-offset-background",children:e.jsxs(N,{variant:a?"accent":"outline",className:"flex items-center gap-1",children:[e.jsx(u,{className:"h-3.5 w-3.5","aria-hidden":"true"}),e.jsx("span",{children:r.label})]})},r.key)})}),p&&e.jsx("div",{role:"alert",className:"rounded-2xl border border-destructive/50 bg-destructive/10 px-3 py-2 text-xs text-destructive",children:p}),d?e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{}),e.jsx(m,{}),e.jsx(m,{})]}):f.length===0?e.jsx(Y,{}):e.jsx(L,{style:{height:"70vh"},data:f,computeItemKey:(r,a)=>a.id,endReached:j,components:{List:g.forwardRef(function(a,u){return e.jsx("div",{ref:u,className:"space-y-3",...a})}),Footer:()=>e.jsx("div",{className:"pt-1",children:o?e.jsx("button",{type:"button",onClick:j,disabled:c,className:"mx-auto flex items-center justify-center rounded-full border border-border bg-card px-3 py-1.5 text-xs text-muted-foreground shadow-md disabled:opacity-60",children:c?"Loading more...":"Load more"}):e.jsx("p",{className:"py-2 text-center text-xs text-muted-foreground",children:"You're all caught up."})})},itemContent:(r,a)=>e.jsx("div",{className:"pb-1",children:e.jsx(A,{item:a})})})]})};export{m as FeedSkeleton,z as default};
