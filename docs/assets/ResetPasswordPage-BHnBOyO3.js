import{r,u as j,j as e,L as N,s as p}from"./index-D8UbFo8l.js";import{u as S}from"./useDocumentTitle-DE2z2dc5.js";import{A as k}from"./AuthLayout-D7SOiETi.js";import"./brand-DTIDtbc4.js";import"./film-E5LDX5VI.js";import"./heart-handshake-BSWC6PUm.js";const i=8,q=()=>{S("Reset password");const[a,x]=r.useState(""),[d,f]=r.useState(""),[n,u]=r.useState(!1),[g,h]=r.useState(!0),[c,s]=r.useState(null),[l,m]=r.useState(null),b=j();r.useEffect(()=>{let t=!1;return(async()=>{try{const{data:y,error:v}=await p.auth.getUser();if(t)return;(v||!y.user)&&s("This password reset link is invalid or has expired. Please request a new one.")}catch{t||s("We couldn&apos;t verify your reset link. Please request a new one.")}finally{t||h(!1)}})(),()=>{t=!0}},[]);const w=async t=>{if(t.preventDefault(),s(null),m(null),!a||a.length<i){s(`Password must be at least ${i} characters long.`);return}if(a!==d){s("Passwords do not match.");return}u(!0);try{const{error:o}=await p.auth.updateUser({password:a});if(o){s(o.message||"We couldn&apos;t update your password. Please try again.");return}m("Your password has been updated. Redirecting to sign in…"),setTimeout(()=>{b("/auth/signin")},2500)}catch(o){console.error(o),s("Something went wrong while updating your password.")}finally{u(!1)}};return e.jsx(k,{kicker:"Reset password",title:"Set a new password",description:"Choose a strong password to protect your MoviNesta account.",footer:e.jsx(N,{to:"/auth/signin",className:"font-medium text-mn-primary hover:underline",children:"Back to sign in"}),children:g?e.jsx("p",{className:"text-sm text-mn-text-secondary",children:"Checking your reset link…"}):e.jsxs(e.Fragment,{children:[c&&e.jsx("div",{role:"alert",className:"rounded-xl border border-mn-error/40 bg-mn-error/10 px-3 py-2 text-xs text-mn-error",children:c}),l&&e.jsx("div",{role:"status",className:"rounded-xl border border-emerald-400/40 bg-emerald-400/10 px-3 py-2 text-xs text-emerald-800",children:l}),!l&&e.jsxs("form",{onSubmit:w,className:"space-y-4",noValidate:!0,children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{htmlFor:"reset-password",className:"text-xs font-medium text-mn-text-secondary",children:"New password"}),e.jsx("input",{id:"reset-password",type:"password",autoComplete:"new-password",required:!0,minLength:i,value:a,onChange:t=>x(t.target.value),disabled:n,className:"w-full rounded-lg border border-mn-border bg-mn-bg-input px-3 py-2 text-sm text-mn-text-primary placeholder:text-mn-text-muted focus:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary/40 focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg"}),e.jsxs("p",{className:"text-xs text-mn-text-muted",children:["At least ",i," characters."]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{htmlFor:"reset-confirm",className:"text-xs font-medium text-mn-text-secondary",children:"Confirm new password"}),e.jsx("input",{id:"reset-confirm",type:"password",autoComplete:"new-password",required:!0,minLength:i,value:d,onChange:t=>f(t.target.value),disabled:n,className:"w-full rounded-lg border border-mn-border bg-mn-bg-input px-3 py-2 text-sm text-mn-text-primary placeholder:text-mn-text-muted focus:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary/40 focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg"})]}),e.jsx("button",{type:"submit",disabled:n,"aria-busy":n,className:"inline-flex w-full items-center justify-center rounded-lg bg-mn-primary px-4 py-2 text-sm font-medium text-white shadow-mn-soft hover:bg-mn-primary-soft disabled:cursor-not-allowed disabled:opacity-60",children:n?"Updating password…":"Update password"})]})]})})};export{q as default};
