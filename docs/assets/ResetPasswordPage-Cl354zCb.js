import{r,u as N,j as e,B as j,L as k,s as p}from"./index-C0YC7Lqk.js";import{u as S}from"./useDocumentTitle-qe37jqeh.js";import{A as C}from"./AuthLayout-COhaL2wk.js";import"./brand-Ma_ngRFQ.js";import"./sparkles-BsAyD2aC.js";import"./film-BhU7UJY3.js";const n=8,A=()=>{S("Reset password");const[o,f]=r.useState(""),[u,g]=r.useState(""),[i,l]=r.useState(!1),[x,h]=r.useState(!0),[c,t]=r.useState(null),[d,m]=r.useState(null),b=N();r.useEffect(()=>{let s=!1;return(async()=>{try{const{data:v,error:y}=await p.auth.getUser();if(s)return;(y||!v.user)&&t("This password reset link is invalid or has expired. Please request a new one.")}catch{s||t("We couldn&apos;t verify your reset link. Please request a new one.")}finally{s||h(!1)}})(),()=>{s=!0}},[]);const w=async s=>{if(s.preventDefault(),t(null),m(null),!o||o.length<n){t(`Password must be at least ${n} characters long.`);return}if(o!==u){t("Passwords do not match.");return}l(!0);try{const{error:a}=await p.auth.updateUser({password:o});if(a){t(a.message||"We couldn&apos;t update your password. Please try again.");return}m("Your password has been updated. Redirecting to sign in…"),setTimeout(()=>{b("/auth/signin")},2500)}catch(a){console.error(a),t("Something went wrong while updating your password.")}finally{l(!1)}};return e.jsx(C,{kicker:"Reset password",title:"Set a new password",description:"Choose a strong password to protect your MoviNesta account.",footer:e.jsx(k,{to:"/auth/signin",className:"font-medium text-primary hover:underline",children:"Back to sign in"}),children:x?e.jsx("p",{className:"text-sm text-muted-foreground",children:"Checking your reset link…"}):e.jsxs(e.Fragment,{children:[c&&e.jsx("div",{role:"alert",className:"rounded-xl border border-destructive/40 bg-destructive/10 px-3 py-2 text-xs text-destructive",children:c}),d&&e.jsx("div",{role:"status",className:"rounded-xl border border-emerald-400/40 bg-emerald-400/10 px-3 py-2 text-xs text-emerald-800",children:d}),!d&&e.jsxs("form",{onSubmit:w,className:"space-y-4",noValidate:!0,children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{htmlFor:"reset-password",className:"text-xs font-medium text-muted-foreground",children:"New password"}),e.jsx("input",{id:"reset-password",type:"password",autoComplete:"new-password",required:!0,minLength:n,value:o,onChange:s=>f(s.target.value),disabled:i,className:"w-full rounded-lg border border-border bg-background px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/40 focus-visible:ring-offset-2 focus-visible:ring-offset-background"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["At least ",n," characters."]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{htmlFor:"reset-confirm",className:"text-xs font-medium text-muted-foreground",children:"Confirm new password"}),e.jsx("input",{id:"reset-confirm",type:"password",autoComplete:"new-password",required:!0,minLength:n,value:u,onChange:s=>g(s.target.value),disabled:i,className:"w-full rounded-lg border border-border bg-background px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/40 focus-visible:ring-offset-2 focus-visible:ring-offset-background"})]}),e.jsx(j,{type:"submit",className:"w-full",disabled:i,children:i?"Updating password…":"Update password"})]})]})})};export{A as default};
