import{u as $r,r as a,R as kn,b as In,d as Or,e as lt,j as e,f as Yr,q as _n,g as Br,s as ct}from"./index-yaS868vE.js";import{c as x,u as zr,a as $,s as I,b as Wr,f as Sn,M as y,S as qr,d as ot,P as It,F as Mn,e as Rn}from"./FriendAvatarStack-C3Pr3Fzu.js";import{u as Ur}from"./useMutation-WGdhQwN_.js";import{u as Xr}from"./scroll-area-DLyeWNt0.js";import{D as Gr,a as Hr,b as Kr,c as Vr,d as Zr}from"./dialog-D7Egbaxy.js";import"./TopBar-DVbOlr27.js";import"./format-DMUSBM01.js";import"./circle-alert-DQlp3o6x.js";import"./index-DQ8Wqi_L.js";import"./index-B227mAYG.js";import"./index-6Jf4GuQ-.js";const ze="mn_swipe_onboarding_seen",Qr={floaty_gamey:{distanceWidthFactor:.22,distanceMin:86,distanceMax:140,intentFactor:.35,intentMin:30,intentMax:52,velocityThreshold:.55,velocityProjectionMs:220,dragFollowAlpha:.22,rotationFactor:15,rotateZCap:18,rotateYCap:14,rotateXCap:7,undercardTranslateY:8,undercardBlurMax:1.4,punchScale:1.015,punchDurationMs:140,burstBaseCount:12,burstDurationMs:520}},C=Qr.floaty_gamey,Jr=88,dt=()=>typeof window>"u"?Jr:x(window.innerWidth*C.distanceWidthFactor,C.distanceMin,C.distanceMax),Cn=()=>x(Math.round(dt()*C.intentFactor),C.intentMin,C.intentMax),es=(r,o)=>{const h=Math.abs(r);if(h<=o)return r;const g=h-o;return Math.sign(r)*(o+g*.18)},Lt=8,ts=1.25,Fn=C.velocityThreshold,We=220,ns=360,Tn=C.rotationFactor,rs=`
@keyframes mn-swipe-burst {
  0% { transform: translate3d(0px,0px,0px) rotate(0deg) scale(1); opacity: 0.95; }
  100% { transform: translate3d(var(--dx, 0px), var(--dy, 0px), 0px) rotate(var(--rot, 0deg)) scale(var(--s, 1)); opacity: 0; }
}
.mn-swipe-burst-dot {
  position: absolute;
  left: var(--x, 0px);
  top: var(--y, 0px);
  width: var(--sz, 8px);
  height: var(--sz, 8px);
  border-radius: 9999px;
  filter: blur(0px);
  will-change: transform, opacity;
  animation: mn-swipe-burst var(--dur, 520ms) cubic-bezier(0.18, 0.78, 0.22, 1) forwards;
}
.mn-swipe-burst-dot[data-shape="square"] { border-radius: 6px; }
@media (prefers-reduced-motion: reduce) {
  .mn-swipe-burst-dot { animation: none !important; opacity: 0 !important; }
}
`,ss={"--mn-swipe-radius":"clamp(26px, min(6vw, 4.2vh), 44px)","--mn-swipe-pad":"clamp(12px, min(4.6vw, 3.2vh), 24px)","--mn-swipe-kicker":"clamp(10px, min(2.5vw, 1.45vh), 12px)","--mn-swipe-header":"clamp(1.05rem, min(4.2vw, 2.6vh), 1.35rem)","--mn-swipe-top-hit":"clamp(2.25rem, min(9vw, 5.2vh), 2.9rem)","--mn-swipe-top-icon":"clamp(22px, min(5.6vw, 3.2vh), 30px)","--mn-swipe-title":"clamp(1.6rem, min(6.6vw, 4.4vh), 2.6rem)","--mn-swipe-subtitle":"clamp(0.92rem, min(3.6vw, 2.2vh), 1.15rem)","--mn-swipe-meta":"clamp(0.88rem, min(3.2vw, 2.0vh), 1.08rem)","--mn-swipe-chip":"clamp(0.72rem, min(2.9vw, 1.75vh), 0.9rem)","--mn-swipe-hit":"clamp(2.25rem, min(9vw, 5.5vh), 2.85rem)","--mn-swipe-gap":"clamp(1.35rem, min(6.2vw, 3.7vh), 2.5rem)","--mn-swipe-action":"clamp(3.1rem, min(12.5vw, 7.0vh), 4.1rem)","--mn-swipe-action-primary":"clamp(4.4rem, min(17.5vw, 9.2vh), 6.1rem)","--mn-swipe-icon":"clamp(22px, min(5.5vw, 3.4vh), 30px)","--mn-swipe-icon-primary":"clamp(32px, min(8.5vw, 4.8vh), 46px)","--mn-swipe-star-hit":"clamp(18px, min(5vw, 2.8vh), 24px)","--mn-swipe-star-icon":"clamp(14px, min(3.8vw, 2.1vh), 19px)"},Ln=r=>{if(r==null)return null;const o=String(r).trim();if(!o)return null;const h=o.replace(/%/g,""),g=Number(h);return Number.isFinite(g)?g:null},is=r=>{if(r==null)return null;const o=typeof r=="number"?r:Number(String(r).trim());if(!Number.isFinite(o))return null;const h=Math.round(o/2);return h<=0?null:Math.min(5,Math.max(1,h))},as=r=>{if(r==null)return null;const o=Math.round(r);return o<=0?null:Math.min(10,Math.max(2,o*2))},ls=r=>{const o=(()=>{const b=String(r?.source??"").trim();if(!b)return null;const j=b.replace("-","_");return j==="for_you"||j==="for-you"?"for-you":j==="friends"||j==="from_friends"||j==="from-friends"?"from-friends":j==="trending"?"trending":j==="popular"?"popular":j==="combined"?"combined":j==="explore"?"explore":null})(),h=r?.kind==="series"?"series":r?.kind==="anime"?"anime":"movie",g=typeof r?.releaseYear=="number"?r.releaseYear:r?.releaseYear!=null?Number(r.releaseYear):null,_=typeof r?.runtimeMinutes=="number"?r.runtimeMinutes:r?.runtimeMinutes!=null?Number(r.runtimeMinutes):null;return{id:String(r?.id??""),title:String(r?.title??"Untitled"),deckId:r?.deckId??null,position:typeof r?.position=="number"?r.position:r?.position!=null?Number(r.position):null,year:Number.isFinite(g)?g:null,type:h,runtimeMinutes:Number.isFinite(_)?_:null,tagline:r?.tagline??null,mood:r?.mood??null,vibeTag:r?.vibeTag??null,posterUrl:r?.posterUrl??null,tmdbPosterPath:r?.tmdbPosterPath??null,tmdbBackdropPath:r?.tmdbBackdropPath??null,source:o,why:r?.why??null,friendIds:Array.isArray(r?.friendIds)?r.friendIds:null,friendProfiles:Array.isArray(r?.friendProfiles)?r.friendProfiles:null,friendLikesCount:typeof r?.friendLikesCount=="number"?r.friendLikesCount:Array.isArray(r?.friendProfiles)?r.friendProfiles.length:Array.isArray(r?.friendIds)?r.friendIds.length:null,topFriendName:Array.isArray(r?.friendProfiles)&&r.friendProfiles[0]?String(r.friendProfiles[0].display_name??r.friendProfiles[0].username??""):r?.topFriendName??null,topFriendInitials:r?.topFriendInitials??null,topFriendReviewSnippet:r?.topFriendReviewSnippet??null,overview:r?.overview??null,genres:Array.isArray(r?.genres)?r.genres:null,language:r?.language??null,country:r?.country??null,initialRating:typeof r?.initialRating=="number"?r.initialRating:r?.initialRating!=null?Number(r.initialRating):null,initiallyInWatchlist:!!r?.initiallyInWatchlist,imdbRating:typeof r?.imdbRating=="number"?r.imdbRating:r?.imdbRating!=null?Number(r.imdbRating):null,rtTomatoMeter:typeof r?.rtTomatoMeter=="number"?r.rtTomatoMeter:r?.rtTomatoMeter!=null?Number(r.rtTomatoMeter):null}};function Pn(r){const{card:o,friendCount:h,imdb:g,rt:_}=r;let b=74;const j=o?.source??null;j==="for-you"&&(b+=10),j==="from-friends"&&(b+=7),j==="trending"&&(b+=4),j==="popular"&&(b+=2);const P=typeof o?.friendLikesCount=="number"?o.friendLikesCount:0;if(P>0){const be=h>0?P/Math.max(1,h)*18:Math.min(12,P*3);b+=be}g!=null&&(b+=(g-7)*4),_!=null&&(b+=(_-70)*.15),o?.why&&(b+=3);const q=Math.round(b);return Math.round(x(q,55,99))}const An=async r=>{const{data:o,error:h}=await ct.from("media_items").select("id, kind, omdb_plot, omdb_director, omdb_writer, omdb_actors, omdb_genre, omdb_language, omdb_country, omdb_imdb_rating, omdb_imdb_votes, omdb_metascore, omdb_rating_rotten_tomatoes, omdb_poster, omdb_awards, omdb_box_office, omdb_released, omdb_rated, omdb_runtime, omdb_fetched_at, omdb_status, omdb_error").eq("id",r).maybeSingle();if(h)throw h;if(!o)return null;const g=o.omdb_genre!=null?String(o.omdb_genre).split(",").map(b=>b.trim()).filter(Boolean):null,_=Ln(o.omdb_rating_rotten_tomatoes);return{title_id:o.id,content_type:o.kind??null,plot:o.omdb_plot??null,omdb_director:o.omdb_director??null,omdb_writer:o.omdb_writer??null,omdb_actors:o.omdb_actors??null,genres:g,omdb_language:o.omdb_language??null,omdb_country:o.omdb_country??null,imdb_rating:o.omdb_imdb_rating??null,imdb_votes:o.omdb_imdb_votes??null,metascore:o.omdb_metascore??null,rt_tomato_pct:_,poster_url:o.omdb_poster??null,omdb_awards:o.omdb_awards??null,omdb_box_office_str:o.omdb_box_office??null,omdb_box_office:null,omdb_released:o.omdb_released??null,omdb_rated:o.omdb_rated??null,omdb_runtime:o.omdb_runtime??null,omdb_fetched_at:o.omdb_fetched_at??null,omdb_status:o.omdb_status??null,omdb_error:o.omdb_error??null}},ne="want_to_watch",he="watched",Fs=()=>{const r=$r(),[o,h]=a.useState(null),[g,_]=a.useState(!1),[b,j]=a.useState([]),[P,q]=a.useState(0),[be,ut]=a.useState({w:0,h:0});a.useEffect(()=>{if(typeof window>"u")return;let t=0;const n=()=>{cancelAnimationFrame(t),t=requestAnimationFrame(()=>{ut({w:window.innerWidth,h:window.innerHeight})})};return n(),window.addEventListener("resize",n,{passive:!0}),window.addEventListener("orientationchange",n,{passive:!0}),()=>{cancelAnimationFrame(t),window.removeEventListener("resize",n),window.removeEventListener("orientationchange",n)}},[]);const S=a.useMemo(()=>{const t=be.h||844;return t<640?4:t<720?5:t<820?6:t<920?7:8},[be.h]),Me=a.useMemo(()=>x(S+2,6,10),[S]),{cards:mt,sessionId:Dn,isLoading:le,isError:we,swipe:En,fetchMore:qe,trimConsumed:Dt,swipeSyncError:$n,retryFailedSwipe:On,isRetryingSwipe:Yn,trackImpression:Et,trackDwell:pt,sendEventAsync:Bn}=zr("combined",{limit:72,kindFilter:o,minImdbRating:P>0?P:null,genresAny:b.length?b:null}),M=a.useMemo(()=>mt.map(ls),[mt]),$t=a.useMemo(()=>{const t=new Set;for(const n of M){const i=n?.genres??[];for(const l of i){const c=String(l??"").trim();c&&t.add(c)}}return Array.from(t).sort((n,i)=>n.localeCompare(i))},[M]),Ue=kn.useCallback(t=>{if(!t)return!1;if(b.length){const n=Array.isArray(t.genres)?t.genres:[],i=new Set(n.map(c=>String(c).toLowerCase()));if(!b.some(c=>i.has(String(c).toLowerCase())))return!1}if(P>0){const n=typeof t.imdbRating=="number"&&!Number.isNaN(t.imdbRating)?t.imdbRating:null;if(n!=null&&n<P)return!1}return!0},[b,P]),[L,ge]=a.useState(0),N=mt[L],s=M[L],[K,Ot]=a.useState(!1),oe=a.useRef(!1);a.useEffect(()=>{oe.current=K},[K]);const[zn,Xe]=a.useState(()=>typeof window>"u"?!1:!localStorage.getItem(ze)),[Yt,Wn]=a.useState([]),Bt=(t,n)=>{t&&Wn(i=>{const l=i.includes(t);return n?l?i:[...i,t]:l?i.filter(c=>c!==t):i})},ft=t=>Bt(s?.id,t),qn=!!s?.id&&Yt.includes(s.id),re=M[L+1]??null,Un=!!re?.id&&Yt.includes(re.id),Xn=!!(re?.posterUrl&&!Un);a.useEffect(()=>{if(typeof window>"u")return;const t=re?.posterUrl;if(!t)return;const n=new Image;n.decoding="async",n.src=t},[re?.posterUrl]);const[fs,ce]=a.useState(null),[xs,Gn]=a.useState(!1),[ve,Ge]=a.useState(!1),[He,Ke]=a.useState(!1),[hs,xt]=a.useState(!1),[Re,zt]=a.useState(null),[Hn,ht]=a.useState(!1),se=a.useRef(null),Wt=a.useRef(new Set),[qt,Ut]=a.useState(null),Ce=a.useRef(null),[bs,Kn]=a.useState(0),[Vn,Xt]=a.useState(0),bt=a.useRef(null),wt=a.useRef(!1),[ws,Zn]=a.useState(!1),[Qn,Gt]=a.useState(!1),D=s?.id??null,Ve=re?.id??null,{user:U}=In(),Ze=Or();a.useEffect(()=>{if(typeof window>"u"||M.length===0)return;const t=window.requestIdleCallback,n=()=>{const c=Math.min(Math.max(L+1,0),M.length),f=Math.min(M.length,c+8),p=M.slice(c,f).map(u=>{if(!u.id)return null;const v=_n.titleDetail(u.id);return Ze.getQueryData(v)?null:Ze.prefetchQuery({queryKey:v,queryFn:()=>An(u.id),staleTime:1e3*60*30,gcTime:1e3*60*60})});Promise.allSettled(p.filter(Boolean))};if(t){const l=t(n);return()=>{typeof window<"u"&&"cancelIdleCallback"in window&&window.cancelIdleCallback?.(l)}}const i=window.setTimeout(n,280);return()=>window.clearTimeout(i)},[M,L,Ze]);const{data:Fe}=lt({queryKey:["title-preview",Ve],enabled:!!Ve,staleTime:1e3*60*30,gcTime:1e3*60*60,refetchOnWindowFocus:!1,queryFn:async()=>{if(!Ve)return null;const{data:t,error:n}=await ct.from("media_items").select("id, omdb_director, omdb_genre, omdb_rating_rotten_tomatoes, omdb_imdb_rating").eq("id",Ve).maybeSingle();if(n)throw n;return t?{omdb_director:t.omdb_director??null,omdb_genre:t.omdb_genre??null,omdb_rating_rotten_tomatoes:t.omdb_rating_rotten_tomatoes??null,omdb_imdb_rating:t.omdb_imdb_rating??null}:null}}),Ht=$(Fe?.omdb_director),Jn=Ln(Fe?.omdb_rating_rotten_tomatoes),er=I(Fe?.omdb_imdb_rating),{data:de=0}=lt({queryKey:["friendCount",{userId:U?.id??null}],enabled:!!U?.id,staleTime:1e3*60*10,gcTime:1e3*60*30,refetchOnWindowFocus:!1,queryFn:async()=>{if(!U?.id)return 0;const{count:t,error:n}=await ct.from("follows").select("followed_id",{count:"exact",head:!0}).eq("follower_id",U.id);if(n)throw n;return t??0}}),Kt=["mediaFeedback",{userId:U?.id??null,mediaItemId:D}],{data:gt}=lt({queryKey:Kt,enabled:!!(U?.id&&D),staleTime:1e3*30,gcTime:1e3*60*10,refetchOnWindowFocus:!1,queryFn:async()=>{if(!U?.id||!D)return null;const{data:t,error:n}=await ct.from("media_feedback").select("in_watchlist, rating_0_10, last_action").eq("user_id",U.id).eq("media_item_id",D).maybeSingle();if(n)throw n;return t??null}}),Vt=gt?.in_watchlist?ne:gt?.last_action==="like"?he:null,tr=is(gt?.rating_0_10),[nr,Qe]=a.useState(null),[Zt,vt]=a.useState(null),yt={status:nr??Vt,rating:Zt??tr},ue=Ur({mutationFn:async t=>{if(!U?.id||!N)return;const n={sessionId:Dn,deckId:N.deckId??null,position:N.position??null,mediaItemId:N.id,source:N.source??null,payload:{ui:"SwipePage",action:t.status?"status":t.ratingStars!=null?"rating":"feedback"}},i=[];if(t.status!==void 0&&(t.status===he?i.push({...n,eventType:"like"}):i.push({...n,eventType:"watchlist",inWatchlist:t.status===ne})),t.ratingStars!==void 0&&i.push({...n,eventType:"rating",rating0_10:as(t.ratingStars)}),!!i.length)for(const l of i)await Bn(l)},onSuccess:()=>{Ze.invalidateQueries({queryKey:Kt})}}),Te=a.useRef(null),Qt=a.useRef(null),Je=a.useRef(!1),[rr,sr]=a.useState(!1);a.useEffect(()=>{if(typeof window>"u"||!window.matchMedia)return;const t=window.matchMedia("(prefers-reduced-motion: reduce)"),n=()=>{Je.current=t.matches,sr(t.matches)};return n(),typeof t.addEventListener=="function"?t.addEventListener("change",n):t.addListener?.(n),()=>{typeof t.removeEventListener=="function"?t.removeEventListener("change",n):t.removeListener?.(n)}},[]);const et=a.useRef({x:0,y:0}),Jt=()=>{if(typeof window>"u")return null;if(Te.current)return Te.current;const t=window.AudioContext||window.webkitAudioContext;if(!t)return null;const n=new t;return Te.current=n,n},jt=t=>{typeof navigator>"u"||typeof navigator.vibrate!="function"||navigator.vibrate(t)},en=(t,n)=>{const i=Jt();if(!i)return;i.state==="suspended"&&i.resume().catch(()=>{});const l=i.createOscillator(),c=i.createGain();let f=440,m=440;t==="like"?(f=420,m=660):t==="dislike"?(f=280,m=190):(f=360,m=320);const p=i.currentTime,u=.08+n*.07;l.type="triangle",l.frequency.setValueAtTime(f,p),l.frequency.linearRampToValueAtTime(m,p+u);const v=.18+n*.18;c.gain.setValueAtTime(v,p),c.gain.exponentialRampToValueAtTime(.001,p+u),l.connect(c),c.connect(i.destination),l.start(p),l.stop(p+u+.02)},ir=(t,n=1)=>{if(Je.current)return;const i=Qt.current;if(!i)return;const l=i.getBoundingClientRect(),c=l.width,f=l.height;if(c<=0||f<=0)return;const m=C.burstDurationMs,p=Math.max(6,Math.round(C.burstBaseCount*x(n,.25,1))),u=t==="like"?Math.min(92,c*.28):Math.max(c-92,c*.72),v=Math.min(92,f*.14),k=t==="like"?"rgba(52,211,153,0.82)":"rgba(251,113,133,0.82)",F=t==="like"?"rgba(255,255,255,0.75)":"rgba(255,255,255,0.7)";for(let R=0;R<p;R++){const d=document.createElement("span"),A=R%5===0;d.className="mn-swipe-burst-dot",d.setAttribute("data-shape",A?"square":"dot");const T=(Math.random()*Math.PI*.9+Math.PI*.05)*(t==="like"?1:-1),H=62+Math.random()*98,z=Math.cos(T)*H,ae=-Math.abs(Math.sin(T))*H*(.85+Math.random()*.5),fe=5+Math.random()*6,W=(Math.random()*160-80).toFixed(1)+"deg",Be=(.8+Math.random()*.9).toFixed(2);d.style.setProperty("--x",u.toFixed(1)+"px"),d.style.setProperty("--y",v.toFixed(1)+"px"),d.style.setProperty("--dx",z.toFixed(1)+"px"),d.style.setProperty("--dy",ae.toFixed(1)+"px"),d.style.setProperty("--rot",W),d.style.setProperty("--s",Be),d.style.setProperty("--sz",fe.toFixed(1)+"px"),d.style.setProperty("--dur",m+"ms"),d.style.background=R%3===0?F:k,i.appendChild(d),window.setTimeout(()=>d.remove(),m+60)}},{data:w}=lt({queryKey:_n.titleDetail(D),enabled:!!D,staleTime:1e3*60*30,gcTime:1e3*60*60,refetchOnWindowFocus:!1,queryFn:async()=>D?An(D):null}),tt=$(w?.plot)??$(s?.overview)??null,O=w?.genres??s?.genres??null,ar=w?.omdb_language??s?.language??null;$(ar);const lr=w?.omdb_country??s?.country??null,or=$(lr),tn=Wr(or),me=$(w?.omdb_director),nn=$(w?.omdb_writer),Pe=$(w?.omdb_actors),ye=w?.imdb_rating??s?.imdbRating??null,Nt=w?.rt_tomato_pct??s?.rtTomatoMeter??null,kt=w?.metascore??null,_t=w?.imdb_votes??null,rn=$(w?.omdb_awards),sn=$(w?.omdb_box_office_str),an=$(w?.omdb_released),St=w?.content_type==="movie"||w?.content_type==="series"||w?.content_type==="anime"?w.content_type:s?.type??null,ln=s,cr=ln?.certification??ln?.rated??w?.omdb_rated??null,on=$(cr),cn=(Array.isArray(O)?O:O?String(O).split(",").map(t=>t.trim()):[])??[],dn=cn.length>3?cn.slice(3).filter(Boolean):[],dr=[w?.omdb_language??null,s?.language??null],un=Array.from(new Set(dr.map(t=>$(t)).filter(t=>!!t))),Mt=()=>U?!0:(alert("Sign in to save this title, rate it, or add it to your watchlist."),!1),mn=t=>{if(!(!D||!N||!Mt()||ue.isPending)){if(t===ne){const n=yt.status===ne?null:ne;Qe(n),ue.mutate({status:n});return}t===he&&(Qe(he),ue.mutate({status:he}))}},ur=()=>{!D||!N||!Mt()||ue.isPending||(Qe(ne),ue.mutate({status:ne}),hr())},mr=t=>{!D||!N||!Mt()||ue.isPending||(vt(t),ue.mutate({ratingStars:t}))},pn=t=>yt?.status===t,fn=yt?.rating??null,Rt=Zt??fn;a.useEffect(()=>{vt(null),Qe(null)},[D,fn,Vt]);const pr=t=>{const n=Rt===t?null:t;vt(n),mr(n)},xn=()=>typeof window<"u"?`${window.location.origin}/title/${s?.id??""}`:`/title/${s?.id??""}`,fr=xn(),xr=async t=>{if(!s||!N)return;const n=xn(),i=`Check this out: ${s.title}`,l=t??i;try{navigator.share?await navigator.share({title:s.title,text:l,url:n}):navigator.clipboard?.writeText?(await navigator.clipboard.writeText(`${l}

${n}`),alert("Link copied to clipboard")):alert(`${l}

${n}`)}catch{}},hn=!!(s?.posterUrl&&!qn),V=a.useRef(null),bn=a.useRef(null),Y=a.useRef(null),B=a.useRef(null),Ae=a.useRef(0),ie=a.useRef(0),je=a.useRef(0),Ne=a.useRef(!1),X=a.useRef(null),wn=a.useRef(!1),Z=a.useRef(null),pe=a.useRef(0),Ie=a.useRef(null),Q=a.useRef(null),G=a.useRef(null),E=a.useRef(0),J=a.useRef(null),ee=a.useRef(.5),te=a.useRef(.5),Le=a.useRef(null),De=a.useRef(null),nt=a.useRef(null),rt=a.useRef(null),ke=a.useRef(null),hr=()=>{if(!s)return;Xe(!1),typeof window<"u"&&localStorage.setItem(ze,"1"),ce(null);const t=V.current;t&&(t.style.transition="transform 220ms cubic-bezier(0.22,0.61,0.36,1), opacity 220ms ease-out",t.style.transform="perspective(1400px) translateX(0px) translateY(6px) scale(1.02) rotateZ(-1deg)",window.setTimeout(()=>{t.style.transform="perspective(1400px) translateX(0px) translateY(26px) scale(0.95)"},16),t.style.opacity="0"),window.setTimeout(()=>{gn(0,!0),ge(n=>Math.min(n+1,M.length)),t&&(t.style.transition="none",t.style.transform="translateX(0px) translateY(0px) scale(1)",t.style.opacity="1")},220)};a.useEffect(()=>{if(typeof window>"u")return;const t=localStorage.getItem(ze);Xe(!t)},[]),a.useEffect(()=>{ft(!1),xt(!1),Ge(!1),Ke(!1),Zn(!1)},[s?.id]),a.useEffect(()=>{!N||!s||le||we||Ue(s)||(Ge(!1),Ke(!1),xt(!1),ge(t=>Math.min(t+1,M.length)))},[N?.id,s?.id,le,we,Ue]),a.useEffect(()=>{if(!N)return;const t=performance.now();if(ke.current&&rt.current&&rt.current!==N.id){const n=nt.current;if(n!=null){const i=Math.max(0,Math.round(t-n));pt(ke.current,i)}}if(!Ue(s)){ke.current=null,rt.current=null,nt.current=null;return}Et(N),ke.current=N,rt.current=N.id,nt.current=t},[N?.id,s?.id,Ue,pt,Et]),a.useEffect(()=>()=>{if(!ke.current)return;const t=nt.current;if(t==null)return;const n=Math.max(0,Math.round(performance.now()-t));pt(ke.current,n)},[]),a.useEffect(()=>{if(typeof window>"u")return;(window.requestIdleCallback??(n=>window.setTimeout(n,180)))(()=>{const n=M.slice(L+1,L+4);for(const i of n){if(!i?.posterUrl)continue;const l=new Image;l.loading="lazy",l.decoding="async",l.src=i.posterUrl}})},[M,L]),a.useEffect(()=>()=>{Z.current&&cancelAnimationFrame(Z.current),se.current!=null&&window.clearTimeout(se.current),Ce.current!=null&&window.clearTimeout(Ce.current),Te.current&&Te.current.close().catch(()=>{})},[]),a.useEffect(()=>{const t=M.length-L;t<12&&qe(Math.max(60,t+24))},[M.length,L,qe]),a.useEffect(()=>{if(L<=10)return;const t=Math.min(Math.max(L-6,0),M.length);t>0&&(Dt(t),ge(n=>Math.max(4,n-t)))},[M.length,L,Dt]);const gn=a.useCallback((t,n=!1,i)=>{const l=bn.current;if(!l)return;const c=x(Math.abs(t)/dt(),0,1),f=.68+c*.32,m=.9+c*.1,p=.985+c*.015,u=(1-c)*C.undercardTranslateY,v=(1-c)*C.undercardBlurMax,k=1-c,F=x(-t*.02,-10,10)*k,R=x(-t/220,-2.2,2.2)*k,d=i??200;l.style.transition=n?`filter ${d}ms cubic-bezier(0.22,0.61,0.36,1), transform ${d}ms cubic-bezier(0.22,0.61,0.36,1)`:"none",l.style.transform=`translate3d(${F.toFixed(2)}px, ${u.toFixed(2)}px, 0px) rotateZ(${R.toFixed(3)}deg) scale(${p.toFixed(4)})`,l.style.filter=`brightness(${f.toFixed(3)}) saturate(${m.toFixed(3)}) blur(${v.toFixed(2)}px)`},[]),br=()=>{typeof performance>"u"||(Ie.current=performance.now())},wr=()=>{if(typeof performance>"u")return 1;const t=Ie.current;if(t==null)return 1;const n=(performance.now()-t)/Math.max(1,C.punchDurationMs);if(n>=1)return Ie.current=null,1;const i=Math.sin(Math.PI*n);return 1+(C.punchScale-1)*i},Ee=(t,n=!1,i,l)=>{const c=V.current;if(!c)return;const f=x(t,-We,We),m=es(t,We),p=Math.abs(t)>.5&&X.current==="x";c.style.transformOrigin=p?`${(te.current*100).toFixed(1)}% ${(ee.current*100).toFixed(1)}%`:"50% 50%";const u=dt(),v=Cn(),k=Math.abs(f),F=v*.6,R=x((k-F)/Math.max(1,u-F),0,1),d=f>0?R:0,A=f<0?R:0;c.style.setProperty("--mn-swipe-like-opacity",String(d)),c.style.setProperty("--mn-swipe-nope-opacity",String(A)),c.style.setProperty("--mn-swipe-like-scale",String(.96+d*.04)),c.style.setProperty("--mn-swipe-nope-scale",String(.96+A*.04));const T=x(Math.abs(f)/u,0,1),H=x((.5-ee.current)*2,-1,1),z=H<0?-1:1,ae=.55+.45*Math.abs(H),fe=x((te.current-.5)*2,-1,1),W=x(Math.abs(E.current)/1.35,0,1),Be=f/Tn*ae*z,Tt=x(Be*(1+W*.28),-18,C.rotateZCap),at=x(f/24+Math.sign(f)*W*2.8+-fe*T*4.5,-14,C.rotateYCap),Pt=x(H*(1.8+W*2.2)*T,-7,C.rotateXCap),xe=Je.current,Fr=xe?0:x(je.current*.18,-14,14),Tr=-T*(3.2+W*1.6),Pr=wr(),Ar=(1+T*.006+W*.004)*Pr,At=xe?{x:0,y:0}:et.current,Ir=At.y*-4,Lr=At.x*5,Dr=At.y*-4,Nn=i??320,Er=l??"cubic-bezier(0.16, 1, 0.3, 1)";c.style.transition=n?`transform ${Nn}ms ${Er}`:"none",c.style.transform=`
      perspective(1400px)
      translate3d(${m}px, ${Dr+Tr+Fr}px, 0px)
      rotateX(${xe?0:Ir+Pt}deg)
      rotateY(${xe?0:at+Lr}deg)
      rotateZ(${xe?0:Tt}deg)
      scale(${Ar})
    `,Ae.current=f,gn(f,n,Nn)},st=(t=!0,n=0)=>{et.current={x:0,y:0};const i=Math.abs(n),l=x(i/1.35,0,1),c=t?x(Math.round(320-l*140),170,320):void 0,f=t&&i<.45?"cubic-bezier(0.22, 1.2, 0.36, 1)":"cubic-bezier(0.16, 1, 0.3, 1)";Ee(0,t,c,f),Ae.current=0,Y.current=null,B.current=null,Q.current=null,G.current=null,E.current=0,ie.current=0,je.current=0,Ne.current=!1,X.current=null,ce(null),te.current=.5,ee.current=.5,Le.current=null},gr=(t,n)=>{zt({card:t,direction:n}),ht(!0),se.current!=null&&window.clearTimeout(se.current),se.current=window.setTimeout(()=>ht(!1),2800)},vr=()=>{ht(!1),zt(null),se.current!=null&&(window.clearTimeout(se.current),se.current=null)},yr=()=>{Re&&(ge(t=>{const n=t-1;if(n<0)return t;const i=M[n];return i&&i.id===Re.card.id?n:t}),it("Reviewing previous card. Swipe actions are already saved."),typeof window<"u"&&window.requestAnimationFrame(()=>st(!1)),vr())},it=t=>{Ut(t),Ce.current!=null&&window.clearTimeout(Ce.current),t&&(Ce.current=window.setTimeout(()=>Ut(null),3200))},jr=(t,n)=>{const i=t.runtimeMinutes??0,l=O??t.genres??[],c=St==="series"||t.type==="series",f=l.map(m=>m.toLowerCase());return n==="like"?f.some(m=>m.includes("horror")||m.includes("thriller"))?"We’ll show more intense picks like this.":f.some(m=>m.includes("comedy"))?"We’ll show more light and funny picks like this.":c?"Nice — we’ll bring in more series that match this vibe.":ye!=null&&I(ye)!=null&&I(ye)>=7.5?"Nice pick — we’ll show more highly rated titles like this.":t.friendLikesCount&&t.friendLikesCount>=3?"Your friends are into this — we’ll pull in more friend-favorites.":"Got it — we’ll keep tuning around this kind of title.":n==="dislike"?c?"Looks like this series isn’t your thing — we’ll dial down similar shows.":i>130&&Vn+1>=3?"You’ve skipped a few long movies — we’ll lean toward shorter runtimes.":i>130?"Noted — we’ll be more careful with super long movies.":"Okay, we’ll dial down similar titles in your feed.":n==="skip"?"We’ll move this out of your way and keep the feed feeling fresh.":null},_e=(t,n=0)=>{if(!s||!N)return;const i=`${N.deckId??"unknown"}:${N.id}`;if(Wt.current.has(i)){it("That swipe was already saved. Back is for review only."),st(!0);return}if(Wt.current.add(i),Xe(!1),typeof window<"u"&&localStorage.setItem(ze,"1"),gr(s,t),En({card:N,direction:t}),ce(null),t==="dislike"&&(s.runtimeMinutes??0)>130?Xt(d=>d+1):Xt(0),Kn(d=>{const A=d+1,T=jr(s,t);return T&&A>=4&&A%4===0?it(T):it(null),A}),t==="skip"){const d=V.current;d&&(d.style.transition="transform 220ms cubic-bezier(0.22,0.61,0.36,1), opacity 220ms ease-out",d.style.transform="perspective(1400px) translateX(0px) translateY(4px) scale(1.03) rotateZ(-1deg)",window.setTimeout(()=>{d.style.transform="perspective(1400px) translateX(0px) translateY(24px) scale(0.95)"},16),d.style.opacity="0");const A=.4;jt(16+A*40),en(t,A),window.setTimeout(()=>{ge(T=>Math.min(T+1,M.length)),d&&(d.style.transition="none",d.style.transform="translateX(0px) translateY(0px) scale(1)",d.style.opacity="1")},220);return}const l=t==="like"?1:-1,c=typeof window<"u"?window.innerWidth+240:ns,f=Math.abs(n),m=x(f/1.35,0,1),p=x(f*260,0,280),u=(c+p)*l,v=x(Math.round(260-m*110),140,260),k=V.current;if(k){const d=x((.5-ee.current)*2,-1,1),A=d<0?-1:1,T=.55+.45*Math.abs(d),H=x((te.current-.5)*2,-1,1);k.style.transformOrigin=`${(te.current*100).toFixed(1)}% ${(ee.current*100).toFixed(1)}%`;const z=Je.current,ae=u/Tn*T*A,fe=z?0:x(ae*(1+m*.12),-24,24),W=z?0:x(l*(10+m*12)+-H*(4+m*3),-22,22),Be=z?0:x(d*(4+m*2),-8,8),Tt=-4-m*14,at=1.04+m*.04,Pt=z?1:1+m*.025,xe=z?1:1-m*.018;k.style.transition=`transform ${v}ms cubic-bezier(0.22,0.61,0.36,1)`,k.style.transform=`
        perspective(1400px)
        translate3d(${u}px, ${Tt}px, 0px)
        rotateX(${Be}deg)
        rotateY(${W}deg)
        rotateZ(${fe}deg)
        scale3d(${(at*Pt).toFixed(4)}, ${(at*xe).toFixed(4)}, 1)
      `}const F=Math.abs(Ae.current)+Math.abs(n)*220,R=x(F/520,.25,1);ir(t,R),jt(12+R*28),en(t,R),window.setTimeout(()=>{ge(d=>Math.min(d+1,M.length)),window.requestAnimationFrame(()=>st(!1))},v)},Nr=(t,n,i,l)=>{if(!s||!N||J.current!=null)return;const f=l instanceof HTMLElement&&!!l.closest('button, a, input, textarea, select, [data-swipe-interactive="true"][role="button"], [data-swipe-interactive="true"][tabindex]:not([tabindex="-1"])');if(wn.current=f,f)return;Ne.current=!0,J.current=i,X.current=null,Y.current=t,B.current=n;const m=V.current;if(m){const u=m.getBoundingClientRect();u.width>0&&u.height>0?(te.current=x((t-u.left)/u.width,0,1),ee.current=x((n-u.top)/u.height,0,1)):(te.current=.5,ee.current=.5)}else te.current=.5,ee.current=.5;ie.current=0,je.current=0,Ae.current=0,pe.current=0,Ie.current=null,Q.current=t,G.current=performance.now(),De.current=G.current,E.current=0,ce(null);const p=ve&&bt.current&&bt.current.contains(l);wt.current=!!p},kr=(t,n,i)=>{if(J.current!=null&&i!==J.current||!Ne.current||Y.current===null||B.current===null)return;const l=performance.now(),c=t-Y.current,f=n-B.current;if(!oe.current&&X.current==null){const F=Math.abs(c),R=Math.abs(f);if(F<Lt&&R<Lt)return;if(R>F*ts){Ne.current=!1,J.current=null,X.current="y",Y.current=null,B.current=null,Q.current=null,G.current=null,E.current=0,ce(null);return}X.current="x",Ot(!0),oe.current=!0,Y.current=t-Math.sign(c)*Lt,B.current=n,Q.current=t,G.current=l,E.current=0,Jt();const d=V.current;if(d)try{d.setPointerCapture(i)}catch{}}if(!oe.current||Y.current===null)return;const m=t-Y.current;ie.current=m;const p=B.current!=null?n-B.current:0;je.current=x(p,-70,70);const u=Cn();let v=null;if(m>u?v="like":m<-u&&(v="dislike"),ce(v),v&&v!==Le.current&&(jt(8),br()),Le.current=v,Q.current!==null&&G.current!==null){const F=l-G.current;if(F>0){const R=(t-Q.current)/F,d=x(R,-2.5,2.5);E.current=E.current*.75+d*.25}}if(Q.current=t,G.current=l,Z.current!=null)return;const k=()=>{Z.current=null;const F=x(C.dragFollowAlpha,.08,1);pe.current=pe.current+(ie.current-pe.current)*F,Ee(pe.current),Ne.current&&oe.current&&X.current==="x"&&(Z.current=window.requestAnimationFrame(k))};Z.current=window.requestAnimationFrame(k)},vn=(t,n,i)=>{if(J.current!=null&&t!==J.current)return;const l=oe.current;Ot(!1),oe.current=!1,Ne.current=!1;const c=J.current;J.current=null,Z.current!=null&&(cancelAnimationFrame(Z.current),Z.current=null,Ee(pe.current));const f=t??c;if(f!=null)try{V.current?.releasePointerCapture(f)}catch{}if(!l){const d=X.current==="y",A=Y.current,T=B.current,H=A!=null&&n!=null?n-A:0,z=T!=null&&i!=null?i-T:0,ae=De.current!=null?performance.now()-De.current:null,fe=!d&&Math.abs(H)<10&&Math.abs(z)<10&&(ae==null||ae<280)&&!wn.current;Y.current=null,B.current=null,Q.current=null,G.current=null,E.current=0,De.current=null,ie.current=0,je.current=0,X.current=null,ce(null),te.current=.5,ee.current=.5,Le.current=null,fe&&!(ve&&wt.current)&&(Ge(W=>!W),Ke(!1),xt(!1));return}De.current=null;const p=x(ie.current,-We,We)+E.current*C.velocityProjectionMs,u=ve&&wt.current,v=dt(),k=u?v*1.6:v,F=u?Fn*1.4:Fn,R=Math.abs(p)>=k||Math.abs(E.current)>=F;if(Y.current=null,B.current=null,Q.current=null,G.current=null,ie.current=0,je.current=0,pe.current=0,Ie.current=null,X.current=null,R){_e(p>=0?"like":"dislike",E.current),Le.current=null,E.current=0;return}st(!0,E.current)},$e=!s||le||we||K,yn=typeof s?.friendLikesCount=="number"?s.friendLikesCount:0,_r=de>0?Math.round(yn/Math.max(1,de)*100):0;a.useEffect(()=>{const t=n=>{!s||$e||K||(n.key==="ArrowLeft"?(n.preventDefault(),_e("dislike")):n.key==="ArrowRight"?(n.preventDefault(),_e("like")):(n.key==="ArrowDown"||n.key===" ")&&(n.preventDefault(),_e("skip")))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[s,$e,K]);const Sr=()=>{if(!Hn||!Re)return null;const t=Re.direction==="like"?"Loved it":Re.direction==="dislike"?"Marked as ‘No thanks’":"Saved for ‘Not now’";return e.jsx("div",{className:"pointer-events-none fixed inset-x-0 bottom-4 z-40 flex justify-center px-4 sm:px-0",children:e.jsxs("div",{className:"pointer-events-auto inline-flex items-center gap-3 rounded-md border border-border bg-background/95 px-3 py-2 text-[12px] text-foreground shadow-lg backdrop-blur",children:[e.jsx("span",{children:t}),e.jsx("button",{type:"button","aria-label":"Back to previous card",onClick:yr,className:"text-xs font-semibold uppercase tracking-[0.14em] text-primary hover:text-primary/80",children:"Back"})]})})},Mr=()=>qt?e.jsx("div",{className:"pointer-events-none absolute inset-x-0 top-2 z-30 flex justify-center px-4 sm:px-0",children:e.jsxs("div",{className:"pointer-events-auto inline-flex max-w-md items-start gap-2 rounded-md border border-border bg-background/95 px-3 py-2 text-xs text-muted-foreground shadow-lg backdrop-blur",children:[e.jsx(y,{name:"auto_awesome",className:"mt-0.5 text-[18px] text-primary"}),e.jsx("span",{children:qt})]})}):null,Oe=typeof s?.imdbRating=="number"&&!Number.isNaN(s.imdbRating)?s.imdbRating:typeof w?.imdb_rating=="number"&&!Number.isNaN(w.imdb_rating)?w.imdb_rating:I(w?.imdb_rating),Ye=typeof s?.rtTomatoMeter=="number"&&!Number.isNaN(s.rtTomatoMeter)?s.rtTomatoMeter:typeof w?.rt_tomato_pct=="number"&&!Number.isNaN(w.rt_tomato_pct)?w.rt_tomato_pct:I(w?.rt_tomato_pct),Ct=a.useMemo(()=>Pn({card:s??null,friendCount:de,imdb:Oe??null,rt:Ye??null}),[s,de,Oe,Ye]),Se=s?(()=>{const t=[];if(s.year&&t.push(String(s.year)),Oe!=null&&I(Oe)!=null&&t.push(`IMDb ${String(I(Oe)?.toFixed(1))}`),Ye!=null&&I(Ye)!=null&&t.push(`RT ${Math.round(Number(Ye))}%`),typeof s.runtimeMinutes=="number"&&s.runtimeMinutes>0){const n=Sn(s.runtimeMinutes);n&&t.push(n)}return t.join(" • ")})():"",Ft=a.useMemo(()=>{const t=St??s?.type??null;return t==="series"?"SERIES":t==="anime"?"ANIME":"MOVIE"},[St,s?.type]),jn=a.useMemo(()=>{const t=O??s?.genres??null;return(Array.isArray(t)?t:t?String(t).split(",").map(i=>i.trim()).filter(Boolean):[]).map(i=>String(i??"").trim()).filter(Boolean).slice(0,3)},[O,s?.genres]),Rr=t=>{if(typeof window<"u"&&window.matchMedia&&window.matchMedia("(pointer: coarse)").matches||K)return;const n=V.current;if(!n)return;const i=n.getBoundingClientRect(),l=(t.clientX-i.left)/i.width,c=(t.clientY-i.top)/i.height;et.current={x:(l-.5)*2,y:(c-.5)*2},Ee(ie.current)},Cr=()=>{K||(et.current={x:0,y:0},Ee(Ae.current,!0))};return e.jsxs("div",{"data-reduce-motion":rr?"1":"0",className:"relative flex flex-1 min-h-0 flex-col overflow-hidden overscroll-none h-[calc(100dvh-(5.5rem+env(safe-area-inset-bottom)))] sm:h-[calc(100dvh-(6rem+env(safe-area-inset-bottom)))]",style:ss,children:[e.jsx("style",{children:rs}),s?.posterUrl&&e.jsxs("div",{"aria-hidden":"true",className:"pointer-events-none absolute inset-0 -z-10",style:{backgroundImage:`url(${s.posterUrl})`,backgroundSize:"cover",backgroundPosition:"center"},children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-background/40 via-background/70 to-background"}),e.jsx("div",{className:"absolute inset-0 backdrop-blur-2xl"})]}),Mr(),e.jsxs("div",{className:"relative z-10 flex shrink-0 flex-col gap-[calc(var(--mn-swipe-pad)*0.75)] px-[var(--mn-swipe-pad)] pt-[calc(env(safe-area-inset-top)+var(--mn-swipe-pad)*0.75)]",children:[e.jsxs("header",{className:"flex items-center justify-between",children:[e.jsx("button",{type:"button",onClick:()=>_(!0),className:"inline-flex h-[var(--mn-swipe-top-hit)] w-[var(--mn-swipe-top-hit)] items-center justify-center text-muted-foreground/90 transition-colors hover:text-foreground","aria-label":"Filters",children:e.jsx(y,{name:"tune",className:"text-[length:var(--mn-swipe-top-icon)]"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-[length:var(--mn-swipe-kicker)] font-semibold tracking-[0.25em] text-primary/90",children:"DISCOVERY"}),e.jsx("div",{className:"text-[length:var(--mn-swipe-header)] font-semibold text-foreground",children:"For You"})]}),e.jsxs("button",{type:"button",onClick:()=>r("/activity"),className:"relative inline-flex h-[var(--mn-swipe-top-hit)] w-[var(--mn-swipe-top-hit)] items-center justify-center text-muted-foreground/90 transition-colors hover:text-foreground","aria-label":"Activity",children:[e.jsx(y,{name:"notifications",className:"text-[length:var(--mn-swipe-top-icon)]"}),e.jsx("span",{"aria-hidden":"true",className:"absolute right-[8px] top-[8px] h-2 w-2 rounded-full bg-primary"})]})]}),e.jsx(qr,{message:$n,onRetry:On,isRetrying:Yn})]}),e.jsxs("div",{className:"relative z-10 flex flex-1 min-h-0 flex-col overflow-visible px-[var(--mn-swipe-pad)]",children:[e.jsxs("div",{className:"relative flex flex-1 min-h-0 items-center justify-center overflow-visible [perspective:1400px]","aria-live":"polite",children:[le&&!s&&!we&&e.jsx(Yr,{}),we&&!le&&e.jsxs("div",{className:"flex h-full w-full flex-col items-center justify-center gap-3 text-center text-sm text-muted-foreground",children:[e.jsx(y,{name:"info",className:"text-[32px] text-amber-400"}),e.jsx("p",{children:"We couldn't load your swipe deck."}),e.jsx("button",{type:"button",onClick:()=>qe(32),className:"mt-1 rounded-md border border-border px-3 py-1.5 text-[12px] font-semibold text-foreground hover:bg-card/70",children:"Retry"})]}),!le&&!we&&!s&&e.jsxs("div",{className:"flex h-full w-full flex-col items-center justify-center gap-3 text-center text-sm text-muted-foreground",children:[e.jsx(y,{name:"auto_awesome",className:"text-[32px] text-primary"}),e.jsx("p",{children:"All caught up. New cards will appear soon."}),e.jsx("button",{type:"button",onClick:()=>qe(36),className:"mt-1 rounded-md border border-border px-3 py-1.5 text-[12px] font-semibold text-foreground hover:bg-card/70",children:"Refresh deck"})]}),!le&&s&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative z-10 mx-auto h-full max-h-[720px] w-full max-w-md",children:[re&&e.jsx("div",{"aria-hidden":"true",className:"pointer-events-none absolute inset-0",children:(()=>{const t=re;if(!t)return null;const n=typeof t.friendLikesCount=="number"?t.friendLikesCount:Array.isArray(t.friendProfiles)?t.friendProfiles.length:0,i=de>0?Math.round(n/Math.max(1,de)*100):0,l=typeof t.imdbRating=="number"&&!Number.isNaN(t.imdbRating)?t.imdbRating:er??null,c=typeof t.rtTomatoMeter=="number"&&!Number.isNaN(t.rtTomatoMeter)?t.rtTomatoMeter:Jn??null,f=Pn({card:t,friendCount:de,imdb:l,rt:c}),m=(()=>{const p=Array.isArray(t.genres)?t.genres:[],u=Fe?.omdb_genre!=null?String(Fe.omdb_genre).split(",").map(k=>k.trim()).filter(Boolean):[];return(p.length>0?p:u).map(k=>String(k??"").trim()).filter(Boolean).slice(0,3)})();return e.jsx("div",{ref:bn,className:"absolute inset-0",style:{filter:"brightness(0.68) saturate(0.9)",willChange:"filter"},children:e.jsx("div",{className:"relative h-full w-full rounded-[var(--mn-swipe-radius)] bg-gradient-to-b from-white/10 via-primary/25 to-white/10 p-[1.25px] shadow-[0_30px_90px_rgba(0,0,0,0.75)]",children:e.jsxs("div",{className:"relative h-full w-full overflow-hidden rounded-[var(--mn-swipe-radius)] bg-background/20 backdrop-blur-sm",children:[Xn&&t.posterUrl?e.jsx("img",{src:t.posterUrl,alt:ot(t)??`${t.title} poster`,className:"h-full w-full object-cover",draggable:!1,loading:"lazy",onError:()=>Bt(t.id,!0)}):e.jsx("div",{className:"h-full w-full",children:e.jsx(It,{title:t.title})}),e.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-black/10 via-black/20 to-black/70"}),t.source==="from-friends"&&e.jsx("div",{className:"absolute left-[var(--mn-swipe-pad)] top-[var(--mn-swipe-pad)]",children:(()=>{const p=t.topFriendName??t.friendProfiles?.[0]?.display_name??t.friendProfiles?.[0]?.username??"",u=Math.max(0,n-1),v=!!p,k=(p.trim().charAt(0)||"F").toUpperCase();return e.jsxs("div",{className:"flex items-center gap-2 rounded-full border border-white/10 bg-black/30 px-2.5 py-2 shadow-sm backdrop-blur-md",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center overflow-hidden rounded-full border border-white/20 bg-white/10 text-sm font-semibold text-white/90",children:v&&t.friendProfiles?.[0]?.avatar_url?e.jsx("img",{src:t.friendProfiles[0].avatar_url,alt:p||"Friend",className:"h-full w-full object-cover",loading:"lazy",referrerPolicy:"no-referrer"}):e.jsx("span",{children:k})}),u>0&&e.jsxs("div",{className:"grid h-10 w-10 place-items-center rounded-full border border-white/10 bg-white/10 text-sm font-semibold text-white/90",children:["+",u]}),e.jsx("div",{className:"pr-1 text-sm font-semibold text-white/90",children:v?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-primary",children:p}),e.jsx("span",{className:"text-white/80",children:" & others watched"})]}):e.jsx("span",{className:"text-white/80",children:"From friends"})})]})})()}),e.jsxs("div",{className:"absolute inset-x-0 bottom-0 px-[var(--mn-swipe-pad)] pb-[var(--mn-swipe-pad)]",children:[e.jsx("div",{"aria-hidden":"true",className:"pointer-events-none absolute inset-x-0 bottom-0 h-[72%] bg-gradient-to-t from-black/85 via-black/40 to-transparent"}),e.jsxs("div",{className:"relative",children:[(()=>{const p=t.source??"for-you",u=p==="trending"?{label:"Trending",icon:"local_fire_department"}:p==="popular"?{label:"Popular",icon:"stars"}:p==="from-friends"?{label:"From Friends",icon:"group"}:{label:"For You",icon:"auto_awesome"};return e.jsxs("div",{className:"mb-3 inline-flex items-center gap-2 rounded-full bg-primary/25 px-3 py-1.5 text-[length:var(--mn-swipe-chip)] font-semibold text-primary-foreground backdrop-blur",children:[e.jsx(y,{name:u.icon,filled:!0,className:"text-[18px]"}),e.jsx("span",{className:"tracking-[0.12em]",children:u.label}),e.jsx("span",{className:"text-white/35",children:"•"}),e.jsxs("span",{className:"font-semibold text-emerald-300",children:[f,"% Match"]})]})})(),e.jsx("h2",{className:"line-clamp-2 text-[length:var(--mn-swipe-title)] font-extrabold leading-[1.02] text-white",children:t.title}),Ht&&e.jsxs("p",{className:"mt-1 text-[length:var(--mn-swipe-subtitle)] font-semibold text-white/60",children:["Directed by ",Ht.split(",")[0]]}),e.jsx("div",{className:"mt-4 text-[length:var(--mn-swipe-meta)] text-white/70 whitespace-nowrap overflow-hidden text-ellipsis",children:[t.year?e.jsx("span",{children:t.year},"y"):null,l!=null?e.jsxs("span",{className:"text-white/70",children:["IMDb ",String(l.toFixed(1))]},"i"):null,c!=null?e.jsxs("span",{className:"text-white/70",children:["RT ",Math.round(c),"%"]},"r"):null,typeof t.runtimeMinutes=="number"&&t.runtimeMinutes>0?e.jsx("span",{children:Sn(t.runtimeMinutes)},"t"):null].filter(Boolean).map((p,u)=>e.jsxs(kn.Fragment,{children:[u>0&&e.jsx("span",{className:"mx-1 text-white/30",children:"•"}),p]},u))}),Array.isArray(t.friendProfiles)&&t.friendProfiles.length>0&&e.jsxs("div",{className:"mt-5 flex w-full items-center justify-between gap-3 rounded-2xl border border-white/10 bg-white/10 px-4 py-3 text-left backdrop-blur-md","aria-label":"Friends summary",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Mn,{profiles:t.friendProfiles,max:3,size:32}),e.jsxs("div",{className:"leading-tight",children:[e.jsxs("p",{className:"text-[length:var(--mn-swipe-subtitle)] font-extrabold text-white",children:[x(Math.round(i),0,100),"% of friends"]}),e.jsxs("p",{className:"text-sm font-semibold text-white/60",children:[t.source==="from-friends"?"watched":"liked"," this title"]})]})]}),e.jsx("div",{className:"grid h-[var(--mn-swipe-hit)] w-[var(--mn-swipe-hit)] place-items-center rounded-full border border-white/10 bg-white/10 text-white/70",children:e.jsx(y,{name:"chevron_right",className:"text-[length:var(--mn-swipe-top-icon)]"})})]}),m.length>0&&e.jsx("div",{className:"mt-4 flex flex-wrap gap-3",children:m.map(p=>e.jsxs("span",{className:"inline-flex items-center rounded-full border border-white/10 bg-white/10 px-3 py-1.5 text-[length:var(--mn-swipe-chip)] font-semibold text-white/75",children:["#",p]},p))})]})]})]})})})})()}),e.jsx("div",{className:"relative h-full w-full rounded-[var(--mn-swipe-radius)] bg-gradient-to-b from-white/10 via-primary/25 to-white/10 p-[1.25px] shadow-[0_30px_90px_rgba(0,0,0,0.75)]",children:e.jsxs("article",{ref:V,role:"group","aria-roledescription":"Movie card","aria-label":ot(s),className:`relative h-full w-full select-none overflow-hidden rounded-[var(--mn-swipe-radius)] bg-background/20 backdrop-blur-sm transform-gpu will-change-transform ${ve?"ring-1 ring-primary/40":""}`,onPointerDown:t=>{t.pointerType==="mouse"&&t.button!==0||Nr(t.clientX,t.clientY,t.pointerId,t.target)},onPointerMove:t=>kr(t.clientX,t.clientY,t.pointerId),onPointerUp:t=>vn(t.pointerId,t.clientX,t.clientY),onPointerCancel:t=>vn(t.pointerId,t.clientX,t.clientY),onMouseMove:Rr,onMouseLeave:Cr,style:{touchAction:"pan-y"},children:[e.jsx("div",{ref:Qt,"aria-hidden":"true",className:"pointer-events-none absolute inset-0 z-20 overflow-hidden"}),!ve&&e.jsxs("div",{className:"relative h-full w-full",children:[hn&&s.posterUrl?e.jsx("img",{src:s.posterUrl,alt:ot(s)??`${s.title} poster`,className:"h-full w-full object-cover",draggable:!1,loading:"lazy",onError:()=>ft(!0)}):e.jsx(It,{title:s.title}),e.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-black/10 via-black/20 to-black/70"}),e.jsx("div",{className:"pointer-events-none absolute inset-x-[calc(var(--mn-swipe-pad)*1.2)] top-[calc(var(--mn-swipe-pad)*0.8)] flex justify-start",children:e.jsxs("div",{className:`flex items-center gap-2 rounded-md bg-emerald-500/14 px-3 py-1.5 text-xs font-semibold uppercase tracking-[0.14em] text-emerald-200 shadow-md backdrop-blur-sm ${K?"":"transition-[opacity,transform] duration-200"}`,style:{opacity:"var(--mn-swipe-like-opacity, 0)",transform:"translate3d(0,0,0) scale(var(--mn-swipe-like-scale, 0.96))"},children:[e.jsx(y,{name:"favorite",filled:!0,className:"text-[18px] text-emerald-300"}),e.jsx("span",{children:"Love it"})]})}),e.jsx("div",{className:"pointer-events-none absolute inset-x-[calc(var(--mn-swipe-pad)*1.2)] top-[calc(var(--mn-swipe-pad)*0.8)] flex justify-end",children:e.jsxs("div",{className:`flex items-center gap-2 rounded-md bg-rose-500/14 px-3 py-1.5 text-xs font-semibold uppercase tracking-[0.14em] text-rose-200 shadow-md backdrop-blur-sm ${K?"":"transition-[opacity,transform] duration-200"}`,style:{opacity:"var(--mn-swipe-nope-opacity, 0)",transform:"translate3d(0,0,0) scale(var(--mn-swipe-nope-scale, 0.96))"},children:[e.jsx(y,{name:"close",className:"text-[18px] text-rose-300"}),e.jsx("span",{children:"No thanks"})]})}),s.source==="from-friends"&&e.jsx("div",{className:"absolute left-[var(--mn-swipe-pad)] top-[var(--mn-swipe-pad)]",children:(()=>{const t=s.topFriendName??s.friendProfiles?.[0]?.display_name??s.friendProfiles?.[0]?.username??"",n=Math.max(0,yn-1),i=!!t,l=(t.trim().charAt(0)||"F").toUpperCase();return e.jsxs("div",{className:"flex items-center gap-2 rounded-full border border-white/10 bg-black/30 px-2.5 py-2 shadow-sm backdrop-blur-md",children:[e.jsx("div",{className:"grid h-10 w-10 place-items-center overflow-hidden rounded-full border border-white/20 bg-white/10 text-sm font-semibold text-white/90",children:i&&s.friendProfiles?.[0]?.avatar_url?e.jsx("img",{src:s.friendProfiles[0].avatar_url,alt:t||"Friend",className:"h-full w-full object-cover",loading:"lazy",referrerPolicy:"no-referrer"}):e.jsx("span",{children:l})}),n>0&&e.jsxs("div",{className:"grid h-10 w-10 place-items-center rounded-full border border-white/10 bg-white/10 text-sm font-semibold text-white/90",children:["+",n]}),e.jsx("div",{className:"pr-1 text-sm font-semibold text-white/90",children:i?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-primary",children:t}),e.jsx("span",{className:"text-white/80",children:" & others watched"})]}):e.jsx("span",{className:"text-white/80",children:"From friends"})})]})})()}),e.jsxs("div",{className:"absolute inset-x-0 bottom-0 px-[var(--mn-swipe-pad)] pb-[var(--mn-swipe-pad)]",children:[e.jsx("div",{"aria-hidden":"true",className:"pointer-events-none absolute inset-x-0 bottom-0 h-[72%] bg-gradient-to-t from-black/85 via-black/40 to-transparent"}),e.jsxs("div",{className:"relative",children:[(()=>{const t=s.source??"for-you",n=t==="trending"?{label:"Trending",icon:"local_fire_department"}:t==="popular"?{label:"Popular",icon:"stars"}:t==="from-friends"?{label:"From Friends",icon:"group"}:{label:"For You",icon:"auto_awesome"};return e.jsxs("div",{className:"mb-3 inline-flex items-center gap-2 rounded-full bg-primary/25 px-3 py-1.5 text-[length:var(--mn-swipe-chip)] font-semibold text-primary-foreground backdrop-blur",children:[e.jsx(y,{name:n.icon,filled:!0,className:"text-[18px]"}),e.jsx("span",{className:"tracking-[0.12em]",children:n.label}),e.jsx("span",{className:"text-white/35",children:"•"}),e.jsxs("span",{className:"font-semibold text-emerald-300",children:[Ct,"% Match"]})]})})(),e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsx("h2",{className:"min-w-0 line-clamp-2 text-[length:var(--mn-swipe-title)] font-extrabold leading-[1.02] text-white",children:s.title}),e.jsx("span",{className:"shrink-0 rounded-full border border-white/10 bg-white/10 px-3 py-1 text-[length:var(--mn-swipe-chip)] font-extrabold tracking-[0.14em] text-white/75",children:Ft})]}),me&&e.jsxs("p",{className:"mt-1 text-[length:var(--mn-swipe-subtitle)] font-semibold text-white/60",children:["Directed by ",me.split(",")[0]]}),Se&&e.jsx("div",{className:"mt-4 text-[length:var(--mn-swipe-meta)] text-white/70 whitespace-nowrap overflow-hidden text-ellipsis",children:Se}),Array.isArray(s.friendProfiles)&&s.friendProfiles.length>0&&e.jsxs("button",{type:"button",onClick:()=>Gn(!0),className:"mt-5 flex w-full items-center justify-between gap-3 rounded-2xl border border-white/10 bg-white/10 px-4 py-3 text-left backdrop-blur-md","aria-label":"See friends","data-swipe-interactive":"true",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Mn,{profiles:s.friendProfiles,max:3,size:32}),e.jsxs("div",{className:"leading-tight",children:[e.jsxs("p",{className:"text-[length:var(--mn-swipe-subtitle)] font-extrabold text-white",children:[x(Math.round(_r),0,100),"% of friends"]}),e.jsxs("p",{className:"text-sm font-semibold text-white/60",children:[s.source==="from-friends"?"watched":"liked"," this title"]})]})]}),e.jsx("div",{className:"grid h-[var(--mn-swipe-hit)] w-[var(--mn-swipe-hit)] place-items-center rounded-full border border-white/10 bg-white/10 text-white/70",children:e.jsx(y,{name:"chevron_right",className:"text-[length:var(--mn-swipe-top-icon)]"})})]}),jn.length>0&&e.jsx("div",{className:"mt-4 flex flex-wrap gap-3",children:jn.map(t=>e.jsxs("span",{className:"inline-flex items-center rounded-full border border-white/10 bg-white/10 px-3 py-1.5 text-[length:var(--mn-swipe-chip)] font-semibold text-white/75",children:["#",t]},t))})]})]})]}),ve&&s&&e.jsxs("div",{className:"absolute inset-0 z-10 flex h-full flex-col",children:[e.jsxs("div",{className:"absolute inset-0 z-0 overflow-hidden bg-[#261933]",children:[hn&&s.posterUrl?e.jsx("img",{src:s.posterUrl,alt:ot(s)??`${s.title} poster`,className:"h-full w-full object-cover",draggable:!1,loading:"lazy",onError:()=>ft(!0),style:{filter:"blur(6px) brightness(0.60)",transform:"scale(1.14)"}}):e.jsx(It,{title:s.title}),e.jsx("div",{className:"pointer-events-none absolute inset-0 z-0 bg-gradient-to-b from-black/10 via-black/60 to-[#261933]"})]}),e.jsx("button",{type:"button",onClick:()=>Ge(!1),className:"absolute right-[var(--mn-swipe-pad)] top-[var(--mn-swipe-pad)] z-20 inline-flex h-[var(--mn-swipe-top-hit)] w-[var(--mn-swipe-top-hit)] items-center justify-center rounded-full border border-white/10 bg-white/10 text-white/80 backdrop-blur hover:bg-white/15","aria-label":"Close details","data-swipe-interactive":"true",children:e.jsx(y,{name:"close",className:"text-[length:var(--mn-swipe-top-icon)]"})}),e.jsxs("div",{className:"relative z-10 flex min-h-0 flex-1 flex-col px-[var(--mn-swipe-pad)] pb-[var(--mn-swipe-pad)] pt-[calc(var(--mn-swipe-top-hit)+var(--mn-swipe-pad)*0.75)]",children:[e.jsx("div",{"aria-hidden":"true",className:"pointer-events-none absolute inset-0 z-0 bg-gradient-to-b from-[#261933]/35 via-[#261933]/90 to-[#261933]"}),e.jsxs("div",{ref:bt,id:"swipe-detail-panel","aria-label":He?"Full details":"Details summary","aria-live":"polite",className:"relative z-10 mt-1 flex min-h-0 flex-1 flex-col text-left text-[13px] text-white/70",children:[e.jsx("div",{"data-swipe-interactive":"true",className:"flex min-h-0 flex-1 flex-col overflow-hidden",children:He?e.jsxs("div",{className:"flex min-h-0 flex-1 flex-col gap-3",children:[e.jsxs("div",{className:"shrink-0 space-y-2",children:[(()=>{const t=s.source??"for-you",n=t==="trending"?{label:"Trending",icon:"local_fire_department"}:t==="popular"?{label:"Popular",icon:"stars"}:t==="from-friends"?{label:"From Friends",icon:"group"}:{label:"For You",icon:"auto_awesome"};return e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-white/10 px-[calc(var(--mn-swipe-pad)*0.75)] py-[calc(var(--mn-swipe-pad)*0.25)] text-[length:var(--mn-swipe-chip)] font-semibold text-white/80",children:[e.jsx(y,{name:n.icon,filled:!0,className:"text-[length:calc(var(--mn-swipe-chip)+0.25rem)]"}),e.jsx("span",{className:"tracking-[0.12em]",children:n.label}),e.jsx("span",{className:"text-white/35",children:"•"}),e.jsxs("span",{className:"font-semibold text-emerald-300",children:[Ct,"% Match"]})]})})(),e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsx("h3",{className:"min-w-0 line-clamp-1 text-[clamp(1.05rem,4.6vw,1.35rem)] font-extrabold text-white",children:s.title}),e.jsx("span",{className:"shrink-0 rounded-full border border-white/10 bg-white/10 px-[calc(var(--mn-swipe-pad)*0.7)] py-[calc(var(--mn-swipe-pad)*0.22)] text-[length:var(--mn-swipe-chip)] font-extrabold tracking-[0.14em] text-white/75",children:Ft})]}),Se&&e.jsx("p",{className:"text-[length:var(--mn-swipe-meta)] text-white/55 whitespace-nowrap overflow-hidden text-ellipsis",children:Se})]}),e.jsxs("div",{className:"flex min-h-0 flex-1 flex-col gap-2 overflow-hidden",children:[e.jsx("div",{className:"shrink-0 grid grid-cols-2 gap-x-3 gap-y-2 rounded-2xl border border-white/10 bg-white/10 px-[calc(var(--mn-swipe-pad)*0.75)] py-[calc(var(--mn-swipe-pad)*0.5)] text-[length:var(--mn-swipe-chip)] leading-snug text-white/75",children:(()=>{const t=[];if(dn.length>0&&t.push({label:"Genres",value:dn.slice(0,6).join(", ")}),un.length>0&&t.push({label:"Languages",value:un.slice(0,4).join(", ")}),me&&t.push({label:"Director",value:me}),nn&&t.push({label:"Writers",value:nn}),Pe){const i=Pe.split(",").map(l=>l.trim()).filter(Boolean).slice(3);i.length>0&&t.push({label:"More cast",value:i.slice(0,8).join(", ")})}return an&&t.push({label:"Released",value:an}),rn&&t.push({label:"Awards",value:rn}),sn&&t.push({label:"Box office",value:sn}),ye&&I(ye)!=null&&t.push({label:"IMDb",value:String(I(ye)?.toFixed(1))}),Nt&&I(Nt)!=null&&t.push({label:"RT",value:`${String(I(Nt))}%`}),_t&&Rn(_t)&&t.push({label:"IMDb votes",value:String(Rn(_t))}),kt&&I(kt)!=null&&t.push({label:"Metascore",value:String(I(kt))}),t.slice(0,10).map(n=>e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-[length:var(--mn-swipe-kicker)] font-semibold uppercase tracking-[0.14em] text-white/45",children:n.label}),e.jsx("p",{className:"line-clamp-2",children:n.value})]},n.label))})()}),e.jsxs("div",{className:"flex min-h-0 flex-1 flex-col overflow-hidden rounded-2xl border border-white/10 bg-white/10 px-3 py-2",children:[e.jsx("p",{className:"text-[length:var(--mn-swipe-kicker)] font-semibold uppercase tracking-[0.14em] text-white/45",children:"Overview"}),tt?e.jsx("p",{className:"mt-1 min-h-0 flex-1 overflow-hidden text-[length:var(--mn-swipe-meta)] leading-relaxed text-white/70",style:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:Me,overflow:"hidden"},children:tt}):e.jsx("p",{className:"mt-1 text-[length:var(--mn-swipe-meta)] text-white/40",children:"No overview available."})]})]})]}):e.jsxs("div",{className:"flex min-h-0 flex-1 flex-col gap-3",children:[e.jsxs("div",{className:"shrink-0 space-y-2",children:[(()=>{const t=s.source??"for-you",n=t==="trending"?{label:"Trending",icon:"local_fire_department"}:t==="popular"?{label:"Popular",icon:"stars"}:t==="from-friends"?{label:"From Friends",icon:"group"}:{label:"For You",icon:"auto_awesome"};return e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-white/10 px-[calc(var(--mn-swipe-pad)*0.75)] py-[calc(var(--mn-swipe-pad)*0.25)] text-[length:var(--mn-swipe-chip)] font-semibold text-white/80",children:[e.jsx(y,{name:n.icon,filled:!0,className:"text-[length:calc(var(--mn-swipe-chip)+0.25rem)]"}),e.jsx("span",{className:"tracking-[0.12em]",children:n.label}),e.jsx("span",{className:"text-white/35",children:"•"}),e.jsxs("span",{className:"font-semibold text-emerald-300",children:[Ct,"% Match"]})]})})(),e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsx("h3",{className:"min-w-0 line-clamp-2 text-[clamp(1.25rem,5vw,1.75rem)] font-extrabold leading-[1.06] text-white",children:s.title}),e.jsx("span",{className:"shrink-0 rounded-full border border-white/10 bg-white/10 px-[calc(var(--mn-swipe-pad)*0.7)] py-[calc(var(--mn-swipe-pad)*0.22)] text-[length:var(--mn-swipe-chip)] font-extrabold tracking-[0.14em] text-white/75",children:Ft})]}),Se&&e.jsx("p",{className:"text-[clamp(0.78rem,2.8vw,0.95rem)] text-white/60 whitespace-nowrap overflow-hidden text-ellipsis",children:Se}),e.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 text-[clamp(0.70rem,2.6vw,0.8rem)] text-white/65",children:[O&&e.jsxs("div",{className:"flex min-w-0 flex-1 items-center gap-2",children:[e.jsx("span",{className:"shrink-0 font-semibold text-white/75",children:"Genres"}),e.jsx("span",{className:"min-w-0 flex-1 truncate",children:Array.isArray(O)?O.slice(0,3).join(", "):String(O).split(",").map(t=>t.trim()).slice(0,3).join(", ")})]}),on&&e.jsx("span",{className:"rounded-full border border-white/10 bg-white/10 px-2 py-0.5 font-semibold text-white/85",children:on}),tn&&e.jsx("span",{className:"rounded-full border border-white/10 bg-white/10 px-2 py-0.5 font-semibold text-white/70",children:tn})]})]}),tt?e.jsxs("div",{className:"flex min-h-0 flex-1 flex-col overflow-hidden rounded-2xl border border-white/10 bg-white/10 px-3 py-2",children:[e.jsx("p",{className:"text-[length:var(--mn-swipe-kicker)] font-semibold uppercase tracking-[0.16em] text-white/45",children:"Overview"}),e.jsx("p",{className:"mt-1 min-h-0 flex-1 overflow-hidden text-[clamp(0.82rem,2.9vw,0.95rem)] leading-relaxed text-white/70",style:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:S,overflow:"hidden"},children:tt})]}):e.jsx("div",{className:"min-h-0 flex-1"}),me||Pe?e.jsxs("div",{className:"shrink-0 min-w-0 space-y-1 text-[clamp(0.70rem,2.6vw,0.78rem)] text-white/70",children:[me&&e.jsxs("p",{className:"line-clamp-1 min-w-0",children:[e.jsx("span",{className:"font-semibold text-white/75",children:"Director:"})," ",e.jsx("span",{className:"min-w-0",children:me})]}),Pe&&e.jsxs("p",{className:"line-clamp-1 min-w-0",children:[e.jsx("span",{className:"font-semibold text-white/75",children:"Cast:"})," ",e.jsx("span",{className:"min-w-0",children:Pe.split(",").map(t=>t.trim()).filter(Boolean).slice(0,4).join(", ")})]})]}):null,e.jsxs("div",{className:"shrink-0 space-y-2",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/10 px-3 py-1.5",children:[e.jsx("span",{className:"text-[length:var(--mn-swipe-chip)] font-semibold text-white/50",children:"Your rating"}),e.jsx("div",{className:"flex items-center gap-0.5","aria-label":"Your rating",children:Array.from({length:5}).map((t,n)=>{const i=n+1,l=Rt!=null&&Rt>=i;return e.jsx("button",{type:"button",onClick:()=>pr(i),className:"flex h-[var(--mn-swipe-star-hit)] w-[var(--mn-swipe-star-hit)] items-center justify-center rounded-full hover:scale-105 focus-visible:outline-none",children:e.jsx(y,{name:"star",filled:l,className:`text-[length:var(--mn-swipe-star-icon)] ${l?"text-yellow-400":"text-white/30"}`})},i)})})]}),e.jsxs("div",{className:"ml-auto flex flex-wrap items-center gap-1.5",children:[e.jsx("button",{type:"button",onClick:()=>mn(ne),className:`inline-flex items-center rounded-full px-[calc(var(--mn-swipe-pad)*0.6)] py-[calc(var(--mn-swipe-pad)*0.22)] text-[length:var(--mn-swipe-chip)] font-semibold transition-colors ${pn(ne)?"bg-primary/90 text-primary-foreground":"border border-white/10 bg-white/10 text-white/75 hover:bg-white/15"}`,children:"Watchlist"}),e.jsx("button",{type:"button",onClick:()=>mn(he),className:`inline-flex items-center rounded-full px-[calc(var(--mn-swipe-pad)*0.6)] py-[calc(var(--mn-swipe-pad)*0.22)] text-[length:var(--mn-swipe-chip)] font-semibold transition-colors ${pn(he)?"bg-emerald-500/90 text-primary-foreground":"border border-white/10 bg-white/10 text-white/75 hover:bg-white/15"}`,children:"Watched"}),e.jsxs("button",{type:"button",onClick:()=>Gt(!0),className:"inline-flex items-center gap-1 rounded-full border border-white/10 bg-white/10 px-[calc(var(--mn-swipe-pad)*0.6)] py-[calc(var(--mn-swipe-pad)*0.22)] text-[length:var(--mn-swipe-chip)] font-semibold text-white/75 hover:bg-white/15",children:[e.jsx(y,{name:"share",className:"text-[length:calc(var(--mn-swipe-chip)+0.2rem)]"}),e.jsx("span",{className:"hidden sm:inline",children:"Share"})]})]})]}),typeof s.friendLikesCount=="number"&&s.friendLikesCount>0||s.topFriendName&&s.topFriendReviewSnippet?e.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/10 px-[calc(var(--mn-swipe-pad)*0.75)] py-[calc(var(--mn-swipe-pad)*0.5)] text-[length:var(--mn-swipe-chip)] text-white/80 shadow-md",children:[typeof s.friendLikesCount=="number"&&s.friendLikesCount>0&&e.jsxs("div",{className:"inline-flex items-center gap-1 text-[length:var(--mn-swipe-chip)] text-white/60",children:[e.jsx(y,{name:"local_fire_department",filled:!0,className:"text-[16px] text-primary/80"}),s.friendLikesCount===1?"1 friend likes this":`${s.friendLikesCount} friends like this`]}),s.topFriendName&&s.topFriendReviewSnippet&&e.jsxs("div",{className:"mt-1 inline-flex w-full items-start gap-2 text-left",children:[e.jsx(y,{name:"check_circle",filled:!0,className:"mt-0.5 text-[16px] text-primary"}),e.jsxs("span",{className:"block line-clamp-2 text-[length:var(--mn-swipe-chip)]",children:[s.topFriendName,": “",s.topFriendReviewSnippet,"”"]})]})]}):null]})]})}),e.jsx("div",{className:"mt-2 flex shrink-0 justify-end",children:e.jsx("button",{type:"button",onClick:()=>Ke(t=>!t),"aria-expanded":He,"aria-controls":"swipe-detail-panel",className:"inline-flex items-center gap-1 rounded-full border border-white/15 bg-white/5 px-[calc(var(--mn-swipe-pad)*0.6)] py-[calc(var(--mn-swipe-pad)*0.22)] text-[length:var(--mn-swipe-chip)] font-semibold text-white/70 hover:bg-white/10 hover:text-white",children:e.jsx("span",{children:He?"Collapse":"Full details"})})})]})]})]})]},D??"empty")})]}),zn&&e.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center bg-gradient-to-b from-background/70 via-background/50 to-background/80",children:e.jsxs("div",{className:"pointer-events-auto max-w-xs rounded-2xl border border-border bg-background/95 p-4 text-center shadow-lg",children:[e.jsx("p",{className:"text-sm font-semibold text-foreground",children:"Swipe to decide"}),e.jsx("p",{className:"mt-1 text-[12px] text-muted-foreground",children:"Swipe left to pass, right to save what you love."}),e.jsx("button",{type:"button",className:"mt-3 w-full rounded-xl bg-primary px-3 py-2 text-sm font-semibold text-white shadow-md",onClick:()=>{Xe(!1),typeof window<"u"&&localStorage.setItem(ze,"1")},children:"Got it"})]})})]})]}),e.jsxs("div",{className:"mt-2 flex shrink-0 items-center justify-center gap-[var(--mn-swipe-gap)]","aria-label":"Swipe actions",children:[e.jsx("button",{type:"button",onClick:()=>_e("dislike"),disabled:$e,className:"inline-flex h-[var(--mn-swipe-action)] w-[var(--mn-swipe-action)] items-center justify-center rounded-full border border-white/10 bg-white/10 text-white/60 shadow-md backdrop-blur transition-all duration-150 hover:bg-white/15 active:translate-y-[1px] disabled:cursor-not-allowed disabled:opacity-50","aria-label":"Dislike",children:e.jsx(y,{name:"close",className:"text-[length:var(--mn-swipe-icon)]"})}),e.jsx("button",{type:"button",onClick:ur,disabled:$e,className:"relative inline-flex h-[var(--mn-swipe-action-primary)] w-[var(--mn-swipe-action-primary)] items-center justify-center rounded-full bg-primary text-primary-foreground shadow-[0_22px_55px_rgba(0,0,0,0.55)] transition-all duration-150 hover:brightness-110 active:translate-y-[1px] disabled:cursor-not-allowed disabled:opacity-50","aria-label":"Add to watchlist",children:e.jsx(y,{name:"bookmark_add",filled:!0,className:"text-[length:var(--mn-swipe-icon-primary)]"})}),e.jsx("button",{type:"button",onClick:()=>_e("like"),disabled:$e,className:"inline-flex h-[var(--mn-swipe-action)] w-[var(--mn-swipe-action)] items-center justify-center rounded-full border border-white/10 bg-white/10 text-white/60 shadow-md backdrop-blur transition-all duration-150 hover:bg-white/15 active:translate-y-[1px] disabled:cursor-not-allowed disabled:opacity-50","aria-label":"Like",children:e.jsx(y,{name:"favorite",filled:!0,className:"text-[length:var(--mn-swipe-icon)]"})})]}),e.jsx(os,{isOpen:Qn,onClose:()=>Gt(!1),activeCard:s,shareUrl:fr,onShareExternal:xr}),e.jsx(Gr,{open:g,onOpenChange:_,children:e.jsxs(Hr,{className:"max-w-md border border-border/60 bg-card text-foreground",children:[e.jsxs(Kr,{children:[e.jsx(Vr,{children:"Filters"}),e.jsx(Zr,{className:"text-muted-foreground",children:"Fine-tune what shows up in your Discovery deck."})]}),e.jsxs("div",{className:"mt-2 space-y-5",children:[e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 text-xs font-semibold tracking-wide text-muted-foreground",children:"Content type"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{label:"All",value:null},{label:"Movies",value:"movie"},{label:"Series",value:"series"},{label:"Anime",value:"anime"}].map(t=>{const n=o===t.value;return e.jsxs("button",{type:"button",onClick:()=>h(t.value),className:["inline-flex items-center gap-2 rounded-full border px-3 py-1.5 text-xs font-semibold transition",n?"border-primary/60 bg-primary/15 text-foreground":"border-border/60 bg-background/30 text-muted-foreground hover:bg-background/45"].join(" "),children:[n?e.jsx(y,{name:"check_circle",filled:!0,className:"text-[18px] text-primary"}):e.jsx("span",{className:"h-4 w-4"}),t.label]},t.label)})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("div",{className:"text-xs font-semibold tracking-wide text-muted-foreground",children:"Genres"}),b.length>0&&e.jsx("button",{type:"button",onClick:()=>j([]),className:"text-xs font-semibold text-primary hover:underline",children:"Clear"})]}),$t.length===0?e.jsx("p",{className:"text-xs text-muted-foreground",children:"Load a few cards to unlock genre filters."}):e.jsx("div",{className:"max-h-40 overflow-auto rounded-xl border border-border/60 bg-background/20 p-2",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:$t.map(t=>{const n=b.some(i=>i.toLowerCase()===t.toLowerCase());return e.jsx("button",{type:"button",onClick:()=>j(i=>n?i.filter(l=>l.toLowerCase()!==t.toLowerCase()):[...i,t]),className:["rounded-full border px-3 py-1 text-xs font-semibold transition",n?"border-primary/60 bg-primary/15 text-foreground":"border-border/60 bg-card/40 text-muted-foreground hover:bg-card/55"].join(" "),children:t},t)})})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("div",{className:"text-xs font-semibold tracking-wide text-muted-foreground",children:"Minimum rating"}),e.jsx("div",{className:"text-xs font-semibold text-foreground",children:P<=0?"Any":P.toFixed(1)})]}),e.jsx("input",{type:"range",min:0,max:10,step:.5,value:P,onChange:t=>q(Number(t.target.value)),className:"w-full"}),e.jsxs("div",{className:"mt-1 flex justify-between text-[11px] text-muted-foreground",children:[e.jsx("span",{children:"0"}),e.jsx("span",{children:"10"})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{h(null),j([]),q(0)},className:"flex-1 rounded-xl border border-border/60 bg-background/20 px-4 py-2 text-sm font-semibold text-muted-foreground hover:bg-background/35",children:"Reset"}),e.jsx("button",{type:"button",onClick:()=>_(!1),className:"flex-1 rounded-xl bg-primary px-4 py-2 text-sm font-semibold text-primary-foreground hover:opacity-90",children:"Done"})]})]})]})}),Sr()]})]})},os=({isOpen:r,onClose:o,activeCard:h,shareUrl:g,onShareExternal:_})=>{const{user:b}=In(),{data:j=[],isLoading:P}=Br();if(a.useEffect(()=>{if(!r)return;const S=Me=>{Me.key==="Escape"&&o()};return window.addEventListener("keydown",S),()=>window.removeEventListener("keydown",S)},[r,o]),!r||!h)return null;const q=`Check this out: ${h.title}

${g}`,be=S=>{S.target===S.currentTarget&&o()},ut=S=>{(S.key==="Enter"||S.key===" ")&&o()};return e.jsx("div",{role:"button",tabIndex:0,className:"fixed inset-0 z-[9999] flex flex-col justify-end bg-black/55",onClick:be,onKeyDown:ut,children:e.jsxs("div",{role:"dialog","aria-modal":"true",className:"pointer-events-auto mb-[72px] w-full max-w-md self-center rounded-t-2xl bg-card pb-3 pt-2 shadow-[0_-18px_45px_rgba(0,0,0,0.65)]",onClick:S=>S.stopPropagation(),onKeyDown:S=>S.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-4 pb-2",children:[e.jsx("button",{type:"button","aria-hidden":"true",tabIndex:-1,className:"rounded-full p-1 text-muted-foreground",children:e.jsx(y,{name:"search",className:"text-[18px]"})}),e.jsx("span",{className:"text-sm font-semibold text-foreground",children:"Send to"}),e.jsx("button",{type:"button",onClick:o,className:"rounded-full p-1 text-muted-foreground hover:bg-background/80",children:e.jsx("span",{className:"text-[18px] leading-none",children:"×"})})]}),e.jsxs("section",{className:"border-t border-border px-4 pt-3 pb-2",children:[e.jsx("h2",{className:"mb-2 text-[12px] font-medium uppercase tracking-[0.08em] text-muted-foreground/90",children:"Send to"}),P?e.jsx("div",{className:"flex gap-3 overflow-hidden",children:Array.from({length:4}).map((S,Me)=>e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:"h-11 w-11 animate-pulse rounded-full bg-border/50"}),e.jsx("div",{className:"h-2.5 w-12 animate-pulse rounded bg-border/40"})]},Me))}):b?j.length===0?e.jsx("p",{className:"text-[12px] text-muted-foreground/80",children:"No conversations yet. Start a chat from a profile or the Messages tab."}):e.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1 pt-0.5",children:j.map(S=>e.jsx(cs,{conversation:S,text:q},S.id))}):e.jsx("p",{className:"text-[12px] text-muted-foreground/80",children:"Sign in to share via messages."})]}),e.jsx("section",{className:"border-t border-border px-4 pt-3 pb-3",children:e.jsxs("div",{className:"flex gap-3 overflow-x-auto pb-1 pt-0.5",children:[e.jsx(us,{shareUrl:g,title:h.title}),e.jsx(ms,{shareUrl:g,title:h.title}),e.jsx(ps,{onShareExternal:_}),e.jsx(ds,{shareUrl:g})]})})]})})},cs=({conversation:r,text:o})=>{const h=r.isGroup?null:r.participants?.find(q=>!q.isSelf)??r.participants?.[0],g=h?.displayName??r.title??"Conversation",_=h?.avatarUrl,b=Xr(r.id),j=()=>{b.isPending||b.mutate({text:o})},P=g.split(" ").map(q=>q.charAt(0).toUpperCase()).slice(0,2).join("");return e.jsxs("button",{type:"button",onClick:j,className:"flex w-[72px] flex-col items-center gap-1 text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex h-11 w-11 items-center justify-center overflow-hidden rounded-full bg-muted text-xs text-muted-foreground",children:_?e.jsx("img",{src:_,alt:g,className:"h-full w-full object-cover"}):e.jsx("span",{children:P})}),b.isSuccess&&e.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 flex h-4 w-4 items-center justify-center rounded-full bg-emerald-500",children:e.jsx(y,{name:"check",filled:!0,className:"text-[14px] text-primary-foreground"})})]}),e.jsx("span",{className:"line-clamp-2 max-w-[72px] text-xs text-foreground",children:g})]})},ds=({shareUrl:r})=>{const o=async()=>{if(navigator.clipboard?.writeText)try{await navigator.clipboard.writeText(r)}catch{}};return e.jsxs("button",{type:"button",onClick:o,className:"flex w-[72px] flex-col items-center gap-1 text-center",children:[e.jsx("div",{className:"flex h-11 w-11 items-center justify-center rounded-full bg-primary",children:e.jsx(y,{name:"link",className:"text-[18px] text-primary-foreground"})}),e.jsx("span",{className:"line-clamp-2 max-w-[72px] text-xs text-foreground",children:"Copy link"})]})},us=({shareUrl:r,title:o})=>{const h=()=>{if(typeof window>"u")return;const g=`Check this out: ${o}

${r}`,_=`https://api.whatsapp.com/send?text=${encodeURIComponent(g)}`;window.open(_,"_blank","noopener,noreferrer")};return e.jsxs("button",{type:"button",onClick:h,className:"flex w-[72px] flex-col items-center gap-1 text-center",children:[e.jsx("div",{className:"flex h-11 w-11 items-center justify-center rounded-full bg-primary",children:e.jsx("span",{className:"text-[16px] font-semibold text-white",children:"W"})}),e.jsx("span",{className:"line-clamp-2 max-w-[72px] text-xs text-foreground",children:"WhatsApp"})]})},ms=({shareUrl:r,title:o})=>{const h=()=>{if(typeof window>"u")return;const g=`Check this out: ${o}

${r}`,_=`https://t.me/share/url?url=${encodeURIComponent(r)}&text=${encodeURIComponent(g)}`;window.open(_,"_blank","noopener,noreferrer")};return e.jsxs("button",{type:"button",onClick:h,className:"flex w-[72px] flex-col items-center gap-1 text-center",children:[e.jsx("div",{className:"flex h-11 w-11 items-center justify-center rounded-full bg-primary",children:e.jsx("span",{className:"text-[16px] font-semibold text-white",children:"T"})}),e.jsx("span",{className:"line-clamp-2 max-w-[72px] text-xs text-foreground",children:"Telegram"})]})},ps=({onShareExternal:r})=>{const o=async()=>{await r()};return e.jsxs("button",{type:"button",onClick:o,className:"flex w-[72px] flex-col items-center gap-1 text-center",children:[e.jsx("div",{className:"flex h-11 w-11 items-center justify-center rounded-full border border-border bg-muted",children:e.jsx(y,{name:"more_horiz",className:"text-[18px] text-muted-foreground"})}),e.jsx("span",{className:"line-clamp-2 max-w-[72px] text-xs text-foreground",children:"More"})]})};export{Fs as default};
