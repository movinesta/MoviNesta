import{c as D,r as g,j as e,L as p}from"./index-DyWq_Gt8.js";import{T as F}from"./TopBar-Cwkp26YK.js";import{T as I,a as $,b as W}from"./Tabs-C1kPOS6V.js";import{C as M,D as E,a as R}from"./DiaryStatsTab-BEeXXBWw.js";import{u as U,a as Y}from"./useDiaryLibrary-D8uhQUAT.js";import{d as B,a as q}from"./diaryStatus-BH3whMXG.js";import{F as N}from"./film-clFOPZLM.js";import{S as P}from"./star-DjoVrBLJ.js";import{C as V,L as z}from"./list-checks-ChhDx3S8.js";import"./index-LadubUCe.js";import"./index-vAwoU-j0.js";import"./format-DMUSBM01.js";import"./sparkles-Bx_Gyw2G.js";import"./users-D_v2v9Fg.js";import"./bookmark-plus-BktNhIJb.js";import"./useMutation-C5YwRx1y.js";const G=[["path",{d:"M2 5h20",key:"1fs1ex"}],["path",{d:"M6 12h12",key:"8npq4p"}],["path",{d:"M9 19h6",key:"456am0"}]],w=D("list-filter",G),H=[{value:"all",label:"All"},{value:"want_to_watch",label:"Want to Watch"},{value:"watching",label:"Watching"},{value:"watched",label:"Watched"},{value:"dropped",label:"Dropped"}],J=[{value:"all",label:"All types"},{value:"movie",label:"Movies"},{value:"series",label:"Series"},{value:"anime",label:"Anime"}],K=({userId:r,isOwnProfile:a=!1,displayName:c,username:s})=>{const[m,k]=g.useState("all"),[x,T]=g.useState("all"),{entries:u,isLoading:S,isError:L,error:C}=U({status:m==="all"?void 0:m,type:x==="all"?void 0:x},r),{updateStatus:f,updateRating:y}=Y(),h=f.isPending||y.isPending,d=a,v=c||(s?`@${s}`:"this user");return S?e.jsxs("div",{className:"px-2 pb-4",children:[e.jsx("div",{className:"mb-3 flex items-center justify-between gap-2 px-1 text-xs text-muted-foreground",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(w,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:a?"Loading your library…":`Loading ${v}’s library…`})]})}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Array.from({length:6}).map((t,o)=>e.jsxs("div",{className:"overflow-hidden rounded-2xl border border-border bg-card/80 shadow-lg",children:[e.jsx("div",{className:"h-40 w-full bg-background/70"}),e.jsxs("div",{className:"space-y-1.5 p-2.5",children:[e.jsx("div",{className:"h-3 w-3/4 rounded bg-background/70"}),e.jsx("div",{className:"h-2.5 w-1/2 rounded bg-background/80"}),e.jsx("div",{className:"h-2.5 w-2/3 rounded bg-background/80"})]})]},o))})]}):L?e.jsx("div",{className:"flex min-h-[40vh] items-center justify-center px-4",children:e.jsxs("div",{className:"max-w-sm rounded-2xl border border-destructive/40 bg-destructive/5 p-4 text-center text-xs text-foreground shadow-lg",children:[e.jsxs("p",{className:"font-semibold",children:["Unable to load ",a?"your":"their"," library."]}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:C??"Please try again in a moment."})]})}):u.length?e.jsxs("div",{className:"px-2 pb-4",children:[e.jsxs("div",{className:"mb-3 flex flex-wrap items-center justify-between gap-2 px-1 text-xs",children:[e.jsx("div",{className:"flex flex-wrap gap-1",children:H.map(t=>{const o=m===t.value;return e.jsx("button",{type:"button",onClick:()=>k(t.value),className:`rounded-full border px-2.5 py-1 text-xs transition ${o?"border-primary/60 bg-primary text-foreground shadow-sm":"border-border bg-card/80 text-muted-foreground hover:border-border hover:text-foreground"}`,children:t.label},t.value)})}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(w,{className:"h-3.5 w-3.5 text-muted-foreground","aria-hidden":"true"}),e.jsxs("label",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx("span",{children:"Type"}),e.jsx("select",{value:x,onChange:t=>T(t.target.value),className:"rounded-full border border-border bg-card/80 px-2 py-1 text-xs text-foreground",children:J.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3 sm:grid-cols-3",children:u.length===0?e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center py-12 text-center text-sm text-muted-foreground",children:[e.jsx("p",{className:"font-medium text-foreground",children:a?"Your diary is empty":"No diary entries yet"}),e.jsx("p",{className:"mt-1 max-w-xs text-xs text-muted-foreground",children:a?"Start by searching for a movie or show and adding it to your diary.":"When they start logging what they watch, it will show up here."}),a&&e.jsx(p,{to:"/search",className:"mt-4 inline-flex items-center rounded-full bg-primary px-4 py-1.5 text-xs font-medium text-primary-foreground shadow-sm hover:bg-primary/90",children:"Search titles"})]}):u.map(t=>{const o=()=>{if(!d)return;const l=["want_to_watch","watching","watched","dropped"],i=l.indexOf(t.status),n=l[(i+1)%l.length];f.mutate({titleId:t.titleId,status:n,type:t.type})},A=l=>{if(!d)return;const i=t.rating===l?null:l;y.mutate({titleId:t.titleId,rating:i,type:t.type})},j=`/title/${t.titleId}`;return e.jsxs("article",{className:"group flex flex-col overflow-hidden rounded-2xl border border-border bg-card/80 shadow-lg",children:[e.jsx(p,{to:j,className:"relative block",children:e.jsx("div",{className:"aspect-[2/3] w-full overflow-hidden bg-background/80",children:t.posterUrl?e.jsx("img",{src:t.posterUrl,alt:t.title,className:"h-full w-full object-cover transition-transform duration-200 group-hover:scale-[1.03]"}):e.jsxs("div",{className:"flex h-full w-full items-center justify-center text-xs text-muted-foreground",children:[e.jsx(N,{className:"mr-1 h-4 w-4"}),"No poster"]})})}),e.jsxs("div",{className:"flex flex-1 flex-col gap-1.5 p-2.5",children:[e.jsxs("div",{className:"min-h-[2.4rem]",children:[e.jsx(p,{to:j,className:"line-clamp-2 text-sm font-medium text-foreground hover:underline",children:t.title}),t.year&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["(",t.year,")"]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-1",children:[e.jsx("button",{type:"button",onClick:o,disabled:h||!d,className:`rounded-full border px-2 py-0.5 text-[9px] font-medium transition ${q(t.status??null)} ${h?"opacity-70":d?"hover:border-primary/70 hover:bg-primary":"opacity-80"}`,children:B(t.status??null)}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"flex items-center gap-0.5",children:Array.from({length:5}).map((l,i)=>{const n=i+1,_=(t.rating??0)>=n;return e.jsx("button",{type:"button",className:"p-0.5",disabled:h||!d,onClick:()=>A(n),children:e.jsx(P,{className:`h-3.5 w-3.5 ${_?"fill-yellow-400 text-yellow-300":"text-muted-foreground"}`})},i)})}),e.jsx("span",{className:"text-xs text-muted-foreground",children:t.rating!=null?`${t.rating}/5`:"No rating"})]})]})]})]},t.id)})})]}):e.jsx("div",{className:"flex min-h-[40vh] items-center justify-center px-4",children:e.jsxs("div",{className:"max-w-sm rounded-2xl border border-border bg-card/80 p-5 text-center text-xs text-muted-foreground shadow-lg",children:[e.jsx("div",{className:"mx-auto mb-3 flex h-10 w-10 items-center justify-center rounded-2xl bg-primary/15",children:e.jsx(N,{className:"h-5 w-5 text-primary","aria-hidden":"true"})}),e.jsx("p",{className:"font-heading text-sm font-semibold text-foreground",children:a?"Your library is empty":`${v}'s library is empty`}),e.jsx("p",{className:"mt-1 text-xs",children:a?"As you add titles to your Watchlist and mark them as watched, this tab will turn into a sortable diary of everything you’ve seen.":"When they add titles to their Watchlist or mark them watched, you’ll be able to browse their picks here."})]})})},b=[{key:"timeline",label:"Timeline",icon:V,description:"Chronological history of your ratings, reviews, and library updates."},{key:"library",label:"Library",icon:z,description:"Filter your watchlist and history by status and type."},{key:"stats",label:"Stats",icon:M,description:"Rating distribution, top genres, and watch trends over time."}],xe=()=>{const[r,a]=g.useState("timeline"),c=b.find(s=>s.key===r)??b[0];return e.jsxs("div",{className:"flex flex-1 flex-col gap-4 pb-4",children:[e.jsx(F,{title:"Your clean movie diary",subtitle:"Log what you watch, manage your library, and keep tabs on your habits without the noise."}),e.jsxs("section",{className:"px-2",children:[e.jsx("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:e.jsx("div",{className:"w-full sm:max-w-lg",children:e.jsx(I,{value:r,onValueChange:s=>a(s),children:e.jsx($,{className:"w-full",children:b.map(s=>e.jsx(W,{value:s.key,icon:e.jsx(s.icon,{className:"h-3.5 w-3.5","aria-hidden":"true"}),children:s.label},s.key))})})})}),e.jsx("p",{className:"mt-1 px-1 text-xs text-muted-foreground",children:c.description})]}),e.jsxs("section",{"aria-live":"polite",className:"flex-1",children:[r==="timeline"&&e.jsx("div",{id:"diary-tabpanel-timeline",role:"tabpanel",className:"h-full w-full",children:e.jsx(E,{})}),r==="library"&&e.jsx("div",{id:"diary-tabpanel-library",role:"tabpanel",className:"h-full w-full",children:e.jsx(K,{})}),r==="stats"&&e.jsx("div",{id:"diary-tabpanel-stats",role:"tabpanel",className:"h-full w-full",children:e.jsx(R,{})})]})]})};export{xe as default};
