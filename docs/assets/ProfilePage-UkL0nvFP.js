import{D as pe,K as he,u as ve,b as we,e as ye,N as je,O as Ne,R as d,P as _e,c as z,y as ke,s as j,j as e,B as f,S as Ce,i as O,M as Se,n as Ue,m as se,E as Fe}from"./index-BhYCkKJ1.js";import{D as Pe,a as Le,b as Me,c as Ae,d as Ee,e as $e}from"./dialog-DKXGxth9.js";import{a as Be}from"./appUrl-BIFKGN0O.js";import{I as ie}from"./input-WYf2XWmQ.js";import{u as Ie}from"./useUserLastActive-B3ynIkGR.js";import{V as qe}from"./VerifiedBadge-Bqpsp2OE.js";import{u as De}from"./useToggleFollow-DfXcO5k7.js";import{u as ze}from"./useSuggestedPeople-AvbYDKYw.js";import{a as Te}from"./useDiaryLibrary-DjiZyGrD.js";import{A as Oe}from"./arrow-left-BlxqK35Q.js";import{S as Ke}from"./share-2-BUCL3I_Q.js";import{P as Ve}from"./plus-C69Lhyvl.js";const Qe=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],We=pe("settings",Qe),Re=a=>a?a.startsWith("@")?a:`@${a}`:null,re=(a,r)=>{const m=(a||r||"").replace(/^@/,"").trim();if(!m)return"?";const s=m.split(/\s+/);return s.length===1?s[0].slice(0,2).toUpperCase():(s[0][0]+s[1][0]).toUpperCase()},M=a=>a>=1e6?`${(a/1e6).toFixed(1).replace(/\.0$/,"")}M`:a>=1e4?`${Math.round(a/100)/10}k`:a>=1e3?`${(a/1e3).toFixed(1).replace(/\.0$/,"")}k`:String(a),Ye=async(a,r)=>{try{if(typeof navigator<"u"&&"share"in navigator){await navigator.share({title:a,url:r});return}}catch{}try{await navigator.clipboard.writeText(r)}catch{}};function T({title:a,imageUrl:r,onClick:o}){return e.jsxs("button",{type:"button",onClick:o,className:"group relative aspect-[2/3] overflow-hidden rounded-2xl bg-muted/40 text-left shadow-sm ring-1 ring-border/50 transition focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40 focus-visible:ring-offset-2 focus-visible:ring-offset-background",children:[r?e.jsx("img",{src:r,alt:a,className:"absolute inset-0 h-full w-full object-cover transition-transform duration-300 group-hover:scale-[1.02]",loading:"lazy"}):e.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-xs text-muted-foreground",children:a}),e.jsx("div",{className:"absolute inset-0 bg-black/0 transition-colors group-hover:bg-black/15"}),e.jsx("div",{className:"absolute inset-x-0 bottom-0 flex h-1/4 items-end bg-gradient-to-t from-black/70 via-black/25 to-transparent p-2",children:e.jsx("p",{className:"truncate text-xs font-medium text-white",children:a})})]})}function He({id:a,displayName:r,username:o,avatarUrl:m,matchPercent:s,isFollowing:p,onFollow:A,onOpen:E}){const N=typeof s=="number"&&s>0?`${s}% match`:p?"Following":"Similar taste";return e.jsxs("div",{className:"snap-start min-w-[140px] rounded-2xl border border-border/60 bg-card/80 p-3 shadow-sm",children:[e.jsxs("button",{type:"button",onClick:()=>E(o),className:"flex w-full flex-col items-center gap-3 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40 focus-visible:ring-offset-2 focus-visible:ring-offset-background",children:[m?e.jsx("img",{src:m,alt:r??o??"User",className:"h-16 w-16 rounded-full object-cover",loading:"lazy"}):e.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-muted text-xs font-semibold text-muted-foreground",children:re(r,o)}),e.jsxs("div",{className:"w-full text-center",children:[e.jsx("p",{className:"w-full truncate text-sm font-bold text-white",children:r??o??"User"}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:N})]})]}),e.jsx(f,{type:"button",onClick:()=>A(a,p),className:O("mt-3 h-8 w-full rounded-full text-xs font-bold",p?"bg-white/10 hover:bg-white/20":"bg-primary hover:bg-primary/80"),children:p?"Following":"Follow"})]})}const ot=()=>{const{username:a}=he(),r=ve(),{user:o}=we(),m=ye(),{data:s,isLoading:p,isError:A,error:E}=je(a??""),N=De(),b=!!s?.isCurrentUser,$=s?.displayName||s?.username||"Profile",K=Re(s?.username),{getStatus:V}=Ne(),C=s?.id??null,B=d.useMemo(()=>C?V(C):"offline",[V,C]),Q=Ie(C),W=d.useMemo(()=>{if(B==="online")return"Online";const t=_e(Q.data??null);return t?t==="Just now"?"Online":`Active ${t}`:null},[Q.data,B]),[h,S]=d.useState("favorites");d.useEffect(()=>S("favorites"),[a]);const{entries:u,isLoading:v,isError:ae}=Te({status:"all",type:"all"},s?.id),le=d.useMemo(()=>u.filter(t=>t.status==="watched").length,[u]),U=d.useMemo(()=>{const t=u.filter(l=>typeof l.rating=="number").sort((l,x)=>(x.rating??0)-(l.rating??0)),i=t.filter(l=>(l.rating??0)>=4);return(i.length?i:t).slice(0,60)},[u]),F=d.useMemo(()=>u.filter(t=>t.status==="watched").sort((t,i)=>t.updatedAt<i.updatedAt?1:-1).slice(0,60),[u]),R=d.useMemo(()=>u.filter(t=>t.status==="want_to_watch").sort((t,i)=>t.updatedAt<i.updatedAt?1:-1).slice(0,60),[u]),Y=d.useMemo(()=>(U.find(i=>!!i.posterUrl)??F.find(i=>!!i.posterUrl)??u.find(i=>!!i.posterUrl))?.posterUrl??null,[U,F,u]),{data:ne=[]}=ze(),H=ne.slice(0,10),{data:w=[],isLoading:G}=z({queryKey:["profile","lists",s?.id??null,b],enabled:!!s?.id,queryFn:async()=>{if(!s?.id)return[];let t=j.from("lists").select("id, name, description, is_public, updated_at").eq("user_id",s.id).order("updated_at",{ascending:!1}).limit(60);b||(t=t.eq("is_public",!0));const{data:i,error:l}=await t;if(l)throw new Error(l.message);return i??[]}}),oe=w.length,{data:de=new Map}=z({queryKey:["profile","listCovers",s?.id??null,w.map(t=>t.id).join(",")],enabled:!!s?.id&&w.length>0,queryFn:async()=>{const t=w.map(c=>c.id),{data:i,error:l}=await j.from("list_items").select("list_id, title_id, position").in("list_id",t).order("position",{ascending:!0}).limit(400);if(l)return console.warn("[ProfilePageV2] Failed to load list_items",l.message),new Map;const x=new Map;(i??[]).forEach(c=>{!c?.list_id||!c?.title_id||x.has(c.list_id)||x.set(c.list_id,c.title_id)});const _=Array.from(new Set(Array.from(x.values())));if(!_.length)return new Map;const{data:n,error:g}=await j.from("media_items").select(`id,
           kind,
           tmdb_title,
           tmdb_name,
           tmdb_original_title,
           tmdb_original_name,
           tmdb_release_date,
           tmdb_first_air_date,
           tmdb_poster_path,
           tmdb_backdrop_path,
           tmdb_original_language,
           omdb_title,
           omdb_year,
           omdb_language,
           omdb_imdb_id,
           omdb_imdb_rating,
           omdb_rating_rotten_tomatoes,
           omdb_poster,
           omdb_rated,
           tmdb_id`).in("id",_).limit(200);if(g)return console.warn("[ProfilePageV2] Failed to load list cover titles",g.message),new Map;const D=new Map(n.map(c=>{const k=se(c);return[k.id,k.posterUrl??k.backdropUrl??null]})),y=new Map;return x.forEach((c,k)=>{y.set(k,D.get(c)??null)}),y}}),{data:J=[],isLoading:I}=z({queryKey:["profile","reviews",s?.id??null],enabled:!!s?.id,queryFn:async()=>{if(!s?.id)return[];const{data:t,error:i}=await j.from("reviews").select("id, title_id, content_type, rating, headline, body, spoiler, created_at").eq("user_id",s.id).order("created_at",{ascending:!1}).limit(80);if(i)throw new Error(i.message);const l=t??[],x=Array.from(new Set(l.map(n=>n.title_id).filter(Boolean))),_=new Map;if(x.length){const{data:n,error:g}=await j.from("media_items").select(`id,
             kind,
             tmdb_title,
             tmdb_name,
             tmdb_original_title,
             tmdb_original_name,
             tmdb_release_date,
             tmdb_first_air_date,
             tmdb_poster_path,
             tmdb_backdrop_path,
             tmdb_original_language,
             omdb_title,
             omdb_year,
             omdb_language,
             omdb_imdb_id,
             omdb_imdb_rating,
             omdb_rating_rotten_tomatoes,
             omdb_poster,
             omdb_rated,
             tmdb_id`).in("id",x).limit(200);!g&&n&&n.forEach(D=>{const y=se(D);_.set(y.id,{title:y.title,posterUrl:y.posterUrl})})}return l.map(n=>{const g=_.get(n.title_id);return{id:n.id,titleId:n.title_id,title:g?.title??"Untitled",posterUrl:g?.posterUrl??null,ratingStars:Fe(n.rating??null),headline:n.headline,body:n.body,spoiler:!!n.spoiler,createdAt:n.created_at}})}}),[ce,X]=d.useState(!1),ue=async t=>{if(!o?.id){alert("You need to be signed in to start a conversation.");return}if(o.id===t){alert("You can't start a conversation with yourself.");return}X(!0);try{const i=await Ue("create-direct-conversation",{targetUserId:t},{timeoutMs:25e3});if(!i?.ok||!i.conversationId)throw new Error(i?.error??"Failed to start conversation");r(`/messages/${i.conversationId}`)}catch(i){console.error("[ProfilePageV2] Failed to start conversation",i),alert("Couldn't start conversation. Please try again.")}finally{X(!1)}},[me,P]=d.useState(!1),[Z,ee]=d.useState(""),[q,te]=d.useState(""),L=ke({mutationFn:async()=>{if(!o?.id)throw new Error("Not authenticated");const t=Z.trim();if(!t)throw new Error("List name is required");const{data:i,error:l}=await j.from("lists").insert({user_id:o.id,name:t,description:q.trim()?q.trim():null,is_public:!1}).select("id").single();if(l)throw new Error(l.message);return i},onSuccess:async t=>{P(!1),ee(""),te(""),await m.invalidateQueries({queryKey:["profile","lists",s?.id??null]}),t?.id&&r(`/lists/${t.id}`)}}),xe=async(t,i)=>{s?.id&&(await N.mutateAsync({targetUserId:t,currentlyFollowing:i}),m.invalidateQueries({queryKey:["suggested-people",o?.id??null]}))},fe=d.useMemo(()=>typeof window>"u"?"":Be(`/u/${s?.username??""}`),[s?.username]);if(p)return e.jsx("div",{className:"flex flex-1 flex-col",children:e.jsx("div",{className:"flex flex-1 items-center justify-center py-12 text-sm text-muted-foreground",children:"Loading profile…"})});if(A||!s)return e.jsx("div",{className:"flex flex-1 flex-col px-[var(--page-pad-x)] py-12",children:e.jsxs("div",{className:"mx-auto max-w-sm rounded-2xl border border-destructive/40 bg-destructive/5 p-4 text-center text-xs text-foreground shadow-lg",children:[e.jsx("p",{className:"font-semibold",children:"Unable to load profile."}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:E?.message??"Please try again in a moment."}),e.jsx(f,{type:"button",variant:"secondary",className:"mt-4",onClick:()=>r(-1),children:"Go back"})]})});const be=b&&H.length>0,ge=[{id:"favorites",label:"Favorites"},{id:"recent",label:"Recent"},{id:"watchlist",label:"Watchlist"},{id:"lists",label:"Lists"},{id:"reviews",label:"Reviews"}];return e.jsxs("div",{className:"relative flex min-h-screen w-full flex-1 flex-col pb-2",children:[e.jsxs("div",{className:"relative h-80 w-full shrink-0",children:[Y?e.jsx("img",{src:Y,alt:"Profile cover",className:"absolute inset-0 h-full w-full object-cover"}):e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-[#0b0611] via-[#150b1e] to-background"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black/40 via-transparent to-background"}),e.jsxs("div",{className:"absolute left-0 top-0 z-20 flex w-full items-center justify-between p-[var(--page-pad-x)] pt-12",children:[e.jsx("button",{type:"button",onClick:()=>r(-1),className:"flex h-11 w-11 items-center justify-center rounded-full bg-black/20 text-white backdrop-blur-md transition-colors hover:bg-black/40 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 focus-visible:ring-offset-black/20","aria-label":"Back",children:e.jsx(Oe,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:()=>r("/search"),className:"flex h-11 w-11 items-center justify-center rounded-full bg-black/20 text-white backdrop-blur-md transition-colors hover:bg-black/40 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 focus-visible:ring-offset-black/20","aria-label":"Search",children:e.jsx(Ce,{className:"h-5 w-5"})}),b?e.jsx("button",{type:"button",onClick:()=>r("/settings"),className:"flex h-11 w-11 items-center justify-center rounded-full bg-black/20 text-white backdrop-blur-md transition-colors hover:bg-black/40 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 focus-visible:ring-offset-black/20","aria-label":"Settings",children:e.jsx(We,{className:"h-5 w-5"})}):null]})]})]}),e.jsx("div",{className:"relative z-10 -mt-20 px-[var(--page-pad-x)]",children:e.jsxs("div",{className:"flex flex-col items-start gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -inset-2 rounded-full bg-primary/30 blur-md"}),s.avatarUrl?e.jsx("img",{src:s.avatarUrl,alt:$,className:"relative h-28 w-28 rounded-full border-4 border-background bg-card object-cover shadow-xl"}):e.jsx("div",{className:"relative flex h-28 w-28 items-center justify-center rounded-full border-4 border-background bg-card text-2xl font-bold text-muted-foreground shadow-xl",children:re(s.displayName,s.username)})]}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h1",{className:"text-3xl font-bold leading-tight tracking-tight text-white",children:$}),e.jsx(qe,{isVerified:s.isVerified,type:s.verifiedType??null,label:s.verifiedLabel,verifiedAt:s.verifiedAt,org:s.verifiedByOrg,className:"mt-1 inline-flex items-center justify-center rounded-full p-1 text-white/90 hover:text-white"})]}),K?e.jsx("p",{className:"mt-1 text-base font-medium text-muted-foreground",children:K}):null,W?e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-sm font-medium text-muted-foreground",children:[B==="online"?e.jsx("span",{className:"h-2.5 w-2.5 rounded-full bg-green-500","aria-hidden":!0}):null,e.jsx("span",{children:W})]}):null]}),e.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[b?e.jsx(f,{type:"button",variant:"secondary",className:"h-9 rounded-full bg-white/10 px-5 text-sm font-semibold text-white hover:bg-white/20",onClick:()=>r("/settings/profile"),children:"Edit"}):e.jsx(f,{type:"button",variant:"secondary",className:O("h-9 rounded-full px-5 text-sm font-semibold",s.isFollowing?"bg-white/10 text-white hover:bg-white/20":"bg-primary text-white hover:bg-primary/80"),disabled:N.isPending,onClick:async()=>{await N.mutateAsync({targetUserId:s.id,currentlyFollowing:s.isFollowing}),await m.invalidateQueries({queryKey:["profile","byUsername",s.username??"",o?.id??null]})},children:s.isFollowing?"Following":"Follow"}),e.jsx(f,{type:"button",variant:"secondary",size:"icon",className:"rounded-full bg-white/10 text-white hover:bg-white/20",onClick:()=>Ye(`${$} on MoviNesta`,fe),"aria-label":"Share profile",children:e.jsx(Ke,{className:"h-4 w-4"})})]})]}),s.bio?e.jsx("p",{className:"mt-3 max-w-sm text-sm leading-relaxed text-gray-300",children:s.bio}):null,b?null:e.jsx("div",{className:"mt-4 flex gap-2",children:e.jsxs(f,{type:"button",variant:"secondary",className:"h-9 rounded-full bg-white/10 px-4 text-sm font-semibold text-white hover:bg-white/20",onClick:()=>ue(s.id),disabled:ce,children:[e.jsx(Se,{className:"h-4 w-4"}),"Message"]})})]})]})}),e.jsxs("div",{className:"flex justify-between px-[var(--page-pad-x)] py-6",children:[e.jsxs("button",{type:"button",onClick:()=>S("recent"),className:"group flex flex-col items-center gap-1",children:[e.jsx("span",{className:"text-2xl font-bold text-white transition-colors group-hover:text-primary",children:M(le)}),e.jsx("span",{className:"text-xs font-medium uppercase tracking-wide text-muted-foreground",children:"Watched"})]}),e.jsxs("button",{type:"button",onClick:()=>S("lists"),className:"group flex flex-col items-center gap-1",children:[e.jsx("span",{className:"text-2xl font-bold text-white transition-colors group-hover:text-primary",children:M(oe)}),e.jsx("span",{className:"text-xs font-medium uppercase tracking-wide text-muted-foreground",children:"Lists"})]}),e.jsxs("button",{type:"button",onClick:()=>r(`/u/${s.username}/followers`),className:"group flex flex-col items-center gap-1",children:[e.jsx("span",{className:"text-2xl font-bold text-white transition-colors group-hover:text-primary",children:M(s.followersCount)}),e.jsx("span",{className:"text-xs font-medium uppercase tracking-wide text-muted-foreground",children:"Followers"})]}),e.jsxs("button",{type:"button",onClick:()=>r(`/u/${s.username}/following`),className:"group flex flex-col items-center gap-1",children:[e.jsx("span",{className:"text-2xl font-bold text-white transition-colors group-hover:text-primary",children:M(s.followingCount)}),e.jsx("span",{className:"text-xs font-medium uppercase tracking-wide text-muted-foreground",children:"Following"})]})]}),be?e.jsxs("div",{className:"mb-8 pl-5",children:[e.jsx("h3",{className:"mb-4 text-lg font-bold text-white",children:"Discover People"}),e.jsx("div",{className:"no-scrollbar flex snap-x gap-3 overflow-x-auto pb-4 pr-5",children:H.map(t=>e.jsx(He,{id:t.id,displayName:t.displayName,username:t.username,avatarUrl:t.avatarUrl,matchPercent:t.matchPercent,isFollowing:t.isFollowing,onFollow:xe,onOpen:i=>{i&&r(`/u/${i.replace(/^@/,"")}`)}},t.id))})]}):null,e.jsx("div",{className:"sticky top-0 z-20 border-b border-white/5 bg-background/80 px-5 backdrop-blur-lg",children:e.jsx("div",{className:"no-scrollbar flex gap-8 overflow-x-auto",children:ge.map(t=>{const i=h===t.id;return e.jsxs("button",{type:"button",onClick:()=>S(t.id),className:O("relative shrink-0 py-4 text-sm transition-colors",i?"font-bold text-white":"font-medium text-muted-foreground hover:text-white"),children:[t.label,i?e.jsx("span",{className:"absolute bottom-0 left-0 h-0.5 w-full rounded-t-full bg-primary shadow-[0_0_10px_rgba(127,19,236,0.5)]"}):null]},t.id)})})}),e.jsxs("div",{className:"min-h-[420px] p-4",children:[ae?e.jsx("div",{className:"rounded-2xl border border-destructive/40 bg-destructive/5 p-4 text-xs text-muted-foreground",children:"Failed to load library."}):null,h==="favorites"?e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[(v?[]:U).map(t=>e.jsx(T,{title:t.title,imageUrl:t.posterUrl,onClick:()=>r(`/title/${t.titleId}`)},t.id)),!v&&U.length===0?e.jsx("div",{className:"col-span-3 rounded-2xl border border-white/5 bg-card p-5 text-center text-xs text-muted-foreground",children:"No favorites yet."}):null]}):null,h==="recent"?e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[(v?[]:F).map(t=>e.jsx(T,{title:t.title,imageUrl:t.posterUrl,onClick:()=>r(`/title/${t.titleId}`)},t.id)),!v&&F.length===0?e.jsx("div",{className:"col-span-3 rounded-2xl border border-white/5 bg-card p-5 text-center text-xs text-muted-foreground",children:"No watched titles yet."}):null]}):null,h==="watchlist"?e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[(v?[]:R).map(t=>e.jsx(T,{title:t.title,imageUrl:t.posterUrl,onClick:()=>r(`/title/${t.titleId}`)},t.id)),!v&&R.length===0?e.jsx("div",{className:"col-span-3 rounded-2xl border border-white/5 bg-card p-5 text-center text-xs text-muted-foreground",children:"Watchlist is empty."}):null]}):null,h==="lists"?e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[G?null:w.map(t=>{const i=de.get(t.id)??null;return e.jsxs("button",{type:"button",onClick:()=>r(`/lists/${t.id}`),className:"group relative overflow-hidden rounded-2xl border border-white/5 bg-card text-left",children:[i?e.jsx("img",{src:i,alt:t.name,className:"absolute inset-0 h-full w-full object-cover opacity-70 transition-transform duration-300 group-hover:scale-[1.02]",loading:"lazy"}):null,e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/35 to-black/10"}),e.jsxs("div",{className:"relative p-4",children:[e.jsx("p",{className:"text-sm font-bold text-white",children:t.name}),t.description?e.jsx("p",{className:"mt-1 line-clamp-2 text-xs text-muted-foreground",children:t.description}):e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:t.is_public?"Public list":"Private list"})]})]},t.id)}),!G&&w.length===0?e.jsx("div",{className:"col-span-2 rounded-2xl border border-white/5 bg-card p-5 text-center text-xs text-muted-foreground",children:"No lists yet."}):null]}):null,h==="reviews"?e.jsxs("div",{className:"space-y-3",children:[I?e.jsx("div",{className:"rounded-2xl border border-white/5 bg-card p-5 text-center text-xs text-muted-foreground",children:"Loading reviews…"}):null,!I&&J.length===0?e.jsx("div",{className:"rounded-2xl border border-white/5 bg-card p-5 text-center text-xs text-muted-foreground",children:"No reviews yet."}):null,I?null:J.map(t=>e.jsxs("button",{type:"button",onClick:()=>r(`/title/${t.titleId}`),className:"flex w-full gap-3 rounded-2xl border border-white/5 bg-card p-4 text-left",children:[e.jsx("div",{className:"h-16 w-12 overflow-hidden rounded-lg bg-muted/40",children:t.posterUrl?e.jsx("img",{src:t.posterUrl,alt:t.title,className:"h-full w-full object-cover",loading:"lazy"}):null}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("p",{className:"truncate text-sm font-semibold text-white",children:t.title}),typeof t.ratingStars=="number"?e.jsxs("span",{className:"shrink-0 rounded-full bg-white/10 px-2 py-0.5 text-xs font-semibold text-white",children:[t.ratingStars.toFixed(1),"★"]}):null]}),t.headline?e.jsx("p",{className:"mt-1 line-clamp-1 text-xs text-muted-foreground",children:t.headline}):null,t.body?e.jsx("p",{className:"mt-1 line-clamp-2 text-xs text-muted-foreground",children:t.spoiler?"Spoiler hidden":t.body}):null]})]},t.id))]}):null]}),b?e.jsx("button",{type:"button",onClick:()=>P(!0),className:"fixed bottom-24 right-6 z-50 flex h-14 w-14 items-center justify-center rounded-full bg-primary shadow-lg shadow-primary/40 transition-transform active:scale-95","aria-label":"Create list",children:e.jsx(Ve,{className:"h-7 w-7 text-white"})}):null,e.jsx(Pe,{open:me,onOpenChange:P,children:e.jsxs(Le,{children:[e.jsxs(Me,{children:[e.jsx(Ae,{children:"Create a list"}),e.jsx(Ee,{children:"Start a curated collection you can share later. You can add titles from any title page."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"create-list-name",className:"text-xs font-medium text-muted-foreground",children:"Name"}),e.jsx(ie,{id:"create-list-name",value:Z,onChange:t=>ee(t.target.value),placeholder:"e.g. Cozy Sci‑Fi",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"create-list-description",className:"text-xs font-medium text-muted-foreground",children:"Description (optional)"}),e.jsx(ie,{id:"create-list-description",value:q,onChange:t=>te(t.target.value),placeholder:"Why this list exists…",className:"mt-1"})]})]}),e.jsxs($e,{children:[e.jsx(f,{type:"button",variant:"secondary",onClick:()=>P(!1),disabled:L.isPending,children:"Cancel"}),e.jsx(f,{type:"button",onClick:()=>L.mutate(),disabled:L.isPending,children:L.isPending?"Creating…":"Create"})]})]})})]})};export{ot as default};
