var lm=s=>{throw TypeError(s)};var Hc=(s,e,r)=>e.has(s)||lm("Cannot "+r);var k=(s,e,r)=>(Hc(s,e,"read from private field"),r?r.call(s):e.get(s)),ge=(s,e,r)=>e.has(s)?lm("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,r),ie=(s,e,r,i)=>(Hc(s,e,"write to private field"),i?i.call(s,r):e.set(s,r),r),Ee=(s,e,r)=>(Hc(s,e,"access private method"),r);var So=(s,e,r,i)=>({set _(l){ie(s,e,l,r)},get _(){return k(s,e,i)}});function qp(s,e){for(var r=0;r<e.length;r++){const i=e[r];if(typeof i!="string"&&!Array.isArray(i)){for(const l in i)if(l!=="default"&&!(l in s)){const c=Object.getOwnPropertyDescriptor(i,l);c&&Object.defineProperty(s,l,c.get?c:{enumerable:!0,get:()=>i[l]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function r(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(l){if(l.ep)return;l.ep=!0;const c=r(l);fetch(l.href,c)}})();function Qu(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function Sv(s){if(Object.prototype.hasOwnProperty.call(s,"__esModule"))return s;var e=s.default;if(typeof e=="function"){var r=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(s).forEach(function(i){var l=Object.getOwnPropertyDescriptor(s,i);Object.defineProperty(r,i,l.get?l:{enumerable:!0,get:function(){return s[i]}})}),r}var Kc={exports:{}},Wi={},Qc={exports:{}},Pe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cm;function kv(){if(cm)return Pe;cm=1;var s=Symbol.for("react.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),c=Symbol.for("react.provider"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),x=Symbol.iterator;function j(O){return O===null||typeof O!="object"?null:(O=x&&O[x]||O["@@iterator"],typeof O=="function"?O:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,_={};function b(O,A,W){this.props=O,this.context=A,this.refs=_,this.updater=W||w}b.prototype.isReactComponent={},b.prototype.setState=function(O,A){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,A,"setState")},b.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function L(){}L.prototype=b.prototype;function C(O,A,W){this.props=O,this.context=A,this.refs=_,this.updater=W||w}var T=C.prototype=new L;T.constructor=C,N(T,b.prototype),T.isPureReactComponent=!0;var I=Array.isArray,q=Object.prototype.hasOwnProperty,F={current:null},G={key:!0,ref:!0,__self:!0,__source:!0};function B(O,A,W){var re,J={},ne=null,D=null;if(A!=null)for(re in A.ref!==void 0&&(D=A.ref),A.key!==void 0&&(ne=""+A.key),A)q.call(A,re)&&!G.hasOwnProperty(re)&&(J[re]=A[re]);var z=arguments.length-2;if(z===1)J.children=W;else if(1<z){for(var te=Array(z),ke=0;ke<z;ke++)te[ke]=arguments[ke+2];J.children=te}if(O&&O.defaultProps)for(re in z=O.defaultProps,z)J[re]===void 0&&(J[re]=z[re]);return{$$typeof:s,type:O,key:ne,ref:D,props:J,_owner:F.current}}function ae(O,A){return{$$typeof:s,type:O.type,key:A,ref:O.ref,props:O.props,_owner:O._owner}}function Y(O){return typeof O=="object"&&O!==null&&O.$$typeof===s}function xe(O){var A={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(W){return A[W]})}var ee=/\/+/g;function ue(O,A){return typeof O=="object"&&O!==null&&O.key!=null?xe(""+O.key):A.toString(36)}function Se(O,A,W,re,J){var ne=typeof O;(ne==="undefined"||ne==="boolean")&&(O=null);var D=!1;if(O===null)D=!0;else switch(ne){case"string":case"number":D=!0;break;case"object":switch(O.$$typeof){case s:case e:D=!0}}if(D)return D=O,J=J(D),O=re===""?"."+ue(D,0):re,I(J)?(W="",O!=null&&(W=O.replace(ee,"$&/")+"/"),Se(J,A,W,"",function(ke){return ke})):J!=null&&(Y(J)&&(J=ae(J,W+(!J.key||D&&D.key===J.key?"":(""+J.key).replace(ee,"$&/")+"/")+O)),A.push(J)),1;if(D=0,re=re===""?".":re+":",I(O))for(var z=0;z<O.length;z++){ne=O[z];var te=re+ue(ne,z);D+=Se(ne,A,W,te,J)}else if(te=j(O),typeof te=="function")for(O=te.call(O),z=0;!(ne=O.next()).done;)ne=ne.value,te=re+ue(ne,z++),D+=Se(ne,A,W,te,J);else if(ne==="object")throw A=String(O),Error("Objects are not valid as a React child (found: "+(A==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":A)+"). If you meant to render a collection of children, use an array instead.");return D}function we(O,A,W){if(O==null)return O;var re=[],J=0;return Se(O,re,"","",function(ne){return A.call(W,ne,J++)}),re}function Ce(O){if(O._status===-1){var A=O._result;A=A(),A.then(function(W){(O._status===0||O._status===-1)&&(O._status=1,O._result=W)},function(W){(O._status===0||O._status===-1)&&(O._status=2,O._result=W)}),O._status===-1&&(O._status=0,O._result=A)}if(O._status===1)return O._result.default;throw O._result}var je={current:null},K={transition:null},le={ReactCurrentDispatcher:je,ReactCurrentBatchConfig:K,ReactCurrentOwner:F};function Z(){throw Error("act(...) is not supported in production builds of React.")}return Pe.Children={map:we,forEach:function(O,A,W){we(O,function(){A.apply(this,arguments)},W)},count:function(O){var A=0;return we(O,function(){A++}),A},toArray:function(O){return we(O,function(A){return A})||[]},only:function(O){if(!Y(O))throw Error("React.Children.only expected to receive a single React element child.");return O}},Pe.Component=b,Pe.Fragment=r,Pe.Profiler=l,Pe.PureComponent=C,Pe.StrictMode=i,Pe.Suspense=m,Pe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=le,Pe.act=Z,Pe.cloneElement=function(O,A,W){if(O==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+O+".");var re=N({},O.props),J=O.key,ne=O.ref,D=O._owner;if(A!=null){if(A.ref!==void 0&&(ne=A.ref,D=F.current),A.key!==void 0&&(J=""+A.key),O.type&&O.type.defaultProps)var z=O.type.defaultProps;for(te in A)q.call(A,te)&&!G.hasOwnProperty(te)&&(re[te]=A[te]===void 0&&z!==void 0?z[te]:A[te])}var te=arguments.length-2;if(te===1)re.children=W;else if(1<te){z=Array(te);for(var ke=0;ke<te;ke++)z[ke]=arguments[ke+2];re.children=z}return{$$typeof:s,type:O.type,key:J,ref:ne,props:re,_owner:D}},Pe.createContext=function(O){return O={$$typeof:d,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},O.Provider={$$typeof:c,_context:O},O.Consumer=O},Pe.createElement=B,Pe.createFactory=function(O){var A=B.bind(null,O);return A.type=O,A},Pe.createRef=function(){return{current:null}},Pe.forwardRef=function(O){return{$$typeof:f,render:O}},Pe.isValidElement=Y,Pe.lazy=function(O){return{$$typeof:y,_payload:{_status:-1,_result:O},_init:Ce}},Pe.memo=function(O,A){return{$$typeof:g,type:O,compare:A===void 0?null:A}},Pe.startTransition=function(O){var A=K.transition;K.transition={};try{O()}finally{K.transition=A}},Pe.unstable_act=Z,Pe.useCallback=function(O,A){return je.current.useCallback(O,A)},Pe.useContext=function(O){return je.current.useContext(O)},Pe.useDebugValue=function(){},Pe.useDeferredValue=function(O){return je.current.useDeferredValue(O)},Pe.useEffect=function(O,A){return je.current.useEffect(O,A)},Pe.useId=function(){return je.current.useId()},Pe.useImperativeHandle=function(O,A,W){return je.current.useImperativeHandle(O,A,W)},Pe.useInsertionEffect=function(O,A){return je.current.useInsertionEffect(O,A)},Pe.useLayoutEffect=function(O,A){return je.current.useLayoutEffect(O,A)},Pe.useMemo=function(O,A){return je.current.useMemo(O,A)},Pe.useReducer=function(O,A,W){return je.current.useReducer(O,A,W)},Pe.useRef=function(O){return je.current.useRef(O)},Pe.useState=function(O){return je.current.useState(O)},Pe.useSyncExternalStore=function(O,A,W){return je.current.useSyncExternalStore(O,A,W)},Pe.useTransition=function(){return je.current.useTransition()},Pe.version="18.3.1",Pe}var um;function Gu(){return um||(um=1,Qc.exports=kv()),Qc.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dm;function Ev(){if(dm)return Wi;dm=1;var s=Gu(),e=Symbol.for("react.element"),r=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,l=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function d(f,m,g){var y,x={},j=null,w=null;g!==void 0&&(j=""+g),m.key!==void 0&&(j=""+m.key),m.ref!==void 0&&(w=m.ref);for(y in m)i.call(m,y)&&!c.hasOwnProperty(y)&&(x[y]=m[y]);if(f&&f.defaultProps)for(y in m=f.defaultProps,m)x[y]===void 0&&(x[y]=m[y]);return{$$typeof:e,type:f,key:j,ref:w,props:x,_owner:l.current}}return Wi.Fragment=r,Wi.jsx=d,Wi.jsxs=d,Wi}var hm;function Cv(){return hm||(hm=1,Kc.exports=Ev()),Kc.exports}var a=Cv(),E=Gu();const Ft=Qu(E),Pv=qp({__proto__:null,default:Ft},[E]);var ko={},Gc={exports:{}},Pt={},Jc={exports:{}},Yc={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fm;function Tv(){return fm||(fm=1,(function(s){function e(K,le){var Z=K.length;K.push(le);e:for(;0<Z;){var O=Z-1>>>1,A=K[O];if(0<l(A,le))K[O]=le,K[Z]=A,Z=O;else break e}}function r(K){return K.length===0?null:K[0]}function i(K){if(K.length===0)return null;var le=K[0],Z=K.pop();if(Z!==le){K[0]=Z;e:for(var O=0,A=K.length,W=A>>>1;O<W;){var re=2*(O+1)-1,J=K[re],ne=re+1,D=K[ne];if(0>l(J,Z))ne<A&&0>l(D,J)?(K[O]=D,K[ne]=Z,O=ne):(K[O]=J,K[re]=Z,O=re);else if(ne<A&&0>l(D,Z))K[O]=D,K[ne]=Z,O=ne;else break e}}return le}function l(K,le){var Z=K.sortIndex-le.sortIndex;return Z!==0?Z:K.id-le.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;s.unstable_now=function(){return c.now()}}else{var d=Date,f=d.now();s.unstable_now=function(){return d.now()-f}}var m=[],g=[],y=1,x=null,j=3,w=!1,N=!1,_=!1,b=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(K){for(var le=r(g);le!==null;){if(le.callback===null)i(g);else if(le.startTime<=K)i(g),le.sortIndex=le.expirationTime,e(m,le);else break;le=r(g)}}function I(K){if(_=!1,T(K),!N)if(r(m)!==null)N=!0,Ce(q);else{var le=r(g);le!==null&&je(I,le.startTime-K)}}function q(K,le){N=!1,_&&(_=!1,L(B),B=-1),w=!0;var Z=j;try{for(T(le),x=r(m);x!==null&&(!(x.expirationTime>le)||K&&!xe());){var O=x.callback;if(typeof O=="function"){x.callback=null,j=x.priorityLevel;var A=O(x.expirationTime<=le);le=s.unstable_now(),typeof A=="function"?x.callback=A:x===r(m)&&i(m),T(le)}else i(m);x=r(m)}if(x!==null)var W=!0;else{var re=r(g);re!==null&&je(I,re.startTime-le),W=!1}return W}finally{x=null,j=Z,w=!1}}var F=!1,G=null,B=-1,ae=5,Y=-1;function xe(){return!(s.unstable_now()-Y<ae)}function ee(){if(G!==null){var K=s.unstable_now();Y=K;var le=!0;try{le=G(!0,K)}finally{le?ue():(F=!1,G=null)}}else F=!1}var ue;if(typeof C=="function")ue=function(){C(ee)};else if(typeof MessageChannel<"u"){var Se=new MessageChannel,we=Se.port2;Se.port1.onmessage=ee,ue=function(){we.postMessage(null)}}else ue=function(){b(ee,0)};function Ce(K){G=K,F||(F=!0,ue())}function je(K,le){B=b(function(){K(s.unstable_now())},le)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(K){K.callback=null},s.unstable_continueExecution=function(){N||w||(N=!0,Ce(q))},s.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ae=0<K?Math.floor(1e3/K):5},s.unstable_getCurrentPriorityLevel=function(){return j},s.unstable_getFirstCallbackNode=function(){return r(m)},s.unstable_next=function(K){switch(j){case 1:case 2:case 3:var le=3;break;default:le=j}var Z=j;j=le;try{return K()}finally{j=Z}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(K,le){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var Z=j;j=K;try{return le()}finally{j=Z}},s.unstable_scheduleCallback=function(K,le,Z){var O=s.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?O+Z:O):Z=O,K){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=Z+A,K={id:y++,callback:le,priorityLevel:K,startTime:Z,expirationTime:A,sortIndex:-1},Z>O?(K.sortIndex=Z,e(g,K),r(m)===null&&K===r(g)&&(_?(L(B),B=-1):_=!0,je(I,Z-O))):(K.sortIndex=A,e(m,K),N||w||(N=!0,Ce(q))),K},s.unstable_shouldYield=xe,s.unstable_wrapCallback=function(K){var le=j;return function(){var Z=j;j=le;try{return K.apply(this,arguments)}finally{j=Z}}}})(Yc)),Yc}var mm;function Rv(){return mm||(mm=1,Jc.exports=Tv()),Jc.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pm;function Ov(){if(pm)return Pt;pm=1;var s=Gu(),e=Rv();function r(t){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+t,o=1;o<arguments.length;o++)n+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+t+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,l={};function c(t,n){d(t,n),d(t+"Capture",n)}function d(t,n){for(l[t]=n,t=0;t<n.length;t++)i.add(n[t])}var f=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,y={},x={};function j(t){return m.call(x,t)?!0:m.call(y,t)?!1:g.test(t)?x[t]=!0:(y[t]=!0,!1)}function w(t,n,o,u){if(o!==null&&o.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return u?!1:o!==null?!o.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function N(t,n,o,u){if(n===null||typeof n>"u"||w(t,n,o,u))return!0;if(u)return!1;if(o!==null)switch(o.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function _(t,n,o,u,h,p,v){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=u,this.attributeNamespace=h,this.mustUseProperty=o,this.propertyName=t,this.type=n,this.sanitizeURL=p,this.removeEmptyString=v}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){b[t]=new _(t,0,!1,t,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var n=t[0];b[n]=new _(n,1,!1,t[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(t){b[t]=new _(t,2,!1,t.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){b[t]=new _(t,2,!1,t,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){b[t]=new _(t,3,!1,t.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(t){b[t]=new _(t,3,!0,t,null,!1,!1)}),["capture","download"].forEach(function(t){b[t]=new _(t,4,!1,t,null,!1,!1)}),["cols","rows","size","span"].forEach(function(t){b[t]=new _(t,6,!1,t,null,!1,!1)}),["rowSpan","start"].forEach(function(t){b[t]=new _(t,5,!1,t.toLowerCase(),null,!1,!1)});var L=/[\-:]([a-z])/g;function C(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var n=t.replace(L,C);b[n]=new _(n,1,!1,t,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var n=t.replace(L,C);b[n]=new _(n,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(t){var n=t.replace(L,C);b[n]=new _(n,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(t){b[t]=new _(t,1,!1,t.toLowerCase(),null,!1,!1)}),b.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(t){b[t]=new _(t,1,!1,t.toLowerCase(),null,!0,!0)});function T(t,n,o,u){var h=b.hasOwnProperty(n)?b[n]:null;(h!==null?h.type!==0:u||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(N(n,o,h,u)&&(o=null),u||h===null?j(n)&&(o===null?t.removeAttribute(n):t.setAttribute(n,""+o)):h.mustUseProperty?t[h.propertyName]=o===null?h.type===3?!1:"":o:(n=h.attributeName,u=h.attributeNamespace,o===null?t.removeAttribute(n):(h=h.type,o=h===3||h===4&&o===!0?"":""+o,u?t.setAttributeNS(u,n,o):t.setAttribute(n,o))))}var I=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,q=Symbol.for("react.element"),F=Symbol.for("react.portal"),G=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),ae=Symbol.for("react.profiler"),Y=Symbol.for("react.provider"),xe=Symbol.for("react.context"),ee=Symbol.for("react.forward_ref"),ue=Symbol.for("react.suspense"),Se=Symbol.for("react.suspense_list"),we=Symbol.for("react.memo"),Ce=Symbol.for("react.lazy"),je=Symbol.for("react.offscreen"),K=Symbol.iterator;function le(t){return t===null||typeof t!="object"?null:(t=K&&t[K]||t["@@iterator"],typeof t=="function"?t:null)}var Z=Object.assign,O;function A(t){if(O===void 0)try{throw Error()}catch(o){var n=o.stack.trim().match(/\n( *(at )?)/);O=n&&n[1]||""}return`
`+O+t}var W=!1;function re(t,n){if(!t||W)return"";W=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch($){var u=$}Reflect.construct(t,[],n)}else{try{n.call()}catch($){u=$}t.call(n.prototype)}else{try{throw Error()}catch($){u=$}t()}}catch($){if($&&u&&typeof $.stack=="string"){for(var h=$.stack.split(`
`),p=u.stack.split(`
`),v=h.length-1,S=p.length-1;1<=v&&0<=S&&h[v]!==p[S];)S--;for(;1<=v&&0<=S;v--,S--)if(h[v]!==p[S]){if(v!==1||S!==1)do if(v--,S--,0>S||h[v]!==p[S]){var P=`
`+h[v].replace(" at new "," at ");return t.displayName&&P.includes("<anonymous>")&&(P=P.replace("<anonymous>",t.displayName)),P}while(1<=v&&0<=S);break}}}finally{W=!1,Error.prepareStackTrace=o}return(t=t?t.displayName||t.name:"")?A(t):""}function J(t){switch(t.tag){case 5:return A(t.type);case 16:return A("Lazy");case 13:return A("Suspense");case 19:return A("SuspenseList");case 0:case 2:case 15:return t=re(t.type,!1),t;case 11:return t=re(t.type.render,!1),t;case 1:return t=re(t.type,!0),t;default:return""}}function ne(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case G:return"Fragment";case F:return"Portal";case ae:return"Profiler";case B:return"StrictMode";case ue:return"Suspense";case Se:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case xe:return(t.displayName||"Context")+".Consumer";case Y:return(t._context.displayName||"Context")+".Provider";case ee:var n=t.render;return t=t.displayName,t||(t=n.displayName||n.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case we:return n=t.displayName||null,n!==null?n:ne(t.type)||"Memo";case Ce:n=t._payload,t=t._init;try{return ne(t(n))}catch{}}return null}function D(t){var n=t.type;switch(t.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=n.render,t=t.displayName||t.name||"",n.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ne(n);case 8:return n===B?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function z(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function te(t){var n=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function ke(t){var n=te(t)?"checked":"value",o=Object.getOwnPropertyDescriptor(t.constructor.prototype,n),u=""+t[n];if(!t.hasOwnProperty(n)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var h=o.get,p=o.set;return Object.defineProperty(t,n,{configurable:!0,get:function(){return h.call(this)},set:function(v){u=""+v,p.call(this,v)}}),Object.defineProperty(t,n,{enumerable:o.enumerable}),{getValue:function(){return u},setValue:function(v){u=""+v},stopTracking:function(){t._valueTracker=null,delete t[n]}}}}function Xe(t){t._valueTracker||(t._valueTracker=ke(t))}function cr(t){if(!t)return!1;var n=t._valueTracker;if(!n)return!0;var o=n.getValue(),u="";return t&&(u=te(t)?t.checked?"true":"false":t.value),t=u,t!==o?(n.setValue(t),!0):!1}function ns(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ss(t,n){var o=n.checked;return Z({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??t._wrapperState.initialChecked})}function ri(t,n){var o=n.defaultValue==null?"":n.defaultValue,u=n.checked!=null?n.checked:n.defaultChecked;o=z(n.value!=null?n.value:o),t._wrapperState={initialChecked:u,initialValue:o,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function fa(t,n){n=n.checked,n!=null&&T(t,"checked",n,!1)}function ni(t,n){fa(t,n);var o=z(n.value),u=n.type;if(o!=null)u==="number"?(o===0&&t.value===""||t.value!=o)&&(t.value=""+o):t.value!==""+o&&(t.value=""+o);else if(u==="submit"||u==="reset"){t.removeAttribute("value");return}n.hasOwnProperty("value")?si(t,n.type,o):n.hasOwnProperty("defaultValue")&&si(t,n.type,z(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(t.defaultChecked=!!n.defaultChecked)}function ma(t,n,o){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var u=n.type;if(!(u!=="submit"&&u!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+t._wrapperState.initialValue,o||n===t.value||(t.value=n),t.defaultValue=n}o=t.name,o!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,o!==""&&(t.name=o)}function si(t,n,o){(n!=="number"||ns(t.ownerDocument)!==t)&&(o==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+o&&(t.defaultValue=""+o))}var Ur=Array.isArray;function Dr(t,n,o,u){if(t=t.options,n){n={};for(var h=0;h<o.length;h++)n["$"+o[h]]=!0;for(o=0;o<t.length;o++)h=n.hasOwnProperty("$"+t[o].value),t[o].selected!==h&&(t[o].selected=h),h&&u&&(t[o].defaultSelected=!0)}else{for(o=""+z(o),n=null,h=0;h<t.length;h++){if(t[h].value===o){t[h].selected=!0,u&&(t[h].defaultSelected=!0);return}n!==null||t[h].disabled||(n=t[h])}n!==null&&(n.selected=!0)}}function ii(t,n){if(n.dangerouslySetInnerHTML!=null)throw Error(r(91));return Z({},n,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function pa(t,n){var o=n.value;if(o==null){if(o=n.children,n=n.defaultValue,o!=null){if(n!=null)throw Error(r(92));if(Ur(o)){if(1<o.length)throw Error(r(93));o=o[0]}n=o}n==null&&(n=""),o=n}t._wrapperState={initialValue:z(o)}}function yd(t,n){var o=z(n.value),u=z(n.defaultValue);o!=null&&(o=""+o,o!==t.value&&(t.value=o),n.defaultValue==null&&t.defaultValue!==o&&(t.defaultValue=o)),u!=null&&(t.defaultValue=""+u)}function vd(t){var n=t.textContent;n===t._wrapperState.initialValue&&n!==""&&n!==null&&(t.value=n)}function bd(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function nl(t,n){return t==null||t==="http://www.w3.org/1999/xhtml"?bd(n):t==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ga,wd=(function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,o,u,h){MSApp.execUnsafeLocalFunction(function(){return t(n,o,u,h)})}:t})(function(t,n){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=n;else{for(ga=ga||document.createElement("div"),ga.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=ga.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;n.firstChild;)t.appendChild(n.firstChild)}});function ai(t,n){if(n){var o=t.firstChild;if(o&&o===t.lastChild&&o.nodeType===3){o.nodeValue=n;return}}t.textContent=n}var oi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Px=["Webkit","ms","Moz","O"];Object.keys(oi).forEach(function(t){Px.forEach(function(n){n=n+t.charAt(0).toUpperCase()+t.substring(1),oi[n]=oi[t]})});function jd(t,n,o){return n==null||typeof n=="boolean"||n===""?"":o||typeof n!="number"||n===0||oi.hasOwnProperty(t)&&oi[t]?(""+n).trim():n+"px"}function _d(t,n){t=t.style;for(var o in n)if(n.hasOwnProperty(o)){var u=o.indexOf("--")===0,h=jd(o,n[o],u);o==="float"&&(o="cssFloat"),u?t.setProperty(o,h):t[o]=h}}var Tx=Z({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function sl(t,n){if(n){if(Tx[t]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(r(137,t));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(r(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(r(61))}if(n.style!=null&&typeof n.style!="object")throw Error(r(62))}}function il(t,n){if(t.indexOf("-")===-1)return typeof n.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var al=null;function ol(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ll=null,is=null,as=null;function Nd(t){if(t=Pi(t)){if(typeof ll!="function")throw Error(r(280));var n=t.stateNode;n&&(n=$a(n),ll(t.stateNode,t.type,n))}}function Sd(t){is?as?as.push(t):as=[t]:is=t}function kd(){if(is){var t=is,n=as;if(as=is=null,Nd(t),n)for(t=0;t<n.length;t++)Nd(n[t])}}function Ed(t,n){return t(n)}function Cd(){}var cl=!1;function Pd(t,n,o){if(cl)return t(n,o);cl=!0;try{return Ed(t,n,o)}finally{cl=!1,(is!==null||as!==null)&&(Cd(),kd())}}function li(t,n){var o=t.stateNode;if(o===null)return null;var u=$a(o);if(u===null)return null;o=u[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(t=t.type,u=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!u;break e;default:t=!1}if(t)return null;if(o&&typeof o!="function")throw Error(r(231,n,typeof o));return o}var ul=!1;if(f)try{var ci={};Object.defineProperty(ci,"passive",{get:function(){ul=!0}}),window.addEventListener("test",ci,ci),window.removeEventListener("test",ci,ci)}catch{ul=!1}function Rx(t,n,o,u,h,p,v,S,P){var $=Array.prototype.slice.call(arguments,3);try{n.apply(o,$)}catch(H){this.onError(H)}}var ui=!1,xa=null,ya=!1,dl=null,Ox={onError:function(t){ui=!0,xa=t}};function Ax(t,n,o,u,h,p,v,S,P){ui=!1,xa=null,Rx.apply(Ox,arguments)}function Ix(t,n,o,u,h,p,v,S,P){if(Ax.apply(this,arguments),ui){if(ui){var $=xa;ui=!1,xa=null}else throw Error(r(198));ya||(ya=!0,dl=$)}}function Nn(t){var n=t,o=t;if(t.alternate)for(;n.return;)n=n.return;else{t=n;do n=t,(n.flags&4098)!==0&&(o=n.return),t=n.return;while(t)}return n.tag===3?o:null}function Td(t){if(t.tag===13){var n=t.memoizedState;if(n===null&&(t=t.alternate,t!==null&&(n=t.memoizedState)),n!==null)return n.dehydrated}return null}function Rd(t){if(Nn(t)!==t)throw Error(r(188))}function Lx(t){var n=t.alternate;if(!n){if(n=Nn(t),n===null)throw Error(r(188));return n!==t?null:t}for(var o=t,u=n;;){var h=o.return;if(h===null)break;var p=h.alternate;if(p===null){if(u=h.return,u!==null){o=u;continue}break}if(h.child===p.child){for(p=h.child;p;){if(p===o)return Rd(h),t;if(p===u)return Rd(h),n;p=p.sibling}throw Error(r(188))}if(o.return!==u.return)o=h,u=p;else{for(var v=!1,S=h.child;S;){if(S===o){v=!0,o=h,u=p;break}if(S===u){v=!0,u=h,o=p;break}S=S.sibling}if(!v){for(S=p.child;S;){if(S===o){v=!0,o=p,u=h;break}if(S===u){v=!0,u=p,o=h;break}S=S.sibling}if(!v)throw Error(r(189))}}if(o.alternate!==u)throw Error(r(190))}if(o.tag!==3)throw Error(r(188));return o.stateNode.current===o?t:n}function Od(t){return t=Lx(t),t!==null?Ad(t):null}function Ad(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var n=Ad(t);if(n!==null)return n;t=t.sibling}return null}var Id=e.unstable_scheduleCallback,Ld=e.unstable_cancelCallback,Mx=e.unstable_shouldYield,Ux=e.unstable_requestPaint,Ke=e.unstable_now,Dx=e.unstable_getCurrentPriorityLevel,hl=e.unstable_ImmediatePriority,Md=e.unstable_UserBlockingPriority,va=e.unstable_NormalPriority,$x=e.unstable_LowPriority,Ud=e.unstable_IdlePriority,ba=null,ur=null;function Fx(t){if(ur&&typeof ur.onCommitFiberRoot=="function")try{ur.onCommitFiberRoot(ba,t,void 0,(t.current.flags&128)===128)}catch{}}var Jt=Math.clz32?Math.clz32:qx,Bx=Math.log,zx=Math.LN2;function qx(t){return t>>>=0,t===0?32:31-(Bx(t)/zx|0)|0}var wa=64,ja=4194304;function di(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function _a(t,n){var o=t.pendingLanes;if(o===0)return 0;var u=0,h=t.suspendedLanes,p=t.pingedLanes,v=o&268435455;if(v!==0){var S=v&~h;S!==0?u=di(S):(p&=v,p!==0&&(u=di(p)))}else v=o&~h,v!==0?u=di(v):p!==0&&(u=di(p));if(u===0)return 0;if(n!==0&&n!==u&&(n&h)===0&&(h=u&-u,p=n&-n,h>=p||h===16&&(p&4194240)!==0))return n;if((u&4)!==0&&(u|=o&16),n=t.entangledLanes,n!==0)for(t=t.entanglements,n&=u;0<n;)o=31-Jt(n),h=1<<o,u|=t[o],n&=~h;return u}function Wx(t,n){switch(t){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Vx(t,n){for(var o=t.suspendedLanes,u=t.pingedLanes,h=t.expirationTimes,p=t.pendingLanes;0<p;){var v=31-Jt(p),S=1<<v,P=h[v];P===-1?((S&o)===0||(S&u)!==0)&&(h[v]=Wx(S,n)):P<=n&&(t.expiredLanes|=S),p&=~S}}function fl(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Dd(){var t=wa;return wa<<=1,(wa&4194240)===0&&(wa=64),t}function ml(t){for(var n=[],o=0;31>o;o++)n.push(t);return n}function hi(t,n,o){t.pendingLanes|=n,n!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,n=31-Jt(n),t[n]=o}function Hx(t,n){var o=t.pendingLanes&~n;t.pendingLanes=n,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=n,t.mutableReadLanes&=n,t.entangledLanes&=n,n=t.entanglements;var u=t.eventTimes;for(t=t.expirationTimes;0<o;){var h=31-Jt(o),p=1<<h;n[h]=0,u[h]=-1,t[h]=-1,o&=~p}}function pl(t,n){var o=t.entangledLanes|=n;for(t=t.entanglements;o;){var u=31-Jt(o),h=1<<u;h&n|t[u]&n&&(t[u]|=n),o&=~h}}var Ie=0;function $d(t){return t&=-t,1<t?4<t?(t&268435455)!==0?16:536870912:4:1}var Fd,gl,Bd,zd,qd,xl=!1,Na=[],$r=null,Fr=null,Br=null,fi=new Map,mi=new Map,zr=[],Kx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Wd(t,n){switch(t){case"focusin":case"focusout":$r=null;break;case"dragenter":case"dragleave":Fr=null;break;case"mouseover":case"mouseout":Br=null;break;case"pointerover":case"pointerout":fi.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":mi.delete(n.pointerId)}}function pi(t,n,o,u,h,p){return t===null||t.nativeEvent!==p?(t={blockedOn:n,domEventName:o,eventSystemFlags:u,nativeEvent:p,targetContainers:[h]},n!==null&&(n=Pi(n),n!==null&&gl(n)),t):(t.eventSystemFlags|=u,n=t.targetContainers,h!==null&&n.indexOf(h)===-1&&n.push(h),t)}function Qx(t,n,o,u,h){switch(n){case"focusin":return $r=pi($r,t,n,o,u,h),!0;case"dragenter":return Fr=pi(Fr,t,n,o,u,h),!0;case"mouseover":return Br=pi(Br,t,n,o,u,h),!0;case"pointerover":var p=h.pointerId;return fi.set(p,pi(fi.get(p)||null,t,n,o,u,h)),!0;case"gotpointercapture":return p=h.pointerId,mi.set(p,pi(mi.get(p)||null,t,n,o,u,h)),!0}return!1}function Vd(t){var n=Sn(t.target);if(n!==null){var o=Nn(n);if(o!==null){if(n=o.tag,n===13){if(n=Td(o),n!==null){t.blockedOn=n,qd(t.priority,function(){Bd(o)});return}}else if(n===3&&o.stateNode.current.memoizedState.isDehydrated){t.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Sa(t){if(t.blockedOn!==null)return!1;for(var n=t.targetContainers;0<n.length;){var o=vl(t.domEventName,t.eventSystemFlags,n[0],t.nativeEvent);if(o===null){o=t.nativeEvent;var u=new o.constructor(o.type,o);al=u,o.target.dispatchEvent(u),al=null}else return n=Pi(o),n!==null&&gl(n),t.blockedOn=o,!1;n.shift()}return!0}function Hd(t,n,o){Sa(t)&&o.delete(n)}function Gx(){xl=!1,$r!==null&&Sa($r)&&($r=null),Fr!==null&&Sa(Fr)&&(Fr=null),Br!==null&&Sa(Br)&&(Br=null),fi.forEach(Hd),mi.forEach(Hd)}function gi(t,n){t.blockedOn===n&&(t.blockedOn=null,xl||(xl=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Gx)))}function xi(t){function n(h){return gi(h,t)}if(0<Na.length){gi(Na[0],t);for(var o=1;o<Na.length;o++){var u=Na[o];u.blockedOn===t&&(u.blockedOn=null)}}for($r!==null&&gi($r,t),Fr!==null&&gi(Fr,t),Br!==null&&gi(Br,t),fi.forEach(n),mi.forEach(n),o=0;o<zr.length;o++)u=zr[o],u.blockedOn===t&&(u.blockedOn=null);for(;0<zr.length&&(o=zr[0],o.blockedOn===null);)Vd(o),o.blockedOn===null&&zr.shift()}var os=I.ReactCurrentBatchConfig,ka=!0;function Jx(t,n,o,u){var h=Ie,p=os.transition;os.transition=null;try{Ie=1,yl(t,n,o,u)}finally{Ie=h,os.transition=p}}function Yx(t,n,o,u){var h=Ie,p=os.transition;os.transition=null;try{Ie=4,yl(t,n,o,u)}finally{Ie=h,os.transition=p}}function yl(t,n,o,u){if(ka){var h=vl(t,n,o,u);if(h===null)Ml(t,n,u,Ea,o),Wd(t,u);else if(Qx(h,t,n,o,u))u.stopPropagation();else if(Wd(t,u),n&4&&-1<Kx.indexOf(t)){for(;h!==null;){var p=Pi(h);if(p!==null&&Fd(p),p=vl(t,n,o,u),p===null&&Ml(t,n,u,Ea,o),p===h)break;h=p}h!==null&&u.stopPropagation()}else Ml(t,n,u,null,o)}}var Ea=null;function vl(t,n,o,u){if(Ea=null,t=ol(u),t=Sn(t),t!==null)if(n=Nn(t),n===null)t=null;else if(o=n.tag,o===13){if(t=Td(n),t!==null)return t;t=null}else if(o===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;t=null}else n!==t&&(t=null);return Ea=t,null}function Kd(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Dx()){case hl:return 1;case Md:return 4;case va:case $x:return 16;case Ud:return 536870912;default:return 16}default:return 16}}var qr=null,bl=null,Ca=null;function Qd(){if(Ca)return Ca;var t,n=bl,o=n.length,u,h="value"in qr?qr.value:qr.textContent,p=h.length;for(t=0;t<o&&n[t]===h[t];t++);var v=o-t;for(u=1;u<=v&&n[o-u]===h[p-u];u++);return Ca=h.slice(t,1<u?1-u:void 0)}function Pa(t){var n=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&n===13&&(t=13)):t=n,t===10&&(t=13),32<=t||t===13?t:0}function Ta(){return!0}function Gd(){return!1}function At(t){function n(o,u,h,p,v){this._reactName=o,this._targetInst=h,this.type=u,this.nativeEvent=p,this.target=v,this.currentTarget=null;for(var S in t)t.hasOwnProperty(S)&&(o=t[S],this[S]=o?o(p):p[S]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?Ta:Gd,this.isPropagationStopped=Gd,this}return Z(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Ta)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Ta)},persist:function(){},isPersistent:Ta}),n}var ls={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wl=At(ls),yi=Z({},ls,{view:0,detail:0}),Xx=At(yi),jl,_l,vi,Ra=Z({},yi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sl,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==vi&&(vi&&t.type==="mousemove"?(jl=t.screenX-vi.screenX,_l=t.screenY-vi.screenY):_l=jl=0,vi=t),jl)},movementY:function(t){return"movementY"in t?t.movementY:_l}}),Jd=At(Ra),Zx=Z({},Ra,{dataTransfer:0}),ey=At(Zx),ty=Z({},yi,{relatedTarget:0}),Nl=At(ty),ry=Z({},ls,{animationName:0,elapsedTime:0,pseudoElement:0}),ny=At(ry),sy=Z({},ls,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),iy=At(sy),ay=Z({},ls,{data:0}),Yd=At(ay),oy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ly={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function uy(t){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(t):(t=cy[t])?!!n[t]:!1}function Sl(){return uy}var dy=Z({},yi,{key:function(t){if(t.key){var n=oy[t.key]||t.key;if(n!=="Unidentified")return n}return t.type==="keypress"?(t=Pa(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?ly[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sl,charCode:function(t){return t.type==="keypress"?Pa(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Pa(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),hy=At(dy),fy=Z({},Ra,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xd=At(fy),my=Z({},yi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sl}),py=At(my),gy=Z({},ls,{propertyName:0,elapsedTime:0,pseudoElement:0}),xy=At(gy),yy=Z({},Ra,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),vy=At(yy),by=[9,13,27,32],kl=f&&"CompositionEvent"in window,bi=null;f&&"documentMode"in document&&(bi=document.documentMode);var wy=f&&"TextEvent"in window&&!bi,Zd=f&&(!kl||bi&&8<bi&&11>=bi),eh=" ",th=!1;function rh(t,n){switch(t){case"keyup":return by.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nh(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var cs=!1;function jy(t,n){switch(t){case"compositionend":return nh(n);case"keypress":return n.which!==32?null:(th=!0,eh);case"textInput":return t=n.data,t===eh&&th?null:t;default:return null}}function _y(t,n){if(cs)return t==="compositionend"||!kl&&rh(t,n)?(t=Qd(),Ca=bl=qr=null,cs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Zd&&n.locale!=="ko"?null:n.data;default:return null}}var Ny={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sh(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n==="input"?!!Ny[t.type]:n==="textarea"}function ih(t,n,o,u){Sd(u),n=Ma(n,"onChange"),0<n.length&&(o=new wl("onChange","change",null,o,u),t.push({event:o,listeners:n}))}var wi=null,ji=null;function Sy(t){_h(t,0)}function Oa(t){var n=ms(t);if(cr(n))return t}function ky(t,n){if(t==="change")return n}var ah=!1;if(f){var El;if(f){var Cl="oninput"in document;if(!Cl){var oh=document.createElement("div");oh.setAttribute("oninput","return;"),Cl=typeof oh.oninput=="function"}El=Cl}else El=!1;ah=El&&(!document.documentMode||9<document.documentMode)}function lh(){wi&&(wi.detachEvent("onpropertychange",ch),ji=wi=null)}function ch(t){if(t.propertyName==="value"&&Oa(ji)){var n=[];ih(n,ji,t,ol(t)),Pd(Sy,n)}}function Ey(t,n,o){t==="focusin"?(lh(),wi=n,ji=o,wi.attachEvent("onpropertychange",ch)):t==="focusout"&&lh()}function Cy(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Oa(ji)}function Py(t,n){if(t==="click")return Oa(n)}function Ty(t,n){if(t==="input"||t==="change")return Oa(n)}function Ry(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var Yt=typeof Object.is=="function"?Object.is:Ry;function _i(t,n){if(Yt(t,n))return!0;if(typeof t!="object"||t===null||typeof n!="object"||n===null)return!1;var o=Object.keys(t),u=Object.keys(n);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var h=o[u];if(!m.call(n,h)||!Yt(t[h],n[h]))return!1}return!0}function uh(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function dh(t,n){var o=uh(t);t=0;for(var u;o;){if(o.nodeType===3){if(u=t+o.textContent.length,t<=n&&u>=n)return{node:o,offset:n-t};t=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=uh(o)}}function hh(t,n){return t&&n?t===n?!0:t&&t.nodeType===3?!1:n&&n.nodeType===3?hh(t,n.parentNode):"contains"in t?t.contains(n):t.compareDocumentPosition?!!(t.compareDocumentPosition(n)&16):!1:!1}function fh(){for(var t=window,n=ns();n instanceof t.HTMLIFrameElement;){try{var o=typeof n.contentWindow.location.href=="string"}catch{o=!1}if(o)t=n.contentWindow;else break;n=ns(t.document)}return n}function Pl(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n&&(n==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||n==="textarea"||t.contentEditable==="true")}function Oy(t){var n=fh(),o=t.focusedElem,u=t.selectionRange;if(n!==o&&o&&o.ownerDocument&&hh(o.ownerDocument.documentElement,o)){if(u!==null&&Pl(o)){if(n=u.start,t=u.end,t===void 0&&(t=n),"selectionStart"in o)o.selectionStart=n,o.selectionEnd=Math.min(t,o.value.length);else if(t=(n=o.ownerDocument||document)&&n.defaultView||window,t.getSelection){t=t.getSelection();var h=o.textContent.length,p=Math.min(u.start,h);u=u.end===void 0?p:Math.min(u.end,h),!t.extend&&p>u&&(h=u,u=p,p=h),h=dh(o,p);var v=dh(o,u);h&&v&&(t.rangeCount!==1||t.anchorNode!==h.node||t.anchorOffset!==h.offset||t.focusNode!==v.node||t.focusOffset!==v.offset)&&(n=n.createRange(),n.setStart(h.node,h.offset),t.removeAllRanges(),p>u?(t.addRange(n),t.extend(v.node,v.offset)):(n.setEnd(v.node,v.offset),t.addRange(n)))}}for(n=[],t=o;t=t.parentNode;)t.nodeType===1&&n.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<n.length;o++)t=n[o],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Ay=f&&"documentMode"in document&&11>=document.documentMode,us=null,Tl=null,Ni=null,Rl=!1;function mh(t,n,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Rl||us==null||us!==ns(u)||(u=us,"selectionStart"in u&&Pl(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Ni&&_i(Ni,u)||(Ni=u,u=Ma(Tl,"onSelect"),0<u.length&&(n=new wl("onSelect","select",null,n,o),t.push({event:n,listeners:u}),n.target=us)))}function Aa(t,n){var o={};return o[t.toLowerCase()]=n.toLowerCase(),o["Webkit"+t]="webkit"+n,o["Moz"+t]="moz"+n,o}var ds={animationend:Aa("Animation","AnimationEnd"),animationiteration:Aa("Animation","AnimationIteration"),animationstart:Aa("Animation","AnimationStart"),transitionend:Aa("Transition","TransitionEnd")},Ol={},ph={};f&&(ph=document.createElement("div").style,"AnimationEvent"in window||(delete ds.animationend.animation,delete ds.animationiteration.animation,delete ds.animationstart.animation),"TransitionEvent"in window||delete ds.transitionend.transition);function Ia(t){if(Ol[t])return Ol[t];if(!ds[t])return t;var n=ds[t],o;for(o in n)if(n.hasOwnProperty(o)&&o in ph)return Ol[t]=n[o];return t}var gh=Ia("animationend"),xh=Ia("animationiteration"),yh=Ia("animationstart"),vh=Ia("transitionend"),bh=new Map,wh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Wr(t,n){bh.set(t,n),c(n,[t])}for(var Al=0;Al<wh.length;Al++){var Il=wh[Al],Iy=Il.toLowerCase(),Ly=Il[0].toUpperCase()+Il.slice(1);Wr(Iy,"on"+Ly)}Wr(gh,"onAnimationEnd"),Wr(xh,"onAnimationIteration"),Wr(yh,"onAnimationStart"),Wr("dblclick","onDoubleClick"),Wr("focusin","onFocus"),Wr("focusout","onBlur"),Wr(vh,"onTransitionEnd"),d("onMouseEnter",["mouseout","mouseover"]),d("onMouseLeave",["mouseout","mouseover"]),d("onPointerEnter",["pointerout","pointerover"]),d("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Si="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),My=new Set("cancel close invalid load scroll toggle".split(" ").concat(Si));function jh(t,n,o){var u=t.type||"unknown-event";t.currentTarget=o,Ix(u,n,void 0,t),t.currentTarget=null}function _h(t,n){n=(n&4)!==0;for(var o=0;o<t.length;o++){var u=t[o],h=u.event;u=u.listeners;e:{var p=void 0;if(n)for(var v=u.length-1;0<=v;v--){var S=u[v],P=S.instance,$=S.currentTarget;if(S=S.listener,P!==p&&h.isPropagationStopped())break e;jh(h,S,$),p=P}else for(v=0;v<u.length;v++){if(S=u[v],P=S.instance,$=S.currentTarget,S=S.listener,P!==p&&h.isPropagationStopped())break e;jh(h,S,$),p=P}}}if(ya)throw t=dl,ya=!1,dl=null,t}function Ue(t,n){var o=n[zl];o===void 0&&(o=n[zl]=new Set);var u=t+"__bubble";o.has(u)||(Nh(n,t,2,!1),o.add(u))}function Ll(t,n,o){var u=0;n&&(u|=4),Nh(o,t,u,n)}var La="_reactListening"+Math.random().toString(36).slice(2);function ki(t){if(!t[La]){t[La]=!0,i.forEach(function(o){o!=="selectionchange"&&(My.has(o)||Ll(o,!1,t),Ll(o,!0,t))});var n=t.nodeType===9?t:t.ownerDocument;n===null||n[La]||(n[La]=!0,Ll("selectionchange",!1,n))}}function Nh(t,n,o,u){switch(Kd(n)){case 1:var h=Jx;break;case 4:h=Yx;break;default:h=yl}o=h.bind(null,n,o,t),h=void 0,!ul||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(h=!0),u?h!==void 0?t.addEventListener(n,o,{capture:!0,passive:h}):t.addEventListener(n,o,!0):h!==void 0?t.addEventListener(n,o,{passive:h}):t.addEventListener(n,o,!1)}function Ml(t,n,o,u,h){var p=u;if((n&1)===0&&(n&2)===0&&u!==null)e:for(;;){if(u===null)return;var v=u.tag;if(v===3||v===4){var S=u.stateNode.containerInfo;if(S===h||S.nodeType===8&&S.parentNode===h)break;if(v===4)for(v=u.return;v!==null;){var P=v.tag;if((P===3||P===4)&&(P=v.stateNode.containerInfo,P===h||P.nodeType===8&&P.parentNode===h))return;v=v.return}for(;S!==null;){if(v=Sn(S),v===null)return;if(P=v.tag,P===5||P===6){u=p=v;continue e}S=S.parentNode}}u=u.return}Pd(function(){var $=p,H=ol(o),Q=[];e:{var V=bh.get(t);if(V!==void 0){var oe=wl,de=t;switch(t){case"keypress":if(Pa(o)===0)break e;case"keydown":case"keyup":oe=hy;break;case"focusin":de="focus",oe=Nl;break;case"focusout":de="blur",oe=Nl;break;case"beforeblur":case"afterblur":oe=Nl;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":oe=Jd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":oe=ey;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":oe=py;break;case gh:case xh:case yh:oe=ny;break;case vh:oe=xy;break;case"scroll":oe=Xx;break;case"wheel":oe=vy;break;case"copy":case"cut":case"paste":oe=iy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":oe=Xd}var he=(n&4)!==0,Qe=!he&&t==="scroll",M=he?V!==null?V+"Capture":null:V;he=[];for(var R=$,U;R!==null;){U=R;var X=U.stateNode;if(U.tag===5&&X!==null&&(U=X,M!==null&&(X=li(R,M),X!=null&&he.push(Ei(R,X,U)))),Qe)break;R=R.return}0<he.length&&(V=new oe(V,de,null,o,H),Q.push({event:V,listeners:he}))}}if((n&7)===0){e:{if(V=t==="mouseover"||t==="pointerover",oe=t==="mouseout"||t==="pointerout",V&&o!==al&&(de=o.relatedTarget||o.fromElement)&&(Sn(de)||de[br]))break e;if((oe||V)&&(V=H.window===H?H:(V=H.ownerDocument)?V.defaultView||V.parentWindow:window,oe?(de=o.relatedTarget||o.toElement,oe=$,de=de?Sn(de):null,de!==null&&(Qe=Nn(de),de!==Qe||de.tag!==5&&de.tag!==6)&&(de=null)):(oe=null,de=$),oe!==de)){if(he=Jd,X="onMouseLeave",M="onMouseEnter",R="mouse",(t==="pointerout"||t==="pointerover")&&(he=Xd,X="onPointerLeave",M="onPointerEnter",R="pointer"),Qe=oe==null?V:ms(oe),U=de==null?V:ms(de),V=new he(X,R+"leave",oe,o,H),V.target=Qe,V.relatedTarget=U,X=null,Sn(H)===$&&(he=new he(M,R+"enter",de,o,H),he.target=U,he.relatedTarget=Qe,X=he),Qe=X,oe&&de)t:{for(he=oe,M=de,R=0,U=he;U;U=hs(U))R++;for(U=0,X=M;X;X=hs(X))U++;for(;0<R-U;)he=hs(he),R--;for(;0<U-R;)M=hs(M),U--;for(;R--;){if(he===M||M!==null&&he===M.alternate)break t;he=hs(he),M=hs(M)}he=null}else he=null;oe!==null&&Sh(Q,V,oe,he,!1),de!==null&&Qe!==null&&Sh(Q,Qe,de,he,!0)}}e:{if(V=$?ms($):window,oe=V.nodeName&&V.nodeName.toLowerCase(),oe==="select"||oe==="input"&&V.type==="file")var fe=ky;else if(sh(V))if(ah)fe=Ty;else{fe=Cy;var ye=Ey}else(oe=V.nodeName)&&oe.toLowerCase()==="input"&&(V.type==="checkbox"||V.type==="radio")&&(fe=Py);if(fe&&(fe=fe(t,$))){ih(Q,fe,o,H);break e}ye&&ye(t,V,$),t==="focusout"&&(ye=V._wrapperState)&&ye.controlled&&V.type==="number"&&si(V,"number",V.value)}switch(ye=$?ms($):window,t){case"focusin":(sh(ye)||ye.contentEditable==="true")&&(us=ye,Tl=$,Ni=null);break;case"focusout":Ni=Tl=us=null;break;case"mousedown":Rl=!0;break;case"contextmenu":case"mouseup":case"dragend":Rl=!1,mh(Q,o,H);break;case"selectionchange":if(Ay)break;case"keydown":case"keyup":mh(Q,o,H)}var ve;if(kl)e:{switch(t){case"compositionstart":var _e="onCompositionStart";break e;case"compositionend":_e="onCompositionEnd";break e;case"compositionupdate":_e="onCompositionUpdate";break e}_e=void 0}else cs?rh(t,o)&&(_e="onCompositionEnd"):t==="keydown"&&o.keyCode===229&&(_e="onCompositionStart");_e&&(Zd&&o.locale!=="ko"&&(cs||_e!=="onCompositionStart"?_e==="onCompositionEnd"&&cs&&(ve=Qd()):(qr=H,bl="value"in qr?qr.value:qr.textContent,cs=!0)),ye=Ma($,_e),0<ye.length&&(_e=new Yd(_e,t,null,o,H),Q.push({event:_e,listeners:ye}),ve?_e.data=ve:(ve=nh(o),ve!==null&&(_e.data=ve)))),(ve=wy?jy(t,o):_y(t,o))&&($=Ma($,"onBeforeInput"),0<$.length&&(H=new Yd("onBeforeInput","beforeinput",null,o,H),Q.push({event:H,listeners:$}),H.data=ve))}_h(Q,n)})}function Ei(t,n,o){return{instance:t,listener:n,currentTarget:o}}function Ma(t,n){for(var o=n+"Capture",u=[];t!==null;){var h=t,p=h.stateNode;h.tag===5&&p!==null&&(h=p,p=li(t,o),p!=null&&u.unshift(Ei(t,p,h)),p=li(t,n),p!=null&&u.push(Ei(t,p,h))),t=t.return}return u}function hs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Sh(t,n,o,u,h){for(var p=n._reactName,v=[];o!==null&&o!==u;){var S=o,P=S.alternate,$=S.stateNode;if(P!==null&&P===u)break;S.tag===5&&$!==null&&(S=$,h?(P=li(o,p),P!=null&&v.unshift(Ei(o,P,S))):h||(P=li(o,p),P!=null&&v.push(Ei(o,P,S)))),o=o.return}v.length!==0&&t.push({event:n,listeners:v})}var Uy=/\r\n?/g,Dy=/\u0000|\uFFFD/g;function kh(t){return(typeof t=="string"?t:""+t).replace(Uy,`
`).replace(Dy,"")}function Ua(t,n,o){if(n=kh(n),kh(t)!==n&&o)throw Error(r(425))}function Da(){}var Ul=null,Dl=null;function $l(t,n){return t==="textarea"||t==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Fl=typeof setTimeout=="function"?setTimeout:void 0,$y=typeof clearTimeout=="function"?clearTimeout:void 0,Eh=typeof Promise=="function"?Promise:void 0,Fy=typeof queueMicrotask=="function"?queueMicrotask:typeof Eh<"u"?function(t){return Eh.resolve(null).then(t).catch(By)}:Fl;function By(t){setTimeout(function(){throw t})}function Bl(t,n){var o=n,u=0;do{var h=o.nextSibling;if(t.removeChild(o),h&&h.nodeType===8)if(o=h.data,o==="/$"){if(u===0){t.removeChild(h),xi(n);return}u--}else o!=="$"&&o!=="$?"&&o!=="$!"||u++;o=h}while(o);xi(n)}function Vr(t){for(;t!=null;t=t.nextSibling){var n=t.nodeType;if(n===1||n===3)break;if(n===8){if(n=t.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return t}function Ch(t){t=t.previousSibling;for(var n=0;t;){if(t.nodeType===8){var o=t.data;if(o==="$"||o==="$!"||o==="$?"){if(n===0)return t;n--}else o==="/$"&&n++}t=t.previousSibling}return null}var fs=Math.random().toString(36).slice(2),dr="__reactFiber$"+fs,Ci="__reactProps$"+fs,br="__reactContainer$"+fs,zl="__reactEvents$"+fs,zy="__reactListeners$"+fs,qy="__reactHandles$"+fs;function Sn(t){var n=t[dr];if(n)return n;for(var o=t.parentNode;o;){if(n=o[br]||o[dr]){if(o=n.alternate,n.child!==null||o!==null&&o.child!==null)for(t=Ch(t);t!==null;){if(o=t[dr])return o;t=Ch(t)}return n}t=o,o=t.parentNode}return null}function Pi(t){return t=t[dr]||t[br],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ms(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(r(33))}function $a(t){return t[Ci]||null}var ql=[],ps=-1;function Hr(t){return{current:t}}function De(t){0>ps||(t.current=ql[ps],ql[ps]=null,ps--)}function Le(t,n){ps++,ql[ps]=t.current,t.current=n}var Kr={},ft=Hr(Kr),Nt=Hr(!1),kn=Kr;function gs(t,n){var o=t.type.contextTypes;if(!o)return Kr;var u=t.stateNode;if(u&&u.__reactInternalMemoizedUnmaskedChildContext===n)return u.__reactInternalMemoizedMaskedChildContext;var h={},p;for(p in o)h[p]=n[p];return u&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=n,t.__reactInternalMemoizedMaskedChildContext=h),h}function St(t){return t=t.childContextTypes,t!=null}function Fa(){De(Nt),De(ft)}function Ph(t,n,o){if(ft.current!==Kr)throw Error(r(168));Le(ft,n),Le(Nt,o)}function Th(t,n,o){var u=t.stateNode;if(n=n.childContextTypes,typeof u.getChildContext!="function")return o;u=u.getChildContext();for(var h in u)if(!(h in n))throw Error(r(108,D(t)||"Unknown",h));return Z({},o,u)}function Ba(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Kr,kn=ft.current,Le(ft,t),Le(Nt,Nt.current),!0}function Rh(t,n,o){var u=t.stateNode;if(!u)throw Error(r(169));o?(t=Th(t,n,kn),u.__reactInternalMemoizedMergedChildContext=t,De(Nt),De(ft),Le(ft,t)):De(Nt),Le(Nt,o)}var wr=null,za=!1,Wl=!1;function Oh(t){wr===null?wr=[t]:wr.push(t)}function Wy(t){za=!0,Oh(t)}function Qr(){if(!Wl&&wr!==null){Wl=!0;var t=0,n=Ie;try{var o=wr;for(Ie=1;t<o.length;t++){var u=o[t];do u=u(!0);while(u!==null)}wr=null,za=!1}catch(h){throw wr!==null&&(wr=wr.slice(t+1)),Id(hl,Qr),h}finally{Ie=n,Wl=!1}}return null}var xs=[],ys=0,qa=null,Wa=0,zt=[],qt=0,En=null,jr=1,_r="";function Cn(t,n){xs[ys++]=Wa,xs[ys++]=qa,qa=t,Wa=n}function Ah(t,n,o){zt[qt++]=jr,zt[qt++]=_r,zt[qt++]=En,En=t;var u=jr;t=_r;var h=32-Jt(u)-1;u&=~(1<<h),o+=1;var p=32-Jt(n)+h;if(30<p){var v=h-h%5;p=(u&(1<<v)-1).toString(32),u>>=v,h-=v,jr=1<<32-Jt(n)+h|o<<h|u,_r=p+t}else jr=1<<p|o<<h|u,_r=t}function Vl(t){t.return!==null&&(Cn(t,1),Ah(t,1,0))}function Hl(t){for(;t===qa;)qa=xs[--ys],xs[ys]=null,Wa=xs[--ys],xs[ys]=null;for(;t===En;)En=zt[--qt],zt[qt]=null,_r=zt[--qt],zt[qt]=null,jr=zt[--qt],zt[qt]=null}var It=null,Lt=null,$e=!1,Xt=null;function Ih(t,n){var o=Kt(5,null,null,0);o.elementType="DELETED",o.stateNode=n,o.return=t,n=t.deletions,n===null?(t.deletions=[o],t.flags|=16):n.push(o)}function Lh(t,n){switch(t.tag){case 5:var o=t.type;return n=n.nodeType!==1||o.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(t.stateNode=n,It=t,Lt=Vr(n.firstChild),!0):!1;case 6:return n=t.pendingProps===""||n.nodeType!==3?null:n,n!==null?(t.stateNode=n,It=t,Lt=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(o=En!==null?{id:jr,overflow:_r}:null,t.memoizedState={dehydrated:n,treeContext:o,retryLane:1073741824},o=Kt(18,null,null,0),o.stateNode=n,o.return=t,t.child=o,It=t,Lt=null,!0):!1;default:return!1}}function Kl(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ql(t){if($e){var n=Lt;if(n){var o=n;if(!Lh(t,n)){if(Kl(t))throw Error(r(418));n=Vr(o.nextSibling);var u=It;n&&Lh(t,n)?Ih(u,o):(t.flags=t.flags&-4097|2,$e=!1,It=t)}}else{if(Kl(t))throw Error(r(418));t.flags=t.flags&-4097|2,$e=!1,It=t}}}function Mh(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;It=t}function Va(t){if(t!==It)return!1;if(!$e)return Mh(t),$e=!0,!1;var n;if((n=t.tag!==3)&&!(n=t.tag!==5)&&(n=t.type,n=n!=="head"&&n!=="body"&&!$l(t.type,t.memoizedProps)),n&&(n=Lt)){if(Kl(t))throw Uh(),Error(r(418));for(;n;)Ih(t,n),n=Vr(n.nextSibling)}if(Mh(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(r(317));e:{for(t=t.nextSibling,n=0;t;){if(t.nodeType===8){var o=t.data;if(o==="/$"){if(n===0){Lt=Vr(t.nextSibling);break e}n--}else o!=="$"&&o!=="$!"&&o!=="$?"||n++}t=t.nextSibling}Lt=null}}else Lt=It?Vr(t.stateNode.nextSibling):null;return!0}function Uh(){for(var t=Lt;t;)t=Vr(t.nextSibling)}function vs(){Lt=It=null,$e=!1}function Gl(t){Xt===null?Xt=[t]:Xt.push(t)}var Vy=I.ReactCurrentBatchConfig;function Ti(t,n,o){if(t=o.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(r(309));var u=o.stateNode}if(!u)throw Error(r(147,t));var h=u,p=""+t;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===p?n.ref:(n=function(v){var S=h.refs;v===null?delete S[p]:S[p]=v},n._stringRef=p,n)}if(typeof t!="string")throw Error(r(284));if(!o._owner)throw Error(r(290,t))}return t}function Ha(t,n){throw t=Object.prototype.toString.call(n),Error(r(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t))}function Dh(t){var n=t._init;return n(t._payload)}function $h(t){function n(M,R){if(t){var U=M.deletions;U===null?(M.deletions=[R],M.flags|=16):U.push(R)}}function o(M,R){if(!t)return null;for(;R!==null;)n(M,R),R=R.sibling;return null}function u(M,R){for(M=new Map;R!==null;)R.key!==null?M.set(R.key,R):M.set(R.index,R),R=R.sibling;return M}function h(M,R){return M=rn(M,R),M.index=0,M.sibling=null,M}function p(M,R,U){return M.index=U,t?(U=M.alternate,U!==null?(U=U.index,U<R?(M.flags|=2,R):U):(M.flags|=2,R)):(M.flags|=1048576,R)}function v(M){return t&&M.alternate===null&&(M.flags|=2),M}function S(M,R,U,X){return R===null||R.tag!==6?(R=Fc(U,M.mode,X),R.return=M,R):(R=h(R,U),R.return=M,R)}function P(M,R,U,X){var fe=U.type;return fe===G?H(M,R,U.props.children,X,U.key):R!==null&&(R.elementType===fe||typeof fe=="object"&&fe!==null&&fe.$$typeof===Ce&&Dh(fe)===R.type)?(X=h(R,U.props),X.ref=Ti(M,R,U),X.return=M,X):(X=xo(U.type,U.key,U.props,null,M.mode,X),X.ref=Ti(M,R,U),X.return=M,X)}function $(M,R,U,X){return R===null||R.tag!==4||R.stateNode.containerInfo!==U.containerInfo||R.stateNode.implementation!==U.implementation?(R=Bc(U,M.mode,X),R.return=M,R):(R=h(R,U.children||[]),R.return=M,R)}function H(M,R,U,X,fe){return R===null||R.tag!==7?(R=Mn(U,M.mode,X,fe),R.return=M,R):(R=h(R,U),R.return=M,R)}function Q(M,R,U){if(typeof R=="string"&&R!==""||typeof R=="number")return R=Fc(""+R,M.mode,U),R.return=M,R;if(typeof R=="object"&&R!==null){switch(R.$$typeof){case q:return U=xo(R.type,R.key,R.props,null,M.mode,U),U.ref=Ti(M,null,R),U.return=M,U;case F:return R=Bc(R,M.mode,U),R.return=M,R;case Ce:var X=R._init;return Q(M,X(R._payload),U)}if(Ur(R)||le(R))return R=Mn(R,M.mode,U,null),R.return=M,R;Ha(M,R)}return null}function V(M,R,U,X){var fe=R!==null?R.key:null;if(typeof U=="string"&&U!==""||typeof U=="number")return fe!==null?null:S(M,R,""+U,X);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case q:return U.key===fe?P(M,R,U,X):null;case F:return U.key===fe?$(M,R,U,X):null;case Ce:return fe=U._init,V(M,R,fe(U._payload),X)}if(Ur(U)||le(U))return fe!==null?null:H(M,R,U,X,null);Ha(M,U)}return null}function oe(M,R,U,X,fe){if(typeof X=="string"&&X!==""||typeof X=="number")return M=M.get(U)||null,S(R,M,""+X,fe);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case q:return M=M.get(X.key===null?U:X.key)||null,P(R,M,X,fe);case F:return M=M.get(X.key===null?U:X.key)||null,$(R,M,X,fe);case Ce:var ye=X._init;return oe(M,R,U,ye(X._payload),fe)}if(Ur(X)||le(X))return M=M.get(U)||null,H(R,M,X,fe,null);Ha(R,X)}return null}function de(M,R,U,X){for(var fe=null,ye=null,ve=R,_e=R=0,at=null;ve!==null&&_e<U.length;_e++){ve.index>_e?(at=ve,ve=null):at=ve.sibling;var Oe=V(M,ve,U[_e],X);if(Oe===null){ve===null&&(ve=at);break}t&&ve&&Oe.alternate===null&&n(M,ve),R=p(Oe,R,_e),ye===null?fe=Oe:ye.sibling=Oe,ye=Oe,ve=at}if(_e===U.length)return o(M,ve),$e&&Cn(M,_e),fe;if(ve===null){for(;_e<U.length;_e++)ve=Q(M,U[_e],X),ve!==null&&(R=p(ve,R,_e),ye===null?fe=ve:ye.sibling=ve,ye=ve);return $e&&Cn(M,_e),fe}for(ve=u(M,ve);_e<U.length;_e++)at=oe(ve,M,_e,U[_e],X),at!==null&&(t&&at.alternate!==null&&ve.delete(at.key===null?_e:at.key),R=p(at,R,_e),ye===null?fe=at:ye.sibling=at,ye=at);return t&&ve.forEach(function(nn){return n(M,nn)}),$e&&Cn(M,_e),fe}function he(M,R,U,X){var fe=le(U);if(typeof fe!="function")throw Error(r(150));if(U=fe.call(U),U==null)throw Error(r(151));for(var ye=fe=null,ve=R,_e=R=0,at=null,Oe=U.next();ve!==null&&!Oe.done;_e++,Oe=U.next()){ve.index>_e?(at=ve,ve=null):at=ve.sibling;var nn=V(M,ve,Oe.value,X);if(nn===null){ve===null&&(ve=at);break}t&&ve&&nn.alternate===null&&n(M,ve),R=p(nn,R,_e),ye===null?fe=nn:ye.sibling=nn,ye=nn,ve=at}if(Oe.done)return o(M,ve),$e&&Cn(M,_e),fe;if(ve===null){for(;!Oe.done;_e++,Oe=U.next())Oe=Q(M,Oe.value,X),Oe!==null&&(R=p(Oe,R,_e),ye===null?fe=Oe:ye.sibling=Oe,ye=Oe);return $e&&Cn(M,_e),fe}for(ve=u(M,ve);!Oe.done;_e++,Oe=U.next())Oe=oe(ve,M,_e,Oe.value,X),Oe!==null&&(t&&Oe.alternate!==null&&ve.delete(Oe.key===null?_e:Oe.key),R=p(Oe,R,_e),ye===null?fe=Oe:ye.sibling=Oe,ye=Oe);return t&&ve.forEach(function(Nv){return n(M,Nv)}),$e&&Cn(M,_e),fe}function Qe(M,R,U,X){if(typeof U=="object"&&U!==null&&U.type===G&&U.key===null&&(U=U.props.children),typeof U=="object"&&U!==null){switch(U.$$typeof){case q:e:{for(var fe=U.key,ye=R;ye!==null;){if(ye.key===fe){if(fe=U.type,fe===G){if(ye.tag===7){o(M,ye.sibling),R=h(ye,U.props.children),R.return=M,M=R;break e}}else if(ye.elementType===fe||typeof fe=="object"&&fe!==null&&fe.$$typeof===Ce&&Dh(fe)===ye.type){o(M,ye.sibling),R=h(ye,U.props),R.ref=Ti(M,ye,U),R.return=M,M=R;break e}o(M,ye);break}else n(M,ye);ye=ye.sibling}U.type===G?(R=Mn(U.props.children,M.mode,X,U.key),R.return=M,M=R):(X=xo(U.type,U.key,U.props,null,M.mode,X),X.ref=Ti(M,R,U),X.return=M,M=X)}return v(M);case F:e:{for(ye=U.key;R!==null;){if(R.key===ye)if(R.tag===4&&R.stateNode.containerInfo===U.containerInfo&&R.stateNode.implementation===U.implementation){o(M,R.sibling),R=h(R,U.children||[]),R.return=M,M=R;break e}else{o(M,R);break}else n(M,R);R=R.sibling}R=Bc(U,M.mode,X),R.return=M,M=R}return v(M);case Ce:return ye=U._init,Qe(M,R,ye(U._payload),X)}if(Ur(U))return de(M,R,U,X);if(le(U))return he(M,R,U,X);Ha(M,U)}return typeof U=="string"&&U!==""||typeof U=="number"?(U=""+U,R!==null&&R.tag===6?(o(M,R.sibling),R=h(R,U),R.return=M,M=R):(o(M,R),R=Fc(U,M.mode,X),R.return=M,M=R),v(M)):o(M,R)}return Qe}var bs=$h(!0),Fh=$h(!1),Ka=Hr(null),Qa=null,ws=null,Jl=null;function Yl(){Jl=ws=Qa=null}function Xl(t){var n=Ka.current;De(Ka),t._currentValue=n}function Zl(t,n,o){for(;t!==null;){var u=t.alternate;if((t.childLanes&n)!==n?(t.childLanes|=n,u!==null&&(u.childLanes|=n)):u!==null&&(u.childLanes&n)!==n&&(u.childLanes|=n),t===o)break;t=t.return}}function js(t,n){Qa=t,Jl=ws=null,t=t.dependencies,t!==null&&t.firstContext!==null&&((t.lanes&n)!==0&&(kt=!0),t.firstContext=null)}function Wt(t){var n=t._currentValue;if(Jl!==t)if(t={context:t,memoizedValue:n,next:null},ws===null){if(Qa===null)throw Error(r(308));ws=t,Qa.dependencies={lanes:0,firstContext:t}}else ws=ws.next=t;return n}var Pn=null;function ec(t){Pn===null?Pn=[t]:Pn.push(t)}function Bh(t,n,o,u){var h=n.interleaved;return h===null?(o.next=o,ec(n)):(o.next=h.next,h.next=o),n.interleaved=o,Nr(t,u)}function Nr(t,n){t.lanes|=n;var o=t.alternate;for(o!==null&&(o.lanes|=n),o=t,t=t.return;t!==null;)t.childLanes|=n,o=t.alternate,o!==null&&(o.childLanes|=n),o=t,t=t.return;return o.tag===3?o.stateNode:null}var Gr=!1;function tc(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function zh(t,n){t=t.updateQueue,n.updateQueue===t&&(n.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Sr(t,n){return{eventTime:t,lane:n,tag:0,payload:null,callback:null,next:null}}function Jr(t,n,o){var u=t.updateQueue;if(u===null)return null;if(u=u.shared,(Re&2)!==0){var h=u.pending;return h===null?n.next=n:(n.next=h.next,h.next=n),u.pending=n,Nr(t,o)}return h=u.interleaved,h===null?(n.next=n,ec(u)):(n.next=h.next,h.next=n),u.interleaved=n,Nr(t,o)}function Ga(t,n,o){if(n=n.updateQueue,n!==null&&(n=n.shared,(o&4194240)!==0)){var u=n.lanes;u&=t.pendingLanes,o|=u,n.lanes=o,pl(t,o)}}function qh(t,n){var o=t.updateQueue,u=t.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var h=null,p=null;if(o=o.firstBaseUpdate,o!==null){do{var v={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};p===null?h=p=v:p=p.next=v,o=o.next}while(o!==null);p===null?h=p=n:p=p.next=n}else h=p=n;o={baseState:u.baseState,firstBaseUpdate:h,lastBaseUpdate:p,shared:u.shared,effects:u.effects},t.updateQueue=o;return}t=o.lastBaseUpdate,t===null?o.firstBaseUpdate=n:t.next=n,o.lastBaseUpdate=n}function Ja(t,n,o,u){var h=t.updateQueue;Gr=!1;var p=h.firstBaseUpdate,v=h.lastBaseUpdate,S=h.shared.pending;if(S!==null){h.shared.pending=null;var P=S,$=P.next;P.next=null,v===null?p=$:v.next=$,v=P;var H=t.alternate;H!==null&&(H=H.updateQueue,S=H.lastBaseUpdate,S!==v&&(S===null?H.firstBaseUpdate=$:S.next=$,H.lastBaseUpdate=P))}if(p!==null){var Q=h.baseState;v=0,H=$=P=null,S=p;do{var V=S.lane,oe=S.eventTime;if((u&V)===V){H!==null&&(H=H.next={eventTime:oe,lane:0,tag:S.tag,payload:S.payload,callback:S.callback,next:null});e:{var de=t,he=S;switch(V=n,oe=o,he.tag){case 1:if(de=he.payload,typeof de=="function"){Q=de.call(oe,Q,V);break e}Q=de;break e;case 3:de.flags=de.flags&-65537|128;case 0:if(de=he.payload,V=typeof de=="function"?de.call(oe,Q,V):de,V==null)break e;Q=Z({},Q,V);break e;case 2:Gr=!0}}S.callback!==null&&S.lane!==0&&(t.flags|=64,V=h.effects,V===null?h.effects=[S]:V.push(S))}else oe={eventTime:oe,lane:V,tag:S.tag,payload:S.payload,callback:S.callback,next:null},H===null?($=H=oe,P=Q):H=H.next=oe,v|=V;if(S=S.next,S===null){if(S=h.shared.pending,S===null)break;V=S,S=V.next,V.next=null,h.lastBaseUpdate=V,h.shared.pending=null}}while(!0);if(H===null&&(P=Q),h.baseState=P,h.firstBaseUpdate=$,h.lastBaseUpdate=H,n=h.shared.interleaved,n!==null){h=n;do v|=h.lane,h=h.next;while(h!==n)}else p===null&&(h.shared.lanes=0);On|=v,t.lanes=v,t.memoizedState=Q}}function Wh(t,n,o){if(t=n.effects,n.effects=null,t!==null)for(n=0;n<t.length;n++){var u=t[n],h=u.callback;if(h!==null){if(u.callback=null,u=o,typeof h!="function")throw Error(r(191,h));h.call(u)}}}var Ri={},hr=Hr(Ri),Oi=Hr(Ri),Ai=Hr(Ri);function Tn(t){if(t===Ri)throw Error(r(174));return t}function rc(t,n){switch(Le(Ai,n),Le(Oi,t),Le(hr,Ri),t=n.nodeType,t){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:nl(null,"");break;default:t=t===8?n.parentNode:n,n=t.namespaceURI||null,t=t.tagName,n=nl(n,t)}De(hr),Le(hr,n)}function _s(){De(hr),De(Oi),De(Ai)}function Vh(t){Tn(Ai.current);var n=Tn(hr.current),o=nl(n,t.type);n!==o&&(Le(Oi,t),Le(hr,o))}function nc(t){Oi.current===t&&(De(hr),De(Oi))}var Fe=Hr(0);function Ya(t){for(var n=t;n!==null;){if(n.tag===13){var o=n.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var sc=[];function ic(){for(var t=0;t<sc.length;t++)sc[t]._workInProgressVersionPrimary=null;sc.length=0}var Xa=I.ReactCurrentDispatcher,ac=I.ReactCurrentBatchConfig,Rn=0,Be=null,Ze=null,st=null,Za=!1,Ii=!1,Li=0,Hy=0;function mt(){throw Error(r(321))}function oc(t,n){if(n===null)return!1;for(var o=0;o<n.length&&o<t.length;o++)if(!Yt(t[o],n[o]))return!1;return!0}function lc(t,n,o,u,h,p){if(Rn=p,Be=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,Xa.current=t===null||t.memoizedState===null?Jy:Yy,t=o(u,h),Ii){p=0;do{if(Ii=!1,Li=0,25<=p)throw Error(r(301));p+=1,st=Ze=null,n.updateQueue=null,Xa.current=Xy,t=o(u,h)}while(Ii)}if(Xa.current=ro,n=Ze!==null&&Ze.next!==null,Rn=0,st=Ze=Be=null,Za=!1,n)throw Error(r(300));return t}function cc(){var t=Li!==0;return Li=0,t}function fr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return st===null?Be.memoizedState=st=t:st=st.next=t,st}function Vt(){if(Ze===null){var t=Be.alternate;t=t!==null?t.memoizedState:null}else t=Ze.next;var n=st===null?Be.memoizedState:st.next;if(n!==null)st=n,Ze=t;else{if(t===null)throw Error(r(310));Ze=t,t={memoizedState:Ze.memoizedState,baseState:Ze.baseState,baseQueue:Ze.baseQueue,queue:Ze.queue,next:null},st===null?Be.memoizedState=st=t:st=st.next=t}return st}function Mi(t,n){return typeof n=="function"?n(t):n}function uc(t){var n=Vt(),o=n.queue;if(o===null)throw Error(r(311));o.lastRenderedReducer=t;var u=Ze,h=u.baseQueue,p=o.pending;if(p!==null){if(h!==null){var v=h.next;h.next=p.next,p.next=v}u.baseQueue=h=p,o.pending=null}if(h!==null){p=h.next,u=u.baseState;var S=v=null,P=null,$=p;do{var H=$.lane;if((Rn&H)===H)P!==null&&(P=P.next={lane:0,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null}),u=$.hasEagerState?$.eagerState:t(u,$.action);else{var Q={lane:H,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null};P===null?(S=P=Q,v=u):P=P.next=Q,Be.lanes|=H,On|=H}$=$.next}while($!==null&&$!==p);P===null?v=u:P.next=S,Yt(u,n.memoizedState)||(kt=!0),n.memoizedState=u,n.baseState=v,n.baseQueue=P,o.lastRenderedState=u}if(t=o.interleaved,t!==null){h=t;do p=h.lane,Be.lanes|=p,On|=p,h=h.next;while(h!==t)}else h===null&&(o.lanes=0);return[n.memoizedState,o.dispatch]}function dc(t){var n=Vt(),o=n.queue;if(o===null)throw Error(r(311));o.lastRenderedReducer=t;var u=o.dispatch,h=o.pending,p=n.memoizedState;if(h!==null){o.pending=null;var v=h=h.next;do p=t(p,v.action),v=v.next;while(v!==h);Yt(p,n.memoizedState)||(kt=!0),n.memoizedState=p,n.baseQueue===null&&(n.baseState=p),o.lastRenderedState=p}return[p,u]}function Hh(){}function Kh(t,n){var o=Be,u=Vt(),h=n(),p=!Yt(u.memoizedState,h);if(p&&(u.memoizedState=h,kt=!0),u=u.queue,hc(Jh.bind(null,o,u,t),[t]),u.getSnapshot!==n||p||st!==null&&st.memoizedState.tag&1){if(o.flags|=2048,Ui(9,Gh.bind(null,o,u,h,n),void 0,null),it===null)throw Error(r(349));(Rn&30)!==0||Qh(o,n,h)}return h}function Qh(t,n,o){t.flags|=16384,t={getSnapshot:n,value:o},n=Be.updateQueue,n===null?(n={lastEffect:null,stores:null},Be.updateQueue=n,n.stores=[t]):(o=n.stores,o===null?n.stores=[t]:o.push(t))}function Gh(t,n,o,u){n.value=o,n.getSnapshot=u,Yh(n)&&Xh(t)}function Jh(t,n,o){return o(function(){Yh(n)&&Xh(t)})}function Yh(t){var n=t.getSnapshot;t=t.value;try{var o=n();return!Yt(t,o)}catch{return!0}}function Xh(t){var n=Nr(t,1);n!==null&&rr(n,t,1,-1)}function Zh(t){var n=fr();return typeof t=="function"&&(t=t()),n.memoizedState=n.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mi,lastRenderedState:t},n.queue=t,t=t.dispatch=Gy.bind(null,Be,t),[n.memoizedState,t]}function Ui(t,n,o,u){return t={tag:t,create:n,destroy:o,deps:u,next:null},n=Be.updateQueue,n===null?(n={lastEffect:null,stores:null},Be.updateQueue=n,n.lastEffect=t.next=t):(o=n.lastEffect,o===null?n.lastEffect=t.next=t:(u=o.next,o.next=t,t.next=u,n.lastEffect=t)),t}function ef(){return Vt().memoizedState}function eo(t,n,o,u){var h=fr();Be.flags|=t,h.memoizedState=Ui(1|n,o,void 0,u===void 0?null:u)}function to(t,n,o,u){var h=Vt();u=u===void 0?null:u;var p=void 0;if(Ze!==null){var v=Ze.memoizedState;if(p=v.destroy,u!==null&&oc(u,v.deps)){h.memoizedState=Ui(n,o,p,u);return}}Be.flags|=t,h.memoizedState=Ui(1|n,o,p,u)}function tf(t,n){return eo(8390656,8,t,n)}function hc(t,n){return to(2048,8,t,n)}function rf(t,n){return to(4,2,t,n)}function nf(t,n){return to(4,4,t,n)}function sf(t,n){if(typeof n=="function")return t=t(),n(t),function(){n(null)};if(n!=null)return t=t(),n.current=t,function(){n.current=null}}function af(t,n,o){return o=o!=null?o.concat([t]):null,to(4,4,sf.bind(null,n,t),o)}function fc(){}function of(t,n){var o=Vt();n=n===void 0?null:n;var u=o.memoizedState;return u!==null&&n!==null&&oc(n,u[1])?u[0]:(o.memoizedState=[t,n],t)}function lf(t,n){var o=Vt();n=n===void 0?null:n;var u=o.memoizedState;return u!==null&&n!==null&&oc(n,u[1])?u[0]:(t=t(),o.memoizedState=[t,n],t)}function cf(t,n,o){return(Rn&21)===0?(t.baseState&&(t.baseState=!1,kt=!0),t.memoizedState=o):(Yt(o,n)||(o=Dd(),Be.lanes|=o,On|=o,t.baseState=!0),n)}function Ky(t,n){var o=Ie;Ie=o!==0&&4>o?o:4,t(!0);var u=ac.transition;ac.transition={};try{t(!1),n()}finally{Ie=o,ac.transition=u}}function uf(){return Vt().memoizedState}function Qy(t,n,o){var u=en(t);if(o={lane:u,action:o,hasEagerState:!1,eagerState:null,next:null},df(t))hf(n,o);else if(o=Bh(t,n,o,u),o!==null){var h=vt();rr(o,t,u,h),ff(o,n,u)}}function Gy(t,n,o){var u=en(t),h={lane:u,action:o,hasEagerState:!1,eagerState:null,next:null};if(df(t))hf(n,h);else{var p=t.alternate;if(t.lanes===0&&(p===null||p.lanes===0)&&(p=n.lastRenderedReducer,p!==null))try{var v=n.lastRenderedState,S=p(v,o);if(h.hasEagerState=!0,h.eagerState=S,Yt(S,v)){var P=n.interleaved;P===null?(h.next=h,ec(n)):(h.next=P.next,P.next=h),n.interleaved=h;return}}catch{}finally{}o=Bh(t,n,h,u),o!==null&&(h=vt(),rr(o,t,u,h),ff(o,n,u))}}function df(t){var n=t.alternate;return t===Be||n!==null&&n===Be}function hf(t,n){Ii=Za=!0;var o=t.pending;o===null?n.next=n:(n.next=o.next,o.next=n),t.pending=n}function ff(t,n,o){if((o&4194240)!==0){var u=n.lanes;u&=t.pendingLanes,o|=u,n.lanes=o,pl(t,o)}}var ro={readContext:Wt,useCallback:mt,useContext:mt,useEffect:mt,useImperativeHandle:mt,useInsertionEffect:mt,useLayoutEffect:mt,useMemo:mt,useReducer:mt,useRef:mt,useState:mt,useDebugValue:mt,useDeferredValue:mt,useTransition:mt,useMutableSource:mt,useSyncExternalStore:mt,useId:mt,unstable_isNewReconciler:!1},Jy={readContext:Wt,useCallback:function(t,n){return fr().memoizedState=[t,n===void 0?null:n],t},useContext:Wt,useEffect:tf,useImperativeHandle:function(t,n,o){return o=o!=null?o.concat([t]):null,eo(4194308,4,sf.bind(null,n,t),o)},useLayoutEffect:function(t,n){return eo(4194308,4,t,n)},useInsertionEffect:function(t,n){return eo(4,2,t,n)},useMemo:function(t,n){var o=fr();return n=n===void 0?null:n,t=t(),o.memoizedState=[t,n],t},useReducer:function(t,n,o){var u=fr();return n=o!==void 0?o(n):n,u.memoizedState=u.baseState=n,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:n},u.queue=t,t=t.dispatch=Qy.bind(null,Be,t),[u.memoizedState,t]},useRef:function(t){var n=fr();return t={current:t},n.memoizedState=t},useState:Zh,useDebugValue:fc,useDeferredValue:function(t){return fr().memoizedState=t},useTransition:function(){var t=Zh(!1),n=t[0];return t=Ky.bind(null,t[1]),fr().memoizedState=t,[n,t]},useMutableSource:function(){},useSyncExternalStore:function(t,n,o){var u=Be,h=fr();if($e){if(o===void 0)throw Error(r(407));o=o()}else{if(o=n(),it===null)throw Error(r(349));(Rn&30)!==0||Qh(u,n,o)}h.memoizedState=o;var p={value:o,getSnapshot:n};return h.queue=p,tf(Jh.bind(null,u,p,t),[t]),u.flags|=2048,Ui(9,Gh.bind(null,u,p,o,n),void 0,null),o},useId:function(){var t=fr(),n=it.identifierPrefix;if($e){var o=_r,u=jr;o=(u&~(1<<32-Jt(u)-1)).toString(32)+o,n=":"+n+"R"+o,o=Li++,0<o&&(n+="H"+o.toString(32)),n+=":"}else o=Hy++,n=":"+n+"r"+o.toString(32)+":";return t.memoizedState=n},unstable_isNewReconciler:!1},Yy={readContext:Wt,useCallback:of,useContext:Wt,useEffect:hc,useImperativeHandle:af,useInsertionEffect:rf,useLayoutEffect:nf,useMemo:lf,useReducer:uc,useRef:ef,useState:function(){return uc(Mi)},useDebugValue:fc,useDeferredValue:function(t){var n=Vt();return cf(n,Ze.memoizedState,t)},useTransition:function(){var t=uc(Mi)[0],n=Vt().memoizedState;return[t,n]},useMutableSource:Hh,useSyncExternalStore:Kh,useId:uf,unstable_isNewReconciler:!1},Xy={readContext:Wt,useCallback:of,useContext:Wt,useEffect:hc,useImperativeHandle:af,useInsertionEffect:rf,useLayoutEffect:nf,useMemo:lf,useReducer:dc,useRef:ef,useState:function(){return dc(Mi)},useDebugValue:fc,useDeferredValue:function(t){var n=Vt();return Ze===null?n.memoizedState=t:cf(n,Ze.memoizedState,t)},useTransition:function(){var t=dc(Mi)[0],n=Vt().memoizedState;return[t,n]},useMutableSource:Hh,useSyncExternalStore:Kh,useId:uf,unstable_isNewReconciler:!1};function Zt(t,n){if(t&&t.defaultProps){n=Z({},n),t=t.defaultProps;for(var o in t)n[o]===void 0&&(n[o]=t[o]);return n}return n}function mc(t,n,o,u){n=t.memoizedState,o=o(u,n),o=o==null?n:Z({},n,o),t.memoizedState=o,t.lanes===0&&(t.updateQueue.baseState=o)}var no={isMounted:function(t){return(t=t._reactInternals)?Nn(t)===t:!1},enqueueSetState:function(t,n,o){t=t._reactInternals;var u=vt(),h=en(t),p=Sr(u,h);p.payload=n,o!=null&&(p.callback=o),n=Jr(t,p,h),n!==null&&(rr(n,t,h,u),Ga(n,t,h))},enqueueReplaceState:function(t,n,o){t=t._reactInternals;var u=vt(),h=en(t),p=Sr(u,h);p.tag=1,p.payload=n,o!=null&&(p.callback=o),n=Jr(t,p,h),n!==null&&(rr(n,t,h,u),Ga(n,t,h))},enqueueForceUpdate:function(t,n){t=t._reactInternals;var o=vt(),u=en(t),h=Sr(o,u);h.tag=2,n!=null&&(h.callback=n),n=Jr(t,h,u),n!==null&&(rr(n,t,u,o),Ga(n,t,u))}};function mf(t,n,o,u,h,p,v){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(u,p,v):n.prototype&&n.prototype.isPureReactComponent?!_i(o,u)||!_i(h,p):!0}function pf(t,n,o){var u=!1,h=Kr,p=n.contextType;return typeof p=="object"&&p!==null?p=Wt(p):(h=St(n)?kn:ft.current,u=n.contextTypes,p=(u=u!=null)?gs(t,h):Kr),n=new n(o,p),t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=no,t.stateNode=n,n._reactInternals=t,u&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=h,t.__reactInternalMemoizedMaskedChildContext=p),n}function gf(t,n,o,u){t=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(o,u),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(o,u),n.state!==t&&no.enqueueReplaceState(n,n.state,null)}function pc(t,n,o,u){var h=t.stateNode;h.props=o,h.state=t.memoizedState,h.refs={},tc(t);var p=n.contextType;typeof p=="object"&&p!==null?h.context=Wt(p):(p=St(n)?kn:ft.current,h.context=gs(t,p)),h.state=t.memoizedState,p=n.getDerivedStateFromProps,typeof p=="function"&&(mc(t,n,p,o),h.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(n=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),n!==h.state&&no.enqueueReplaceState(h,h.state,null),Ja(t,o,h,u),h.state=t.memoizedState),typeof h.componentDidMount=="function"&&(t.flags|=4194308)}function Ns(t,n){try{var o="",u=n;do o+=J(u),u=u.return;while(u);var h=o}catch(p){h=`
Error generating stack: `+p.message+`
`+p.stack}return{value:t,source:n,stack:h,digest:null}}function gc(t,n,o){return{value:t,source:null,stack:o??null,digest:n??null}}function xc(t,n){try{console.error(n.value)}catch(o){setTimeout(function(){throw o})}}var Zy=typeof WeakMap=="function"?WeakMap:Map;function xf(t,n,o){o=Sr(-1,o),o.tag=3,o.payload={element:null};var u=n.value;return o.callback=function(){uo||(uo=!0,Oc=u),xc(t,n)},o}function yf(t,n,o){o=Sr(-1,o),o.tag=3;var u=t.type.getDerivedStateFromError;if(typeof u=="function"){var h=n.value;o.payload=function(){return u(h)},o.callback=function(){xc(t,n)}}var p=t.stateNode;return p!==null&&typeof p.componentDidCatch=="function"&&(o.callback=function(){xc(t,n),typeof u!="function"&&(Xr===null?Xr=new Set([this]):Xr.add(this));var v=n.stack;this.componentDidCatch(n.value,{componentStack:v!==null?v:""})}),o}function vf(t,n,o){var u=t.pingCache;if(u===null){u=t.pingCache=new Zy;var h=new Set;u.set(n,h)}else h=u.get(n),h===void 0&&(h=new Set,u.set(n,h));h.has(o)||(h.add(o),t=fv.bind(null,t,n,o),n.then(t,t))}function bf(t){do{var n;if((n=t.tag===13)&&(n=t.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return t;t=t.return}while(t!==null);return null}function wf(t,n,o,u,h){return(t.mode&1)===0?(t===n?t.flags|=65536:(t.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(n=Sr(-1,1),n.tag=2,Jr(o,n,1))),o.lanes|=1),t):(t.flags|=65536,t.lanes=h,t)}var ev=I.ReactCurrentOwner,kt=!1;function yt(t,n,o,u){n.child=t===null?Fh(n,null,o,u):bs(n,t.child,o,u)}function jf(t,n,o,u,h){o=o.render;var p=n.ref;return js(n,h),u=lc(t,n,o,u,p,h),o=cc(),t!==null&&!kt?(n.updateQueue=t.updateQueue,n.flags&=-2053,t.lanes&=~h,kr(t,n,h)):($e&&o&&Vl(n),n.flags|=1,yt(t,n,u,h),n.child)}function _f(t,n,o,u,h){if(t===null){var p=o.type;return typeof p=="function"&&!$c(p)&&p.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(n.tag=15,n.type=p,Nf(t,n,p,u,h)):(t=xo(o.type,null,u,n,n.mode,h),t.ref=n.ref,t.return=n,n.child=t)}if(p=t.child,(t.lanes&h)===0){var v=p.memoizedProps;if(o=o.compare,o=o!==null?o:_i,o(v,u)&&t.ref===n.ref)return kr(t,n,h)}return n.flags|=1,t=rn(p,u),t.ref=n.ref,t.return=n,n.child=t}function Nf(t,n,o,u,h){if(t!==null){var p=t.memoizedProps;if(_i(p,u)&&t.ref===n.ref)if(kt=!1,n.pendingProps=u=p,(t.lanes&h)!==0)(t.flags&131072)!==0&&(kt=!0);else return n.lanes=t.lanes,kr(t,n,h)}return yc(t,n,o,u,h)}function Sf(t,n,o){var u=n.pendingProps,h=u.children,p=t!==null?t.memoizedState:null;if(u.mode==="hidden")if((n.mode&1)===0)n.memoizedState={baseLanes:0,cachePool:null,transitions:null},Le(ks,Mt),Mt|=o;else{if((o&1073741824)===0)return t=p!==null?p.baseLanes|o:o,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:t,cachePool:null,transitions:null},n.updateQueue=null,Le(ks,Mt),Mt|=t,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},u=p!==null?p.baseLanes:o,Le(ks,Mt),Mt|=u}else p!==null?(u=p.baseLanes|o,n.memoizedState=null):u=o,Le(ks,Mt),Mt|=u;return yt(t,n,h,o),n.child}function kf(t,n){var o=n.ref;(t===null&&o!==null||t!==null&&t.ref!==o)&&(n.flags|=512,n.flags|=2097152)}function yc(t,n,o,u,h){var p=St(o)?kn:ft.current;return p=gs(n,p),js(n,h),o=lc(t,n,o,u,p,h),u=cc(),t!==null&&!kt?(n.updateQueue=t.updateQueue,n.flags&=-2053,t.lanes&=~h,kr(t,n,h)):($e&&u&&Vl(n),n.flags|=1,yt(t,n,o,h),n.child)}function Ef(t,n,o,u,h){if(St(o)){var p=!0;Ba(n)}else p=!1;if(js(n,h),n.stateNode===null)io(t,n),pf(n,o,u),pc(n,o,u,h),u=!0;else if(t===null){var v=n.stateNode,S=n.memoizedProps;v.props=S;var P=v.context,$=o.contextType;typeof $=="object"&&$!==null?$=Wt($):($=St(o)?kn:ft.current,$=gs(n,$));var H=o.getDerivedStateFromProps,Q=typeof H=="function"||typeof v.getSnapshotBeforeUpdate=="function";Q||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(S!==u||P!==$)&&gf(n,v,u,$),Gr=!1;var V=n.memoizedState;v.state=V,Ja(n,u,v,h),P=n.memoizedState,S!==u||V!==P||Nt.current||Gr?(typeof H=="function"&&(mc(n,o,H,u),P=n.memoizedState),(S=Gr||mf(n,o,S,u,V,P,$))?(Q||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(n.flags|=4194308)):(typeof v.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=u,n.memoizedState=P),v.props=u,v.state=P,v.context=$,u=S):(typeof v.componentDidMount=="function"&&(n.flags|=4194308),u=!1)}else{v=n.stateNode,zh(t,n),S=n.memoizedProps,$=n.type===n.elementType?S:Zt(n.type,S),v.props=$,Q=n.pendingProps,V=v.context,P=o.contextType,typeof P=="object"&&P!==null?P=Wt(P):(P=St(o)?kn:ft.current,P=gs(n,P));var oe=o.getDerivedStateFromProps;(H=typeof oe=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(S!==Q||V!==P)&&gf(n,v,u,P),Gr=!1,V=n.memoizedState,v.state=V,Ja(n,u,v,h);var de=n.memoizedState;S!==Q||V!==de||Nt.current||Gr?(typeof oe=="function"&&(mc(n,o,oe,u),de=n.memoizedState),($=Gr||mf(n,o,$,u,V,de,P)||!1)?(H||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(u,de,P),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(u,de,P)),typeof v.componentDidUpdate=="function"&&(n.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof v.componentDidUpdate!="function"||S===t.memoizedProps&&V===t.memoizedState||(n.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||S===t.memoizedProps&&V===t.memoizedState||(n.flags|=1024),n.memoizedProps=u,n.memoizedState=de),v.props=u,v.state=de,v.context=P,u=$):(typeof v.componentDidUpdate!="function"||S===t.memoizedProps&&V===t.memoizedState||(n.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||S===t.memoizedProps&&V===t.memoizedState||(n.flags|=1024),u=!1)}return vc(t,n,o,u,p,h)}function vc(t,n,o,u,h,p){kf(t,n);var v=(n.flags&128)!==0;if(!u&&!v)return h&&Rh(n,o,!1),kr(t,n,p);u=n.stateNode,ev.current=n;var S=v&&typeof o.getDerivedStateFromError!="function"?null:u.render();return n.flags|=1,t!==null&&v?(n.child=bs(n,t.child,null,p),n.child=bs(n,null,S,p)):yt(t,n,S,p),n.memoizedState=u.state,h&&Rh(n,o,!0),n.child}function Cf(t){var n=t.stateNode;n.pendingContext?Ph(t,n.pendingContext,n.pendingContext!==n.context):n.context&&Ph(t,n.context,!1),rc(t,n.containerInfo)}function Pf(t,n,o,u,h){return vs(),Gl(h),n.flags|=256,yt(t,n,o,u),n.child}var bc={dehydrated:null,treeContext:null,retryLane:0};function wc(t){return{baseLanes:t,cachePool:null,transitions:null}}function Tf(t,n,o){var u=n.pendingProps,h=Fe.current,p=!1,v=(n.flags&128)!==0,S;if((S=v)||(S=t!==null&&t.memoizedState===null?!1:(h&2)!==0),S?(p=!0,n.flags&=-129):(t===null||t.memoizedState!==null)&&(h|=1),Le(Fe,h&1),t===null)return Ql(n),t=n.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?((n.mode&1)===0?n.lanes=1:t.data==="$!"?n.lanes=8:n.lanes=1073741824,null):(v=u.children,t=u.fallback,p?(u=n.mode,p=n.child,v={mode:"hidden",children:v},(u&1)===0&&p!==null?(p.childLanes=0,p.pendingProps=v):p=yo(v,u,0,null),t=Mn(t,u,o,null),p.return=n,t.return=n,p.sibling=t,n.child=p,n.child.memoizedState=wc(o),n.memoizedState=bc,t):jc(n,v));if(h=t.memoizedState,h!==null&&(S=h.dehydrated,S!==null))return tv(t,n,v,u,S,h,o);if(p){p=u.fallback,v=n.mode,h=t.child,S=h.sibling;var P={mode:"hidden",children:u.children};return(v&1)===0&&n.child!==h?(u=n.child,u.childLanes=0,u.pendingProps=P,n.deletions=null):(u=rn(h,P),u.subtreeFlags=h.subtreeFlags&14680064),S!==null?p=rn(S,p):(p=Mn(p,v,o,null),p.flags|=2),p.return=n,u.return=n,u.sibling=p,n.child=u,u=p,p=n.child,v=t.child.memoizedState,v=v===null?wc(o):{baseLanes:v.baseLanes|o,cachePool:null,transitions:v.transitions},p.memoizedState=v,p.childLanes=t.childLanes&~o,n.memoizedState=bc,u}return p=t.child,t=p.sibling,u=rn(p,{mode:"visible",children:u.children}),(n.mode&1)===0&&(u.lanes=o),u.return=n,u.sibling=null,t!==null&&(o=n.deletions,o===null?(n.deletions=[t],n.flags|=16):o.push(t)),n.child=u,n.memoizedState=null,u}function jc(t,n){return n=yo({mode:"visible",children:n},t.mode,0,null),n.return=t,t.child=n}function so(t,n,o,u){return u!==null&&Gl(u),bs(n,t.child,null,o),t=jc(n,n.pendingProps.children),t.flags|=2,n.memoizedState=null,t}function tv(t,n,o,u,h,p,v){if(o)return n.flags&256?(n.flags&=-257,u=gc(Error(r(422))),so(t,n,v,u)):n.memoizedState!==null?(n.child=t.child,n.flags|=128,null):(p=u.fallback,h=n.mode,u=yo({mode:"visible",children:u.children},h,0,null),p=Mn(p,h,v,null),p.flags|=2,u.return=n,p.return=n,u.sibling=p,n.child=u,(n.mode&1)!==0&&bs(n,t.child,null,v),n.child.memoizedState=wc(v),n.memoizedState=bc,p);if((n.mode&1)===0)return so(t,n,v,null);if(h.data==="$!"){if(u=h.nextSibling&&h.nextSibling.dataset,u)var S=u.dgst;return u=S,p=Error(r(419)),u=gc(p,u,void 0),so(t,n,v,u)}if(S=(v&t.childLanes)!==0,kt||S){if(u=it,u!==null){switch(v&-v){case 4:h=2;break;case 16:h=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:h=32;break;case 536870912:h=268435456;break;default:h=0}h=(h&(u.suspendedLanes|v))!==0?0:h,h!==0&&h!==p.retryLane&&(p.retryLane=h,Nr(t,h),rr(u,t,h,-1))}return Dc(),u=gc(Error(r(421))),so(t,n,v,u)}return h.data==="$?"?(n.flags|=128,n.child=t.child,n=mv.bind(null,t),h._reactRetry=n,null):(t=p.treeContext,Lt=Vr(h.nextSibling),It=n,$e=!0,Xt=null,t!==null&&(zt[qt++]=jr,zt[qt++]=_r,zt[qt++]=En,jr=t.id,_r=t.overflow,En=n),n=jc(n,u.children),n.flags|=4096,n)}function Rf(t,n,o){t.lanes|=n;var u=t.alternate;u!==null&&(u.lanes|=n),Zl(t.return,n,o)}function _c(t,n,o,u,h){var p=t.memoizedState;p===null?t.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:h}:(p.isBackwards=n,p.rendering=null,p.renderingStartTime=0,p.last=u,p.tail=o,p.tailMode=h)}function Of(t,n,o){var u=n.pendingProps,h=u.revealOrder,p=u.tail;if(yt(t,n,u.children,o),u=Fe.current,(u&2)!==0)u=u&1|2,n.flags|=128;else{if(t!==null&&(t.flags&128)!==0)e:for(t=n.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Rf(t,o,n);else if(t.tag===19)Rf(t,o,n);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===n)break e;for(;t.sibling===null;){if(t.return===null||t.return===n)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}u&=1}if(Le(Fe,u),(n.mode&1)===0)n.memoizedState=null;else switch(h){case"forwards":for(o=n.child,h=null;o!==null;)t=o.alternate,t!==null&&Ya(t)===null&&(h=o),o=o.sibling;o=h,o===null?(h=n.child,n.child=null):(h=o.sibling,o.sibling=null),_c(n,!1,h,o,p);break;case"backwards":for(o=null,h=n.child,n.child=null;h!==null;){if(t=h.alternate,t!==null&&Ya(t)===null){n.child=h;break}t=h.sibling,h.sibling=o,o=h,h=t}_c(n,!0,o,null,p);break;case"together":_c(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function io(t,n){(n.mode&1)===0&&t!==null&&(t.alternate=null,n.alternate=null,n.flags|=2)}function kr(t,n,o){if(t!==null&&(n.dependencies=t.dependencies),On|=n.lanes,(o&n.childLanes)===0)return null;if(t!==null&&n.child!==t.child)throw Error(r(153));if(n.child!==null){for(t=n.child,o=rn(t,t.pendingProps),n.child=o,o.return=n;t.sibling!==null;)t=t.sibling,o=o.sibling=rn(t,t.pendingProps),o.return=n;o.sibling=null}return n.child}function rv(t,n,o){switch(n.tag){case 3:Cf(n),vs();break;case 5:Vh(n);break;case 1:St(n.type)&&Ba(n);break;case 4:rc(n,n.stateNode.containerInfo);break;case 10:var u=n.type._context,h=n.memoizedProps.value;Le(Ka,u._currentValue),u._currentValue=h;break;case 13:if(u=n.memoizedState,u!==null)return u.dehydrated!==null?(Le(Fe,Fe.current&1),n.flags|=128,null):(o&n.child.childLanes)!==0?Tf(t,n,o):(Le(Fe,Fe.current&1),t=kr(t,n,o),t!==null?t.sibling:null);Le(Fe,Fe.current&1);break;case 19:if(u=(o&n.childLanes)!==0,(t.flags&128)!==0){if(u)return Of(t,n,o);n.flags|=128}if(h=n.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),Le(Fe,Fe.current),u)break;return null;case 22:case 23:return n.lanes=0,Sf(t,n,o)}return kr(t,n,o)}var Af,Nc,If,Lf;Af=function(t,n){for(var o=n.child;o!==null;){if(o.tag===5||o.tag===6)t.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return;o=o.return}o.sibling.return=o.return,o=o.sibling}},Nc=function(){},If=function(t,n,o,u){var h=t.memoizedProps;if(h!==u){t=n.stateNode,Tn(hr.current);var p=null;switch(o){case"input":h=ss(t,h),u=ss(t,u),p=[];break;case"select":h=Z({},h,{value:void 0}),u=Z({},u,{value:void 0}),p=[];break;case"textarea":h=ii(t,h),u=ii(t,u),p=[];break;default:typeof h.onClick!="function"&&typeof u.onClick=="function"&&(t.onclick=Da)}sl(o,u);var v;o=null;for($ in h)if(!u.hasOwnProperty($)&&h.hasOwnProperty($)&&h[$]!=null)if($==="style"){var S=h[$];for(v in S)S.hasOwnProperty(v)&&(o||(o={}),o[v]="")}else $!=="dangerouslySetInnerHTML"&&$!=="children"&&$!=="suppressContentEditableWarning"&&$!=="suppressHydrationWarning"&&$!=="autoFocus"&&(l.hasOwnProperty($)?p||(p=[]):(p=p||[]).push($,null));for($ in u){var P=u[$];if(S=h!=null?h[$]:void 0,u.hasOwnProperty($)&&P!==S&&(P!=null||S!=null))if($==="style")if(S){for(v in S)!S.hasOwnProperty(v)||P&&P.hasOwnProperty(v)||(o||(o={}),o[v]="");for(v in P)P.hasOwnProperty(v)&&S[v]!==P[v]&&(o||(o={}),o[v]=P[v])}else o||(p||(p=[]),p.push($,o)),o=P;else $==="dangerouslySetInnerHTML"?(P=P?P.__html:void 0,S=S?S.__html:void 0,P!=null&&S!==P&&(p=p||[]).push($,P)):$==="children"?typeof P!="string"&&typeof P!="number"||(p=p||[]).push($,""+P):$!=="suppressContentEditableWarning"&&$!=="suppressHydrationWarning"&&(l.hasOwnProperty($)?(P!=null&&$==="onScroll"&&Ue("scroll",t),p||S===P||(p=[])):(p=p||[]).push($,P))}o&&(p=p||[]).push("style",o);var $=p;(n.updateQueue=$)&&(n.flags|=4)}},Lf=function(t,n,o,u){o!==u&&(n.flags|=4)};function Di(t,n){if(!$e)switch(t.tailMode){case"hidden":n=t.tail;for(var o=null;n!==null;)n.alternate!==null&&(o=n),n=n.sibling;o===null?t.tail=null:o.sibling=null;break;case"collapsed":o=t.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?n||t.tail===null?t.tail=null:t.tail.sibling=null:u.sibling=null}}function pt(t){var n=t.alternate!==null&&t.alternate.child===t.child,o=0,u=0;if(n)for(var h=t.child;h!==null;)o|=h.lanes|h.childLanes,u|=h.subtreeFlags&14680064,u|=h.flags&14680064,h.return=t,h=h.sibling;else for(h=t.child;h!==null;)o|=h.lanes|h.childLanes,u|=h.subtreeFlags,u|=h.flags,h.return=t,h=h.sibling;return t.subtreeFlags|=u,t.childLanes=o,n}function nv(t,n,o){var u=n.pendingProps;switch(Hl(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pt(n),null;case 1:return St(n.type)&&Fa(),pt(n),null;case 3:return u=n.stateNode,_s(),De(Nt),De(ft),ic(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(t===null||t.child===null)&&(Va(n)?n.flags|=4:t===null||t.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,Xt!==null&&(Lc(Xt),Xt=null))),Nc(t,n),pt(n),null;case 5:nc(n);var h=Tn(Ai.current);if(o=n.type,t!==null&&n.stateNode!=null)If(t,n,o,u,h),t.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!u){if(n.stateNode===null)throw Error(r(166));return pt(n),null}if(t=Tn(hr.current),Va(n)){u=n.stateNode,o=n.type;var p=n.memoizedProps;switch(u[dr]=n,u[Ci]=p,t=(n.mode&1)!==0,o){case"dialog":Ue("cancel",u),Ue("close",u);break;case"iframe":case"object":case"embed":Ue("load",u);break;case"video":case"audio":for(h=0;h<Si.length;h++)Ue(Si[h],u);break;case"source":Ue("error",u);break;case"img":case"image":case"link":Ue("error",u),Ue("load",u);break;case"details":Ue("toggle",u);break;case"input":ri(u,p),Ue("invalid",u);break;case"select":u._wrapperState={wasMultiple:!!p.multiple},Ue("invalid",u);break;case"textarea":pa(u,p),Ue("invalid",u)}sl(o,p),h=null;for(var v in p)if(p.hasOwnProperty(v)){var S=p[v];v==="children"?typeof S=="string"?u.textContent!==S&&(p.suppressHydrationWarning!==!0&&Ua(u.textContent,S,t),h=["children",S]):typeof S=="number"&&u.textContent!==""+S&&(p.suppressHydrationWarning!==!0&&Ua(u.textContent,S,t),h=["children",""+S]):l.hasOwnProperty(v)&&S!=null&&v==="onScroll"&&Ue("scroll",u)}switch(o){case"input":Xe(u),ma(u,p,!0);break;case"textarea":Xe(u),vd(u);break;case"select":case"option":break;default:typeof p.onClick=="function"&&(u.onclick=Da)}u=h,n.updateQueue=u,u!==null&&(n.flags|=4)}else{v=h.nodeType===9?h:h.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=bd(o)),t==="http://www.w3.org/1999/xhtml"?o==="script"?(t=v.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof u.is=="string"?t=v.createElement(o,{is:u.is}):(t=v.createElement(o),o==="select"&&(v=t,u.multiple?v.multiple=!0:u.size&&(v.size=u.size))):t=v.createElementNS(t,o),t[dr]=n,t[Ci]=u,Af(t,n,!1,!1),n.stateNode=t;e:{switch(v=il(o,u),o){case"dialog":Ue("cancel",t),Ue("close",t),h=u;break;case"iframe":case"object":case"embed":Ue("load",t),h=u;break;case"video":case"audio":for(h=0;h<Si.length;h++)Ue(Si[h],t);h=u;break;case"source":Ue("error",t),h=u;break;case"img":case"image":case"link":Ue("error",t),Ue("load",t),h=u;break;case"details":Ue("toggle",t),h=u;break;case"input":ri(t,u),h=ss(t,u),Ue("invalid",t);break;case"option":h=u;break;case"select":t._wrapperState={wasMultiple:!!u.multiple},h=Z({},u,{value:void 0}),Ue("invalid",t);break;case"textarea":pa(t,u),h=ii(t,u),Ue("invalid",t);break;default:h=u}sl(o,h),S=h;for(p in S)if(S.hasOwnProperty(p)){var P=S[p];p==="style"?_d(t,P):p==="dangerouslySetInnerHTML"?(P=P?P.__html:void 0,P!=null&&wd(t,P)):p==="children"?typeof P=="string"?(o!=="textarea"||P!=="")&&ai(t,P):typeof P=="number"&&ai(t,""+P):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(l.hasOwnProperty(p)?P!=null&&p==="onScroll"&&Ue("scroll",t):P!=null&&T(t,p,P,v))}switch(o){case"input":Xe(t),ma(t,u,!1);break;case"textarea":Xe(t),vd(t);break;case"option":u.value!=null&&t.setAttribute("value",""+z(u.value));break;case"select":t.multiple=!!u.multiple,p=u.value,p!=null?Dr(t,!!u.multiple,p,!1):u.defaultValue!=null&&Dr(t,!!u.multiple,u.defaultValue,!0);break;default:typeof h.onClick=="function"&&(t.onclick=Da)}switch(o){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}}u&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return pt(n),null;case 6:if(t&&n.stateNode!=null)Lf(t,n,t.memoizedProps,u);else{if(typeof u!="string"&&n.stateNode===null)throw Error(r(166));if(o=Tn(Ai.current),Tn(hr.current),Va(n)){if(u=n.stateNode,o=n.memoizedProps,u[dr]=n,(p=u.nodeValue!==o)&&(t=It,t!==null))switch(t.tag){case 3:Ua(u.nodeValue,o,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ua(u.nodeValue,o,(t.mode&1)!==0)}p&&(n.flags|=4)}else u=(o.nodeType===9?o:o.ownerDocument).createTextNode(u),u[dr]=n,n.stateNode=u}return pt(n),null;case 13:if(De(Fe),u=n.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if($e&&Lt!==null&&(n.mode&1)!==0&&(n.flags&128)===0)Uh(),vs(),n.flags|=98560,p=!1;else if(p=Va(n),u!==null&&u.dehydrated!==null){if(t===null){if(!p)throw Error(r(318));if(p=n.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(r(317));p[dr]=n}else vs(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;pt(n),p=!1}else Xt!==null&&(Lc(Xt),Xt=null),p=!0;if(!p)return n.flags&65536?n:null}return(n.flags&128)!==0?(n.lanes=o,n):(u=u!==null,u!==(t!==null&&t.memoizedState!==null)&&u&&(n.child.flags|=8192,(n.mode&1)!==0&&(t===null||(Fe.current&1)!==0?et===0&&(et=3):Dc())),n.updateQueue!==null&&(n.flags|=4),pt(n),null);case 4:return _s(),Nc(t,n),t===null&&ki(n.stateNode.containerInfo),pt(n),null;case 10:return Xl(n.type._context),pt(n),null;case 17:return St(n.type)&&Fa(),pt(n),null;case 19:if(De(Fe),p=n.memoizedState,p===null)return pt(n),null;if(u=(n.flags&128)!==0,v=p.rendering,v===null)if(u)Di(p,!1);else{if(et!==0||t!==null&&(t.flags&128)!==0)for(t=n.child;t!==null;){if(v=Ya(t),v!==null){for(n.flags|=128,Di(p,!1),u=v.updateQueue,u!==null&&(n.updateQueue=u,n.flags|=4),n.subtreeFlags=0,u=o,o=n.child;o!==null;)p=o,t=u,p.flags&=14680066,v=p.alternate,v===null?(p.childLanes=0,p.lanes=t,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=v.childLanes,p.lanes=v.lanes,p.child=v.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=v.memoizedProps,p.memoizedState=v.memoizedState,p.updateQueue=v.updateQueue,p.type=v.type,t=v.dependencies,p.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),o=o.sibling;return Le(Fe,Fe.current&1|2),n.child}t=t.sibling}p.tail!==null&&Ke()>Es&&(n.flags|=128,u=!0,Di(p,!1),n.lanes=4194304)}else{if(!u)if(t=Ya(v),t!==null){if(n.flags|=128,u=!0,o=t.updateQueue,o!==null&&(n.updateQueue=o,n.flags|=4),Di(p,!0),p.tail===null&&p.tailMode==="hidden"&&!v.alternate&&!$e)return pt(n),null}else 2*Ke()-p.renderingStartTime>Es&&o!==1073741824&&(n.flags|=128,u=!0,Di(p,!1),n.lanes=4194304);p.isBackwards?(v.sibling=n.child,n.child=v):(o=p.last,o!==null?o.sibling=v:n.child=v,p.last=v)}return p.tail!==null?(n=p.tail,p.rendering=n,p.tail=n.sibling,p.renderingStartTime=Ke(),n.sibling=null,o=Fe.current,Le(Fe,u?o&1|2:o&1),n):(pt(n),null);case 22:case 23:return Uc(),u=n.memoizedState!==null,t!==null&&t.memoizedState!==null!==u&&(n.flags|=8192),u&&(n.mode&1)!==0?(Mt&1073741824)!==0&&(pt(n),n.subtreeFlags&6&&(n.flags|=8192)):pt(n),null;case 24:return null;case 25:return null}throw Error(r(156,n.tag))}function sv(t,n){switch(Hl(n),n.tag){case 1:return St(n.type)&&Fa(),t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 3:return _s(),De(Nt),De(ft),ic(),t=n.flags,(t&65536)!==0&&(t&128)===0?(n.flags=t&-65537|128,n):null;case 5:return nc(n),null;case 13:if(De(Fe),t=n.memoizedState,t!==null&&t.dehydrated!==null){if(n.alternate===null)throw Error(r(340));vs()}return t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 19:return De(Fe),null;case 4:return _s(),null;case 10:return Xl(n.type._context),null;case 22:case 23:return Uc(),null;case 24:return null;default:return null}}var ao=!1,gt=!1,iv=typeof WeakSet=="function"?WeakSet:Set,ce=null;function Ss(t,n){var o=t.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(u){Ve(t,n,u)}else o.current=null}function Sc(t,n,o){try{o()}catch(u){Ve(t,n,u)}}var Mf=!1;function av(t,n){if(Ul=ka,t=fh(),Pl(t)){if("selectionStart"in t)var o={start:t.selectionStart,end:t.selectionEnd};else e:{o=(o=t.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var h=u.anchorOffset,p=u.focusNode;u=u.focusOffset;try{o.nodeType,p.nodeType}catch{o=null;break e}var v=0,S=-1,P=-1,$=0,H=0,Q=t,V=null;t:for(;;){for(var oe;Q!==o||h!==0&&Q.nodeType!==3||(S=v+h),Q!==p||u!==0&&Q.nodeType!==3||(P=v+u),Q.nodeType===3&&(v+=Q.nodeValue.length),(oe=Q.firstChild)!==null;)V=Q,Q=oe;for(;;){if(Q===t)break t;if(V===o&&++$===h&&(S=v),V===p&&++H===u&&(P=v),(oe=Q.nextSibling)!==null)break;Q=V,V=Q.parentNode}Q=oe}o=S===-1||P===-1?null:{start:S,end:P}}else o=null}o=o||{start:0,end:0}}else o=null;for(Dl={focusedElem:t,selectionRange:o},ka=!1,ce=n;ce!==null;)if(n=ce,t=n.child,(n.subtreeFlags&1028)!==0&&t!==null)t.return=n,ce=t;else for(;ce!==null;){n=ce;try{var de=n.alternate;if((n.flags&1024)!==0)switch(n.tag){case 0:case 11:case 15:break;case 1:if(de!==null){var he=de.memoizedProps,Qe=de.memoizedState,M=n.stateNode,R=M.getSnapshotBeforeUpdate(n.elementType===n.type?he:Zt(n.type,he),Qe);M.__reactInternalSnapshotBeforeUpdate=R}break;case 3:var U=n.stateNode.containerInfo;U.nodeType===1?U.textContent="":U.nodeType===9&&U.documentElement&&U.removeChild(U.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(X){Ve(n,n.return,X)}if(t=n.sibling,t!==null){t.return=n.return,ce=t;break}ce=n.return}return de=Mf,Mf=!1,de}function $i(t,n,o){var u=n.updateQueue;if(u=u!==null?u.lastEffect:null,u!==null){var h=u=u.next;do{if((h.tag&t)===t){var p=h.destroy;h.destroy=void 0,p!==void 0&&Sc(n,o,p)}h=h.next}while(h!==u)}}function oo(t,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var o=n=n.next;do{if((o.tag&t)===t){var u=o.create;o.destroy=u()}o=o.next}while(o!==n)}}function kc(t){var n=t.ref;if(n!==null){var o=t.stateNode;switch(t.tag){case 5:t=o;break;default:t=o}typeof n=="function"?n(t):n.current=t}}function Uf(t){var n=t.alternate;n!==null&&(t.alternate=null,Uf(n)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(n=t.stateNode,n!==null&&(delete n[dr],delete n[Ci],delete n[zl],delete n[zy],delete n[qy])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Df(t){return t.tag===5||t.tag===3||t.tag===4}function $f(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Df(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Ec(t,n,o){var u=t.tag;if(u===5||u===6)t=t.stateNode,n?o.nodeType===8?o.parentNode.insertBefore(t,n):o.insertBefore(t,n):(o.nodeType===8?(n=o.parentNode,n.insertBefore(t,o)):(n=o,n.appendChild(t)),o=o._reactRootContainer,o!=null||n.onclick!==null||(n.onclick=Da));else if(u!==4&&(t=t.child,t!==null))for(Ec(t,n,o),t=t.sibling;t!==null;)Ec(t,n,o),t=t.sibling}function Cc(t,n,o){var u=t.tag;if(u===5||u===6)t=t.stateNode,n?o.insertBefore(t,n):o.appendChild(t);else if(u!==4&&(t=t.child,t!==null))for(Cc(t,n,o),t=t.sibling;t!==null;)Cc(t,n,o),t=t.sibling}var ct=null,er=!1;function Yr(t,n,o){for(o=o.child;o!==null;)Ff(t,n,o),o=o.sibling}function Ff(t,n,o){if(ur&&typeof ur.onCommitFiberUnmount=="function")try{ur.onCommitFiberUnmount(ba,o)}catch{}switch(o.tag){case 5:gt||Ss(o,n);case 6:var u=ct,h=er;ct=null,Yr(t,n,o),ct=u,er=h,ct!==null&&(er?(t=ct,o=o.stateNode,t.nodeType===8?t.parentNode.removeChild(o):t.removeChild(o)):ct.removeChild(o.stateNode));break;case 18:ct!==null&&(er?(t=ct,o=o.stateNode,t.nodeType===8?Bl(t.parentNode,o):t.nodeType===1&&Bl(t,o),xi(t)):Bl(ct,o.stateNode));break;case 4:u=ct,h=er,ct=o.stateNode.containerInfo,er=!0,Yr(t,n,o),ct=u,er=h;break;case 0:case 11:case 14:case 15:if(!gt&&(u=o.updateQueue,u!==null&&(u=u.lastEffect,u!==null))){h=u=u.next;do{var p=h,v=p.destroy;p=p.tag,v!==void 0&&((p&2)!==0||(p&4)!==0)&&Sc(o,n,v),h=h.next}while(h!==u)}Yr(t,n,o);break;case 1:if(!gt&&(Ss(o,n),u=o.stateNode,typeof u.componentWillUnmount=="function"))try{u.props=o.memoizedProps,u.state=o.memoizedState,u.componentWillUnmount()}catch(S){Ve(o,n,S)}Yr(t,n,o);break;case 21:Yr(t,n,o);break;case 22:o.mode&1?(gt=(u=gt)||o.memoizedState!==null,Yr(t,n,o),gt=u):Yr(t,n,o);break;default:Yr(t,n,o)}}function Bf(t){var n=t.updateQueue;if(n!==null){t.updateQueue=null;var o=t.stateNode;o===null&&(o=t.stateNode=new iv),n.forEach(function(u){var h=pv.bind(null,t,u);o.has(u)||(o.add(u),u.then(h,h))})}}function tr(t,n){var o=n.deletions;if(o!==null)for(var u=0;u<o.length;u++){var h=o[u];try{var p=t,v=n,S=v;e:for(;S!==null;){switch(S.tag){case 5:ct=S.stateNode,er=!1;break e;case 3:ct=S.stateNode.containerInfo,er=!0;break e;case 4:ct=S.stateNode.containerInfo,er=!0;break e}S=S.return}if(ct===null)throw Error(r(160));Ff(p,v,h),ct=null,er=!1;var P=h.alternate;P!==null&&(P.return=null),h.return=null}catch($){Ve(h,n,$)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)zf(n,t),n=n.sibling}function zf(t,n){var o=t.alternate,u=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(tr(n,t),mr(t),u&4){try{$i(3,t,t.return),oo(3,t)}catch(he){Ve(t,t.return,he)}try{$i(5,t,t.return)}catch(he){Ve(t,t.return,he)}}break;case 1:tr(n,t),mr(t),u&512&&o!==null&&Ss(o,o.return);break;case 5:if(tr(n,t),mr(t),u&512&&o!==null&&Ss(o,o.return),t.flags&32){var h=t.stateNode;try{ai(h,"")}catch(he){Ve(t,t.return,he)}}if(u&4&&(h=t.stateNode,h!=null)){var p=t.memoizedProps,v=o!==null?o.memoizedProps:p,S=t.type,P=t.updateQueue;if(t.updateQueue=null,P!==null)try{S==="input"&&p.type==="radio"&&p.name!=null&&fa(h,p),il(S,v);var $=il(S,p);for(v=0;v<P.length;v+=2){var H=P[v],Q=P[v+1];H==="style"?_d(h,Q):H==="dangerouslySetInnerHTML"?wd(h,Q):H==="children"?ai(h,Q):T(h,H,Q,$)}switch(S){case"input":ni(h,p);break;case"textarea":yd(h,p);break;case"select":var V=h._wrapperState.wasMultiple;h._wrapperState.wasMultiple=!!p.multiple;var oe=p.value;oe!=null?Dr(h,!!p.multiple,oe,!1):V!==!!p.multiple&&(p.defaultValue!=null?Dr(h,!!p.multiple,p.defaultValue,!0):Dr(h,!!p.multiple,p.multiple?[]:"",!1))}h[Ci]=p}catch(he){Ve(t,t.return,he)}}break;case 6:if(tr(n,t),mr(t),u&4){if(t.stateNode===null)throw Error(r(162));h=t.stateNode,p=t.memoizedProps;try{h.nodeValue=p}catch(he){Ve(t,t.return,he)}}break;case 3:if(tr(n,t),mr(t),u&4&&o!==null&&o.memoizedState.isDehydrated)try{xi(n.containerInfo)}catch(he){Ve(t,t.return,he)}break;case 4:tr(n,t),mr(t);break;case 13:tr(n,t),mr(t),h=t.child,h.flags&8192&&(p=h.memoizedState!==null,h.stateNode.isHidden=p,!p||h.alternate!==null&&h.alternate.memoizedState!==null||(Rc=Ke())),u&4&&Bf(t);break;case 22:if(H=o!==null&&o.memoizedState!==null,t.mode&1?(gt=($=gt)||H,tr(n,t),gt=$):tr(n,t),mr(t),u&8192){if($=t.memoizedState!==null,(t.stateNode.isHidden=$)&&!H&&(t.mode&1)!==0)for(ce=t,H=t.child;H!==null;){for(Q=ce=H;ce!==null;){switch(V=ce,oe=V.child,V.tag){case 0:case 11:case 14:case 15:$i(4,V,V.return);break;case 1:Ss(V,V.return);var de=V.stateNode;if(typeof de.componentWillUnmount=="function"){u=V,o=V.return;try{n=u,de.props=n.memoizedProps,de.state=n.memoizedState,de.componentWillUnmount()}catch(he){Ve(u,o,he)}}break;case 5:Ss(V,V.return);break;case 22:if(V.memoizedState!==null){Vf(Q);continue}}oe!==null?(oe.return=V,ce=oe):Vf(Q)}H=H.sibling}e:for(H=null,Q=t;;){if(Q.tag===5){if(H===null){H=Q;try{h=Q.stateNode,$?(p=h.style,typeof p.setProperty=="function"?p.setProperty("display","none","important"):p.display="none"):(S=Q.stateNode,P=Q.memoizedProps.style,v=P!=null&&P.hasOwnProperty("display")?P.display:null,S.style.display=jd("display",v))}catch(he){Ve(t,t.return,he)}}}else if(Q.tag===6){if(H===null)try{Q.stateNode.nodeValue=$?"":Q.memoizedProps}catch(he){Ve(t,t.return,he)}}else if((Q.tag!==22&&Q.tag!==23||Q.memoizedState===null||Q===t)&&Q.child!==null){Q.child.return=Q,Q=Q.child;continue}if(Q===t)break e;for(;Q.sibling===null;){if(Q.return===null||Q.return===t)break e;H===Q&&(H=null),Q=Q.return}H===Q&&(H=null),Q.sibling.return=Q.return,Q=Q.sibling}}break;case 19:tr(n,t),mr(t),u&4&&Bf(t);break;case 21:break;default:tr(n,t),mr(t)}}function mr(t){var n=t.flags;if(n&2){try{e:{for(var o=t.return;o!==null;){if(Df(o)){var u=o;break e}o=o.return}throw Error(r(160))}switch(u.tag){case 5:var h=u.stateNode;u.flags&32&&(ai(h,""),u.flags&=-33);var p=$f(t);Cc(t,p,h);break;case 3:case 4:var v=u.stateNode.containerInfo,S=$f(t);Ec(t,S,v);break;default:throw Error(r(161))}}catch(P){Ve(t,t.return,P)}t.flags&=-3}n&4096&&(t.flags&=-4097)}function ov(t,n,o){ce=t,qf(t)}function qf(t,n,o){for(var u=(t.mode&1)!==0;ce!==null;){var h=ce,p=h.child;if(h.tag===22&&u){var v=h.memoizedState!==null||ao;if(!v){var S=h.alternate,P=S!==null&&S.memoizedState!==null||gt;S=ao;var $=gt;if(ao=v,(gt=P)&&!$)for(ce=h;ce!==null;)v=ce,P=v.child,v.tag===22&&v.memoizedState!==null?Hf(h):P!==null?(P.return=v,ce=P):Hf(h);for(;p!==null;)ce=p,qf(p),p=p.sibling;ce=h,ao=S,gt=$}Wf(t)}else(h.subtreeFlags&8772)!==0&&p!==null?(p.return=h,ce=p):Wf(t)}}function Wf(t){for(;ce!==null;){var n=ce;if((n.flags&8772)!==0){var o=n.alternate;try{if((n.flags&8772)!==0)switch(n.tag){case 0:case 11:case 15:gt||oo(5,n);break;case 1:var u=n.stateNode;if(n.flags&4&&!gt)if(o===null)u.componentDidMount();else{var h=n.elementType===n.type?o.memoizedProps:Zt(n.type,o.memoizedProps);u.componentDidUpdate(h,o.memoizedState,u.__reactInternalSnapshotBeforeUpdate)}var p=n.updateQueue;p!==null&&Wh(n,p,u);break;case 3:var v=n.updateQueue;if(v!==null){if(o=null,n.child!==null)switch(n.child.tag){case 5:o=n.child.stateNode;break;case 1:o=n.child.stateNode}Wh(n,v,o)}break;case 5:var S=n.stateNode;if(o===null&&n.flags&4){o=S;var P=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":P.autoFocus&&o.focus();break;case"img":P.src&&(o.src=P.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var $=n.alternate;if($!==null){var H=$.memoizedState;if(H!==null){var Q=H.dehydrated;Q!==null&&xi(Q)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}gt||n.flags&512&&kc(n)}catch(V){Ve(n,n.return,V)}}if(n===t){ce=null;break}if(o=n.sibling,o!==null){o.return=n.return,ce=o;break}ce=n.return}}function Vf(t){for(;ce!==null;){var n=ce;if(n===t){ce=null;break}var o=n.sibling;if(o!==null){o.return=n.return,ce=o;break}ce=n.return}}function Hf(t){for(;ce!==null;){var n=ce;try{switch(n.tag){case 0:case 11:case 15:var o=n.return;try{oo(4,n)}catch(P){Ve(n,o,P)}break;case 1:var u=n.stateNode;if(typeof u.componentDidMount=="function"){var h=n.return;try{u.componentDidMount()}catch(P){Ve(n,h,P)}}var p=n.return;try{kc(n)}catch(P){Ve(n,p,P)}break;case 5:var v=n.return;try{kc(n)}catch(P){Ve(n,v,P)}}}catch(P){Ve(n,n.return,P)}if(n===t){ce=null;break}var S=n.sibling;if(S!==null){S.return=n.return,ce=S;break}ce=n.return}}var lv=Math.ceil,lo=I.ReactCurrentDispatcher,Pc=I.ReactCurrentOwner,Ht=I.ReactCurrentBatchConfig,Re=0,it=null,Je=null,ut=0,Mt=0,ks=Hr(0),et=0,Fi=null,On=0,co=0,Tc=0,Bi=null,Et=null,Rc=0,Es=1/0,Er=null,uo=!1,Oc=null,Xr=null,ho=!1,Zr=null,fo=0,zi=0,Ac=null,mo=-1,po=0;function vt(){return(Re&6)!==0?Ke():mo!==-1?mo:mo=Ke()}function en(t){return(t.mode&1)===0?1:(Re&2)!==0&&ut!==0?ut&-ut:Vy.transition!==null?(po===0&&(po=Dd()),po):(t=Ie,t!==0||(t=window.event,t=t===void 0?16:Kd(t.type)),t)}function rr(t,n,o,u){if(50<zi)throw zi=0,Ac=null,Error(r(185));hi(t,o,u),((Re&2)===0||t!==it)&&(t===it&&((Re&2)===0&&(co|=o),et===4&&tn(t,ut)),Ct(t,u),o===1&&Re===0&&(n.mode&1)===0&&(Es=Ke()+500,za&&Qr()))}function Ct(t,n){var o=t.callbackNode;Vx(t,n);var u=_a(t,t===it?ut:0);if(u===0)o!==null&&Ld(o),t.callbackNode=null,t.callbackPriority=0;else if(n=u&-u,t.callbackPriority!==n){if(o!=null&&Ld(o),n===1)t.tag===0?Wy(Qf.bind(null,t)):Oh(Qf.bind(null,t)),Fy(function(){(Re&6)===0&&Qr()}),o=null;else{switch($d(u)){case 1:o=hl;break;case 4:o=Md;break;case 16:o=va;break;case 536870912:o=Ud;break;default:o=va}o=rm(o,Kf.bind(null,t))}t.callbackPriority=n,t.callbackNode=o}}function Kf(t,n){if(mo=-1,po=0,(Re&6)!==0)throw Error(r(327));var o=t.callbackNode;if(Cs()&&t.callbackNode!==o)return null;var u=_a(t,t===it?ut:0);if(u===0)return null;if((u&30)!==0||(u&t.expiredLanes)!==0||n)n=go(t,u);else{n=u;var h=Re;Re|=2;var p=Jf();(it!==t||ut!==n)&&(Er=null,Es=Ke()+500,In(t,n));do try{dv();break}catch(S){Gf(t,S)}while(!0);Yl(),lo.current=p,Re=h,Je!==null?n=0:(it=null,ut=0,n=et)}if(n!==0){if(n===2&&(h=fl(t),h!==0&&(u=h,n=Ic(t,h))),n===1)throw o=Fi,In(t,0),tn(t,u),Ct(t,Ke()),o;if(n===6)tn(t,u);else{if(h=t.current.alternate,(u&30)===0&&!cv(h)&&(n=go(t,u),n===2&&(p=fl(t),p!==0&&(u=p,n=Ic(t,p))),n===1))throw o=Fi,In(t,0),tn(t,u),Ct(t,Ke()),o;switch(t.finishedWork=h,t.finishedLanes=u,n){case 0:case 1:throw Error(r(345));case 2:Ln(t,Et,Er);break;case 3:if(tn(t,u),(u&130023424)===u&&(n=Rc+500-Ke(),10<n)){if(_a(t,0)!==0)break;if(h=t.suspendedLanes,(h&u)!==u){vt(),t.pingedLanes|=t.suspendedLanes&h;break}t.timeoutHandle=Fl(Ln.bind(null,t,Et,Er),n);break}Ln(t,Et,Er);break;case 4:if(tn(t,u),(u&4194240)===u)break;for(n=t.eventTimes,h=-1;0<u;){var v=31-Jt(u);p=1<<v,v=n[v],v>h&&(h=v),u&=~p}if(u=h,u=Ke()-u,u=(120>u?120:480>u?480:1080>u?1080:1920>u?1920:3e3>u?3e3:4320>u?4320:1960*lv(u/1960))-u,10<u){t.timeoutHandle=Fl(Ln.bind(null,t,Et,Er),u);break}Ln(t,Et,Er);break;case 5:Ln(t,Et,Er);break;default:throw Error(r(329))}}}return Ct(t,Ke()),t.callbackNode===o?Kf.bind(null,t):null}function Ic(t,n){var o=Bi;return t.current.memoizedState.isDehydrated&&(In(t,n).flags|=256),t=go(t,n),t!==2&&(n=Et,Et=o,n!==null&&Lc(n)),t}function Lc(t){Et===null?Et=t:Et.push.apply(Et,t)}function cv(t){for(var n=t;;){if(n.flags&16384){var o=n.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var u=0;u<o.length;u++){var h=o[u],p=h.getSnapshot;h=h.value;try{if(!Yt(p(),h))return!1}catch{return!1}}}if(o=n.child,n.subtreeFlags&16384&&o!==null)o.return=n,n=o;else{if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function tn(t,n){for(n&=~Tc,n&=~co,t.suspendedLanes|=n,t.pingedLanes&=~n,t=t.expirationTimes;0<n;){var o=31-Jt(n),u=1<<o;t[o]=-1,n&=~u}}function Qf(t){if((Re&6)!==0)throw Error(r(327));Cs();var n=_a(t,0);if((n&1)===0)return Ct(t,Ke()),null;var o=go(t,n);if(t.tag!==0&&o===2){var u=fl(t);u!==0&&(n=u,o=Ic(t,u))}if(o===1)throw o=Fi,In(t,0),tn(t,n),Ct(t,Ke()),o;if(o===6)throw Error(r(345));return t.finishedWork=t.current.alternate,t.finishedLanes=n,Ln(t,Et,Er),Ct(t,Ke()),null}function Mc(t,n){var o=Re;Re|=1;try{return t(n)}finally{Re=o,Re===0&&(Es=Ke()+500,za&&Qr())}}function An(t){Zr!==null&&Zr.tag===0&&(Re&6)===0&&Cs();var n=Re;Re|=1;var o=Ht.transition,u=Ie;try{if(Ht.transition=null,Ie=1,t)return t()}finally{Ie=u,Ht.transition=o,Re=n,(Re&6)===0&&Qr()}}function Uc(){Mt=ks.current,De(ks)}function In(t,n){t.finishedWork=null,t.finishedLanes=0;var o=t.timeoutHandle;if(o!==-1&&(t.timeoutHandle=-1,$y(o)),Je!==null)for(o=Je.return;o!==null;){var u=o;switch(Hl(u),u.tag){case 1:u=u.type.childContextTypes,u!=null&&Fa();break;case 3:_s(),De(Nt),De(ft),ic();break;case 5:nc(u);break;case 4:_s();break;case 13:De(Fe);break;case 19:De(Fe);break;case 10:Xl(u.type._context);break;case 22:case 23:Uc()}o=o.return}if(it=t,Je=t=rn(t.current,null),ut=Mt=n,et=0,Fi=null,Tc=co=On=0,Et=Bi=null,Pn!==null){for(n=0;n<Pn.length;n++)if(o=Pn[n],u=o.interleaved,u!==null){o.interleaved=null;var h=u.next,p=o.pending;if(p!==null){var v=p.next;p.next=h,u.next=v}o.pending=u}Pn=null}return t}function Gf(t,n){do{var o=Je;try{if(Yl(),Xa.current=ro,Za){for(var u=Be.memoizedState;u!==null;){var h=u.queue;h!==null&&(h.pending=null),u=u.next}Za=!1}if(Rn=0,st=Ze=Be=null,Ii=!1,Li=0,Pc.current=null,o===null||o.return===null){et=1,Fi=n,Je=null;break}e:{var p=t,v=o.return,S=o,P=n;if(n=ut,S.flags|=32768,P!==null&&typeof P=="object"&&typeof P.then=="function"){var $=P,H=S,Q=H.tag;if((H.mode&1)===0&&(Q===0||Q===11||Q===15)){var V=H.alternate;V?(H.updateQueue=V.updateQueue,H.memoizedState=V.memoizedState,H.lanes=V.lanes):(H.updateQueue=null,H.memoizedState=null)}var oe=bf(v);if(oe!==null){oe.flags&=-257,wf(oe,v,S,p,n),oe.mode&1&&vf(p,$,n),n=oe,P=$;var de=n.updateQueue;if(de===null){var he=new Set;he.add(P),n.updateQueue=he}else de.add(P);break e}else{if((n&1)===0){vf(p,$,n),Dc();break e}P=Error(r(426))}}else if($e&&S.mode&1){var Qe=bf(v);if(Qe!==null){(Qe.flags&65536)===0&&(Qe.flags|=256),wf(Qe,v,S,p,n),Gl(Ns(P,S));break e}}p=P=Ns(P,S),et!==4&&(et=2),Bi===null?Bi=[p]:Bi.push(p),p=v;do{switch(p.tag){case 3:p.flags|=65536,n&=-n,p.lanes|=n;var M=xf(p,P,n);qh(p,M);break e;case 1:S=P;var R=p.type,U=p.stateNode;if((p.flags&128)===0&&(typeof R.getDerivedStateFromError=="function"||U!==null&&typeof U.componentDidCatch=="function"&&(Xr===null||!Xr.has(U)))){p.flags|=65536,n&=-n,p.lanes|=n;var X=yf(p,S,n);qh(p,X);break e}}p=p.return}while(p!==null)}Xf(o)}catch(fe){n=fe,Je===o&&o!==null&&(Je=o=o.return);continue}break}while(!0)}function Jf(){var t=lo.current;return lo.current=ro,t===null?ro:t}function Dc(){(et===0||et===3||et===2)&&(et=4),it===null||(On&268435455)===0&&(co&268435455)===0||tn(it,ut)}function go(t,n){var o=Re;Re|=2;var u=Jf();(it!==t||ut!==n)&&(Er=null,In(t,n));do try{uv();break}catch(h){Gf(t,h)}while(!0);if(Yl(),Re=o,lo.current=u,Je!==null)throw Error(r(261));return it=null,ut=0,et}function uv(){for(;Je!==null;)Yf(Je)}function dv(){for(;Je!==null&&!Mx();)Yf(Je)}function Yf(t){var n=tm(t.alternate,t,Mt);t.memoizedProps=t.pendingProps,n===null?Xf(t):Je=n,Pc.current=null}function Xf(t){var n=t;do{var o=n.alternate;if(t=n.return,(n.flags&32768)===0){if(o=nv(o,n,Mt),o!==null){Je=o;return}}else{if(o=sv(o,n),o!==null){o.flags&=32767,Je=o;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{et=6,Je=null;return}}if(n=n.sibling,n!==null){Je=n;return}Je=n=t}while(n!==null);et===0&&(et=5)}function Ln(t,n,o){var u=Ie,h=Ht.transition;try{Ht.transition=null,Ie=1,hv(t,n,o,u)}finally{Ht.transition=h,Ie=u}return null}function hv(t,n,o,u){do Cs();while(Zr!==null);if((Re&6)!==0)throw Error(r(327));o=t.finishedWork;var h=t.finishedLanes;if(o===null)return null;if(t.finishedWork=null,t.finishedLanes=0,o===t.current)throw Error(r(177));t.callbackNode=null,t.callbackPriority=0;var p=o.lanes|o.childLanes;if(Hx(t,p),t===it&&(Je=it=null,ut=0),(o.subtreeFlags&2064)===0&&(o.flags&2064)===0||ho||(ho=!0,rm(va,function(){return Cs(),null})),p=(o.flags&15990)!==0,(o.subtreeFlags&15990)!==0||p){p=Ht.transition,Ht.transition=null;var v=Ie;Ie=1;var S=Re;Re|=4,Pc.current=null,av(t,o),zf(o,t),Oy(Dl),ka=!!Ul,Dl=Ul=null,t.current=o,ov(o),Ux(),Re=S,Ie=v,Ht.transition=p}else t.current=o;if(ho&&(ho=!1,Zr=t,fo=h),p=t.pendingLanes,p===0&&(Xr=null),Fx(o.stateNode),Ct(t,Ke()),n!==null)for(u=t.onRecoverableError,o=0;o<n.length;o++)h=n[o],u(h.value,{componentStack:h.stack,digest:h.digest});if(uo)throw uo=!1,t=Oc,Oc=null,t;return(fo&1)!==0&&t.tag!==0&&Cs(),p=t.pendingLanes,(p&1)!==0?t===Ac?zi++:(zi=0,Ac=t):zi=0,Qr(),null}function Cs(){if(Zr!==null){var t=$d(fo),n=Ht.transition,o=Ie;try{if(Ht.transition=null,Ie=16>t?16:t,Zr===null)var u=!1;else{if(t=Zr,Zr=null,fo=0,(Re&6)!==0)throw Error(r(331));var h=Re;for(Re|=4,ce=t.current;ce!==null;){var p=ce,v=p.child;if((ce.flags&16)!==0){var S=p.deletions;if(S!==null){for(var P=0;P<S.length;P++){var $=S[P];for(ce=$;ce!==null;){var H=ce;switch(H.tag){case 0:case 11:case 15:$i(8,H,p)}var Q=H.child;if(Q!==null)Q.return=H,ce=Q;else for(;ce!==null;){H=ce;var V=H.sibling,oe=H.return;if(Uf(H),H===$){ce=null;break}if(V!==null){V.return=oe,ce=V;break}ce=oe}}}var de=p.alternate;if(de!==null){var he=de.child;if(he!==null){de.child=null;do{var Qe=he.sibling;he.sibling=null,he=Qe}while(he!==null)}}ce=p}}if((p.subtreeFlags&2064)!==0&&v!==null)v.return=p,ce=v;else e:for(;ce!==null;){if(p=ce,(p.flags&2048)!==0)switch(p.tag){case 0:case 11:case 15:$i(9,p,p.return)}var M=p.sibling;if(M!==null){M.return=p.return,ce=M;break e}ce=p.return}}var R=t.current;for(ce=R;ce!==null;){v=ce;var U=v.child;if((v.subtreeFlags&2064)!==0&&U!==null)U.return=v,ce=U;else e:for(v=R;ce!==null;){if(S=ce,(S.flags&2048)!==0)try{switch(S.tag){case 0:case 11:case 15:oo(9,S)}}catch(fe){Ve(S,S.return,fe)}if(S===v){ce=null;break e}var X=S.sibling;if(X!==null){X.return=S.return,ce=X;break e}ce=S.return}}if(Re=h,Qr(),ur&&typeof ur.onPostCommitFiberRoot=="function")try{ur.onPostCommitFiberRoot(ba,t)}catch{}u=!0}return u}finally{Ie=o,Ht.transition=n}}return!1}function Zf(t,n,o){n=Ns(o,n),n=xf(t,n,1),t=Jr(t,n,1),n=vt(),t!==null&&(hi(t,1,n),Ct(t,n))}function Ve(t,n,o){if(t.tag===3)Zf(t,t,o);else for(;n!==null;){if(n.tag===3){Zf(n,t,o);break}else if(n.tag===1){var u=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Xr===null||!Xr.has(u))){t=Ns(o,t),t=yf(n,t,1),n=Jr(n,t,1),t=vt(),n!==null&&(hi(n,1,t),Ct(n,t));break}}n=n.return}}function fv(t,n,o){var u=t.pingCache;u!==null&&u.delete(n),n=vt(),t.pingedLanes|=t.suspendedLanes&o,it===t&&(ut&o)===o&&(et===4||et===3&&(ut&130023424)===ut&&500>Ke()-Rc?In(t,0):Tc|=o),Ct(t,n)}function em(t,n){n===0&&((t.mode&1)===0?n=1:(n=ja,ja<<=1,(ja&130023424)===0&&(ja=4194304)));var o=vt();t=Nr(t,n),t!==null&&(hi(t,n,o),Ct(t,o))}function mv(t){var n=t.memoizedState,o=0;n!==null&&(o=n.retryLane),em(t,o)}function pv(t,n){var o=0;switch(t.tag){case 13:var u=t.stateNode,h=t.memoizedState;h!==null&&(o=h.retryLane);break;case 19:u=t.stateNode;break;default:throw Error(r(314))}u!==null&&u.delete(n),em(t,o)}var tm;tm=function(t,n,o){if(t!==null)if(t.memoizedProps!==n.pendingProps||Nt.current)kt=!0;else{if((t.lanes&o)===0&&(n.flags&128)===0)return kt=!1,rv(t,n,o);kt=(t.flags&131072)!==0}else kt=!1,$e&&(n.flags&1048576)!==0&&Ah(n,Wa,n.index);switch(n.lanes=0,n.tag){case 2:var u=n.type;io(t,n),t=n.pendingProps;var h=gs(n,ft.current);js(n,o),h=lc(null,n,u,t,h,o);var p=cc();return n.flags|=1,typeof h=="object"&&h!==null&&typeof h.render=="function"&&h.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,St(u)?(p=!0,Ba(n)):p=!1,n.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,tc(n),h.updater=no,n.stateNode=h,h._reactInternals=n,pc(n,u,t,o),n=vc(null,n,u,!0,p,o)):(n.tag=0,$e&&p&&Vl(n),yt(null,n,h,o),n=n.child),n;case 16:u=n.elementType;e:{switch(io(t,n),t=n.pendingProps,h=u._init,u=h(u._payload),n.type=u,h=n.tag=xv(u),t=Zt(u,t),h){case 0:n=yc(null,n,u,t,o);break e;case 1:n=Ef(null,n,u,t,o);break e;case 11:n=jf(null,n,u,t,o);break e;case 14:n=_f(null,n,u,Zt(u.type,t),o);break e}throw Error(r(306,u,""))}return n;case 0:return u=n.type,h=n.pendingProps,h=n.elementType===u?h:Zt(u,h),yc(t,n,u,h,o);case 1:return u=n.type,h=n.pendingProps,h=n.elementType===u?h:Zt(u,h),Ef(t,n,u,h,o);case 3:e:{if(Cf(n),t===null)throw Error(r(387));u=n.pendingProps,p=n.memoizedState,h=p.element,zh(t,n),Ja(n,u,null,o);var v=n.memoizedState;if(u=v.element,p.isDehydrated)if(p={element:u,isDehydrated:!1,cache:v.cache,pendingSuspenseBoundaries:v.pendingSuspenseBoundaries,transitions:v.transitions},n.updateQueue.baseState=p,n.memoizedState=p,n.flags&256){h=Ns(Error(r(423)),n),n=Pf(t,n,u,o,h);break e}else if(u!==h){h=Ns(Error(r(424)),n),n=Pf(t,n,u,o,h);break e}else for(Lt=Vr(n.stateNode.containerInfo.firstChild),It=n,$e=!0,Xt=null,o=Fh(n,null,u,o),n.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(vs(),u===h){n=kr(t,n,o);break e}yt(t,n,u,o)}n=n.child}return n;case 5:return Vh(n),t===null&&Ql(n),u=n.type,h=n.pendingProps,p=t!==null?t.memoizedProps:null,v=h.children,$l(u,h)?v=null:p!==null&&$l(u,p)&&(n.flags|=32),kf(t,n),yt(t,n,v,o),n.child;case 6:return t===null&&Ql(n),null;case 13:return Tf(t,n,o);case 4:return rc(n,n.stateNode.containerInfo),u=n.pendingProps,t===null?n.child=bs(n,null,u,o):yt(t,n,u,o),n.child;case 11:return u=n.type,h=n.pendingProps,h=n.elementType===u?h:Zt(u,h),jf(t,n,u,h,o);case 7:return yt(t,n,n.pendingProps,o),n.child;case 8:return yt(t,n,n.pendingProps.children,o),n.child;case 12:return yt(t,n,n.pendingProps.children,o),n.child;case 10:e:{if(u=n.type._context,h=n.pendingProps,p=n.memoizedProps,v=h.value,Le(Ka,u._currentValue),u._currentValue=v,p!==null)if(Yt(p.value,v)){if(p.children===h.children&&!Nt.current){n=kr(t,n,o);break e}}else for(p=n.child,p!==null&&(p.return=n);p!==null;){var S=p.dependencies;if(S!==null){v=p.child;for(var P=S.firstContext;P!==null;){if(P.context===u){if(p.tag===1){P=Sr(-1,o&-o),P.tag=2;var $=p.updateQueue;if($!==null){$=$.shared;var H=$.pending;H===null?P.next=P:(P.next=H.next,H.next=P),$.pending=P}}p.lanes|=o,P=p.alternate,P!==null&&(P.lanes|=o),Zl(p.return,o,n),S.lanes|=o;break}P=P.next}}else if(p.tag===10)v=p.type===n.type?null:p.child;else if(p.tag===18){if(v=p.return,v===null)throw Error(r(341));v.lanes|=o,S=v.alternate,S!==null&&(S.lanes|=o),Zl(v,o,n),v=p.sibling}else v=p.child;if(v!==null)v.return=p;else for(v=p;v!==null;){if(v===n){v=null;break}if(p=v.sibling,p!==null){p.return=v.return,v=p;break}v=v.return}p=v}yt(t,n,h.children,o),n=n.child}return n;case 9:return h=n.type,u=n.pendingProps.children,js(n,o),h=Wt(h),u=u(h),n.flags|=1,yt(t,n,u,o),n.child;case 14:return u=n.type,h=Zt(u,n.pendingProps),h=Zt(u.type,h),_f(t,n,u,h,o);case 15:return Nf(t,n,n.type,n.pendingProps,o);case 17:return u=n.type,h=n.pendingProps,h=n.elementType===u?h:Zt(u,h),io(t,n),n.tag=1,St(u)?(t=!0,Ba(n)):t=!1,js(n,o),pf(n,u,h),pc(n,u,h,o),vc(null,n,u,!0,t,o);case 19:return Of(t,n,o);case 22:return Sf(t,n,o)}throw Error(r(156,n.tag))};function rm(t,n){return Id(t,n)}function gv(t,n,o,u){this.tag=t,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Kt(t,n,o,u){return new gv(t,n,o,u)}function $c(t){return t=t.prototype,!(!t||!t.isReactComponent)}function xv(t){if(typeof t=="function")return $c(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ee)return 11;if(t===we)return 14}return 2}function rn(t,n){var o=t.alternate;return o===null?(o=Kt(t.tag,n,t.key,t.mode),o.elementType=t.elementType,o.type=t.type,o.stateNode=t.stateNode,o.alternate=t,t.alternate=o):(o.pendingProps=n,o.type=t.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=t.flags&14680064,o.childLanes=t.childLanes,o.lanes=t.lanes,o.child=t.child,o.memoizedProps=t.memoizedProps,o.memoizedState=t.memoizedState,o.updateQueue=t.updateQueue,n=t.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},o.sibling=t.sibling,o.index=t.index,o.ref=t.ref,o}function xo(t,n,o,u,h,p){var v=2;if(u=t,typeof t=="function")$c(t)&&(v=1);else if(typeof t=="string")v=5;else e:switch(t){case G:return Mn(o.children,h,p,n);case B:v=8,h|=8;break;case ae:return t=Kt(12,o,n,h|2),t.elementType=ae,t.lanes=p,t;case ue:return t=Kt(13,o,n,h),t.elementType=ue,t.lanes=p,t;case Se:return t=Kt(19,o,n,h),t.elementType=Se,t.lanes=p,t;case je:return yo(o,h,p,n);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Y:v=10;break e;case xe:v=9;break e;case ee:v=11;break e;case we:v=14;break e;case Ce:v=16,u=null;break e}throw Error(r(130,t==null?t:typeof t,""))}return n=Kt(v,o,n,h),n.elementType=t,n.type=u,n.lanes=p,n}function Mn(t,n,o,u){return t=Kt(7,t,u,n),t.lanes=o,t}function yo(t,n,o,u){return t=Kt(22,t,u,n),t.elementType=je,t.lanes=o,t.stateNode={isHidden:!1},t}function Fc(t,n,o){return t=Kt(6,t,null,n),t.lanes=o,t}function Bc(t,n,o){return n=Kt(4,t.children!==null?t.children:[],t.key,n),n.lanes=o,n.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},n}function yv(t,n,o,u,h){this.tag=n,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ml(0),this.expirationTimes=ml(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ml(0),this.identifierPrefix=u,this.onRecoverableError=h,this.mutableSourceEagerHydrationData=null}function zc(t,n,o,u,h,p,v,S,P){return t=new yv(t,n,o,S,P),n===1?(n=1,p===!0&&(n|=8)):n=0,p=Kt(3,null,null,n),t.current=p,p.stateNode=t,p.memoizedState={element:u,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},tc(p),t}function vv(t,n,o){var u=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:F,key:u==null?null:""+u,children:t,containerInfo:n,implementation:o}}function nm(t){if(!t)return Kr;t=t._reactInternals;e:{if(Nn(t)!==t||t.tag!==1)throw Error(r(170));var n=t;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(St(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(r(171))}if(t.tag===1){var o=t.type;if(St(o))return Th(t,o,n)}return n}function sm(t,n,o,u,h,p,v,S,P){return t=zc(o,u,!0,t,h,p,v,S,P),t.context=nm(null),o=t.current,u=vt(),h=en(o),p=Sr(u,h),p.callback=n??null,Jr(o,p,h),t.current.lanes=h,hi(t,h,u),Ct(t,u),t}function vo(t,n,o,u){var h=n.current,p=vt(),v=en(h);return o=nm(o),n.context===null?n.context=o:n.pendingContext=o,n=Sr(p,v),n.payload={element:t},u=u===void 0?null:u,u!==null&&(n.callback=u),t=Jr(h,n,v),t!==null&&(rr(t,h,v,p),Ga(t,h,v)),v}function bo(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function im(t,n){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var o=t.retryLane;t.retryLane=o!==0&&o<n?o:n}}function qc(t,n){im(t,n),(t=t.alternate)&&im(t,n)}function bv(){return null}var am=typeof reportError=="function"?reportError:function(t){console.error(t)};function Wc(t){this._internalRoot=t}wo.prototype.render=Wc.prototype.render=function(t){var n=this._internalRoot;if(n===null)throw Error(r(409));vo(t,n,null,null)},wo.prototype.unmount=Wc.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var n=t.containerInfo;An(function(){vo(null,t,null,null)}),n[br]=null}};function wo(t){this._internalRoot=t}wo.prototype.unstable_scheduleHydration=function(t){if(t){var n=zd();t={blockedOn:null,target:t,priority:n};for(var o=0;o<zr.length&&n!==0&&n<zr[o].priority;o++);zr.splice(o,0,t),o===0&&Vd(t)}};function Vc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function jo(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function om(){}function wv(t,n,o,u,h){if(h){if(typeof u=="function"){var p=u;u=function(){var $=bo(v);p.call($)}}var v=sm(n,u,t,0,null,!1,!1,"",om);return t._reactRootContainer=v,t[br]=v.current,ki(t.nodeType===8?t.parentNode:t),An(),v}for(;h=t.lastChild;)t.removeChild(h);if(typeof u=="function"){var S=u;u=function(){var $=bo(P);S.call($)}}var P=zc(t,0,!1,null,null,!1,!1,"",om);return t._reactRootContainer=P,t[br]=P.current,ki(t.nodeType===8?t.parentNode:t),An(function(){vo(n,P,o,u)}),P}function _o(t,n,o,u,h){var p=o._reactRootContainer;if(p){var v=p;if(typeof h=="function"){var S=h;h=function(){var P=bo(v);S.call(P)}}vo(n,v,t,h)}else v=wv(o,n,t,h,u);return bo(v)}Fd=function(t){switch(t.tag){case 3:var n=t.stateNode;if(n.current.memoizedState.isDehydrated){var o=di(n.pendingLanes);o!==0&&(pl(n,o|1),Ct(n,Ke()),(Re&6)===0&&(Es=Ke()+500,Qr()))}break;case 13:An(function(){var u=Nr(t,1);if(u!==null){var h=vt();rr(u,t,1,h)}}),qc(t,1)}},gl=function(t){if(t.tag===13){var n=Nr(t,134217728);if(n!==null){var o=vt();rr(n,t,134217728,o)}qc(t,134217728)}},Bd=function(t){if(t.tag===13){var n=en(t),o=Nr(t,n);if(o!==null){var u=vt();rr(o,t,n,u)}qc(t,n)}},zd=function(){return Ie},qd=function(t,n){var o=Ie;try{return Ie=t,n()}finally{Ie=o}},ll=function(t,n,o){switch(n){case"input":if(ni(t,o),n=o.name,o.type==="radio"&&n!=null){for(o=t;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<o.length;n++){var u=o[n];if(u!==t&&u.form===t.form){var h=$a(u);if(!h)throw Error(r(90));cr(u),ni(u,h)}}}break;case"textarea":yd(t,o);break;case"select":n=o.value,n!=null&&Dr(t,!!o.multiple,n,!1)}},Ed=Mc,Cd=An;var jv={usingClientEntryPoint:!1,Events:[Pi,ms,$a,Sd,kd,Mc]},qi={findFiberByHostInstance:Sn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_v={bundleType:qi.bundleType,version:qi.version,rendererPackageName:qi.rendererPackageName,rendererConfig:qi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:I.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Od(t),t===null?null:t.stateNode},findFiberByHostInstance:qi.findFiberByHostInstance||bv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var No=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!No.isDisabled&&No.supportsFiber)try{ba=No.inject(_v),ur=No}catch{}}return Pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jv,Pt.createPortal=function(t,n){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vc(n))throw Error(r(200));return vv(t,n,null,o)},Pt.createRoot=function(t,n){if(!Vc(t))throw Error(r(299));var o=!1,u="",h=am;return n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(u=n.identifierPrefix),n.onRecoverableError!==void 0&&(h=n.onRecoverableError)),n=zc(t,1,!1,null,null,o,!1,u,h),t[br]=n.current,ki(t.nodeType===8?t.parentNode:t),new Wc(n)},Pt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var n=t._reactInternals;if(n===void 0)throw typeof t.render=="function"?Error(r(188)):(t=Object.keys(t).join(","),Error(r(268,t)));return t=Od(n),t=t===null?null:t.stateNode,t},Pt.flushSync=function(t){return An(t)},Pt.hydrate=function(t,n,o){if(!jo(n))throw Error(r(200));return _o(null,t,n,!0,o)},Pt.hydrateRoot=function(t,n,o){if(!Vc(t))throw Error(r(405));var u=o!=null&&o.hydratedSources||null,h=!1,p="",v=am;if(o!=null&&(o.unstable_strictMode===!0&&(h=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onRecoverableError!==void 0&&(v=o.onRecoverableError)),n=sm(n,null,t,1,o??null,h,!1,p,v),t[br]=n.current,ki(t),u)for(t=0;t<u.length;t++)o=u[t],h=o._getVersion,h=h(o._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[o,h]:n.mutableSourceEagerHydrationData.push(o,h);return new wo(n)},Pt.render=function(t,n,o){if(!jo(n))throw Error(r(200));return _o(null,t,n,!1,o)},Pt.unmountComponentAtNode=function(t){if(!jo(t))throw Error(r(40));return t._reactRootContainer?(An(function(){_o(null,null,t,!1,function(){t._reactRootContainer=null,t[br]=null})}),!0):!1},Pt.unstable_batchedUpdates=Mc,Pt.unstable_renderSubtreeIntoContainer=function(t,n,o,u){if(!jo(o))throw Error(r(200));if(t==null||t._reactInternals===void 0)throw Error(r(38));return _o(t,n,o,!1,u)},Pt.version="18.3.1-next-f1338f8080-20240426",Pt}var gm;function Wp(){if(gm)return Gc.exports;gm=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Gc.exports=Ov(),Gc.exports}var xm;function Av(){if(xm)return ko;xm=1;var s=Wp();return ko.createRoot=s.createRoot,ko.hydrateRoot=s.hydrateRoot,ko}var Iv=Av();const Lv=Qu(Iv);Wp();/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Xi(){return Xi=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i])}return s},Xi.apply(this,arguments)}var xn;(function(s){s.Pop="POP",s.Push="PUSH",s.Replace="REPLACE"})(xn||(xn={}));const ym="popstate";function Mv(s){s===void 0&&(s={});function e(i,l){let{pathname:c,search:d,hash:f}=i.location;return hu("",{pathname:c,search:d,hash:f},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function r(i,l){return typeof l=="string"?l:Fo(l)}return Dv(e,r,null,s)}function qe(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Ju(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Uv(){return Math.random().toString(36).substr(2,8)}function vm(s,e){return{usr:s.state,key:s.key,idx:e}}function hu(s,e,r,i){return r===void 0&&(r=null),Xi({pathname:typeof s=="string"?s:s.pathname,search:"",hash:""},typeof e=="string"?Ys(e):e,{state:r,key:e&&e.key||i||Uv()})}function Fo(s){let{pathname:e="/",search:r="",hash:i=""}=s;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function Ys(s){let e={};if(s){let r=s.indexOf("#");r>=0&&(e.hash=s.substr(r),s=s.substr(0,r));let i=s.indexOf("?");i>=0&&(e.search=s.substr(i),s=s.substr(0,i)),s&&(e.pathname=s)}return e}function Dv(s,e,r,i){i===void 0&&(i={});let{window:l=document.defaultView,v5Compat:c=!1}=i,d=l.history,f=xn.Pop,m=null,g=y();g==null&&(g=0,d.replaceState(Xi({},d.state,{idx:g}),""));function y(){return(d.state||{idx:null}).idx}function x(){f=xn.Pop;let b=y(),L=b==null?null:b-g;g=b,m&&m({action:f,location:_.location,delta:L})}function j(b,L){f=xn.Push;let C=hu(_.location,b,L);g=y()+1;let T=vm(C,g),I=_.createHref(C);try{d.pushState(T,"",I)}catch(q){if(q instanceof DOMException&&q.name==="DataCloneError")throw q;l.location.assign(I)}c&&m&&m({action:f,location:_.location,delta:1})}function w(b,L){f=xn.Replace;let C=hu(_.location,b,L);g=y();let T=vm(C,g),I=_.createHref(C);d.replaceState(T,"",I),c&&m&&m({action:f,location:_.location,delta:0})}function N(b){let L=l.location.origin!=="null"?l.location.origin:l.location.href,C=typeof b=="string"?b:Fo(b);return C=C.replace(/ $/,"%20"),qe(L,"No window.location.(origin|href) available to create URL for href: "+C),new URL(C,L)}let _={get action(){return f},get location(){return s(l,d)},listen(b){if(m)throw new Error("A history only accepts one active listener");return l.addEventListener(ym,x),m=b,()=>{l.removeEventListener(ym,x),m=null}},createHref(b){return e(l,b)},createURL:N,encodeLocation(b){let L=N(b);return{pathname:L.pathname,search:L.search,hash:L.hash}},push:j,replace:w,go(b){return d.go(b)}};return _}var bm;(function(s){s.data="data",s.deferred="deferred",s.redirect="redirect",s.error="error"})(bm||(bm={}));function $v(s,e,r){return r===void 0&&(r="/"),Fv(s,e,r)}function Fv(s,e,r,i){let l=typeof e=="string"?Ys(e):e,c=Gs(l.pathname||"/",r);if(c==null)return null;let d=Vp(s);Bv(d);let f=null;for(let m=0;f==null&&m<d.length;++m){let g=Xv(c);f=Jv(d[m],g)}return f}function Vp(s,e,r,i){e===void 0&&(e=[]),r===void 0&&(r=[]),i===void 0&&(i="");let l=(c,d,f)=>{let m={relativePath:f===void 0?c.path||"":f,caseSensitive:c.caseSensitive===!0,childrenIndex:d,route:c};m.relativePath.startsWith("/")&&(qe(m.relativePath.startsWith(i),'Absolute route path "'+m.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),m.relativePath=m.relativePath.slice(i.length));let g=yn([i,m.relativePath]),y=r.concat(m);c.children&&c.children.length>0&&(qe(c.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+g+'".')),Vp(c.children,e,y,g)),!(c.path==null&&!c.index)&&e.push({path:g,score:Qv(g,c.index),routesMeta:y})};return s.forEach((c,d)=>{var f;if(c.path===""||!((f=c.path)!=null&&f.includes("?")))l(c,d);else for(let m of Hp(c.path))l(c,d,m)}),e}function Hp(s){let e=s.split("/");if(e.length===0)return[];let[r,...i]=e,l=r.endsWith("?"),c=r.replace(/\?$/,"");if(i.length===0)return l?[c,""]:[c];let d=Hp(i.join("/")),f=[];return f.push(...d.map(m=>m===""?c:[c,m].join("/"))),l&&f.push(...d),f.map(m=>s.startsWith("/")&&m===""?"/":m)}function Bv(s){s.sort((e,r)=>e.score!==r.score?r.score-e.score:Gv(e.routesMeta.map(i=>i.childrenIndex),r.routesMeta.map(i=>i.childrenIndex)))}const zv=/^:[\w-]+$/,qv=3,Wv=2,Vv=1,Hv=10,Kv=-2,wm=s=>s==="*";function Qv(s,e){let r=s.split("/"),i=r.length;return r.some(wm)&&(i+=Kv),e&&(i+=Wv),r.filter(l=>!wm(l)).reduce((l,c)=>l+(zv.test(c)?qv:c===""?Vv:Hv),i)}function Gv(s,e){return s.length===e.length&&s.slice(0,-1).every((i,l)=>i===e[l])?s[s.length-1]-e[e.length-1]:0}function Jv(s,e,r){let{routesMeta:i}=s,l={},c="/",d=[];for(let f=0;f<i.length;++f){let m=i[f],g=f===i.length-1,y=c==="/"?e:e.slice(c.length)||"/",x=fu({path:m.relativePath,caseSensitive:m.caseSensitive,end:g},y),j=m.route;if(!x)return null;Object.assign(l,x.params),d.push({params:l,pathname:yn([c,x.pathname]),pathnameBase:n0(yn([c,x.pathnameBase])),route:j}),x.pathnameBase!=="/"&&(c=yn([c,x.pathnameBase]))}return d}function fu(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[r,i]=Yv(s.path,s.caseSensitive,s.end),l=e.match(r);if(!l)return null;let c=l[0],d=c.replace(/(.)\/+$/,"$1"),f=l.slice(1);return{params:i.reduce((g,y,x)=>{let{paramName:j,isOptional:w}=y;if(j==="*"){let _=f[x]||"";d=c.slice(0,c.length-_.length).replace(/(.)\/+$/,"$1")}const N=f[x];return w&&!N?g[j]=void 0:g[j]=(N||"").replace(/%2F/g,"/"),g},{}),pathname:c,pathnameBase:d,pattern:s}}function Yv(s,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),Ju(s==="*"||!s.endsWith("*")||s.endsWith("/*"),'Route path "'+s+'" will be treated as if it were '+('"'+s.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+s.replace(/\*$/,"/*")+'".'));let i=[],l="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,f,m)=>(i.push({paramName:f,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return s.endsWith("*")?(i.push({paramName:"*"}),l+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?l+="\\/*$":s!==""&&s!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function Xv(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ju(!1,'The URL path "'+s+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),s}}function Gs(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,i=s.charAt(r);return i&&i!=="/"?null:s.slice(r)||"/"}const Zv=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,e0=s=>Zv.test(s);function t0(s,e){e===void 0&&(e="/");let{pathname:r,search:i="",hash:l=""}=typeof s=="string"?Ys(s):s,c;if(r)if(e0(r))c=r;else{if(r.includes("//")){let d=r;r=r.replace(/\/\/+/g,"/"),Ju(!1,"Pathnames cannot have embedded double slashes - normalizing "+(d+" -> "+r))}r.startsWith("/")?c=jm(r.substring(1),"/"):c=jm(r,e)}else c=e;return{pathname:c,search:s0(i),hash:i0(l)}}function jm(s,e){let r=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(l=>{l===".."?r.length>1&&r.pop():l!=="."&&r.push(l)}),r.length>1?r.join("/"):"/"}function Xc(s,e,r,i){return"Cannot include a '"+s+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function r0(s){return s.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function Yu(s,e){let r=r0(s);return e?r.map((i,l)=>l===r.length-1?i.pathname:i.pathnameBase):r.map(i=>i.pathnameBase)}function Xu(s,e,r,i){i===void 0&&(i=!1);let l;typeof s=="string"?l=Ys(s):(l=Xi({},s),qe(!l.pathname||!l.pathname.includes("?"),Xc("?","pathname","search",l)),qe(!l.pathname||!l.pathname.includes("#"),Xc("#","pathname","hash",l)),qe(!l.search||!l.search.includes("#"),Xc("#","search","hash",l)));let c=s===""||l.pathname==="",d=c?"/":l.pathname,f;if(d==null)f=r;else{let x=e.length-1;if(!i&&d.startsWith("..")){let j=d.split("/");for(;j[0]==="..";)j.shift(),x-=1;l.pathname=j.join("/")}f=x>=0?e[x]:"/"}let m=t0(l,f),g=d&&d!=="/"&&d.endsWith("/"),y=(c||d===".")&&r.endsWith("/");return!m.pathname.endsWith("/")&&(g||y)&&(m.pathname+="/"),m}const yn=s=>s.join("/").replace(/\/\/+/g,"/"),n0=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),s0=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,i0=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function a0(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}const Kp=["post","put","patch","delete"];new Set(Kp);const o0=["get",...Kp];new Set(o0);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Zi(){return Zi=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i])}return s},Zi.apply(this,arguments)}const Yo=E.createContext(null),Qp=E.createContext(null),Lr=E.createContext(null),Xo=E.createContext(null),vr=E.createContext({outlet:null,matches:[],isDataRoute:!1}),Gp=E.createContext(null);function l0(s,e){let{relative:r}=e===void 0?{}:e;Xs()||qe(!1);let{basename:i,navigator:l}=E.useContext(Lr),{hash:c,pathname:d,search:f}=Zo(s,{relative:r}),m=d;return i!=="/"&&(m=d==="/"?i:yn([i,d])),l.createHref({pathname:m,search:f,hash:c})}function Xs(){return E.useContext(Xo)!=null}function lr(){return Xs()||qe(!1),E.useContext(Xo).location}function Jp(s){E.useContext(Lr).static||E.useLayoutEffect(s)}function Bt(){let{isDataRoute:s}=E.useContext(vr);return s?_0():c0()}function c0(){Xs()||qe(!1);let s=E.useContext(Yo),{basename:e,future:r,navigator:i}=E.useContext(Lr),{matches:l}=E.useContext(vr),{pathname:c}=lr(),d=JSON.stringify(Yu(l,r.v7_relativeSplatPath)),f=E.useRef(!1);return Jp(()=>{f.current=!0}),E.useCallback(function(g,y){if(y===void 0&&(y={}),!f.current)return;if(typeof g=="number"){i.go(g);return}let x=Xu(g,JSON.parse(d),c,y.relative==="path");s==null&&e!=="/"&&(x.pathname=x.pathname==="/"?e:yn([e,x.pathname])),(y.replace?i.replace:i.push)(x,y.state,y)},[e,i,d,c,s])}const u0=E.createContext(null);function d0(s){let e=E.useContext(vr).outlet;return e&&E.createElement(u0.Provider,{value:s},e)}function Zu(){let{matches:s}=E.useContext(vr),e=s[s.length-1];return e?e.params:{}}function Zo(s,e){let{relative:r}=e===void 0?{}:e,{future:i}=E.useContext(Lr),{matches:l}=E.useContext(vr),{pathname:c}=lr(),d=JSON.stringify(Yu(l,i.v7_relativeSplatPath));return E.useMemo(()=>Xu(s,JSON.parse(d),c,r==="path"),[s,d,c,r])}function h0(s,e){return f0(s,e)}function f0(s,e,r,i){Xs()||qe(!1);let{navigator:l}=E.useContext(Lr),{matches:c}=E.useContext(vr),d=c[c.length-1],f=d?d.params:{};d&&d.pathname;let m=d?d.pathnameBase:"/";d&&d.route;let g=lr(),y;if(e){var x;let b=typeof e=="string"?Ys(e):e;m==="/"||(x=b.pathname)!=null&&x.startsWith(m)||qe(!1),y=b}else y=g;let j=y.pathname||"/",w=j;if(m!=="/"){let b=m.replace(/^\//,"").split("/");w="/"+j.replace(/^\//,"").split("/").slice(b.length).join("/")}let N=$v(s,{pathname:w}),_=y0(N&&N.map(b=>Object.assign({},b,{params:Object.assign({},f,b.params),pathname:yn([m,l.encodeLocation?l.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?m:yn([m,l.encodeLocation?l.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),c,r,i);return e&&_?E.createElement(Xo.Provider,{value:{location:Zi({pathname:"/",search:"",hash:"",state:null,key:"default"},y),navigationType:xn.Pop}},_):_}function m0(){let s=j0(),e=a0(s)?s.status+" "+s.statusText:s instanceof Error?s.message:JSON.stringify(s),r=s instanceof Error?s.stack:null,l={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},e),r?E.createElement("pre",{style:l},r):null,null)}const p0=E.createElement(m0,null);class g0 extends E.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?E.createElement(vr.Provider,{value:this.props.routeContext},E.createElement(Gp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function x0(s){let{routeContext:e,match:r,children:i}=s,l=E.useContext(Yo);return l&&l.static&&l.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(l.staticContext._deepestRenderedBoundaryId=r.route.id),E.createElement(vr.Provider,{value:e},i)}function y0(s,e,r,i){var l;if(e===void 0&&(e=[]),r===void 0&&(r=null),i===void 0&&(i=null),s==null){var c;if(!r)return null;if(r.errors)s=r.matches;else if((c=i)!=null&&c.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)s=r.matches;else return null}let d=s,f=(l=r)==null?void 0:l.errors;if(f!=null){let y=d.findIndex(x=>x.route.id&&(f==null?void 0:f[x.route.id])!==void 0);y>=0||qe(!1),d=d.slice(0,Math.min(d.length,y+1))}let m=!1,g=-1;if(r&&i&&i.v7_partialHydration)for(let y=0;y<d.length;y++){let x=d[y];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(g=y),x.route.id){let{loaderData:j,errors:w}=r,N=x.route.loader&&j[x.route.id]===void 0&&(!w||w[x.route.id]===void 0);if(x.route.lazy||N){m=!0,g>=0?d=d.slice(0,g+1):d=[d[0]];break}}}return d.reduceRight((y,x,j)=>{let w,N=!1,_=null,b=null;r&&(w=f&&x.route.id?f[x.route.id]:void 0,_=x.route.errorElement||p0,m&&(g<0&&j===0?(N0("route-fallback"),N=!0,b=null):g===j&&(N=!0,b=x.route.hydrateFallbackElement||null)));let L=e.concat(d.slice(0,j+1)),C=()=>{let T;return w?T=_:N?T=b:x.route.Component?T=E.createElement(x.route.Component,null):x.route.element?T=x.route.element:T=y,E.createElement(x0,{match:x,routeContext:{outlet:y,matches:L,isDataRoute:r!=null},children:T})};return r&&(x.route.ErrorBoundary||x.route.errorElement||j===0)?E.createElement(g0,{location:r.location,revalidation:r.revalidation,component:_,error:w,children:C(),routeContext:{outlet:null,matches:L,isDataRoute:!0}}):C()},null)}var Yp=(function(s){return s.UseBlocker="useBlocker",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s})(Yp||{}),Xp=(function(s){return s.UseBlocker="useBlocker",s.UseLoaderData="useLoaderData",s.UseActionData="useActionData",s.UseRouteError="useRouteError",s.UseNavigation="useNavigation",s.UseRouteLoaderData="useRouteLoaderData",s.UseMatches="useMatches",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s.UseRouteId="useRouteId",s})(Xp||{});function v0(s){let e=E.useContext(Yo);return e||qe(!1),e}function b0(s){let e=E.useContext(Qp);return e||qe(!1),e}function w0(s){let e=E.useContext(vr);return e||qe(!1),e}function Zp(s){let e=w0(),r=e.matches[e.matches.length-1];return r.route.id||qe(!1),r.route.id}function j0(){var s;let e=E.useContext(Gp),r=b0(),i=Zp();return e!==void 0?e:(s=r.errors)==null?void 0:s[i]}function _0(){let{router:s}=v0(Yp.UseNavigateStable),e=Zp(Xp.UseNavigateStable),r=E.useRef(!1);return Jp(()=>{r.current=!0}),E.useCallback(function(l,c){c===void 0&&(c={}),r.current&&(typeof l=="number"?s.navigate(l):s.navigate(l,Zi({fromRouteId:e},c)))},[s,e])}const _m={};function N0(s,e,r){_m[s]||(_m[s]=!0)}function S0(s,e){s==null||s.v7_startTransition,s==null||s.v7_relativeSplatPath}function k0(s){let{to:e,replace:r,state:i,relative:l}=s;Xs()||qe(!1);let{future:c,static:d}=E.useContext(Lr),{matches:f}=E.useContext(vr),{pathname:m}=lr(),g=Bt(),y=Xu(e,Yu(f,c.v7_relativeSplatPath),m,l==="path"),x=JSON.stringify(y);return E.useEffect(()=>g(JSON.parse(x),{replace:r,state:i,relative:l}),[g,x,l,r,i]),null}function eg(s){return d0(s.context)}function Ge(s){qe(!1)}function E0(s){let{basename:e="/",children:r=null,location:i,navigationType:l=xn.Pop,navigator:c,static:d=!1,future:f}=s;Xs()&&qe(!1);let m=e.replace(/^\/*/,"/"),g=E.useMemo(()=>({basename:m,navigator:c,static:d,future:Zi({v7_relativeSplatPath:!1},f)}),[m,f,c,d]);typeof i=="string"&&(i=Ys(i));let{pathname:y="/",search:x="",hash:j="",state:w=null,key:N="default"}=i,_=E.useMemo(()=>{let b=Gs(y,m);return b==null?null:{location:{pathname:b,search:x,hash:j,state:w,key:N},navigationType:l}},[m,y,x,j,w,N,l]);return _==null?null:E.createElement(Lr.Provider,{value:g},E.createElement(Xo.Provider,{children:r,value:_}))}function C0(s){let{children:e,location:r}=s;return h0(mu(e),r)}new Promise(()=>{});function mu(s,e){e===void 0&&(e=[]);let r=[];return E.Children.forEach(s,(i,l)=>{if(!E.isValidElement(i))return;let c=[...e,l];if(i.type===E.Fragment){r.push.apply(r,mu(i.props.children,c));return}i.type!==Ge&&qe(!1),!i.props.index||!i.props.children||qe(!1);let d={id:i.props.id||c.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=mu(i.props.children,c)),r.push(d)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Bo(){return Bo=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i])}return s},Bo.apply(this,arguments)}function tg(s,e){if(s==null)return{};var r={},i=Object.keys(s),l,c;for(c=0;c<i.length;c++)l=i[c],!(e.indexOf(l)>=0)&&(r[l]=s[l]);return r}function P0(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function T0(s,e){return s.button===0&&(!e||e==="_self")&&!P0(s)}function pu(s){return s===void 0&&(s=""),new URLSearchParams(typeof s=="string"||Array.isArray(s)||s instanceof URLSearchParams?s:Object.keys(s).reduce((e,r)=>{let i=s[r];return e.concat(Array.isArray(i)?i.map(l=>[r,l]):[[r,i]])},[]))}function R0(s,e){let r=pu(s);return e&&e.forEach((i,l)=>{r.has(l)||e.getAll(l).forEach(c=>{r.append(l,c)})}),r}const O0=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],A0=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],I0="6";try{window.__reactRouterVersion=I0}catch{}const L0=E.createContext({isTransitioning:!1}),M0="startTransition",Nm=Pv[M0];function U0(s){let{basename:e,children:r,future:i,window:l}=s,c=E.useRef();c.current==null&&(c.current=Mv({window:l,v5Compat:!0}));let d=c.current,[f,m]=E.useState({action:d.action,location:d.location}),{v7_startTransition:g}=i||{},y=E.useCallback(x=>{g&&Nm?Nm(()=>m(x)):m(x)},[m,g]);return E.useLayoutEffect(()=>d.listen(y),[d,y]),E.useEffect(()=>S0(i),[i]),E.createElement(E0,{basename:e,children:r,location:f.location,navigationType:f.action,navigator:d,future:i})}const D0=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",$0=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,We=E.forwardRef(function(e,r){let{onClick:i,relative:l,reloadDocument:c,replace:d,state:f,target:m,to:g,preventScrollReset:y,viewTransition:x}=e,j=tg(e,O0),{basename:w}=E.useContext(Lr),N,_=!1;if(typeof g=="string"&&$0.test(g)&&(N=g,D0))try{let T=new URL(window.location.href),I=g.startsWith("//")?new URL(T.protocol+g):new URL(g),q=Gs(I.pathname,w);I.origin===T.origin&&q!=null?g=q+I.search+I.hash:_=!0}catch{}let b=l0(g,{relative:l}),L=z0(g,{replace:d,state:f,target:m,preventScrollReset:y,relative:l,viewTransition:x});function C(T){i&&i(T),T.defaultPrevented||L(T)}return E.createElement("a",Bo({},j,{href:N||b,onClick:_||c?i:C,ref:r,target:m}))}),F0=E.forwardRef(function(e,r){let{"aria-current":i="page",caseSensitive:l=!1,className:c="",end:d=!1,style:f,to:m,viewTransition:g,children:y}=e,x=tg(e,A0),j=Zo(m,{relative:x.relative}),w=lr(),N=E.useContext(Qp),{navigator:_,basename:b}=E.useContext(Lr),L=N!=null&&W0(j)&&g===!0,C=_.encodeLocation?_.encodeLocation(j).pathname:j.pathname,T=w.pathname,I=N&&N.navigation&&N.navigation.location?N.navigation.location.pathname:null;l||(T=T.toLowerCase(),I=I?I.toLowerCase():null,C=C.toLowerCase()),I&&b&&(I=Gs(I,b)||I);const q=C!=="/"&&C.endsWith("/")?C.length-1:C.length;let F=T===C||!d&&T.startsWith(C)&&T.charAt(q)==="/",G=I!=null&&(I===C||!d&&I.startsWith(C)&&I.charAt(C.length)==="/"),B={isActive:F,isPending:G,isTransitioning:L},ae=F?i:void 0,Y;typeof c=="function"?Y=c(B):Y=[c,F?"active":null,G?"pending":null,L?"transitioning":null].filter(Boolean).join(" ");let xe=typeof f=="function"?f(B):f;return E.createElement(We,Bo({},x,{"aria-current":ae,className:Y,ref:r,style:xe,to:m,viewTransition:g}),typeof y=="function"?y(B):y)});var gu;(function(s){s.UseScrollRestoration="useScrollRestoration",s.UseSubmit="useSubmit",s.UseSubmitFetcher="useSubmitFetcher",s.UseFetcher="useFetcher",s.useViewTransitionState="useViewTransitionState"})(gu||(gu={}));var Sm;(function(s){s.UseFetcher="useFetcher",s.UseFetchers="useFetchers",s.UseScrollRestoration="useScrollRestoration"})(Sm||(Sm={}));function B0(s){let e=E.useContext(Yo);return e||qe(!1),e}function z0(s,e){let{target:r,replace:i,state:l,preventScrollReset:c,relative:d,viewTransition:f}=e===void 0?{}:e,m=Bt(),g=lr(),y=Zo(s,{relative:d});return E.useCallback(x=>{if(T0(x,r)){x.preventDefault();let j=i!==void 0?i:Fo(g)===Fo(y);m(s,{replace:j,state:l,preventScrollReset:c,relative:d,viewTransition:f})}},[g,m,y,i,l,r,s,c,d,f])}function q0(s){let e=E.useRef(pu(s)),r=E.useRef(!1),i=lr(),l=E.useMemo(()=>R0(i.search,r.current?null:e.current),[i.search]),c=Bt(),d=E.useCallback((f,m)=>{const g=pu(typeof f=="function"?f(l):f);r.current=!0,c("?"+g,m)},[c,l]);return[l,d]}function W0(s,e){e===void 0&&(e={});let r=E.useContext(L0);r==null&&qe(!1);let{basename:i}=B0(gu.useViewTransitionState),l=Zo(s,{relative:e.relative});if(!r.isTransitioning)return!1;let c=Gs(r.currentLocation.pathname,i)||r.currentLocation.pathname,d=Gs(r.nextLocation.pathname,i)||r.nextLocation.pathname;return fu(l.pathname,d)!=null||fu(l.pathname,c)!=null}var Zs=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(s){return this.listeners.add(s),this.onSubscribe(),()=>{this.listeners.delete(s),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},V0={setTimeout:(s,e)=>setTimeout(s,e),clearTimeout:s=>clearTimeout(s),setInterval:(s,e)=>setInterval(s,e),clearInterval:s=>clearInterval(s)},ln,Ku,Op,H0=(Op=class{constructor(){ge(this,ln,V0);ge(this,Ku,!1)}setTimeoutProvider(s){ie(this,ln,s)}setTimeout(s,e){return k(this,ln).setTimeout(s,e)}clearTimeout(s){k(this,ln).clearTimeout(s)}setInterval(s,e){return k(this,ln).setInterval(s,e)}clearInterval(s){k(this,ln).clearInterval(s)}},ln=new WeakMap,Ku=new WeakMap,Op),qn=new H0;function K0(s){setTimeout(s,0)}var es=typeof window>"u"||"Deno"in globalThis;function jt(){}function Q0(s,e){return typeof s=="function"?s(e):s}function xu(s){return typeof s=="number"&&s>=0&&s!==1/0}function rg(s,e){return Math.max(s+(e||0)-Date.now(),0)}function vn(s,e){return typeof s=="function"?s(e):s}function Gt(s,e){return typeof s=="function"?s(e):s}function km(s,e){const{type:r="all",exact:i,fetchStatus:l,predicate:c,queryKey:d,stale:f}=s;if(d){if(i){if(e.queryHash!==ed(d,e.options))return!1}else if(!ea(e.queryKey,d))return!1}if(r!=="all"){const m=e.isActive();if(r==="active"&&!m||r==="inactive"&&m)return!1}return!(typeof f=="boolean"&&e.isStale()!==f||l&&l!==e.state.fetchStatus||c&&!c(e))}function Em(s,e){const{exact:r,status:i,predicate:l,mutationKey:c}=s;if(c){if(!e.options.mutationKey)return!1;if(r){if(ts(e.options.mutationKey)!==ts(c))return!1}else if(!ea(e.options.mutationKey,c))return!1}return!(i&&e.state.status!==i||l&&!l(e))}function ed(s,e){return((e==null?void 0:e.queryKeyHashFn)||ts)(s)}function ts(s){return JSON.stringify(s,(e,r)=>yu(r)?Object.keys(r).sort().reduce((i,l)=>(i[l]=r[l],i),{}):r)}function ea(s,e){return s===e?!0:typeof s!=typeof e?!1:s&&e&&typeof s=="object"&&typeof e=="object"?Object.keys(e).every(r=>ea(s[r],e[r])):!1}var G0=Object.prototype.hasOwnProperty;function ng(s,e){if(s===e)return s;const r=Cm(s)&&Cm(e);if(!r&&!(yu(s)&&yu(e)))return e;const l=(r?s:Object.keys(s)).length,c=r?e:Object.keys(e),d=c.length,f=r?new Array(d):{};let m=0;for(let g=0;g<d;g++){const y=r?g:c[g],x=s[y],j=e[y];if(x===j){f[y]=x,(r?g<l:G0.call(s,y))&&m++;continue}if(x===null||j===null||typeof x!="object"||typeof j!="object"){f[y]=j;continue}const w=ng(x,j);f[y]=w,w===x&&m++}return l===d&&m===l?s:f}function zo(s,e){if(!e||Object.keys(s).length!==Object.keys(e).length)return!1;for(const r in s)if(s[r]!==e[r])return!1;return!0}function Cm(s){return Array.isArray(s)&&s.length===Object.keys(s).length}function yu(s){if(!Pm(s))return!1;const e=s.constructor;if(e===void 0)return!0;const r=e.prototype;return!(!Pm(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(s)!==Object.prototype)}function Pm(s){return Object.prototype.toString.call(s)==="[object Object]"}function J0(s){return new Promise(e=>{qn.setTimeout(e,s)})}function vu(s,e,r){return typeof r.structuralSharing=="function"?r.structuralSharing(s,e):r.structuralSharing!==!1?ng(s,e):e}function Y0(s,e,r=0){const i=[...s,e];return r&&i.length>r?i.slice(1):i}function X0(s,e,r=0){const i=[e,...s];return r&&i.length>r?i.slice(0,-1):i}var td=Symbol();function sg(s,e){return!s.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!s.queryFn||s.queryFn===td?()=>Promise.reject(new Error(`Missing queryFn: '${s.queryHash}'`)):s.queryFn}function ig(s,e){return typeof s=="function"?s(...e):!!s}var Vn,cn,Us,Ap,Z0=(Ap=class extends Zs{constructor(){super();ge(this,Vn);ge(this,cn);ge(this,Us);ie(this,Us,e=>{if(!es&&window.addEventListener){const r=()=>e();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){k(this,cn)||this.setEventListener(k(this,Us))}onUnsubscribe(){var e;this.hasListeners()||((e=k(this,cn))==null||e.call(this),ie(this,cn,void 0))}setEventListener(e){var r;ie(this,Us,e),(r=k(this,cn))==null||r.call(this),ie(this,cn,e(i=>{typeof i=="boolean"?this.setFocused(i):this.onFocus()}))}setFocused(e){k(this,Vn)!==e&&(ie(this,Vn,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(r=>{r(e)})}isFocused(){var e;return typeof k(this,Vn)=="boolean"?k(this,Vn):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},Vn=new WeakMap,cn=new WeakMap,Us=new WeakMap,Ap),rd=new Z0;function bu(){let s,e;const r=new Promise((l,c)=>{s=l,e=c});r.status="pending",r.catch(()=>{});function i(l){Object.assign(r,l),delete r.resolve,delete r.reject}return r.resolve=l=>{i({status:"fulfilled",value:l}),s(l)},r.reject=l=>{i({status:"rejected",reason:l}),e(l)},r}var eb=K0;function tb(){let s=[],e=0,r=f=>{f()},i=f=>{f()},l=eb;const c=f=>{e?s.push(f):l(()=>{r(f)})},d=()=>{const f=s;s=[],f.length&&l(()=>{i(()=>{f.forEach(m=>{r(m)})})})};return{batch:f=>{let m;e++;try{m=f()}finally{e--,e||d()}return m},batchCalls:f=>(...m)=>{c(()=>{f(...m)})},schedule:c,setNotifyFunction:f=>{r=f},setBatchNotifyFunction:f=>{i=f},setScheduler:f=>{l=f}}}var rt=tb(),Ds,un,$s,Ip,rb=(Ip=class extends Zs{constructor(){super();ge(this,Ds,!0);ge(this,un);ge(this,$s);ie(this,$s,e=>{if(!es&&window.addEventListener){const r=()=>e(!0),i=()=>e(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",i,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",i)}}})}onSubscribe(){k(this,un)||this.setEventListener(k(this,$s))}onUnsubscribe(){var e;this.hasListeners()||((e=k(this,un))==null||e.call(this),ie(this,un,void 0))}setEventListener(e){var r;ie(this,$s,e),(r=k(this,un))==null||r.call(this),ie(this,un,e(this.setOnline.bind(this)))}setOnline(e){k(this,Ds)!==e&&(ie(this,Ds,e),this.listeners.forEach(i=>{i(e)}))}isOnline(){return k(this,Ds)}},Ds=new WeakMap,un=new WeakMap,$s=new WeakMap,Ip),qo=new rb;function nb(s){return Math.min(1e3*2**s,3e4)}function ag(s){return(s??"online")==="online"?qo.isOnline():!0}var wu=class extends Error{constructor(s){super("CancelledError"),this.revert=s==null?void 0:s.revert,this.silent=s==null?void 0:s.silent}};function og(s){let e=!1,r=0,i;const l=bu(),c=()=>l.status!=="pending",d=_=>{var b;if(!c()){const L=new wu(_);j(L),(b=s.onCancel)==null||b.call(s,L)}},f=()=>{e=!0},m=()=>{e=!1},g=()=>rd.isFocused()&&(s.networkMode==="always"||qo.isOnline())&&s.canRun(),y=()=>ag(s.networkMode)&&s.canRun(),x=_=>{c()||(i==null||i(),l.resolve(_))},j=_=>{c()||(i==null||i(),l.reject(_))},w=()=>new Promise(_=>{var b;i=L=>{(c()||g())&&_(L)},(b=s.onPause)==null||b.call(s)}).then(()=>{var _;i=void 0,c()||(_=s.onContinue)==null||_.call(s)}),N=()=>{if(c())return;let _;const b=r===0?s.initialPromise:void 0;try{_=b??s.fn()}catch(L){_=Promise.reject(L)}Promise.resolve(_).then(x).catch(L=>{var F;if(c())return;const C=s.retry??(es?0:3),T=s.retryDelay??nb,I=typeof T=="function"?T(r,L):T,q=C===!0||typeof C=="number"&&r<C||typeof C=="function"&&C(r,L);if(e||!q){j(L);return}r++,(F=s.onFail)==null||F.call(s,r,L),J0(I).then(()=>g()?void 0:w()).then(()=>{e?j(L):N()})})};return{promise:l,status:()=>l.status,cancel:d,continue:()=>(i==null||i(),l),cancelRetry:f,continueRetry:m,canStart:y,start:()=>(y()?N():w().then(N),l)}}var Hn,Lp,lg=(Lp=class{constructor(){ge(this,Hn)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),xu(this.gcTime)&&ie(this,Hn,qn.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(s){this.gcTime=Math.max(this.gcTime||0,s??(es?1/0:300*1e3))}clearGcTimeout(){k(this,Hn)&&(qn.clearTimeout(k(this,Hn)),ie(this,Hn,void 0))}},Hn=new WeakMap,Lp),Kn,Fs,Qt,Qn,ot,ia,Gn,ir,Cr,Mp,sb=(Mp=class extends lg{constructor(e){super();ge(this,ir);ge(this,Kn);ge(this,Fs);ge(this,Qt);ge(this,Qn);ge(this,ot);ge(this,ia);ge(this,Gn);ie(this,Gn,!1),ie(this,ia,e.defaultOptions),this.setOptions(e.options),this.observers=[],ie(this,Qn,e.client),ie(this,Qt,k(this,Qn).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,ie(this,Kn,Rm(this.options)),this.state=e.state??k(this,Kn),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=k(this,ot))==null?void 0:e.promise}setOptions(e){if(this.options={...k(this,ia),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=Rm(this.options);r.data!==void 0&&(this.setState(Tm(r.data,r.dataUpdatedAt)),ie(this,Kn,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&k(this,Qt).remove(this)}setData(e,r){const i=vu(this.state.data,e,this.options);return Ee(this,ir,Cr).call(this,{data:i,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),i}setState(e,r){Ee(this,ir,Cr).call(this,{type:"setState",state:e,setStateOptions:r})}cancel(e){var i,l;const r=(i=k(this,ot))==null?void 0:i.promise;return(l=k(this,ot))==null||l.cancel(e),r?r.then(jt).catch(jt):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(k(this,Kn))}isActive(){return this.observers.some(e=>Gt(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===td||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>vn(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!rg(this.state.dataUpdatedAt,e)}onFocus(){var r;const e=this.observers.find(i=>i.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(r=k(this,ot))==null||r.continue()}onOnline(){var r;const e=this.observers.find(i=>i.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(r=k(this,ot))==null||r.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),k(this,Qt).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(r=>r!==e),this.observers.length||(k(this,ot)&&(k(this,Gn)?k(this,ot).cancel({revert:!0}):k(this,ot).cancelRetry()),this.scheduleGc()),k(this,Qt).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Ee(this,ir,Cr).call(this,{type:"invalidate"})}async fetch(e,r){var m,g,y,x,j,w,N,_,b,L,C,T;if(this.state.fetchStatus!=="idle"&&((m=k(this,ot))==null?void 0:m.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(k(this,ot))return k(this,ot).continueRetry(),k(this,ot).promise}if(e&&this.setOptions(e),!this.options.queryFn){const I=this.observers.find(q=>q.options.queryFn);I&&this.setOptions(I.options)}const i=new AbortController,l=I=>{Object.defineProperty(I,"signal",{enumerable:!0,get:()=>(ie(this,Gn,!0),i.signal)})},c=()=>{const I=sg(this.options,r),F=(()=>{const G={client:k(this,Qn),queryKey:this.queryKey,meta:this.meta};return l(G),G})();return ie(this,Gn,!1),this.options.persister?this.options.persister(I,F,this):I(F)},f=(()=>{const I={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:k(this,Qn),state:this.state,fetchFn:c};return l(I),I})();(g=this.options.behavior)==null||g.onFetch(f,this),ie(this,Fs,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((y=f.fetchOptions)==null?void 0:y.meta))&&Ee(this,ir,Cr).call(this,{type:"fetch",meta:(x=f.fetchOptions)==null?void 0:x.meta}),ie(this,ot,og({initialPromise:r==null?void 0:r.initialPromise,fn:f.fetchFn,onCancel:I=>{I instanceof wu&&I.revert&&this.setState({...k(this,Fs),fetchStatus:"idle"}),i.abort()},onFail:(I,q)=>{Ee(this,ir,Cr).call(this,{type:"failed",failureCount:I,error:q})},onPause:()=>{Ee(this,ir,Cr).call(this,{type:"pause"})},onContinue:()=>{Ee(this,ir,Cr).call(this,{type:"continue"})},retry:f.options.retry,retryDelay:f.options.retryDelay,networkMode:f.options.networkMode,canRun:()=>!0}));try{const I=await k(this,ot).start();if(I===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(I),(w=(j=k(this,Qt).config).onSuccess)==null||w.call(j,I,this),(_=(N=k(this,Qt).config).onSettled)==null||_.call(N,I,this.state.error,this),I}catch(I){if(I instanceof wu){if(I.silent)return k(this,ot).promise;if(I.revert){if(this.state.data===void 0)throw I;return this.state.data}}throw Ee(this,ir,Cr).call(this,{type:"error",error:I}),(L=(b=k(this,Qt).config).onError)==null||L.call(b,I,this),(T=(C=k(this,Qt).config).onSettled)==null||T.call(C,this.state.data,I,this),I}finally{this.scheduleGc()}}},Kn=new WeakMap,Fs=new WeakMap,Qt=new WeakMap,Qn=new WeakMap,ot=new WeakMap,ia=new WeakMap,Gn=new WeakMap,ir=new WeakSet,Cr=function(e){const r=i=>{switch(e.type){case"failed":return{...i,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...cg(i.data,this.options),fetchMeta:e.meta??null};case"success":const l={...i,...Tm(e.data,e.dataUpdatedAt),dataUpdateCount:i.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return ie(this,Fs,e.manual?l:void 0),l;case"error":const c=e.error;return{...i,error:c,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:c,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...e.state}}};this.state=r(this.state),rt.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),k(this,Qt).notify({query:this,type:"updated",action:e})})},Mp);function cg(s,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:ag(e.networkMode)?"fetching":"paused",...s===void 0&&{error:null,status:"pending"}}}function Tm(s,e){return{data:s,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Rm(s){const e=typeof s.initialData=="function"?s.initialData():s.initialData,r=e!==void 0,i=r?typeof s.initialDataUpdatedAt=="function"?s.initialDataUpdatedAt():s.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:r?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var Tt,Te,aa,bt,Jn,Bs,Tr,dn,oa,zs,qs,Yn,Xn,hn,Ws,Ae,Ki,ju,_u,Nu,Su,ku,Eu,Cu,dg,Up,ug=(Up=class extends Zs{constructor(e,r){super();ge(this,Ae);ge(this,Tt);ge(this,Te);ge(this,aa);ge(this,bt);ge(this,Jn);ge(this,Bs);ge(this,Tr);ge(this,dn);ge(this,oa);ge(this,zs);ge(this,qs);ge(this,Yn);ge(this,Xn);ge(this,hn);ge(this,Ws,new Set);this.options=r,ie(this,Tt,e),ie(this,dn,null),ie(this,Tr,bu()),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(k(this,Te).addObserver(this),Om(k(this,Te),this.options)?Ee(this,Ae,Ki).call(this):this.updateResult(),Ee(this,Ae,Su).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Pu(k(this,Te),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Pu(k(this,Te),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Ee(this,Ae,ku).call(this),Ee(this,Ae,Eu).call(this),k(this,Te).removeObserver(this)}setOptions(e){const r=this.options,i=k(this,Te);if(this.options=k(this,Tt).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Gt(this.options.enabled,k(this,Te))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Ee(this,Ae,Cu).call(this),k(this,Te).setOptions(this.options),r._defaulted&&!zo(this.options,r)&&k(this,Tt).getQueryCache().notify({type:"observerOptionsUpdated",query:k(this,Te),observer:this});const l=this.hasListeners();l&&Am(k(this,Te),i,this.options,r)&&Ee(this,Ae,Ki).call(this),this.updateResult(),l&&(k(this,Te)!==i||Gt(this.options.enabled,k(this,Te))!==Gt(r.enabled,k(this,Te))||vn(this.options.staleTime,k(this,Te))!==vn(r.staleTime,k(this,Te)))&&Ee(this,Ae,ju).call(this);const c=Ee(this,Ae,_u).call(this);l&&(k(this,Te)!==i||Gt(this.options.enabled,k(this,Te))!==Gt(r.enabled,k(this,Te))||c!==k(this,hn))&&Ee(this,Ae,Nu).call(this,c)}getOptimisticResult(e){const r=k(this,Tt).getQueryCache().build(k(this,Tt),e),i=this.createResult(r,e);return ab(this,i)&&(ie(this,bt,i),ie(this,Bs,this.options),ie(this,Jn,k(this,Te).state)),i}getCurrentResult(){return k(this,bt)}trackResult(e,r){return new Proxy(e,{get:(i,l)=>(this.trackProp(l),r==null||r(l),l==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&k(this,Tr).status==="pending"&&k(this,Tr).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(i,l))})}trackProp(e){k(this,Ws).add(e)}getCurrentQuery(){return k(this,Te)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const r=k(this,Tt).defaultQueryOptions(e),i=k(this,Tt).getQueryCache().build(k(this,Tt),r);return i.fetch().then(()=>this.createResult(i,r))}fetch(e){return Ee(this,Ae,Ki).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),k(this,bt)))}createResult(e,r){var ae;const i=k(this,Te),l=this.options,c=k(this,bt),d=k(this,Jn),f=k(this,Bs),g=e!==i?e.state:k(this,aa),{state:y}=e;let x={...y},j=!1,w;if(r._optimisticResults){const Y=this.hasListeners(),xe=!Y&&Om(e,r),ee=Y&&Am(e,i,r,l);(xe||ee)&&(x={...x,...cg(y.data,e.options)}),r._optimisticResults==="isRestoring"&&(x.fetchStatus="idle")}let{error:N,errorUpdatedAt:_,status:b}=x;w=x.data;let L=!1;if(r.placeholderData!==void 0&&w===void 0&&b==="pending"){let Y;c!=null&&c.isPlaceholderData&&r.placeholderData===(f==null?void 0:f.placeholderData)?(Y=c.data,L=!0):Y=typeof r.placeholderData=="function"?r.placeholderData((ae=k(this,qs))==null?void 0:ae.state.data,k(this,qs)):r.placeholderData,Y!==void 0&&(b="success",w=vu(c==null?void 0:c.data,Y,r),j=!0)}if(r.select&&w!==void 0&&!L)if(c&&w===(d==null?void 0:d.data)&&r.select===k(this,oa))w=k(this,zs);else try{ie(this,oa,r.select),w=r.select(w),w=vu(c==null?void 0:c.data,w,r),ie(this,zs,w),ie(this,dn,null)}catch(Y){ie(this,dn,Y)}k(this,dn)&&(N=k(this,dn),w=k(this,zs),_=Date.now(),b="error");const C=x.fetchStatus==="fetching",T=b==="pending",I=b==="error",q=T&&C,F=w!==void 0,B={status:b,fetchStatus:x.fetchStatus,isPending:T,isSuccess:b==="success",isError:I,isInitialLoading:q,isLoading:q,data:w,dataUpdatedAt:x.dataUpdatedAt,error:N,errorUpdatedAt:_,failureCount:x.fetchFailureCount,failureReason:x.fetchFailureReason,errorUpdateCount:x.errorUpdateCount,isFetched:x.dataUpdateCount>0||x.errorUpdateCount>0,isFetchedAfterMount:x.dataUpdateCount>g.dataUpdateCount||x.errorUpdateCount>g.errorUpdateCount,isFetching:C,isRefetching:C&&!T,isLoadingError:I&&!F,isPaused:x.fetchStatus==="paused",isPlaceholderData:j,isRefetchError:I&&F,isStale:nd(e,r),refetch:this.refetch,promise:k(this,Tr),isEnabled:Gt(r.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const Y=ue=>{B.status==="error"?ue.reject(B.error):B.data!==void 0&&ue.resolve(B.data)},xe=()=>{const ue=ie(this,Tr,B.promise=bu());Y(ue)},ee=k(this,Tr);switch(ee.status){case"pending":e.queryHash===i.queryHash&&Y(ee);break;case"fulfilled":(B.status==="error"||B.data!==ee.value)&&xe();break;case"rejected":(B.status!=="error"||B.error!==ee.reason)&&xe();break}}return B}updateResult(){const e=k(this,bt),r=this.createResult(k(this,Te),this.options);if(ie(this,Jn,k(this,Te).state),ie(this,Bs,this.options),k(this,Jn).data!==void 0&&ie(this,qs,k(this,Te)),zo(r,e))return;ie(this,bt,r);const i=()=>{if(!e)return!0;const{notifyOnChangeProps:l}=this.options,c=typeof l=="function"?l():l;if(c==="all"||!c&&!k(this,Ws).size)return!0;const d=new Set(c??k(this,Ws));return this.options.throwOnError&&d.add("error"),Object.keys(k(this,bt)).some(f=>{const m=f;return k(this,bt)[m]!==e[m]&&d.has(m)})};Ee(this,Ae,dg).call(this,{listeners:i()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Ee(this,Ae,Su).call(this)}},Tt=new WeakMap,Te=new WeakMap,aa=new WeakMap,bt=new WeakMap,Jn=new WeakMap,Bs=new WeakMap,Tr=new WeakMap,dn=new WeakMap,oa=new WeakMap,zs=new WeakMap,qs=new WeakMap,Yn=new WeakMap,Xn=new WeakMap,hn=new WeakMap,Ws=new WeakMap,Ae=new WeakSet,Ki=function(e){Ee(this,Ae,Cu).call(this);let r=k(this,Te).fetch(this.options,e);return e!=null&&e.throwOnError||(r=r.catch(jt)),r},ju=function(){Ee(this,Ae,ku).call(this);const e=vn(this.options.staleTime,k(this,Te));if(es||k(this,bt).isStale||!xu(e))return;const i=rg(k(this,bt).dataUpdatedAt,e)+1;ie(this,Yn,qn.setTimeout(()=>{k(this,bt).isStale||this.updateResult()},i))},_u=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(k(this,Te)):this.options.refetchInterval)??!1},Nu=function(e){Ee(this,Ae,Eu).call(this),ie(this,hn,e),!(es||Gt(this.options.enabled,k(this,Te))===!1||!xu(k(this,hn))||k(this,hn)===0)&&ie(this,Xn,qn.setInterval(()=>{(this.options.refetchIntervalInBackground||rd.isFocused())&&Ee(this,Ae,Ki).call(this)},k(this,hn)))},Su=function(){Ee(this,Ae,ju).call(this),Ee(this,Ae,Nu).call(this,Ee(this,Ae,_u).call(this))},ku=function(){k(this,Yn)&&(qn.clearTimeout(k(this,Yn)),ie(this,Yn,void 0))},Eu=function(){k(this,Xn)&&(qn.clearInterval(k(this,Xn)),ie(this,Xn,void 0))},Cu=function(){const e=k(this,Tt).getQueryCache().build(k(this,Tt),this.options);if(e===k(this,Te))return;const r=k(this,Te);ie(this,Te,e),ie(this,aa,e.state),this.hasListeners()&&(r==null||r.removeObserver(this),e.addObserver(this))},dg=function(e){rt.batch(()=>{e.listeners&&this.listeners.forEach(r=>{r(k(this,bt))}),k(this,Tt).getQueryCache().notify({query:k(this,Te),type:"observerResultsUpdated"})})},Up);function ib(s,e){return Gt(e.enabled,s)!==!1&&s.state.data===void 0&&!(s.state.status==="error"&&e.retryOnMount===!1)}function Om(s,e){return ib(s,e)||s.state.data!==void 0&&Pu(s,e,e.refetchOnMount)}function Pu(s,e,r){if(Gt(e.enabled,s)!==!1&&vn(e.staleTime,s)!=="static"){const i=typeof r=="function"?r(s):r;return i==="always"||i!==!1&&nd(s,e)}return!1}function Am(s,e,r,i){return(s!==e||Gt(i.enabled,s)===!1)&&(!r.suspense||s.state.status!=="error")&&nd(s,r)}function nd(s,e){return Gt(e.enabled,s)!==!1&&s.isStaleByTime(vn(e.staleTime,s))}function ab(s,e){return!zo(s.getCurrentResult(),e)}function Wo(s){return{onFetch:(e,r)=>{var y,x,j,w,N;const i=e.options,l=(j=(x=(y=e.fetchOptions)==null?void 0:y.meta)==null?void 0:x.fetchMore)==null?void 0:j.direction,c=((w=e.state.data)==null?void 0:w.pages)||[],d=((N=e.state.data)==null?void 0:N.pageParams)||[];let f={pages:[],pageParams:[]},m=0;const g=async()=>{let _=!1;const b=T=>{Object.defineProperty(T,"signal",{enumerable:!0,get:()=>(e.signal.aborted?_=!0:e.signal.addEventListener("abort",()=>{_=!0}),e.signal)})},L=sg(e.options,e.fetchOptions),C=async(T,I,q)=>{if(_)return Promise.reject();if(I==null&&T.pages.length)return Promise.resolve(T);const G=(()=>{const xe={client:e.client,queryKey:e.queryKey,pageParam:I,direction:q?"backward":"forward",meta:e.options.meta};return b(xe),xe})(),B=await L(G),{maxPages:ae}=e.options,Y=q?X0:Y0;return{pages:Y(T.pages,B,ae),pageParams:Y(T.pageParams,I,ae)}};if(l&&c.length){const T=l==="backward",I=T?hg:Tu,q={pages:c,pageParams:d},F=I(i,q);f=await C(q,F,T)}else{const T=s??c.length;do{const I=m===0?d[0]??i.initialPageParam:Tu(i,f);if(m>0&&I==null)break;f=await C(f,I),m++}while(m<T)}return f};e.options.persister?e.fetchFn=()=>{var _,b;return(b=(_=e.options).persister)==null?void 0:b.call(_,g,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},r)}:e.fetchFn=g}}}function Tu(s,{pages:e,pageParams:r}){const i=e.length-1;return e.length>0?s.getNextPageParam(e[i],e,r[i],r):void 0}function hg(s,{pages:e,pageParams:r}){var i;return e.length>0?(i=s.getPreviousPageParam)==null?void 0:i.call(s,e[0],e,r[0],r):void 0}function ob(s,e){return e?Tu(s,e)!=null:!1}function lb(s,e){return!e||!s.getPreviousPageParam?!1:hg(s,e)!=null}var cb=class extends ug{constructor(s,e){super(s,e)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(s){super.setOptions({...s,behavior:Wo()})}getOptimisticResult(s){return s.behavior=Wo(),super.getOptimisticResult(s)}fetchNextPage(s){return this.fetch({...s,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(s){return this.fetch({...s,meta:{fetchMore:{direction:"backward"}}})}createResult(s,e){var N,_;const{state:r}=s,i=super.createResult(s,e),{isFetching:l,isRefetching:c,isError:d,isRefetchError:f}=i,m=(_=(N=r.fetchMeta)==null?void 0:N.fetchMore)==null?void 0:_.direction,g=d&&m==="forward",y=l&&m==="forward",x=d&&m==="backward",j=l&&m==="backward";return{...i,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:ob(e,r.data),hasPreviousPage:lb(e,r.data),isFetchNextPageError:g,isFetchingNextPage:y,isFetchPreviousPageError:x,isFetchingPreviousPage:j,isRefetchError:f&&!g&&!x,isRefetching:c&&!y&&!j}}},la,pr,wt,Zn,gr,an,Dp,ub=(Dp=class extends lg{constructor(e){super();ge(this,gr);ge(this,la);ge(this,pr);ge(this,wt);ge(this,Zn);ie(this,la,e.client),this.mutationId=e.mutationId,ie(this,wt,e.mutationCache),ie(this,pr,[]),this.state=e.state||fg(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){k(this,pr).includes(e)||(k(this,pr).push(e),this.clearGcTimeout(),k(this,wt).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){ie(this,pr,k(this,pr).filter(r=>r!==e)),this.scheduleGc(),k(this,wt).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){k(this,pr).length||(this.state.status==="pending"?this.scheduleGc():k(this,wt).remove(this))}continue(){var e;return((e=k(this,Zn))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var d,f,m,g,y,x,j,w,N,_,b,L,C,T,I,q,F,G,B,ae;const r=()=>{Ee(this,gr,an).call(this,{type:"continue"})},i={client:k(this,la),meta:this.options.meta,mutationKey:this.options.mutationKey};ie(this,Zn,og({fn:()=>this.options.mutationFn?this.options.mutationFn(e,i):Promise.reject(new Error("No mutationFn found")),onFail:(Y,xe)=>{Ee(this,gr,an).call(this,{type:"failed",failureCount:Y,error:xe})},onPause:()=>{Ee(this,gr,an).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>k(this,wt).canRun(this)}));const l=this.state.status==="pending",c=!k(this,Zn).canStart();try{if(l)r();else{Ee(this,gr,an).call(this,{type:"pending",variables:e,isPaused:c}),await((f=(d=k(this,wt).config).onMutate)==null?void 0:f.call(d,e,this,i));const xe=await((g=(m=this.options).onMutate)==null?void 0:g.call(m,e,i));xe!==this.state.context&&Ee(this,gr,an).call(this,{type:"pending",context:xe,variables:e,isPaused:c})}const Y=await k(this,Zn).start();return await((x=(y=k(this,wt).config).onSuccess)==null?void 0:x.call(y,Y,e,this.state.context,this,i)),await((w=(j=this.options).onSuccess)==null?void 0:w.call(j,Y,e,this.state.context,i)),await((_=(N=k(this,wt).config).onSettled)==null?void 0:_.call(N,Y,null,this.state.variables,this.state.context,this,i)),await((L=(b=this.options).onSettled)==null?void 0:L.call(b,Y,null,e,this.state.context,i)),Ee(this,gr,an).call(this,{type:"success",data:Y}),Y}catch(Y){try{throw await((T=(C=k(this,wt).config).onError)==null?void 0:T.call(C,Y,e,this.state.context,this,i)),await((q=(I=this.options).onError)==null?void 0:q.call(I,Y,e,this.state.context,i)),await((G=(F=k(this,wt).config).onSettled)==null?void 0:G.call(F,void 0,Y,this.state.variables,this.state.context,this,i)),await((ae=(B=this.options).onSettled)==null?void 0:ae.call(B,void 0,Y,e,this.state.context,i)),Y}finally{Ee(this,gr,an).call(this,{type:"error",error:Y})}}finally{k(this,wt).runNext(this)}}},la=new WeakMap,pr=new WeakMap,wt=new WeakMap,Zn=new WeakMap,gr=new WeakSet,an=function(e){const r=i=>{switch(e.type){case"failed":return{...i,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...i,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:e.error,failureCount:i.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=r(this.state),rt.batch(()=>{k(this,pr).forEach(i=>{i.onMutationUpdate(e)}),k(this,wt).notify({mutation:this,type:"updated",action:e})})},Dp);function fg(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Rr,ar,ca,$p,db=($p=class extends Zs{constructor(e={}){super();ge(this,Rr);ge(this,ar);ge(this,ca);this.config=e,ie(this,Rr,new Set),ie(this,ar,new Map),ie(this,ca,0)}build(e,r,i){const l=new ub({client:e,mutationCache:this,mutationId:++So(this,ca)._,options:e.defaultMutationOptions(r),state:i});return this.add(l),l}add(e){k(this,Rr).add(e);const r=Eo(e);if(typeof r=="string"){const i=k(this,ar).get(r);i?i.push(e):k(this,ar).set(r,[e])}this.notify({type:"added",mutation:e})}remove(e){if(k(this,Rr).delete(e)){const r=Eo(e);if(typeof r=="string"){const i=k(this,ar).get(r);if(i)if(i.length>1){const l=i.indexOf(e);l!==-1&&i.splice(l,1)}else i[0]===e&&k(this,ar).delete(r)}}this.notify({type:"removed",mutation:e})}canRun(e){const r=Eo(e);if(typeof r=="string"){const i=k(this,ar).get(r),l=i==null?void 0:i.find(c=>c.state.status==="pending");return!l||l===e}else return!0}runNext(e){var i;const r=Eo(e);if(typeof r=="string"){const l=(i=k(this,ar).get(r))==null?void 0:i.find(c=>c!==e&&c.state.isPaused);return(l==null?void 0:l.continue())??Promise.resolve()}else return Promise.resolve()}clear(){rt.batch(()=>{k(this,Rr).forEach(e=>{this.notify({type:"removed",mutation:e})}),k(this,Rr).clear(),k(this,ar).clear()})}getAll(){return Array.from(k(this,Rr))}find(e){const r={exact:!0,...e};return this.getAll().find(i=>Em(r,i))}findAll(e={}){return this.getAll().filter(r=>Em(e,r))}notify(e){rt.batch(()=>{this.listeners.forEach(r=>{r(e)})})}resumePausedMutations(){const e=this.getAll().filter(r=>r.state.isPaused);return rt.batch(()=>Promise.all(e.map(r=>r.continue().catch(jt))))}},Rr=new WeakMap,ar=new WeakMap,ca=new WeakMap,$p);function Eo(s){var e;return(e=s.options.scope)==null?void 0:e.id}var Or,fn,Rt,Ar,Ir,$o,Ru,Fp,hb=(Fp=class extends Zs{constructor(r,i){super();ge(this,Ir);ge(this,Or);ge(this,fn);ge(this,Rt);ge(this,Ar);ie(this,Or,r),this.setOptions(i),this.bindMethods(),Ee(this,Ir,$o).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var l;const i=this.options;this.options=k(this,Or).defaultMutationOptions(r),zo(this.options,i)||k(this,Or).getMutationCache().notify({type:"observerOptionsUpdated",mutation:k(this,Rt),observer:this}),i!=null&&i.mutationKey&&this.options.mutationKey&&ts(i.mutationKey)!==ts(this.options.mutationKey)?this.reset():((l=k(this,Rt))==null?void 0:l.state.status)==="pending"&&k(this,Rt).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=k(this,Rt))==null||r.removeObserver(this)}onMutationUpdate(r){Ee(this,Ir,$o).call(this),Ee(this,Ir,Ru).call(this,r)}getCurrentResult(){return k(this,fn)}reset(){var r;(r=k(this,Rt))==null||r.removeObserver(this),ie(this,Rt,void 0),Ee(this,Ir,$o).call(this),Ee(this,Ir,Ru).call(this)}mutate(r,i){var l;return ie(this,Ar,i),(l=k(this,Rt))==null||l.removeObserver(this),ie(this,Rt,k(this,Or).getMutationCache().build(k(this,Or),this.options)),k(this,Rt).addObserver(this),k(this,Rt).execute(r)}},Or=new WeakMap,fn=new WeakMap,Rt=new WeakMap,Ar=new WeakMap,Ir=new WeakSet,$o=function(){var i;const r=((i=k(this,Rt))==null?void 0:i.state)??fg();ie(this,fn,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},Ru=function(r){rt.batch(()=>{var i,l,c,d,f,m,g,y;if(k(this,Ar)&&this.hasListeners()){const x=k(this,fn).variables,j=k(this,fn).context,w={client:k(this,Or),meta:this.options.meta,mutationKey:this.options.mutationKey};(r==null?void 0:r.type)==="success"?((l=(i=k(this,Ar)).onSuccess)==null||l.call(i,r.data,x,j,w),(d=(c=k(this,Ar)).onSettled)==null||d.call(c,r.data,null,x,j,w)):(r==null?void 0:r.type)==="error"&&((m=(f=k(this,Ar)).onError)==null||m.call(f,r.error,x,j,w),(y=(g=k(this,Ar)).onSettled)==null||y.call(g,void 0,r.error,x,j,w))}this.listeners.forEach(x=>{x(k(this,fn))})})},Fp),xr,Bp,fb=(Bp=class extends Zs{constructor(e={}){super();ge(this,xr);this.config=e,ie(this,xr,new Map)}build(e,r,i){const l=r.queryKey,c=r.queryHash??ed(l,r);let d=this.get(c);return d||(d=new sb({client:e,queryKey:l,queryHash:c,options:e.defaultQueryOptions(r),state:i,defaultOptions:e.getQueryDefaults(l)}),this.add(d)),d}add(e){k(this,xr).has(e.queryHash)||(k(this,xr).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const r=k(this,xr).get(e.queryHash);r&&(e.destroy(),r===e&&k(this,xr).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){rt.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return k(this,xr).get(e)}getAll(){return[...k(this,xr).values()]}find(e){const r={exact:!0,...e};return this.getAll().find(i=>km(r,i))}findAll(e={}){const r=this.getAll();return Object.keys(e).length>0?r.filter(i=>km(e,i)):r}notify(e){rt.batch(()=>{this.listeners.forEach(r=>{r(e)})})}onFocus(){rt.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){rt.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},xr=new WeakMap,Bp),He,mn,pn,Vs,Hs,gn,Ks,Qs,zp,mb=(zp=class{constructor(s={}){ge(this,He);ge(this,mn);ge(this,pn);ge(this,Vs);ge(this,Hs);ge(this,gn);ge(this,Ks);ge(this,Qs);ie(this,He,s.queryCache||new fb),ie(this,mn,s.mutationCache||new db),ie(this,pn,s.defaultOptions||{}),ie(this,Vs,new Map),ie(this,Hs,new Map),ie(this,gn,0)}mount(){So(this,gn)._++,k(this,gn)===1&&(ie(this,Ks,rd.subscribe(async s=>{s&&(await this.resumePausedMutations(),k(this,He).onFocus())})),ie(this,Qs,qo.subscribe(async s=>{s&&(await this.resumePausedMutations(),k(this,He).onOnline())})))}unmount(){var s,e;So(this,gn)._--,k(this,gn)===0&&((s=k(this,Ks))==null||s.call(this),ie(this,Ks,void 0),(e=k(this,Qs))==null||e.call(this),ie(this,Qs,void 0))}isFetching(s){return k(this,He).findAll({...s,fetchStatus:"fetching"}).length}isMutating(s){return k(this,mn).findAll({...s,status:"pending"}).length}getQueryData(s){var r;const e=this.defaultQueryOptions({queryKey:s});return(r=k(this,He).get(e.queryHash))==null?void 0:r.state.data}ensureQueryData(s){const e=this.defaultQueryOptions(s),r=k(this,He).build(this,e),i=r.state.data;return i===void 0?this.fetchQuery(s):(s.revalidateIfStale&&r.isStaleByTime(vn(e.staleTime,r))&&this.prefetchQuery(e),Promise.resolve(i))}getQueriesData(s){return k(this,He).findAll(s).map(({queryKey:e,state:r})=>{const i=r.data;return[e,i]})}setQueryData(s,e,r){const i=this.defaultQueryOptions({queryKey:s}),l=k(this,He).get(i.queryHash),c=l==null?void 0:l.state.data,d=Q0(e,c);if(d!==void 0)return k(this,He).build(this,i).setData(d,{...r,manual:!0})}setQueriesData(s,e,r){return rt.batch(()=>k(this,He).findAll(s).map(({queryKey:i})=>[i,this.setQueryData(i,e,r)]))}getQueryState(s){var r;const e=this.defaultQueryOptions({queryKey:s});return(r=k(this,He).get(e.queryHash))==null?void 0:r.state}removeQueries(s){const e=k(this,He);rt.batch(()=>{e.findAll(s).forEach(r=>{e.remove(r)})})}resetQueries(s,e){const r=k(this,He);return rt.batch(()=>(r.findAll(s).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...s},e)))}cancelQueries(s,e={}){const r={revert:!0,...e},i=rt.batch(()=>k(this,He).findAll(s).map(l=>l.cancel(r)));return Promise.all(i).then(jt).catch(jt)}invalidateQueries(s,e={}){return rt.batch(()=>(k(this,He).findAll(s).forEach(r=>{r.invalidate()}),(s==null?void 0:s.refetchType)==="none"?Promise.resolve():this.refetchQueries({...s,type:(s==null?void 0:s.refetchType)??(s==null?void 0:s.type)??"active"},e)))}refetchQueries(s,e={}){const r={...e,cancelRefetch:e.cancelRefetch??!0},i=rt.batch(()=>k(this,He).findAll(s).filter(l=>!l.isDisabled()&&!l.isStatic()).map(l=>{let c=l.fetch(void 0,r);return r.throwOnError||(c=c.catch(jt)),l.state.fetchStatus==="paused"?Promise.resolve():c}));return Promise.all(i).then(jt)}fetchQuery(s){const e=this.defaultQueryOptions(s);e.retry===void 0&&(e.retry=!1);const r=k(this,He).build(this,e);return r.isStaleByTime(vn(e.staleTime,r))?r.fetch(e):Promise.resolve(r.state.data)}prefetchQuery(s){return this.fetchQuery(s).then(jt).catch(jt)}fetchInfiniteQuery(s){return s.behavior=Wo(s.pages),this.fetchQuery(s)}prefetchInfiniteQuery(s){return this.fetchInfiniteQuery(s).then(jt).catch(jt)}ensureInfiniteQueryData(s){return s.behavior=Wo(s.pages),this.ensureQueryData(s)}resumePausedMutations(){return qo.isOnline()?k(this,mn).resumePausedMutations():Promise.resolve()}getQueryCache(){return k(this,He)}getMutationCache(){return k(this,mn)}getDefaultOptions(){return k(this,pn)}setDefaultOptions(s){ie(this,pn,s)}setQueryDefaults(s,e){k(this,Vs).set(ts(s),{queryKey:s,defaultOptions:e})}getQueryDefaults(s){const e=[...k(this,Vs).values()],r={};return e.forEach(i=>{ea(s,i.queryKey)&&Object.assign(r,i.defaultOptions)}),r}setMutationDefaults(s,e){k(this,Hs).set(ts(s),{mutationKey:s,defaultOptions:e})}getMutationDefaults(s){const e=[...k(this,Hs).values()],r={};return e.forEach(i=>{ea(s,i.mutationKey)&&Object.assign(r,i.defaultOptions)}),r}defaultQueryOptions(s){if(s._defaulted)return s;const e={...k(this,pn).queries,...this.getQueryDefaults(s.queryKey),...s,_defaulted:!0};return e.queryHash||(e.queryHash=ed(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===td&&(e.enabled=!1),e}defaultMutationOptions(s){return s!=null&&s._defaulted?s:{...k(this,pn).mutations,...(s==null?void 0:s.mutationKey)&&this.getMutationDefaults(s.mutationKey),...s,_defaulted:!0}}clear(){k(this,He).clear(),k(this,mn).clear()}},He=new WeakMap,mn=new WeakMap,pn=new WeakMap,Vs=new WeakMap,Hs=new WeakMap,gn=new WeakMap,Ks=new WeakMap,Qs=new WeakMap,zp),mg=E.createContext(void 0),Mr=s=>{const e=E.useContext(mg);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},pb=({client:s,children:e})=>(E.useEffect(()=>(s.mount(),()=>{s.unmount()}),[s]),a.jsx(mg.Provider,{value:s,children:e})),pg=E.createContext(!1),gb=()=>E.useContext(pg);pg.Provider;function xb(){let s=!1;return{clearReset:()=>{s=!1},reset:()=>{s=!0},isReset:()=>s}}var yb=E.createContext(xb()),vb=()=>E.useContext(yb),bb=(s,e)=>{(s.suspense||s.throwOnError||s.experimental_prefetchInRender)&&(e.isReset()||(s.retryOnMount=!1))},wb=s=>{E.useEffect(()=>{s.clearReset()},[s])},jb=({result:s,errorResetBoundary:e,throwOnError:r,query:i,suspense:l})=>s.isError&&!e.isReset()&&!s.isFetching&&i&&(l&&s.data===void 0||ig(r,[s.error,i])),_b=s=>{if(s.suspense){const r=l=>l==="static"?l:Math.max(l??1e3,1e3),i=s.staleTime;s.staleTime=typeof i=="function"?(...l)=>r(i(...l)):r(i),typeof s.gcTime=="number"&&(s.gcTime=Math.max(s.gcTime,1e3))}},Nb=(s,e)=>s.isLoading&&s.isFetching&&!e,Sb=(s,e)=>(s==null?void 0:s.suspense)&&e.isPending,Im=(s,e,r)=>e.fetchOptimistic(s).catch(()=>{r.clearReset()});function gg(s,e,r){var x,j,w,N,_;const i=gb(),l=vb(),c=Mr(),d=c.defaultQueryOptions(s);(j=(x=c.getDefaultOptions().queries)==null?void 0:x._experimental_beforeQuery)==null||j.call(x,d),d._optimisticResults=i?"isRestoring":"optimistic",_b(d),bb(d,l),wb(l);const f=!c.getQueryCache().get(d.queryHash),[m]=E.useState(()=>new e(c,d)),g=m.getOptimisticResult(d),y=!i&&s.subscribed!==!1;if(E.useSyncExternalStore(E.useCallback(b=>{const L=y?m.subscribe(rt.batchCalls(b)):jt;return m.updateResult(),L},[m,y]),()=>m.getCurrentResult(),()=>m.getCurrentResult()),E.useEffect(()=>{m.setOptions(d)},[d,m]),Sb(d,g))throw Im(d,m,l);if(jb({result:g,errorResetBoundary:l,throwOnError:d.throwOnError,query:c.getQueryCache().get(d.queryHash),suspense:d.suspense}))throw g.error;if((N=(w=c.getDefaultOptions().queries)==null?void 0:w._experimental_afterQuery)==null||N.call(w,d,g),d.experimental_prefetchInRender&&!es&&Nb(g,i)){const b=f?Im(d,m,l):(_=c.getQueryCache().get(d.queryHash))==null?void 0:_.promise;b==null||b.catch(jt).finally(()=>{m.updateResult()})}return d.notifyOnChangeProps?g:m.trackResult(g)}function _t(s,e){return gg(s,ug)}function wn(s,e){const r=Mr(),[i]=E.useState(()=>new hb(r,s));E.useEffect(()=>{i.setOptions(s)},[i,s]);const l=E.useSyncExternalStore(E.useCallback(d=>i.subscribe(rt.batchCalls(d)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),c=E.useCallback((d,f)=>{i.mutate(d,f).catch(jt)},[i]);if(l.error&&ig(i.options.throwOnError,[l.error]))throw l.error;return{...l,mutate:c,mutateAsync:l.mutate}}function kb(s,e){return gg(s,cb)}/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eb=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),xg=(...s)=>s.filter((e,r,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===r).join(" ").trim();/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Cb={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pb=E.forwardRef(({color:s="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:i,className:l="",children:c,iconNode:d,...f},m)=>E.createElement("svg",{ref:m,...Cb,width:e,height:e,stroke:s,strokeWidth:i?Number(r)*24/Number(e):r,className:xg("lucide",l),...f},[...d.map(([g,y])=>E.createElement(g,y)),...Array.isArray(c)?c:[c]]));/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=(s,e)=>{const r=E.forwardRef(({className:i,...l},c)=>E.createElement(Pb,{ref:c,iconNode:e,className:xg(`lucide-${Eb(s)}`,i),...l}));return r.displayName=`${s}`,r};/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tb=Ne("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rb=Ne("Bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ob=Ne("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=Ne("BookmarkPlus",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}],["line",{x1:"12",x2:"12",y1:"7",y2:"13",key:"1cppfj"}],["line",{x1:"15",x2:"9",y1:"10",y2:"10",key:"1gty7f"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yg=Ne("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ab=Ne("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ib=Ne("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vg=Ne("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const el=Ne("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vo=Ne("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jn=Ne("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lb=Ne("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=Ne("Film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bg=Ne("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mb=Ne("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ub=Ne("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Db=Ne("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $b=Ne("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wg=Ne("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lm=Ne("ListFilter",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M7 12h10",key:"b7w52i"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bn=Ne("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fb=Ne("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bb=Ne("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=Ne("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zb=Ne("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mm=Ne("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Um=Ne("Paperclip",[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qb=Ne("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wb=Ne("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vb=Ne("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sd=Ne("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hb=Ne("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kb=Ne("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const id=Ne("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qb=Ne("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=Ne("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yr=Ne("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gb=Ne("SunMedium",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 3v1",key:"1asbbs"}],["path",{d:"M12 20v1",key:"1wcdkc"}],["path",{d:"M3 12h1",key:"lp3yf2"}],["path",{d:"M20 12h1",key:"1vloll"}],["path",{d:"m18.364 5.636-.707.707",key:"1hakh0"}],["path",{d:"m6.343 17.657-.707.707",key:"18m9nf"}],["path",{d:"m5.636 5.636.707.707",key:"1xv1c5"}],["path",{d:"m17.657 17.657.707.707",key:"vl76zb"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ad=Ne("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=Ne("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jg=Ne("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=Ne("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const od=Ne("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=Ne("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jb=Ne("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yb=Ne("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),_g=""+new URL("movinesta-logo-neon-DA-ewCry.png",import.meta.url).href,Dm=s=>{let e;const r=new Set,i=(g,y)=>{const x=typeof g=="function"?g(e):g;if(!Object.is(x,e)){const j=e;e=y??(typeof x!="object"||x===null)?x:Object.assign({},e,x),r.forEach(w=>w(e,j))}},l=()=>e,f={setState:i,getState:l,getInitialState:()=>m,subscribe:g=>(r.add(g),()=>r.delete(g))},m=e=s(i,l,f);return f},Xb=(s=>s?Dm(s):Dm),Zb=s=>s;function ew(s,e=Zb){const r=Ft.useSyncExternalStore(s.subscribe,Ft.useCallback(()=>e(s.getState()),[s,e]),Ft.useCallback(()=>e(s.getInitialState()),[s,e]));return Ft.useDebugValue(r),r}const $m=s=>{const e=Xb(s),r=i=>ew(e,i);return Object.assign(r,e),r},tw=(s=>s?$m(s):$m),rw=tw(s=>({lastVisitedTab:"home",setLastVisitedTab:e=>s({lastVisitedTab:e})}));var Ou=function(s,e){return Ou=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(r[l]=i[l])},Ou(s,e)};function Ng(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Ou(s,e);function r(){this.constructor=s}s.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Ho=function(){return Ho=Object.assign||function(e){for(var r,i=1,l=arguments.length;i<l;i++){r=arguments[i];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(e[c]=r[c])}return e},Ho.apply(this,arguments)};function ei(s,e){var r={};for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&e.indexOf(i)<0&&(r[i]=s[i]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,i=Object.getOwnPropertySymbols(s);l<i.length;l++)e.indexOf(i[l])<0&&Object.prototype.propertyIsEnumerable.call(s,i[l])&&(r[i[l]]=s[i[l]]);return r}function Sg(s,e,r,i){var l=arguments.length,c=l<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,e,r,i);else for(var f=s.length-1;f>=0;f--)(d=s[f])&&(c=(l<3?d(c):l>3?d(e,r,c):d(e,r))||c);return l>3&&c&&Object.defineProperty(e,r,c),c}function kg(s,e){return function(r,i){e(r,i,s)}}function Eg(s,e,r,i,l,c){function d(L){if(L!==void 0&&typeof L!="function")throw new TypeError("Function expected");return L}for(var f=i.kind,m=f==="getter"?"get":f==="setter"?"set":"value",g=!e&&s?i.static?s:s.prototype:null,y=e||(g?Object.getOwnPropertyDescriptor(g,i.name):{}),x,j=!1,w=r.length-1;w>=0;w--){var N={};for(var _ in i)N[_]=_==="access"?{}:i[_];for(var _ in i.access)N.access[_]=i.access[_];N.addInitializer=function(L){if(j)throw new TypeError("Cannot add initializers after decoration has completed");c.push(d(L||null))};var b=(0,r[w])(f==="accessor"?{get:y.get,set:y.set}:y[m],N);if(f==="accessor"){if(b===void 0)continue;if(b===null||typeof b!="object")throw new TypeError("Object expected");(x=d(b.get))&&(y.get=x),(x=d(b.set))&&(y.set=x),(x=d(b.init))&&l.unshift(x)}else(x=d(b))&&(f==="field"?l.unshift(x):y[m]=x)}g&&Object.defineProperty(g,i.name,y),j=!0}function Cg(s,e,r){for(var i=arguments.length>2,l=0;l<e.length;l++)r=i?e[l].call(s,r):e[l].call(s);return i?r:void 0}function Pg(s){return typeof s=="symbol"?s:"".concat(s)}function Tg(s,e,r){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(s,"name",{configurable:!0,value:r?"".concat(r," ",e):e})}function Rg(s,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,e)}function me(s,e,r,i){function l(c){return c instanceof r?c:new r(function(d){d(c)})}return new(r||(r=Promise))(function(c,d){function f(y){try{g(i.next(y))}catch(x){d(x)}}function m(y){try{g(i.throw(y))}catch(x){d(x)}}function g(y){y.done?c(y.value):l(y.value).then(f,m)}g((i=i.apply(s,e||[])).next())})}function Og(s,e){var r={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,l,c,d=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return d.next=f(0),d.throw=f(1),d.return=f(2),typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function f(g){return function(y){return m([g,y])}}function m(g){if(i)throw new TypeError("Generator is already executing.");for(;d&&(d=0,g[0]&&(r=0)),r;)try{if(i=1,l&&(c=g[0]&2?l.return:g[0]?l.throw||((c=l.return)&&c.call(l),0):l.next)&&!(c=c.call(l,g[1])).done)return c;switch(l=0,c&&(g=[g[0]&2,c.value]),g[0]){case 0:case 1:c=g;break;case 4:return r.label++,{value:g[1],done:!1};case 5:r.label++,l=g[1],g=[0];continue;case 7:g=r.ops.pop(),r.trys.pop();continue;default:if(c=r.trys,!(c=c.length>0&&c[c.length-1])&&(g[0]===6||g[0]===2)){r=0;continue}if(g[0]===3&&(!c||g[1]>c[0]&&g[1]<c[3])){r.label=g[1];break}if(g[0]===6&&r.label<c[1]){r.label=c[1],c=g;break}if(c&&r.label<c[2]){r.label=c[2],r.ops.push(g);break}c[2]&&r.ops.pop(),r.trys.pop();continue}g=e.call(s,r)}catch(y){g=[6,y],l=0}finally{i=c=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}}var tl=Object.create?(function(s,e,r,i){i===void 0&&(i=r);var l=Object.getOwnPropertyDescriptor(e,r);(!l||("get"in l?!e.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(s,i,l)}):(function(s,e,r,i){i===void 0&&(i=r),s[i]=e[r]});function Ag(s,e){for(var r in s)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&tl(e,s,r)}function Ko(s){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&s[e],i=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&i>=s.length&&(s=void 0),{value:s&&s[i++],done:!s}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ld(s,e){var r=typeof Symbol=="function"&&s[Symbol.iterator];if(!r)return s;var i=r.call(s),l,c=[],d;try{for(;(e===void 0||e-- >0)&&!(l=i.next()).done;)c.push(l.value)}catch(f){d={error:f}}finally{try{l&&!l.done&&(r=i.return)&&r.call(i)}finally{if(d)throw d.error}}return c}function Ig(){for(var s=[],e=0;e<arguments.length;e++)s=s.concat(ld(arguments[e]));return s}function Lg(){for(var s=0,e=0,r=arguments.length;e<r;e++)s+=arguments[e].length;for(var i=Array(s),l=0,e=0;e<r;e++)for(var c=arguments[e],d=0,f=c.length;d<f;d++,l++)i[l]=c[d];return i}function Mg(s,e,r){if(r||arguments.length===2)for(var i=0,l=e.length,c;i<l;i++)(c||!(i in e))&&(c||(c=Array.prototype.slice.call(e,0,i)),c[i]=e[i]);return s.concat(c||Array.prototype.slice.call(e))}function Js(s){return this instanceof Js?(this.v=s,this):new Js(s)}function Ug(s,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(s,e||[]),l,c=[];return l=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),f("next"),f("throw"),f("return",d),l[Symbol.asyncIterator]=function(){return this},l;function d(w){return function(N){return Promise.resolve(N).then(w,x)}}function f(w,N){i[w]&&(l[w]=function(_){return new Promise(function(b,L){c.push([w,_,b,L])>1||m(w,_)})},N&&(l[w]=N(l[w])))}function m(w,N){try{g(i[w](N))}catch(_){j(c[0][3],_)}}function g(w){w.value instanceof Js?Promise.resolve(w.value.v).then(y,x):j(c[0][2],w)}function y(w){m("next",w)}function x(w){m("throw",w)}function j(w,N){w(N),c.shift(),c.length&&m(c[0][0],c[0][1])}}function Dg(s){var e,r;return e={},i("next"),i("throw",function(l){throw l}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(l,c){e[l]=s[l]?function(d){return(r=!r)?{value:Js(s[l](d)),done:!1}:c?c(d):d}:c}}function $g(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=s[Symbol.asyncIterator],r;return e?e.call(s):(s=typeof Ko=="function"?Ko(s):s[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(c){r[c]=s[c]&&function(d){return new Promise(function(f,m){d=s[c](d),l(f,m,d.done,d.value)})}}function l(c,d,f,m){Promise.resolve(m).then(function(g){c({value:g,done:f})},d)}}function Fg(s,e){return Object.defineProperty?Object.defineProperty(s,"raw",{value:e}):s.raw=e,s}var nw=Object.create?(function(s,e){Object.defineProperty(s,"default",{enumerable:!0,value:e})}):function(s,e){s.default=e},Au=function(s){return Au=Object.getOwnPropertyNames||function(e){var r=[];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[r.length]=i);return r},Au(s)};function Bg(s){if(s&&s.__esModule)return s;var e={};if(s!=null)for(var r=Au(s),i=0;i<r.length;i++)r[i]!=="default"&&tl(e,s,r[i]);return nw(e,s),e}function zg(s){return s&&s.__esModule?s:{default:s}}function qg(s,e,r,i){if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!i:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?i:r==="a"?i.call(s):i?i.value:e.get(s)}function Wg(s,e,r,i,l){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!l)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!l:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?l.call(s,r):l?l.value=r:e.set(s,r),r}function Vg(s,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof s=="function"?e===s:s.has(e)}function Hg(s,e,r){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var i,l;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=e[Symbol.asyncDispose]}if(i===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=e[Symbol.dispose],r&&(l=i)}if(typeof i!="function")throw new TypeError("Object not disposable.");l&&(i=function(){try{l.call(this)}catch(c){return Promise.reject(c)}}),s.stack.push({value:e,dispose:i,async:r})}else r&&s.stack.push({async:!0});return e}var sw=typeof SuppressedError=="function"?SuppressedError:function(s,e,r){var i=new Error(r);return i.name="SuppressedError",i.error=s,i.suppressed=e,i};function Kg(s){function e(c){s.error=s.hasError?new sw(c,s.error,"An error was suppressed during disposal."):c,s.hasError=!0}var r,i=0;function l(){for(;r=s.stack.pop();)try{if(!r.async&&i===1)return i=0,s.stack.push(r),Promise.resolve().then(l);if(r.dispose){var c=r.dispose.call(r.value);if(r.async)return i|=2,Promise.resolve(c).then(l,function(d){return e(d),l()})}else i|=1}catch(d){e(d)}if(i===1)return s.hasError?Promise.reject(s.error):Promise.resolve();if(s.hasError)throw s.error}return l()}function Qg(s,e){return typeof s=="string"&&/^\.\.?\//.test(s)?s.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,i,l,c,d){return i?e?".jsx":".js":l&&(!c||!d)?r:l+c+"."+d.toLowerCase()+"js"}):s}const iw={__extends:Ng,__assign:Ho,__rest:ei,__decorate:Sg,__param:kg,__esDecorate:Eg,__runInitializers:Cg,__propKey:Pg,__setFunctionName:Tg,__metadata:Rg,__awaiter:me,__generator:Og,__createBinding:tl,__exportStar:Ag,__values:Ko,__read:ld,__spread:Ig,__spreadArrays:Lg,__spreadArray:Mg,__await:Js,__asyncGenerator:Ug,__asyncDelegator:Dg,__asyncValues:$g,__makeTemplateObject:Fg,__importStar:Bg,__importDefault:zg,__classPrivateFieldGet:qg,__classPrivateFieldSet:Wg,__classPrivateFieldIn:Vg,__addDisposableResource:Hg,__disposeResources:Kg,__rewriteRelativeImportExtension:Qg},aw=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Hg,get __assign(){return Ho},__asyncDelegator:Dg,__asyncGenerator:Ug,__asyncValues:$g,__await:Js,__awaiter:me,__classPrivateFieldGet:qg,__classPrivateFieldIn:Vg,__classPrivateFieldSet:Wg,__createBinding:tl,__decorate:Sg,__disposeResources:Kg,__esDecorate:Eg,__exportStar:Ag,__extends:Ng,__generator:Og,__importDefault:zg,__importStar:Bg,__makeTemplateObject:Fg,__metadata:Rg,__param:kg,__propKey:Pg,__read:ld,__rest:ei,__rewriteRelativeImportExtension:Qg,__runInitializers:Cg,__setFunctionName:Tg,__spread:Ig,__spreadArray:Mg,__spreadArrays:Lg,__values:Ko,default:iw},Symbol.toStringTag,{value:"Module"})),ow=s=>s?(...e)=>s(...e):(...e)=>fetch(...e);class cd extends Error{constructor(e,r="FunctionsError",i){super(e),this.name=r,this.context=i}}class lw extends cd{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Fm extends cd{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Bm extends cd{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Iu;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(Iu||(Iu={}));class cw{constructor(e,{headers:r={},customFetch:i,region:l=Iu.Any}={}){this.url=e,this.headers=r,this.region=l,this.fetch=ow(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return me(this,arguments,void 0,function*(r,i={}){var l;let c,d;try{const{headers:f,method:m,body:g,signal:y,timeout:x}=i;let j={},{region:w}=i;w||(w=this.region);const N=new URL(`${this.url}/${r}`);w&&w!=="any"&&(j["x-region"]=w,N.searchParams.set("forceFunctionRegion",w));let _;g&&(f&&!Object.prototype.hasOwnProperty.call(f,"Content-Type")||!f)?typeof Blob<"u"&&g instanceof Blob||g instanceof ArrayBuffer?(j["Content-Type"]="application/octet-stream",_=g):typeof g=="string"?(j["Content-Type"]="text/plain",_=g):typeof FormData<"u"&&g instanceof FormData?_=g:(j["Content-Type"]="application/json",_=JSON.stringify(g)):_=g;let b=y;x&&(d=new AbortController,c=setTimeout(()=>d.abort(),x),y?(b=d.signal,y.addEventListener("abort",()=>d.abort())):b=d.signal);const L=yield this.fetch(N.toString(),{method:m||"POST",headers:Object.assign(Object.assign(Object.assign({},j),this.headers),f),body:_,signal:b}).catch(q=>{throw new lw(q)}),C=L.headers.get("x-relay-error");if(C&&C==="true")throw new Fm(L);if(!L.ok)throw new Bm(L);let T=((l=L.headers.get("Content-Type"))!==null&&l!==void 0?l:"text/plain").split(";")[0].trim(),I;return T==="application/json"?I=yield L.json():T==="application/octet-stream"||T==="application/pdf"?I=yield L.blob():T==="text/event-stream"?I=L:T==="multipart/form-data"?I=yield L.formData():I=yield L.text(),{data:I,error:null,response:L}}catch(f){return{data:null,error:f,response:f instanceof Bm||f instanceof Fm?f.context:void 0}}finally{c&&clearTimeout(c)}})}}var xt={};const ti=Sv(aw);var Co={},Po={},To={},Ro={},Oo={},Ao={},zm;function Gg(){if(zm)return Ao;zm=1,Object.defineProperty(Ao,"__esModule",{value:!0});class s extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Ao.default=s,Ao}var qm;function Jg(){if(qm)return Oo;qm=1,Object.defineProperty(Oo,"__esModule",{value:!0});const e=ti.__importDefault(Gg());class r{constructor(l){var c,d;this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=new Headers(l.headers),this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=(c=l.shouldThrowOnError)!==null&&c!==void 0?c:!1,this.signal=l.signal,this.isMaybeSingle=(d=l.isMaybeSingle)!==null&&d!==void 0?d:!1,l.fetch?this.fetch=l.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,c){return this.headers=new Headers(this.headers),this.headers.set(l,c),this}then(l,c){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const d=this.fetch;let f=d(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async m=>{var g,y,x,j;let w=null,N=null,_=null,b=m.status,L=m.statusText;if(m.ok){if(this.method!=="HEAD"){const q=await m.text();q===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((g=this.headers.get("Accept"))===null||g===void 0)&&g.includes("application/vnd.pgrst.plan+text"))?N=q:N=JSON.parse(q))}const T=(y=this.headers.get("Prefer"))===null||y===void 0?void 0:y.match(/count=(exact|planned|estimated)/),I=(x=m.headers.get("content-range"))===null||x===void 0?void 0:x.split("/");T&&I&&I.length>1&&(_=parseInt(I[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(N)&&(N.length>1?(w={code:"PGRST116",details:`Results contain ${N.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},N=null,_=null,b=406,L="Not Acceptable"):N.length===1?N=N[0]:N=null)}else{const T=await m.text();try{w=JSON.parse(T),Array.isArray(w)&&m.status===404&&(N=[],w=null,b=200,L="OK")}catch{m.status===404&&T===""?(b=204,L="No Content"):w={message:T}}if(w&&this.isMaybeSingle&&(!((j=w==null?void 0:w.details)===null||j===void 0)&&j.includes("0 rows"))&&(w=null,b=200,L="OK"),w&&this.shouldThrowOnError)throw new e.default(w)}return{error:w,data:N,count:_,status:b,statusText:L}});return this.shouldThrowOnError||(f=f.catch(m=>{var g,y,x,j,w,N;let _="";const b=m==null?void 0:m.cause;if(b){const L=(g=b==null?void 0:b.message)!==null&&g!==void 0?g:"",C=(y=b==null?void 0:b.code)!==null&&y!==void 0?y:"";_=`${(x=m==null?void 0:m.name)!==null&&x!==void 0?x:"FetchError"}: ${m==null?void 0:m.message}`,_+=`

Caused by: ${(j=b==null?void 0:b.name)!==null&&j!==void 0?j:"Error"}: ${L}`,C&&(_+=` (${C})`),b!=null&&b.stack&&(_+=`
${b.stack}`)}else _=(w=m==null?void 0:m.stack)!==null&&w!==void 0?w:"";return{error:{message:`${(N=m==null?void 0:m.name)!==null&&N!==void 0?N:"FetchError"}: ${m==null?void 0:m.message}`,details:_,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),f.then(l,c)}returns(){return this}overrideTypes(){return this}}return Oo.default=r,Oo}var Wm;function Yg(){if(Wm)return Ro;Wm=1,Object.defineProperty(Ro,"__esModule",{value:!0});const e=ti.__importDefault(Jg());class r extends e.default{select(l){let c=!1;const d=(l??"*").split("").map(f=>/\s/.test(f)&&!c?"":(f==='"'&&(c=!c),f)).join("");return this.url.searchParams.set("select",d),this.headers.append("Prefer","return=representation"),this}order(l,{ascending:c=!0,nullsFirst:d,foreignTable:f,referencedTable:m=f}={}){const g=m?`${m}.order`:"order",y=this.url.searchParams.get(g);return this.url.searchParams.set(g,`${y?`${y},`:""}${l}.${c?"asc":"desc"}${d===void 0?"":d?".nullsfirst":".nullslast"}`),this}limit(l,{foreignTable:c,referencedTable:d=c}={}){const f=typeof d>"u"?"limit":`${d}.limit`;return this.url.searchParams.set(f,`${l}`),this}range(l,c,{foreignTable:d,referencedTable:f=d}={}){const m=typeof f>"u"?"offset":`${f}.offset`,g=typeof f>"u"?"limit":`${f}.limit`;return this.url.searchParams.set(m,`${l}`),this.url.searchParams.set(g,`${c-l+1}`),this}abortSignal(l){return this.signal=l,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:l=!1,verbose:c=!1,settings:d=!1,buffers:f=!1,wal:m=!1,format:g="text"}={}){var y;const x=[l?"analyze":null,c?"verbose":null,d?"settings":null,f?"buffers":null,m?"wal":null].filter(Boolean).join("|"),j=(y=this.headers.get("Accept"))!==null&&y!==void 0?y:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${g}; for="${j}"; options=${x};`),g==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(l){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${l}`),this}}return Ro.default=r,Ro}var Vm;function ud(){if(Vm)return To;Vm=1,Object.defineProperty(To,"__esModule",{value:!0});const e=ti.__importDefault(Yg()),r=new RegExp("[,()]");class i extends e.default{eq(c,d){return this.url.searchParams.append(c,`eq.${d}`),this}neq(c,d){return this.url.searchParams.append(c,`neq.${d}`),this}gt(c,d){return this.url.searchParams.append(c,`gt.${d}`),this}gte(c,d){return this.url.searchParams.append(c,`gte.${d}`),this}lt(c,d){return this.url.searchParams.append(c,`lt.${d}`),this}lte(c,d){return this.url.searchParams.append(c,`lte.${d}`),this}like(c,d){return this.url.searchParams.append(c,`like.${d}`),this}likeAllOf(c,d){return this.url.searchParams.append(c,`like(all).{${d.join(",")}}`),this}likeAnyOf(c,d){return this.url.searchParams.append(c,`like(any).{${d.join(",")}}`),this}ilike(c,d){return this.url.searchParams.append(c,`ilike.${d}`),this}ilikeAllOf(c,d){return this.url.searchParams.append(c,`ilike(all).{${d.join(",")}}`),this}ilikeAnyOf(c,d){return this.url.searchParams.append(c,`ilike(any).{${d.join(",")}}`),this}regexMatch(c,d){return this.url.searchParams.append(c,`match.${d}`),this}regexIMatch(c,d){return this.url.searchParams.append(c,`imatch.${d}`),this}is(c,d){return this.url.searchParams.append(c,`is.${d}`),this}isDistinct(c,d){return this.url.searchParams.append(c,`isdistinct.${d}`),this}in(c,d){const f=Array.from(new Set(d)).map(m=>typeof m=="string"&&r.test(m)?`"${m}"`:`${m}`).join(",");return this.url.searchParams.append(c,`in.(${f})`),this}contains(c,d){return typeof d=="string"?this.url.searchParams.append(c,`cs.${d}`):Array.isArray(d)?this.url.searchParams.append(c,`cs.{${d.join(",")}}`):this.url.searchParams.append(c,`cs.${JSON.stringify(d)}`),this}containedBy(c,d){return typeof d=="string"?this.url.searchParams.append(c,`cd.${d}`):Array.isArray(d)?this.url.searchParams.append(c,`cd.{${d.join(",")}}`):this.url.searchParams.append(c,`cd.${JSON.stringify(d)}`),this}rangeGt(c,d){return this.url.searchParams.append(c,`sr.${d}`),this}rangeGte(c,d){return this.url.searchParams.append(c,`nxl.${d}`),this}rangeLt(c,d){return this.url.searchParams.append(c,`sl.${d}`),this}rangeLte(c,d){return this.url.searchParams.append(c,`nxr.${d}`),this}rangeAdjacent(c,d){return this.url.searchParams.append(c,`adj.${d}`),this}overlaps(c,d){return typeof d=="string"?this.url.searchParams.append(c,`ov.${d}`):this.url.searchParams.append(c,`ov.{${d.join(",")}}`),this}textSearch(c,d,{config:f,type:m}={}){let g="";m==="plain"?g="pl":m==="phrase"?g="ph":m==="websearch"&&(g="w");const y=f===void 0?"":`(${f})`;return this.url.searchParams.append(c,`${g}fts${y}.${d}`),this}match(c){return Object.entries(c).forEach(([d,f])=>{this.url.searchParams.append(d,`eq.${f}`)}),this}not(c,d,f){return this.url.searchParams.append(c,`not.${d}.${f}`),this}or(c,{foreignTable:d,referencedTable:f=d}={}){const m=f?`${f}.or`:"or";return this.url.searchParams.append(m,`(${c})`),this}filter(c,d,f){return this.url.searchParams.append(c,`${d}.${f}`),this}}return To.default=i,To}var Hm;function Xg(){if(Hm)return Po;Hm=1,Object.defineProperty(Po,"__esModule",{value:!0});const e=ti.__importDefault(ud());class r{constructor(l,{headers:c={},schema:d,fetch:f}){this.url=l,this.headers=new Headers(c),this.schema=d,this.fetch=f}select(l,c){const{head:d=!1,count:f}=c??{},m=d?"HEAD":"GET";let g=!1;const y=(l??"*").split("").map(x=>/\s/.test(x)&&!g?"":(x==='"'&&(g=!g),x)).join("");return this.url.searchParams.set("select",y),f&&this.headers.append("Prefer",`count=${f}`),new e.default({method:m,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(l,{count:c,defaultToNull:d=!0}={}){var f;const m="POST";if(c&&this.headers.append("Prefer",`count=${c}`),d||this.headers.append("Prefer","missing=default"),Array.isArray(l)){const g=l.reduce((y,x)=>y.concat(Object.keys(x)),[]);if(g.length>0){const y=[...new Set(g)].map(x=>`"${x}"`);this.url.searchParams.set("columns",y.join(","))}}return new e.default({method:m,url:this.url,headers:this.headers,schema:this.schema,body:l,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}upsert(l,{onConflict:c,ignoreDuplicates:d=!1,count:f,defaultToNull:m=!0}={}){var g;const y="POST";if(this.headers.append("Prefer",`resolution=${d?"ignore":"merge"}-duplicates`),c!==void 0&&this.url.searchParams.set("on_conflict",c),f&&this.headers.append("Prefer",`count=${f}`),m||this.headers.append("Prefer","missing=default"),Array.isArray(l)){const x=l.reduce((j,w)=>j.concat(Object.keys(w)),[]);if(x.length>0){const j=[...new Set(x)].map(w=>`"${w}"`);this.url.searchParams.set("columns",j.join(","))}}return new e.default({method:y,url:this.url,headers:this.headers,schema:this.schema,body:l,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}update(l,{count:c}={}){var d;const f="PATCH";return c&&this.headers.append("Prefer",`count=${c}`),new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:l,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}delete({count:l}={}){var c;const d="DELETE";return l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}}return Po.default=r,Po}var Km;function uw(){if(Km)return Co;Km=1,Object.defineProperty(Co,"__esModule",{value:!0});const s=ti,e=s.__importDefault(Xg()),r=s.__importDefault(ud());class i{constructor(c,{headers:d={},schema:f,fetch:m}={}){this.url=c,this.headers=new Headers(d),this.schemaName=f,this.fetch=m}from(c){if(!c||typeof c!="string"||c.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const d=new URL(`${this.url}/${c}`);return new e.default(d,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(c){return new i(this.url,{headers:this.headers,schema:c,fetch:this.fetch})}rpc(c,d={},{head:f=!1,get:m=!1,count:g}={}){var y;let x;const j=new URL(`${this.url}/rpc/${c}`);let w;f||m?(x=f?"HEAD":"GET",Object.entries(d).filter(([_,b])=>b!==void 0).map(([_,b])=>[_,Array.isArray(b)?`{${b.join(",")}}`:`${b}`]).forEach(([_,b])=>{j.searchParams.append(_,b)})):(x="POST",w=d);const N=new Headers(this.headers);return g&&N.set("Prefer",`count=${g}`),new r.default({method:x,url:j,headers:N,schema:this.schemaName,body:w,fetch:(y=this.fetch)!==null&&y!==void 0?y:fetch})}}return Co.default=i,Co}var Qm;function dw(){if(Qm)return xt;Qm=1,Object.defineProperty(xt,"__esModule",{value:!0}),xt.PostgrestError=xt.PostgrestBuilder=xt.PostgrestTransformBuilder=xt.PostgrestFilterBuilder=xt.PostgrestQueryBuilder=xt.PostgrestClient=void 0;const s=ti,e=s.__importDefault(uw());xt.PostgrestClient=e.default;const r=s.__importDefault(Xg());xt.PostgrestQueryBuilder=r.default;const i=s.__importDefault(ud());xt.PostgrestFilterBuilder=i.default;const l=s.__importDefault(Yg());xt.PostgrestTransformBuilder=l.default;const c=s.__importDefault(Jg());xt.PostgrestBuilder=c.default;const d=s.__importDefault(Gg());return xt.PostgrestError=d.default,xt.default={PostgrestClient:e.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:i.default,PostgrestTransformBuilder:l.default,PostgrestBuilder:c.default,PostgrestError:d.default},xt}var Zg=dw();const ex=Qu(Zg),hw=qp({__proto__:null,default:ex},[Zg]),{PostgrestClient:fw,PostgrestQueryBuilder:bN,PostgrestFilterBuilder:wN,PostgrestTransformBuilder:jN,PostgrestBuilder:_N,PostgrestError:NN}=ex||hw;class mw{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const i=r.node,l=parseInt(i.replace(/^v/,"").split(".")[0]);return l>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${l} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${l} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const i=this.getWebSocketConstructor();return new i(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const pw="2.84.0",gw=`realtime-js/${pw}`,tx="1.0.0",xw="2.0.0",Gm=tx,Lu=1e4,yw=1e3,vw=100;var Fn;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(Fn||(Fn={}));var tt;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(tt||(tt={}));var or;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(or||(or={}));var Mu;(function(s){s.websocket="websocket"})(Mu||(Mu={}));var Bn;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(Bn||(Bn={}));class bw{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast"}encode(e,r){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(e));let i=[e.join_ref,e.ref,e.topic,e.event,e.payload];return r(JSON.stringify(i))}_binaryEncodeUserBroadcastPush(e){var r;return this._isArrayBuffer((r=e.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var r,i,l,c;const d=e.topic,f=(r=e.ref)!==null&&r!==void 0?r:"",m=(i=e.join_ref)!==null&&i!==void 0?i:"",g=e.payload.event,y=(c=(l=e.payload)===null||l===void 0?void 0:l.payload)!==null&&c!==void 0?c:new ArrayBuffer(0),x=this.USER_BROADCAST_PUSH_META_LENGTH+m.length+f.length+d.length+g.length,j=new ArrayBuffer(this.HEADER_LENGTH+x);let w=new DataView(j),N=0;w.setUint8(N++,this.KINDS.userBroadcastPush),w.setUint8(N++,m.length),w.setUint8(N++,f.length),w.setUint8(N++,d.length),w.setUint8(N++,g.length),w.setUint8(N++,this.BINARY_ENCODING),Array.from(m,b=>w.setUint8(N++,b.charCodeAt(0))),Array.from(f,b=>w.setUint8(N++,b.charCodeAt(0))),Array.from(d,b=>w.setUint8(N++,b.charCodeAt(0))),Array.from(g,b=>w.setUint8(N++,b.charCodeAt(0)));var _=new Uint8Array(j.byteLength+y.byteLength);return _.set(new Uint8Array(j),0),_.set(new Uint8Array(y),j.byteLength),_.buffer}_encodeJsonUserBroadcastPush(e){var r,i,l,c;const d=e.topic,f=(r=e.ref)!==null&&r!==void 0?r:"",m=(i=e.join_ref)!==null&&i!==void 0?i:"",g=e.payload.event,y=(c=(l=e.payload)===null||l===void 0?void 0:l.payload)!==null&&c!==void 0?c:{},j=new TextEncoder().encode(JSON.stringify(y)).buffer,w=this.USER_BROADCAST_PUSH_META_LENGTH+m.length+f.length+d.length+g.length,N=new ArrayBuffer(this.HEADER_LENGTH+w);let _=new DataView(N),b=0;_.setUint8(b++,this.KINDS.userBroadcastPush),_.setUint8(b++,m.length),_.setUint8(b++,f.length),_.setUint8(b++,d.length),_.setUint8(b++,g.length),_.setUint8(b++,this.JSON_ENCODING),Array.from(m,C=>_.setUint8(b++,C.charCodeAt(0))),Array.from(f,C=>_.setUint8(b++,C.charCodeAt(0))),Array.from(d,C=>_.setUint8(b++,C.charCodeAt(0))),Array.from(g,C=>_.setUint8(b++,C.charCodeAt(0)));var L=new Uint8Array(N.byteLength+j.byteLength);return L.set(new Uint8Array(N),0),L.set(new Uint8Array(j),N.byteLength),L.buffer}decode(e,r){if(this._isArrayBuffer(e)){let i=this._binaryDecode(e);return r(i)}if(typeof e=="string"){const i=JSON.parse(e),[l,c,d,f,m]=i;return r({join_ref:l,ref:c,topic:d,event:f,payload:m})}return r({})}_binaryDecode(e){const r=new DataView(e),i=r.getUint8(0),l=new TextDecoder;switch(i){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,r,l)}}_decodeUserBroadcast(e,r,i){const l=r.getUint8(1),c=r.getUint8(2),d=r.getUint8(3),f=r.getUint8(4);let m=this.HEADER_LENGTH+4;const g=i.decode(e.slice(m,m+l));m=m+l;const y=i.decode(e.slice(m,m+c));m=m+c;const x=i.decode(e.slice(m,m+d));m=m+d;const j=e.slice(m,e.byteLength),w=f===this.JSON_ENCODING?JSON.parse(i.decode(j)):j,N={type:this.BROADCAST_EVENT,event:y,payload:w};return d>0&&(N.meta=JSON.parse(x)),{join_ref:null,ref:null,topic:g,event:this.BROADCAST_EVENT,payload:N}}_isArrayBuffer(e){var r;return e instanceof ArrayBuffer||((r=e==null?void 0:e.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}}class rx{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Me;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(Me||(Me={}));const Jm=(s,e,r={})=>{var i;const l=(i=r.skipTypes)!==null&&i!==void 0?i:[];return e?Object.keys(e).reduce((c,d)=>(c[d]=ww(d,s,e,l),c),{}):{}},ww=(s,e,r,i)=>{const l=e.find(f=>f.name===s),c=l==null?void 0:l.type,d=r[s];return c&&!i.includes(c)?nx(c,d):Uu(d)},nx=(s,e)=>{if(s.charAt(0)==="_"){const r=s.slice(1,s.length);return Sw(e,r)}switch(s){case Me.bool:return jw(e);case Me.float4:case Me.float8:case Me.int2:case Me.int4:case Me.int8:case Me.numeric:case Me.oid:return _w(e);case Me.json:case Me.jsonb:return Nw(e);case Me.timestamp:return kw(e);case Me.abstime:case Me.date:case Me.daterange:case Me.int4range:case Me.int8range:case Me.money:case Me.reltime:case Me.text:case Me.time:case Me.timestamptz:case Me.timetz:case Me.tsrange:case Me.tstzrange:return Uu(e);default:return Uu(e)}},Uu=s=>s,jw=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},_w=s=>{if(typeof s=="string"){const e=parseFloat(s);if(!Number.isNaN(e))return e}return s},Nw=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch(e){return console.log(`JSON parse error: ${e}`),s}return s},Sw=(s,e)=>{if(typeof s!="string")return s;const r=s.length-1,i=s[r];if(s[0]==="{"&&i==="}"){let c;const d=s.slice(1,r);try{c=JSON.parse("["+d+"]")}catch{c=d?d.split(","):[]}return c.map(f=>nx(e,f))}return s},kw=s=>typeof s=="string"?s.replace(" ","T"):s,sx=s=>{const e=new URL(s);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Zc{constructor(e,r,i={},l=Lu){this.channel=e,this.event=r,this.payload=i,this.timeout=l,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var i;return this._hasReceived(e)&&r((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(i=>i.status===e).forEach(i=>i.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ym;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})(Ym||(Ym={}));class Gi{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},l=>{const{onJoin:c,onLeave:d,onSync:f}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Gi.syncState(this.state,l,c,d),this.pendingDiffs.forEach(m=>{this.state=Gi.syncDiff(this.state,m,c,d)}),this.pendingDiffs=[],f()}),this.channel._on(i.diff,{},l=>{const{onJoin:c,onLeave:d,onSync:f}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(l):(this.state=Gi.syncDiff(this.state,l,c,d),f())}),this.onJoin((l,c,d)=>{this.channel._trigger("presence",{event:"join",key:l,currentPresences:c,newPresences:d})}),this.onLeave((l,c,d)=>{this.channel._trigger("presence",{event:"leave",key:l,currentPresences:c,leftPresences:d})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,i,l){const c=this.cloneDeep(e),d=this.transformState(r),f={},m={};return this.map(c,(g,y)=>{d[g]||(m[g]=y)}),this.map(d,(g,y)=>{const x=c[g];if(x){const j=y.map(b=>b.presence_ref),w=x.map(b=>b.presence_ref),N=y.filter(b=>w.indexOf(b.presence_ref)<0),_=x.filter(b=>j.indexOf(b.presence_ref)<0);N.length>0&&(f[g]=N),_.length>0&&(m[g]=_)}else f[g]=y}),this.syncDiff(c,{joins:f,leaves:m},i,l)}static syncDiff(e,r,i,l){const{joins:c,leaves:d}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return i||(i=()=>{}),l||(l=()=>{}),this.map(c,(f,m)=>{var g;const y=(g=e[f])!==null&&g!==void 0?g:[];if(e[f]=this.cloneDeep(m),y.length>0){const x=e[f].map(w=>w.presence_ref),j=y.filter(w=>x.indexOf(w.presence_ref)<0);e[f].unshift(...j)}i(f,y,m)}),this.map(d,(f,m)=>{let g=e[f];if(!g)return;const y=m.map(x=>x.presence_ref);g=g.filter(x=>y.indexOf(x.presence_ref)<0),e[f]=g,l(f,g,m),g.length===0&&delete e[f]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(i=>r(i,e[i]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,i)=>{const l=e[i];return"metas"in l?r[i]=l.metas.map(c=>(c.presence_ref=c.phx_ref,delete c.phx_ref,delete c.phx_ref_prev,c)):r[i]=l,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Xm;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(Xm||(Xm={}));var Ji;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(Ji||(Ji={}));var Pr;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(Pr||(Pr={}));class dd{constructor(e,r={config:{}},i){var l,c;if(this.topic=e,this.params=r,this.socket=i,this.bindings={},this.state=tt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Zc(this,or.join,this.params,this.timeout),this.rejoinTimer=new rx(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=tt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(d=>d.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=tt.closed,this.socket._remove(this)}),this._onError(d=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,d),this.state=tt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=tt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",d=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,d),this.state=tt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(or.reply,{},(d,f)=>{this._trigger(this._replyEventName(f),d)}),this.presence=new Gi(this),this.broadcastEndpointURL=sx(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((c=(l=this.params.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var i,l,c;if(this.socket.isConnected()||this.socket.connect(),this.state==tt.closed){const{config:{broadcast:d,presence:f,private:m}}=this.params,g=(l=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(w=>w.filter))!==null&&l!==void 0?l:[],y=!!this.bindings[Ji.PRESENCE]&&this.bindings[Ji.PRESENCE].length>0||((c=this.params.config.presence)===null||c===void 0?void 0:c.enabled)===!0,x={},j={broadcast:d,presence:Object.assign(Object.assign({},f),{enabled:y}),postgres_changes:g,private:m};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(w=>e==null?void 0:e(Pr.CHANNEL_ERROR,w)),this._onClose(()=>e==null?void 0:e(Pr.CLOSED)),this.updateJoinPayload(Object.assign({config:j},x)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:w})=>{var N;if(this.socket.setAuth(),w===void 0){e==null||e(Pr.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,b=(N=_==null?void 0:_.length)!==null&&N!==void 0?N:0,L=[];for(let C=0;C<b;C++){const T=_[C],{filter:{event:I,schema:q,table:F,filter:G}}=T,B=w&&w[C];if(B&&B.event===I&&B.schema===q&&B.table===F&&B.filter===G)L.push(Object.assign(Object.assign({},T),{id:B.id}));else{this.unsubscribe(),this.state=tt.errored,e==null||e(Pr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=L,e&&e(Pr.SUBSCRIBED);return}}).receive("error",w=>{this.state=tt.errored,e==null||e(Pr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(w).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Pr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,i){return this.state===tt.joined&&e===Ji.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,r,i)}async httpSend(e,r,i={}){var l;const c=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const d={method:"POST",headers:{Authorization:c,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},f=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(l=i.timeout)!==null&&l!==void 0?l:this.timeout);if(f.status===202)return{success:!0};let m=f.statusText;try{const g=await f.json();m=g.error||g.message||m}catch{}return Promise.reject(new Error(m))}async send(e,r={}){var i,l;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:c,payload:d}=e,m={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:c,payload:d,private:this.private}]})};try{const g=await this._fetchWithTimeout(this.broadcastEndpointURL,m,(i=r.timeout)!==null&&i!==void 0?i:this.timeout);return await((l=g.body)===null||l===void 0?void 0:l.cancel()),g.ok?"ok":"error"}catch(g){return g.name==="AbortError"?"timed out":"error"}}else return new Promise(c=>{var d,f,m;const g=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((m=(f=(d=this.params)===null||d===void 0?void 0:d.config)===null||f===void 0?void 0:f.broadcast)===null||m===void 0)&&m.ack)&&c("ok"),g.receive("ok",()=>c("ok")),g.receive("error",()=>c("error")),g.receive("timeout",()=>c("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=tt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(or.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(l=>{i=new Zc(this,or.leave,{},e),i.receive("ok",()=>{r(),l("ok")}).receive("timeout",()=>{r(),l("timed out")}).receive("error",()=>{l("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i==null||i.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=tt.closed,this.bindings={}}async _fetchWithTimeout(e,r,i){const l=new AbortController,c=setTimeout(()=>l.abort(),i),d=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:l.signal}));return clearTimeout(c),d}_push(e,r,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let l=new Zc(this,e,r,i);return this._canPush()?l.send():this._addToPushBuffer(l),l}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>vw){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,i){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,i){var l,c;const d=e.toLocaleLowerCase(),{close:f,error:m,leave:g,join:y}=or;if(i&&[f,m,g,y].indexOf(d)>=0&&i!==this._joinRef())return;let j=this._onMessage(d,r,i);if(r&&!j)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(d)?(l=this.bindings.postgres_changes)===null||l===void 0||l.filter(w=>{var N,_,b;return((N=w.filter)===null||N===void 0?void 0:N.event)==="*"||((b=(_=w.filter)===null||_===void 0?void 0:_.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===d}).map(w=>w.callback(j,i)):(c=this.bindings[d])===null||c===void 0||c.filter(w=>{var N,_,b,L,C,T;if(["broadcast","presence","postgres_changes"].includes(d))if("id"in w){const I=w.id,q=(N=w.filter)===null||N===void 0?void 0:N.event;return I&&((_=r.ids)===null||_===void 0?void 0:_.includes(I))&&(q==="*"||(q==null?void 0:q.toLocaleLowerCase())===((b=r.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const I=(C=(L=w==null?void 0:w.filter)===null||L===void 0?void 0:L.event)===null||C===void 0?void 0:C.toLocaleLowerCase();return I==="*"||I===((T=r==null?void 0:r.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return w.type.toLocaleLowerCase()===d}).map(w=>{if(typeof j=="object"&&"ids"in j){const N=j.data,{schema:_,table:b,commit_timestamp:L,type:C,errors:T}=N;j=Object.assign(Object.assign({},{schema:_,table:b,commit_timestamp:L,eventType:C,new:{},old:{},errors:T}),this._getPayloadRecords(N))}w.callback(j,i)})}_isClosed(){return this.state===tt.closed}_isJoined(){return this.state===tt.joined}_isJoining(){return this.state===tt.joining}_isLeaving(){return this.state===tt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,i){const l=e.toLocaleLowerCase(),c={type:l,filter:r,callback:i};return this.bindings[l]?this.bindings[l].push(c):this.bindings[l]=[c],this}_off(e,r){const i=e.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(l=>{var c;return!(((c=l.type)===null||c===void 0?void 0:c.toLocaleLowerCase())===i&&dd.isEqual(l.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const i in e)if(e[i]!==r[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(or.close,{},e)}_onError(e){this._on(or.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=tt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Jm(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Jm(e.columns,e.old_record)),r}}const eu=()=>{},Io={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Ew=[1e3,2e3,5e3,1e4],Cw=1e4,Pw=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Tw{constructor(e,r){var i;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Lu,this.transport=null,this.heartbeatIntervalMs=Io.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=eu,this.ref=0,this.reconnectTimer=null,this.vsn=Gm,this.logger=eu,this.conn=null,this.sendBuffer=[],this.serializer=new bw,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=l=>l?(...c)=>l(...c):(...c)=>fetch(...c),!(!((i=r==null?void 0:r.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${Mu.websocket}`,this.httpEndpoint=sx(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=mw.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,i){this.logger(e,r,i)}connectionState(){switch(this.conn&&this.conn.readyState){case Fn.connecting:return Bn.Connecting;case Fn.open:return Bn.Open;case Fn.closing:return Bn.Closing;default:return Bn.Closed}}isConnected(){return this.connectionState()===Bn.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const i=`realtime:${e}`,l=this.getChannels().find(c=>c.topic===i);if(l)return l;{const c=new dd(`realtime:${e}`,r,this);return this.channels.push(c),c}}push(e){const{topic:r,event:i,payload:l,ref:c}=e,d=()=>{this.encode(e,f=>{var m;(m=this.conn)===null||m===void 0||m.send(f)})};this.log("push",`${r} ${i} (${c})`,l),this.isConnected()?d():this.sendBuffer.push(d)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(yw,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Io.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(i=>i.topic===e&&(i._isJoined()||i._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(g){this.log("error","error in heartbeat callback",g)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:i,event:l,payload:c,ref:d}=r,f=d?`(${d})`:"",m=c.status||"";this.log("receive",`${m} ${i} ${l} ${f}`.trim(),c),this.channels.filter(g=>g._isMember(i)).forEach(g=>g._trigger(l,c,d)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===Fn.open||this.conn.readyState===Fn.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(or.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const i=e.match(/\?/)?"&":"?",l=new URLSearchParams(r);return`${e}${i}${l}`}_workerObjectUrl(e){let r;if(e)r=e;else{const i=new Blob([Pw],{type:"application/javascript"});r=URL.createObjectURL(i)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(i=>{const l={access_token:r,version:gw};r&&i.updateJoinPayload(l),i.joinedOnce&&i._isJoined()&&i._push(or.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(i=>{try{i(r)}catch(l){this.log("error",`error in ${e} callback`,l)}})}catch(i){this.log("error",`error triggering ${e} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new rx(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Io.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,i,l,c,d,f,m,g,y,x,j,w;switch(this.transport=(r=e==null?void 0:e.transport)!==null&&r!==void 0?r:null,this.timeout=(i=e==null?void 0:e.timeout)!==null&&i!==void 0?i:Lu,this.heartbeatIntervalMs=(l=e==null?void 0:e.heartbeatIntervalMs)!==null&&l!==void 0?l:Io.HEARTBEAT_INTERVAL,this.worker=(c=e==null?void 0:e.worker)!==null&&c!==void 0?c:!1,this.accessToken=(d=e==null?void 0:e.accessToken)!==null&&d!==void 0?d:null,this.heartbeatCallback=(f=e==null?void 0:e.heartbeatCallback)!==null&&f!==void 0?f:eu,this.vsn=(m=e==null?void 0:e.vsn)!==null&&m!==void 0?m:Gm,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(g=e==null?void 0:e.reconnectAfterMs)!==null&&g!==void 0?g:(N=>Ew[N-1]||Cw),this.vsn){case tx:this.encode=(y=e==null?void 0:e.encode)!==null&&y!==void 0?y:((N,_)=>_(JSON.stringify(N))),this.decode=(x=e==null?void 0:e.decode)!==null&&x!==void 0?x:((N,_)=>_(JSON.parse(N)));break;case xw:this.encode=(j=e==null?void 0:e.encode)!==null&&j!==void 0?j:this.serializer.encode.bind(this.serializer),this.decode=(w=e==null?void 0:e.decode)!==null&&w!==void 0?w:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class hd extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ze(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}class Rw extends hd{constructor(e,r,i){super(e),this.name="StorageApiError",this.status=r,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Du extends hd{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}const fd=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),Ow=()=>Response,$u=s=>{if(Array.isArray(s))return s.map(r=>$u(r));if(typeof s=="function"||s!==Object(s))return s;const e={};return Object.entries(s).forEach(([r,i])=>{const l=r.replace(/([-_][a-z])/gi,c=>c.toUpperCase().replace(/[-_]/g,""));e[l]=$u(i)}),e},Aw=s=>{if(typeof s!="object"||s===null)return!1;const e=Object.getPrototypeOf(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)},tu=s=>{var e;return s.msg||s.message||s.error_description||(typeof s.error=="string"?s.error:(e=s.error)===null||e===void 0?void 0:e.message)||JSON.stringify(s)},Iw=(s,e,r)=>me(void 0,void 0,void 0,function*(){const i=yield Ow();s instanceof i&&!(r!=null&&r.noResolveJson)?s.json().then(l=>{const c=s.status||500,d=(l==null?void 0:l.statusCode)||c+"";e(new Rw(tu(l),c,d))}).catch(l=>{e(new Du(tu(l),l))}):e(new Du(tu(s),s))}),Lw=(s,e,r,i)=>{const l={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"||!i?l:(Aw(i)?(l.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),l.body=JSON.stringify(i)):l.body=i,e!=null&&e.duplex&&(l.duplex=e.duplex),Object.assign(Object.assign({},l),r))};function ha(s,e,r,i,l,c){return me(this,void 0,void 0,function*(){return new Promise((d,f)=>{s(r,Lw(e,i,l,c)).then(m=>{if(!m.ok)throw m;return i!=null&&i.noResolveJson?m:m.json()}).then(m=>d(m)).catch(m=>Iw(m,f,i))})})}function ra(s,e,r,i){return me(this,void 0,void 0,function*(){return ha(s,"GET",e,r,i)})}function sr(s,e,r,i,l){return me(this,void 0,void 0,function*(){return ha(s,"POST",e,i,l,r)})}function Fu(s,e,r,i,l){return me(this,void 0,void 0,function*(){return ha(s,"PUT",e,i,l,r)})}function Mw(s,e,r,i){return me(this,void 0,void 0,function*(){return ha(s,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),i)})}function md(s,e,r,i,l){return me(this,void 0,void 0,function*(){return ha(s,"DELETE",e,i,l,r)})}class Uw{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r}then(e,r){return this.execute().then(e,r)}execute(){return me(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ze(e))return{data:null,error:e};throw e}})}}var ix;class Dw{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r,this[ix]="BlobDownloadBuilder",this.promise=null}asStream(){return new Uw(this.downloadFn,this.shouldThrowOnError)}then(e,r){return this.getPromise().then(e,r)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return me(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ze(e))return{data:null,error:e};throw e}})}}ix=Symbol.toStringTag;const $w={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Zm={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Fw{constructor(e,r={},i,l){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.bucketId=i,this.fetch=fd(l)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,r,i,l){return me(this,void 0,void 0,function*(){try{let c;const d=Object.assign(Object.assign({},Zm),l);let f=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(d.upsert)});const m=d.metadata;typeof Blob<"u"&&i instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),m&&c.append("metadata",this.encodeMetadata(m)),c.append("",i)):typeof FormData<"u"&&i instanceof FormData?(c=i,c.has("cacheControl")||c.append("cacheControl",d.cacheControl),m&&!c.has("metadata")&&c.append("metadata",this.encodeMetadata(m))):(c=i,f["cache-control"]=`max-age=${d.cacheControl}`,f["content-type"]=d.contentType,m&&(f["x-metadata"]=this.toBase64(this.encodeMetadata(m))),(typeof ReadableStream<"u"&&c instanceof ReadableStream||c&&typeof c=="object"&&"pipe"in c&&typeof c.pipe=="function")&&!d.duplex&&(d.duplex="half")),l!=null&&l.headers&&(f=Object.assign(Object.assign({},f),l.headers));const g=this._removeEmptyFolders(r),y=this._getFinalPath(g),x=yield(e=="PUT"?Fu:sr)(this.fetch,`${this.url}/object/${y}`,c,Object.assign({headers:f},d!=null&&d.duplex?{duplex:d.duplex}:{}));return{data:{path:g,id:x.Id,fullPath:x.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(ze(c))return{data:null,error:c};throw c}})}upload(e,r,i){return me(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,i)})}uploadToSignedUrl(e,r,i,l){return me(this,void 0,void 0,function*(){const c=this._removeEmptyFolders(e),d=this._getFinalPath(c),f=new URL(this.url+`/object/upload/sign/${d}`);f.searchParams.set("token",r);try{let m;const g=Object.assign({upsert:Zm.upsert},l),y=Object.assign(Object.assign({},this.headers),{"x-upsert":String(g.upsert)});typeof Blob<"u"&&i instanceof Blob?(m=new FormData,m.append("cacheControl",g.cacheControl),m.append("",i)):typeof FormData<"u"&&i instanceof FormData?(m=i,m.append("cacheControl",g.cacheControl)):(m=i,y["cache-control"]=`max-age=${g.cacheControl}`,y["content-type"]=g.contentType);const x=yield Fu(this.fetch,f.toString(),m,{headers:y});return{data:{path:c,fullPath:x.Key},error:null}}catch(m){if(this.shouldThrowOnError)throw m;if(ze(m))return{data:null,error:m};throw m}})}createSignedUploadUrl(e,r){return me(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e);const l=Object.assign({},this.headers);r!=null&&r.upsert&&(l["x-upsert"]="true");const c=yield sr(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:l}),d=new URL(this.url+c.url),f=d.searchParams.get("token");if(!f)throw new hd("No token returned by API");return{data:{signedUrl:d.toString(),path:e,token:f},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ze(i))return{data:null,error:i};throw i}})}update(e,r,i){return me(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,i)})}move(e,r,i){return me(this,void 0,void 0,function*(){try{return{data:yield sr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ze(l))return{data:null,error:l};throw l}})}copy(e,r,i){return me(this,void 0,void 0,function*(){try{return{data:{path:(yield sr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers})).Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ze(l))return{data:null,error:l};throw l}})}createSignedUrl(e,r,i){return me(this,void 0,void 0,function*(){try{let l=this._getFinalPath(e),c=yield sr(this.fetch,`${this.url}/object/sign/${l}`,Object.assign({expiresIn:r},i!=null&&i.transform?{transform:i.transform}:{}),{headers:this.headers});const d=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return c={signedUrl:encodeURI(`${this.url}${c.signedURL}${d}`)},{data:c,error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ze(l))return{data:null,error:l};throw l}})}createSignedUrls(e,r,i){return me(this,void 0,void 0,function*(){try{const l=yield sr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),c=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return{data:l.map(d=>Object.assign(Object.assign({},d),{signedUrl:d.signedURL?encodeURI(`${this.url}${d.signedURL}${c}`):null})),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ze(l))return{data:null,error:l};throw l}})}download(e,r){const l=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),d=c?`?${c}`:"",f=this._getFinalPath(e),m=()=>ra(this.fetch,`${this.url}/${l}/${f}${d}`,{headers:this.headers,noResolveJson:!0});return new Dw(m,this.shouldThrowOnError)}info(e){return me(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const i=yield ra(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:$u(i),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ze(i))return{data:null,error:i};throw i}})}exists(e){return me(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield Mw(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ze(i)&&i instanceof Du){const l=i.originalError;if([400,404].includes(l==null?void 0:l.status))return{data:!1,error:i}}throw i}})}getPublicUrl(e,r){const i=this._getFinalPath(e),l=[],c=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";c!==""&&l.push(c);const f=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",m=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});m!==""&&l.push(m);let g=l.join("&");return g!==""&&(g=`?${g}`),{data:{publicUrl:encodeURI(`${this.url}/${f}/public/${i}${g}`)}}}remove(e){return me(this,void 0,void 0,function*(){try{return{data:yield md(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ze(r))return{data:null,error:r};throw r}})}list(e,r,i){return me(this,void 0,void 0,function*(){try{const l=Object.assign(Object.assign(Object.assign({},$w),r),{prefix:e||""});return{data:yield sr(this.fetch,`${this.url}/object/list/${this.bucketId}`,l,{headers:this.headers},i),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ze(l))return{data:null,error:l};throw l}})}listV2(e,r){return me(this,void 0,void 0,function*(){try{const i=Object.assign({},e);return{data:yield sr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ze(i))return{data:null,error:i};throw i}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const ax="2.84.0",ox={"X-Client-Info":`storage-js/${ax}`};class Bw{constructor(e,r={},i,l){this.shouldThrowOnError=!1;const c=new URL(e);l!=null&&l.useNewHostname&&/supabase\.(co|in|red)$/.test(c.hostname)&&!c.hostname.includes("storage.supabase.")&&(c.hostname=c.hostname.replace("supabase.","storage.supabase.")),this.url=c.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ox),r),this.fetch=fd(i)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return me(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(e);return{data:yield ra(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ze(r))return{data:null,error:r};throw r}})}getBucket(e){return me(this,void 0,void 0,function*(){try{return{data:yield ra(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ze(r))return{data:null,error:r};throw r}})}createBucket(e){return me(this,arguments,void 0,function*(r,i={public:!1}){try{return{data:yield sr(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:i.type,public:i.public,file_size_limit:i.fileSizeLimit,allowed_mime_types:i.allowedMimeTypes},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ze(l))return{data:null,error:l};throw l}})}updateBucket(e,r){return me(this,void 0,void 0,function*(){try{return{data:yield Fu(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ze(i))return{data:null,error:i};throw i}})}emptyBucket(e){return me(this,void 0,void 0,function*(){try{return{data:yield sr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ze(r))return{data:null,error:r};throw r}})}deleteBucket(e){return me(this,void 0,void 0,function*(){try{return{data:yield md(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ze(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(e){const r={};return e&&("limit"in e&&(r.limit=String(e.limit)),"offset"in e&&(r.offset=String(e.offset)),e.search&&(r.search=e.search),e.sortColumn&&(r.sortColumn=e.sortColumn),e.sortOrder&&(r.sortOrder=e.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class zw{constructor(e,r={},i){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ox),r),this.fetch=fd(i)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return me(this,void 0,void 0,function*(){try{return{data:yield sr(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ze(r))return{data:null,error:r};throw r}})}listBuckets(e){return me(this,void 0,void 0,function*(){try{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const i=r.toString(),l=i?`${this.url}/bucket?${i}`:`${this.url}/bucket`;return{data:yield ra(this.fetch,l,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ze(r))return{data:null,error:r};throw r}})}deleteBucket(e){return me(this,void 0,void 0,function*(){try{return{data:yield md(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ze(r))return{data:null,error:r};throw r}})}}const pd={"X-Client-Info":`storage-js/${ax}`,"Content-Type":"application/json"};class lx extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Dt(s){return typeof s=="object"&&s!==null&&"__isStorageVectorsError"in s}class ru extends lx{constructor(e,r,i){super(e),this.name="StorageVectorsApiError",this.status=r,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class qw extends lx{constructor(e,r){super(e),this.name="StorageVectorsUnknownError",this.originalError=r}}var ep;(function(s){s.InternalError="InternalError",s.S3VectorConflictException="S3VectorConflictException",s.S3VectorNotFoundException="S3VectorNotFoundException",s.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",s.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",s.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(ep||(ep={}));const gd=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),Ww=s=>{if(typeof s!="object"||s===null)return!1;const e=Object.getPrototypeOf(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)},tp=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),Vw=(s,e,r)=>me(void 0,void 0,void 0,function*(){if(s&&typeof s=="object"&&"status"in s&&"ok"in s&&typeof s.status=="number"&&!(r!=null&&r.noResolveJson)){const l=s.status||500,c=s;if(typeof c.json=="function")c.json().then(d=>{const f=(d==null?void 0:d.statusCode)||(d==null?void 0:d.code)||l+"";e(new ru(tp(d),l,f))}).catch(()=>{const d=l+"",f=c.statusText||`HTTP ${l} error`;e(new ru(f,l,d))});else{const d=l+"",f=c.statusText||`HTTP ${l} error`;e(new ru(f,l,d))}}else e(new qw(tp(s),s))}),Hw=(s,e,r,i)=>{const l={method:s,headers:(e==null?void 0:e.headers)||{}};return i?(Ww(i)?(l.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),l.body=JSON.stringify(i)):l.body=i,Object.assign(Object.assign({},l),r)):l};function Kw(s,e,r,i,l,c){return me(this,void 0,void 0,function*(){return new Promise((d,f)=>{s(r,Hw(e,i,l,c)).then(m=>{if(!m.ok)throw m;if(i!=null&&i.noResolveJson)return m;const g=m.headers.get("content-type");return!g||!g.includes("application/json")?{}:m.json()}).then(m=>d(m)).catch(m=>Vw(m,f,i))})})}function $t(s,e,r,i,l){return me(this,void 0,void 0,function*(){return Kw(s,"POST",e,i,l,r)})}class Qw{constructor(e,r={},i){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},pd),r),this.fetch=gd(i)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return me(this,void 0,void 0,function*(){try{return{data:(yield $t(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}})}getIndex(e,r){return me(this,void 0,void 0,function*(){try{return{data:yield $t(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Dt(i))return{data:null,error:i};throw i}})}listIndexes(e){return me(this,void 0,void 0,function*(){try{return{data:yield $t(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}})}deleteIndex(e,r){return me(this,void 0,void 0,function*(){try{return{data:(yield $t(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}))||{},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Dt(i))return{data:null,error:i};throw i}})}}class Gw{constructor(e,r={},i){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},pd),r),this.fetch=gd(i)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return me(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield $t(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}})}getVectors(e){return me(this,void 0,void 0,function*(){try{return{data:yield $t(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}})}listVectors(e){return me(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield $t(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}})}queryVectors(e){return me(this,void 0,void 0,function*(){try{return{data:yield $t(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}})}deleteVectors(e){return me(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield $t(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}})}}class Jw{constructor(e,r={},i){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},pd),r),this.fetch=gd(i)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return me(this,void 0,void 0,function*(){try{return{data:(yield $t(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}})}getBucket(e){return me(this,void 0,void 0,function*(){try{return{data:yield $t(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}})}listBuckets(){return me(this,arguments,void 0,function*(e={}){try{return{data:yield $t(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}})}deleteBucket(e){return me(this,void 0,void 0,function*(){try{return{data:(yield $t(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}})}}class Yw extends Jw{constructor(e,r={}){super(e,r.headers||{},r.fetch)}from(e){return new Xw(this.url,this.headers,e,this.fetch)}}class Xw extends Qw{constructor(e,r,i,l){super(e,r,l),this.vectorBucketName=i}createIndex(e){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return me(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return me(this,arguments,void 0,function*(r={}){return e.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return me(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return me(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new Zw(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class Zw extends Gw{constructor(e,r,i,l,c){super(e,r,c),this.vectorBucketName=i,this.indexName=l}putVectors(e){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return me(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return me(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return me(this,arguments,void 0,function*(r={}){return e.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return me(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return me(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class e1 extends Bw{constructor(e,r={},i,l){super(e,r,i,l)}from(e){return new Fw(this.url,this.headers,e,this.fetch)}get vectors(){return new Yw(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new zw(this.url+"/iceberg",this.headers,this.fetch)}}const t1="2.84.0";let Qi="";typeof Deno<"u"?Qi="deno":typeof document<"u"?Qi="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Qi="react-native":Qi="node";const r1={"X-Client-Info":`supabase-js-${Qi}/${t1}`},n1={headers:r1},s1={schema:"public"},i1={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},a1={},o1=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),l1=()=>Headers,c1=(s,e,r)=>{const i=o1(r),l=l1();return async(c,d)=>{var f;const m=(f=await e())!==null&&f!==void 0?f:s;let g=new l(d==null?void 0:d.headers);return g.has("apikey")||g.set("apikey",s),g.has("Authorization")||g.set("Authorization",`Bearer ${m}`),i(c,Object.assign(Object.assign({},d),{headers:g}))}};function u1(s){return s.endsWith("/")?s:s+"/"}function d1(s,e){var r,i;const{db:l,auth:c,realtime:d,global:f}=s,{db:m,auth:g,realtime:y,global:x}=e,j={db:Object.assign(Object.assign({},m),l),auth:Object.assign(Object.assign({},g),c),realtime:Object.assign(Object.assign({},y),d),storage:{},global:Object.assign(Object.assign(Object.assign({},x),f),{headers:Object.assign(Object.assign({},(r=x==null?void 0:x.headers)!==null&&r!==void 0?r:{}),(i=f==null?void 0:f.headers)!==null&&i!==void 0?i:{})}),accessToken:async()=>""};return s.accessToken?j.accessToken=s.accessToken:delete j.accessToken,j}function h1(s){const e=s==null?void 0:s.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(u1(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const cx="2.84.0",Is=30*1e3,Bu=3,nu=Bu*Is,f1="http://localhost:9999",m1="supabase.auth.token",p1={"X-Client-Info":`gotrue-js/${cx}`},zu="X-Supabase-Api-Version",ux={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},g1=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,x1=600*1e3;class na extends Error{constructor(e,r,i){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=i}}function pe(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class y1 extends na{constructor(e,r,i){super(e,r,i),this.name="AuthApiError",this.status=r,this.code=i}}function v1(s){return pe(s)&&s.name==="AuthApiError"}class zn extends na{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class _n extends na{constructor(e,r,i,l){super(e,i,l),this.name=r,this.status=i}}class Ut extends _n{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function b1(s){return pe(s)&&s.name==="AuthSessionMissingError"}class Ps extends _n{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Lo extends _n{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Mo extends _n{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function w1(s){return pe(s)&&s.name==="AuthImplicitGrantRedirectError"}class rp extends _n{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class qu extends _n{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function su(s){return pe(s)&&s.name==="AuthRetryableFetchError"}class np extends _n{constructor(e,r,i){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=i}}class Wu extends _n{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Qo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),sp=` 	
\r=`.split(""),j1=(()=>{const s=new Array(128);for(let e=0;e<s.length;e+=1)s[e]=-1;for(let e=0;e<sp.length;e+=1)s[sp[e].charCodeAt(0)]=-2;for(let e=0;e<Qo.length;e+=1)s[Qo[e].charCodeAt(0)]=e;return s})();function ip(s,e,r){if(s!==null)for(e.queue=e.queue<<8|s,e.queuedBits+=8;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;r(Qo[i]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;r(Qo[i]),e.queuedBits-=6}}function dx(s,e,r){const i=j1[s];if(i>-1)for(e.queue=e.queue<<6|i,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(s)}"`)}}function ap(s){const e=[],r=d=>{e.push(String.fromCodePoint(d))},i={utf8seq:0,codepoint:0},l={queue:0,queuedBits:0},c=d=>{S1(d,i,r)};for(let d=0;d<s.length;d+=1)dx(s.charCodeAt(d),l,c);return e.join("")}function _1(s,e){if(s<=127){e(s);return}else if(s<=2047){e(192|s>>6),e(128|s&63);return}else if(s<=65535){e(224|s>>12),e(128|s>>6&63),e(128|s&63);return}else if(s<=1114111){e(240|s>>18),e(128|s>>12&63),e(128|s>>6&63),e(128|s&63);return}throw new Error(`Unrecognized Unicode codepoint: ${s.toString(16)}`)}function N1(s,e){for(let r=0;r<s.length;r+=1){let i=s.charCodeAt(r);if(i>55295&&i<=56319){const l=(i-55296)*1024&65535;i=(s.charCodeAt(r+1)-56320&65535|l)+65536,r+=1}_1(i,e)}}function S1(s,e,r){if(e.utf8seq===0){if(s<=127){r(s);return}for(let i=1;i<6;i+=1)if((s>>7-i&1)===0){e.utf8seq=i;break}if(e.utf8seq===2)e.codepoint=s&31;else if(e.utf8seq===3)e.codepoint=s&15;else if(e.utf8seq===4)e.codepoint=s&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(s<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|s&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function Ms(s){const e=[],r={queue:0,queuedBits:0},i=l=>{e.push(l)};for(let l=0;l<s.length;l+=1)dx(s.charCodeAt(l),r,i);return new Uint8Array(e)}function k1(s){const e=[];return N1(s,r=>e.push(r)),new Uint8Array(e)}function Wn(s){const e=[],r={queue:0,queuedBits:0},i=l=>{e.push(l)};return s.forEach(l=>ip(l,r,i)),ip(null,r,i),e.join("")}function E1(s){return Math.round(Date.now()/1e3)+s}function C1(){return Symbol("auth-callback")}const dt=()=>typeof window<"u"&&typeof document<"u",Un={tested:!1,writable:!1},hx=()=>{if(!dt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Un.tested)return Un.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),Un.tested=!0,Un.writable=!0}catch{Un.tested=!0,Un.writable=!1}return Un.writable};function P1(s){const e={},r=new URL(s);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((l,c)=>{e[c]=l})}catch{}return r.searchParams.forEach((i,l)=>{e[l]=i}),e}const fx=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),T1=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",Ls=async(s,e,r)=>{await s.setItem(e,JSON.stringify(r))},Dn=async(s,e)=>{const r=await s.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},sn=async(s,e)=>{await s.removeItem(e)};class rl{constructor(){this.promise=new rl.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}rl.promiseConstructor=Promise;function iu(s){const e=s.split(".");if(e.length!==3)throw new Wu("Invalid JWT structure");for(let i=0;i<e.length;i++)if(!g1.test(e[i]))throw new Wu("JWT not in base64url format");return{header:JSON.parse(ap(e[0])),payload:JSON.parse(ap(e[1])),signature:Ms(e[2]),raw:{header:e[0],payload:e[1]}}}async function R1(s){return await new Promise(e=>{setTimeout(()=>e(null),s)})}function O1(s,e){return new Promise((i,l)=>{(async()=>{for(let c=0;c<1/0;c++)try{const d=await s(c);if(!e(c,null,d)){i(d);return}}catch(d){if(!e(c,d)){l(d);return}}})()})}function A1(s){return("0"+s.toString(16)).substr(-2)}function I1(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=r.length;let l="";for(let c=0;c<56;c++)l+=r.charAt(Math.floor(Math.random()*i));return l}return crypto.getRandomValues(e),Array.from(e,A1).join("")}async function L1(s){const r=new TextEncoder().encode(s),i=await crypto.subtle.digest("SHA-256",r),l=new Uint8Array(i);return Array.from(l).map(c=>String.fromCharCode(c)).join("")}async function M1(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const r=await L1(s);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ts(s,e,r=!1){const i=I1();let l=i;r&&(l+="/PASSWORD_RECOVERY"),await Ls(s,`${e}-code-verifier`,l);const c=await M1(i);return[c,i===c?"plain":"s256"]}const U1=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function D1(s){const e=s.headers.get(zu);if(!e||!e.match(U1))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function $1(s){if(!s)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(s<=e)throw new Error("JWT has expired")}function F1(s){switch(s){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const B1=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Rs(s){if(!B1.test(s))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function au(){const s={};return new Proxy(s,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const i=r.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function z1(s,e){return new Proxy(s,{get:(r,i,l)=>{if(i==="__isInsecureUserWarningProxy")return!0;if(typeof i=="symbol"){const c=i.toString();if(c==="Symbol(Symbol.toPrimitive)"||c==="Symbol(Symbol.toStringTag)"||c==="Symbol(util.inspect.custom)"||c==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,i,l)}return!e.value&&typeof i=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,i,l)}})}function op(s){return JSON.parse(JSON.stringify(s))}const $n=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),q1=[502,503,504];async function lp(s){var e;if(!T1(s))throw new qu($n(s),0);if(q1.includes(s.status))throw new qu($n(s),s.status);let r;try{r=await s.json()}catch(c){throw new zn($n(c),c)}let i;const l=D1(s);if(l&&l.getTime()>=ux["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?i=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(i=r.error_code),i){if(i==="weak_password")throw new np($n(r),s.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(i==="session_not_found")throw new Ut}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((c,d)=>c&&typeof d=="string",!0))throw new np($n(r),s.status,r.weak_password.reasons);throw new y1($n(r),s.status||500,i)}const W1=(s,e,r,i)=>{const l={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"?l:(l.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),l.body=JSON.stringify(i),Object.assign(Object.assign({},l),r))};async function be(s,e,r,i){var l;const c=Object.assign({},i==null?void 0:i.headers);c[zu]||(c[zu]=ux["2024-01-01"].name),i!=null&&i.jwt&&(c.Authorization=`Bearer ${i.jwt}`);const d=(l=i==null?void 0:i.query)!==null&&l!==void 0?l:{};i!=null&&i.redirectTo&&(d.redirect_to=i.redirectTo);const f=Object.keys(d).length?"?"+new URLSearchParams(d).toString():"",m=await V1(s,e,r+f,{headers:c,noResolveJson:i==null?void 0:i.noResolveJson},{},i==null?void 0:i.body);return i!=null&&i.xform?i==null?void 0:i.xform(m):{data:Object.assign({},m),error:null}}async function V1(s,e,r,i,l,c){const d=W1(e,i,l,c);let f;try{f=await s(r,Object.assign({},d))}catch(m){throw console.error(m),new qu($n(m),0)}if(f.ok||await lp(f),i!=null&&i.noResolveJson)return f;try{return await f.json()}catch(m){await lp(m)}}function nr(s){var e;let r=null;Q1(s)&&(r=Object.assign({},s),s.expires_at||(r.expires_at=E1(s.expires_in)));const i=(e=s.user)!==null&&e!==void 0?e:s;return{data:{session:r,user:i},error:null}}function cp(s){const e=nr(s);return!e.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((r,i)=>r&&typeof i=="string",!0)&&(e.data.weak_password=s.weak_password),e}function on(s){var e;return{data:{user:(e=s.user)!==null&&e!==void 0?e:s},error:null}}function H1(s){return{data:s,error:null}}function K1(s){const{action_link:e,email_otp:r,hashed_token:i,redirect_to:l,verification_type:c}=s,d=ei(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),f={action_link:e,email_otp:r,hashed_token:i,redirect_to:l,verification_type:c},m=Object.assign({},d);return{data:{properties:f,user:m},error:null}}function up(s){return s}function Q1(s){return s.access_token&&s.refresh_token&&s.expires_in}const ou=["global","local","others"];class G1{constructor({url:e="",headers:r={},fetch:i}){this.url=e,this.headers=r,this.fetch=fx(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=ou[0]){if(ou.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ou.join(", ")}`);try{return await be(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(i){if(pe(i))return{data:null,error:i};throw i}}async inviteUserByEmail(e,r={}){try{return await be(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:on})}catch(i){if(pe(i))return{data:{user:null},error:i};throw i}}async generateLink(e){try{const{options:r}=e,i=ei(e,["options"]),l=Object.assign(Object.assign({},i),r);return"newEmail"in i&&(l.new_email=i==null?void 0:i.newEmail,delete l.newEmail),await be(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:l,headers:this.headers,xform:K1,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(pe(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await be(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:on})}catch(r){if(pe(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,i,l,c,d,f,m;try{const g={nextPage:null,lastPage:0,total:0},y=await be(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:"",per_page:(c=(l=e==null?void 0:e.perPage)===null||l===void 0?void 0:l.toString())!==null&&c!==void 0?c:""},xform:up});if(y.error)throw y.error;const x=await y.json(),j=(d=y.headers.get("x-total-count"))!==null&&d!==void 0?d:0,w=(m=(f=y.headers.get("link"))===null||f===void 0?void 0:f.split(","))!==null&&m!==void 0?m:[];return w.length>0&&(w.forEach(N=>{const _=parseInt(N.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(N.split(";")[1].split("=")[1]);g[`${b}Page`]=_}),g.total=parseInt(j)),{data:Object.assign(Object.assign({},x),g),error:null}}catch(g){if(pe(g))return{data:{users:[]},error:g};throw g}}async getUserById(e){Rs(e);try{return await be(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:on})}catch(r){if(pe(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Rs(e);try{return await be(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:on})}catch(i){if(pe(i))return{data:{user:null},error:i};throw i}}async deleteUser(e,r=!1){Rs(e);try{return await be(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:on})}catch(i){if(pe(i))return{data:{user:null},error:i};throw i}}async _listFactors(e){Rs(e.userId);try{const{data:r,error:i}=await be(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:l=>({data:{factors:l},error:null})});return{data:r,error:i}}catch(r){if(pe(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Rs(e.userId),Rs(e.id);try{return{data:await be(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(pe(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,i,l,c,d,f,m;try{const g={nextPage:null,lastPage:0,total:0},y=await be(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:"",per_page:(c=(l=e==null?void 0:e.perPage)===null||l===void 0?void 0:l.toString())!==null&&c!==void 0?c:""},xform:up});if(y.error)throw y.error;const x=await y.json(),j=(d=y.headers.get("x-total-count"))!==null&&d!==void 0?d:0,w=(m=(f=y.headers.get("link"))===null||f===void 0?void 0:f.split(","))!==null&&m!==void 0?m:[];return w.length>0&&(w.forEach(N=>{const _=parseInt(N.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(N.split(";")[1].split("=")[1]);g[`${b}Page`]=_}),g.total=parseInt(j)),{data:Object.assign(Object.assign({},x),g),error:null}}catch(g){if(pe(g))return{data:{clients:[]},error:g};throw g}}async _createOAuthClient(e){try{return await be(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(pe(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await be(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(pe(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await be(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:i=>({data:i,error:null})})}catch(i){if(pe(i))return{data:null,error:i};throw i}}async _deleteOAuthClient(e){try{return await be(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(pe(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await be(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(pe(r))return{data:null,error:r};throw r}}}function dp(s={}){return{getItem:e=>s[e]||null,setItem:(e,r)=>{s[e]=r},removeItem:e=>{delete s[e]}}}const Os={debug:!!(globalThis&&hx()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class mx extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class J1 extends mx{}async function Y1(s,e,r){Os.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,e);const i=new globalThis.AbortController;return e>0&&setTimeout(()=>{i.abort(),Os.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(s,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async l=>{if(l){Os.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,l.name);try{return await r()}finally{Os.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,l.name)}}else{if(e===0)throw Os.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new J1(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if(Os.debug)try{const c=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(c,null,"  "))}catch(c){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",c)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function X1(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function px(s){if(!/^0x[a-fA-F0-9]{40}$/.test(s))throw new Error(`@supabase/auth-js: Address "${s}" is invalid.`);return s.toLowerCase()}function Z1(s){return parseInt(s,16)}function ej(s){const e=new TextEncoder().encode(s);return"0x"+Array.from(e,i=>i.toString(16).padStart(2,"0")).join("")}function tj(s){var e;const{chainId:r,domain:i,expirationTime:l,issuedAt:c=new Date,nonce:d,notBefore:f,requestId:m,resources:g,scheme:y,uri:x,version:j}=s;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!i)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(d&&d.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${d}`);if(!x)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(j!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${j}`);if(!((e=s.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${s.statement}`)}const w=px(s.address),N=y?`${y}://${i}`:i,_=s.statement?`${s.statement}
`:"",b=`${N} wants you to sign in with your Ethereum account:
${w}

${_}`;let L=`URI: ${x}
Version: ${j}
Chain ID: ${r}${d?`
Nonce: ${d}`:""}
Issued At: ${c.toISOString()}`;if(l&&(L+=`
Expiration Time: ${l.toISOString()}`),f&&(L+=`
Not Before: ${f.toISOString()}`),m&&(L+=`
Request ID: ${m}`),g){let C=`
Resources:`;for(const T of g){if(!T||typeof T!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${T}`);C+=`
- ${T}`}L+=C}return`${b}
${L}`}class Ye extends Error{constructor({message:e,code:r,cause:i,name:l}){var c;super(e,{cause:i}),this.__isWebAuthnError=!0,this.name=(c=l??(i instanceof Error?i.name:void 0))!==null&&c!==void 0?c:"Unknown Error",this.code=r}}class Go extends Ye{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function rj({error:s,options:e}){var r,i,l;const{publicKey:c}=e;if(!c)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Ye({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else if(s.name==="ConstraintError"){if(((r=c.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Ye({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:s});if(e.mediation==="conditional"&&((i=c.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new Ye({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:s});if(((l=c.authenticatorSelection)===null||l===void 0?void 0:l.userVerification)==="required")return new Ye({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:s})}else{if(s.name==="InvalidStateError")return new Ye({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:s});if(s.name==="NotAllowedError")return new Ye({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="NotSupportedError")return c.pubKeyCredParams.filter(f=>f.type==="public-key").length===0?new Ye({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:s}):new Ye({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:s});if(s.name==="SecurityError"){const d=window.location.hostname;if(gx(d)){if(c.rp.id!==d)return new Ye({message:`The RP ID "${c.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new Ye({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="TypeError"){if(c.user.id.byteLength<1||c.user.id.byteLength>64)return new Ye({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:s})}else if(s.name==="UnknownError")return new Ye({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new Ye({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}function nj({error:s,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Ye({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else{if(s.name==="NotAllowedError")return new Ye({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="SecurityError"){const i=window.location.hostname;if(gx(i)){if(r.rpId!==i)return new Ye({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new Ye({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="UnknownError")return new Ye({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new Ye({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}class sj{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const ij=new sj;function aj(s){if(!s)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(s);const{challenge:e,user:r,excludeCredentials:i}=s,l=ei(s,["challenge","user","excludeCredentials"]),c=Ms(e).buffer,d=Object.assign(Object.assign({},r),{id:Ms(r.id).buffer}),f=Object.assign(Object.assign({},l),{challenge:c,user:d});if(i&&i.length>0){f.excludeCredentials=new Array(i.length);for(let m=0;m<i.length;m++){const g=i[m];f.excludeCredentials[m]=Object.assign(Object.assign({},g),{id:Ms(g.id).buffer,type:g.type||"public-key",transports:g.transports})}}return f}function oj(s){if(!s)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(s);const{challenge:e,allowCredentials:r}=s,i=ei(s,["challenge","allowCredentials"]),l=Ms(e).buffer,c=Object.assign(Object.assign({},i),{challenge:l});if(r&&r.length>0){c.allowCredentials=new Array(r.length);for(let d=0;d<r.length;d++){const f=r[d];c.allowCredentials[d]=Object.assign(Object.assign({},f),{id:Ms(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return c}function lj(s){var e;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const r=s;return{id:s.id,rawId:s.id,response:{attestationObject:Wn(new Uint8Array(s.response.attestationObject)),clientDataJSON:Wn(new Uint8Array(s.response.clientDataJSON))},type:"public-key",clientExtensionResults:s.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function cj(s){var e;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const r=s,i=s.getClientExtensionResults(),l=s.response;return{id:s.id,rawId:s.id,response:{authenticatorData:Wn(new Uint8Array(l.authenticatorData)),clientDataJSON:Wn(new Uint8Array(l.clientDataJSON)),signature:Wn(new Uint8Array(l.signature)),userHandle:l.userHandle?Wn(new Uint8Array(l.userHandle)):void 0},type:"public-key",clientExtensionResults:i,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function gx(s){return s==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(s)}function hp(){var s,e;return!!(dt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((s=navigator==null?void 0:navigator.credentials)===null||s===void 0?void 0:s.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function uj(s){try{const e=await navigator.credentials.create(s);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Go("Browser returned unexpected credential type",e)}:{data:null,error:new Go("Empty credential response",e)}}catch(e){return{data:null,error:rj({error:e,options:s})}}}async function dj(s){try{const e=await navigator.credentials.get(s);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Go("Browser returned unexpected credential type",e)}:{data:null,error:new Go("Empty credential response",e)}}catch(e){return{data:null,error:nj({error:e,options:s})}}}const hj={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},fj={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Jo(...s){const e=l=>l!==null&&typeof l=="object"&&!Array.isArray(l),r=l=>l instanceof ArrayBuffer||ArrayBuffer.isView(l),i={};for(const l of s)if(l)for(const c in l){const d=l[c];if(d!==void 0)if(Array.isArray(d))i[c]=d;else if(r(d))i[c]=d;else if(e(d)){const f=i[c];e(f)?i[c]=Jo(f,d):i[c]=Jo(d)}else i[c]=d}return i}function mj(s,e){return Jo(hj,s,e||{})}function pj(s,e){return Jo(fj,s,e||{})}class gj{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:i,signal:l},c){try{const{data:d,error:f}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!d)return{data:null,error:f};const m=l??ij.createNewAbortSignal();if(d.webauthn.type==="create"){const{user:g}=d.webauthn.credential_options.publicKey;g.name||(g.name=`${g.id}:${i}`),g.displayName||(g.displayName=g.name)}switch(d.webauthn.type){case"create":{const g=mj(d.webauthn.credential_options.publicKey,c==null?void 0:c.create),{data:y,error:x}=await uj({publicKey:g,signal:m});return y?{data:{factorId:e,challengeId:d.id,webauthn:{type:d.webauthn.type,credential_response:y}},error:null}:{data:null,error:x}}case"request":{const g=pj(d.webauthn.credential_options.publicKey,c==null?void 0:c.request),{data:y,error:x}=await dj(Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:g,signal:m}));return y?{data:{factorId:e,challengeId:d.id,webauthn:{type:d.webauthn.type,credential_response:y}},error:null}:{data:null,error:x}}}}catch(d){return pe(d)?{data:null,error:d}:{data:null,error:new zn("Unexpected error in challenge",d)}}}async _verify({challengeId:e,factorId:r,webauthn:i}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:i})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:l}={}},c){if(!r)return{data:null,error:new na("rpId is required for WebAuthn authentication")};try{if(!hp())return{data:null,error:new zn("Browser does not support WebAuthn",null)};const{data:d,error:f}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:i},signal:l},{request:c});if(!d)return{data:null,error:f};const{webauthn:m}=d;return this._verify({factorId:e,challengeId:d.challengeId,webauthn:{type:m.type,rpId:r,rpOrigins:i,credential_response:m.credential_response}})}catch(d){return pe(d)?{data:null,error:d}:{data:null,error:new zn("Unexpected error in authenticate",d)}}}async _register({friendlyName:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:l}={}},c){if(!r)return{data:null,error:new na("rpId is required for WebAuthn registration")};try{if(!hp())return{data:null,error:new zn("Browser does not support WebAuthn",null)};const{data:d,error:f}=await this._enroll({friendlyName:e});if(!d)return await this.client.mfa.listFactors().then(y=>{var x;return(x=y.data)===null||x===void 0?void 0:x.all.find(j=>j.factor_type==="webauthn"&&j.friendly_name===e&&j.status!=="unverified")}).then(y=>y?this.client.mfa.unenroll({factorId:y==null?void 0:y.id}):void 0),{data:null,error:f};const{data:m,error:g}=await this._challenge({factorId:d.id,friendlyName:d.friendly_name,webauthn:{rpId:r,rpOrigins:i},signal:l},{create:c});return m?this._verify({factorId:d.id,challengeId:m.challengeId,webauthn:{rpId:r,rpOrigins:i,type:m.webauthn.type,credential_response:m.webauthn.credential_response}}):{data:null,error:g}}catch(d){return pe(d)?{data:null,error:d}:{data:null,error:new zn("Unexpected error in register",d)}}}}X1();const xj={url:f1,storageKey:m1,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:p1,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function fp(s,e,r){return await r()}const As={};class sa{get jwks(){var e,r;return(r=(e=As[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){As[this.storageKey]=Object.assign(Object.assign({},As[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=As[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){As[this.storageKey]=Object.assign(Object.assign({},As[this.storageKey]),{cachedAt:e})}constructor(e){var r,i,l;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const c=Object.assign(Object.assign({},xj),e);if(this.storageKey=c.storageKey,this.instanceID=(r=sa.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,sa.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!c.debug,typeof c.debug=="function"&&(this.logger=c.debug),this.instanceID>0&&dt()){const d=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(d),this.logDebugMessages&&console.trace(d)}if(this.persistSession=c.persistSession,this.autoRefreshToken=c.autoRefreshToken,this.admin=new G1({url:c.url,headers:c.headers,fetch:c.fetch}),this.url=c.url,this.headers=c.headers,this.fetch=fx(c.fetch),this.lock=c.lock||fp,this.detectSessionInUrl=c.detectSessionInUrl,this.flowType=c.flowType,this.hasCustomAuthorizationHeader=c.hasCustomAuthorizationHeader,this.throwOnError=c.throwOnError,c.lock?this.lock=c.lock:dt()&&(!((i=globalThis==null?void 0:globalThis.navigator)===null||i===void 0)&&i.locks)?this.lock=Y1:this.lock=fp,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new gj(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(c.storage?this.storage=c.storage:hx()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=dp(this.memoryStorage)),c.userStorage&&(this.userStorage=c.userStorage)):(this.memoryStorage={},this.storage=dp(this.memoryStorage)),dt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(d){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",d)}(l=this.broadcastChannel)===null||l===void 0||l.addEventListener("message",async d=>{this._debug("received broadcast notification from other tab or client",d),await this._notifyAllSubscribers(d.data.event,d.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${cx}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},i="none";if(dt()&&(r=P1(window.location.href),this._isImplicitGrantCallback(r)?i="implicit":await this._isPKCECallback(r)&&(i="pkce")),dt()&&this.detectSessionInUrl&&i!=="none"){const{data:l,error:c}=await this._getSessionFromURL(r,i);if(c){if(this._debug("#_initialize()","error detecting session from URL",c),w1(c)){const m=(e=c.details)===null||e===void 0?void 0:e.code;if(m==="identity_already_exists"||m==="identity_not_found"||m==="single_identity_not_deletable")return{error:c}}return await this._removeSession(),{error:c}}const{session:d,redirectType:f}=l;return this._debug("#_initialize()","detected session in URL",d,"redirect type",f),await this._saveSession(d),setTimeout(async()=>{f==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",d):await this._notifyAllSubscribers("SIGNED_IN",d)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return pe(r)?this._returnResult({error:r}):this._returnResult({error:new zn("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,i,l;try{const c=await be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(l=e==null?void 0:e.options)===null||l===void 0?void 0:l.captchaToken}},xform:nr}),{data:d,error:f}=c;if(f||!d)return this._returnResult({data:{user:null,session:null},error:f});const m=d.session,g=d.user;return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",m)),this._returnResult({data:{user:g,session:m},error:null})}catch(c){if(pe(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async signUp(e){var r,i,l;try{let c;if("email"in e){const{email:y,password:x,options:j}=e;let w=null,N=null;this.flowType==="pkce"&&([w,N]=await Ts(this.storage,this.storageKey)),c=await be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:j==null?void 0:j.emailRedirectTo,body:{email:y,password:x,data:(r=j==null?void 0:j.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:j==null?void 0:j.captchaToken},code_challenge:w,code_challenge_method:N},xform:nr})}else if("phone"in e){const{phone:y,password:x,options:j}=e;c=await be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:y,password:x,data:(i=j==null?void 0:j.data)!==null&&i!==void 0?i:{},channel:(l=j==null?void 0:j.channel)!==null&&l!==void 0?l:"sms",gotrue_meta_security:{captcha_token:j==null?void 0:j.captchaToken}},xform:nr})}else throw new Lo("You must provide either an email or phone number and a password");const{data:d,error:f}=c;if(f||!d)return this._returnResult({data:{user:null,session:null},error:f});const m=d.session,g=d.user;return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",m)),this._returnResult({data:{user:g,session:m},error:null})}catch(c){if(pe(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async signInWithPassword(e){try{let r;if("email"in e){const{email:c,password:d,options:f}=e;r=await be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:c,password:d,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:cp})}else if("phone"in e){const{phone:c,password:d,options:f}=e;r=await be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:c,password:d,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:cp})}else throw new Lo("You must provide either an email or phone number and a password");const{data:i,error:l}=r;if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!i||!i.session||!i.user){const c=new Ps;return this._returnResult({data:{user:null,session:null},error:c})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:l})}catch(r){if(pe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,i,l,c;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(i=e.options)===null||i===void 0?void 0:i.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:(c=e.options)===null||c===void 0?void 0:c.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,i,l,c,d,f,m,g,y,x,j;let w,N;if("message"in e)w=e.message,N=e.signature;else{const{chain:_,wallet:b,statement:L,options:C}=e;let T;if(dt())if(typeof b=="object")T=b;else{const ae=window;if("ethereum"in ae&&typeof ae.ethereum=="object"&&"request"in ae.ethereum&&typeof ae.ethereum.request=="function")T=ae.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!(C!=null&&C.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");T=b}const I=new URL((r=C==null?void 0:C.url)!==null&&r!==void 0?r:window.location.href),q=await T.request({method:"eth_requestAccounts"}).then(ae=>ae).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!q||q.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const F=px(q[0]);let G=(i=C==null?void 0:C.signInWithEthereum)===null||i===void 0?void 0:i.chainId;if(!G){const ae=await T.request({method:"eth_chainId"});G=Z1(ae)}const B={domain:I.host,address:F,statement:L,uri:I.href,version:"1",chainId:G,nonce:(l=C==null?void 0:C.signInWithEthereum)===null||l===void 0?void 0:l.nonce,issuedAt:(d=(c=C==null?void 0:C.signInWithEthereum)===null||c===void 0?void 0:c.issuedAt)!==null&&d!==void 0?d:new Date,expirationTime:(f=C==null?void 0:C.signInWithEthereum)===null||f===void 0?void 0:f.expirationTime,notBefore:(m=C==null?void 0:C.signInWithEthereum)===null||m===void 0?void 0:m.notBefore,requestId:(g=C==null?void 0:C.signInWithEthereum)===null||g===void 0?void 0:g.requestId,resources:(y=C==null?void 0:C.signInWithEthereum)===null||y===void 0?void 0:y.resources};w=tj(B),N=await T.request({method:"personal_sign",params:[ej(w),F]})}try{const{data:_,error:b}=await be(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:w,signature:N},!((x=e.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(j=e.options)===null||j===void 0?void 0:j.captchaToken}}:null),xform:nr});if(b)throw b;if(!_||!_.session||!_.user){const L=new Ps;return this._returnResult({data:{user:null,session:null},error:L})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:b})}catch(_){if(pe(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signInWithSolana(e){var r,i,l,c,d,f,m,g,y,x,j,w;let N,_;if("message"in e)N=e.message,_=e.signature;else{const{chain:b,wallet:L,statement:C,options:T}=e;let I;if(dt())if(typeof L=="object")I=L;else{const F=window;if("solana"in F&&typeof F.solana=="object"&&("signIn"in F.solana&&typeof F.solana.signIn=="function"||"signMessage"in F.solana&&typeof F.solana.signMessage=="function"))I=F.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof L!="object"||!(T!=null&&T.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");I=L}const q=new URL((r=T==null?void 0:T.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in I&&I.signIn){const F=await I.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},T==null?void 0:T.signInWithSolana),{version:"1",domain:q.host,uri:q.href}),C?{statement:C}:null));let G;if(Array.isArray(F)&&F[0]&&typeof F[0]=="object")G=F[0];else if(F&&typeof F=="object"&&"signedMessage"in F&&"signature"in F)G=F;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in G&&"signature"in G&&(typeof G.signedMessage=="string"||G.signedMessage instanceof Uint8Array)&&G.signature instanceof Uint8Array)N=typeof G.signedMessage=="string"?G.signedMessage:new TextDecoder().decode(G.signedMessage),_=G.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in I)||typeof I.signMessage!="function"||!("publicKey"in I)||typeof I!="object"||!I.publicKey||!("toBase58"in I.publicKey)||typeof I.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");N=[`${q.host} wants you to sign in with your Solana account:`,I.publicKey.toBase58(),...C?["",C,""]:[""],"Version: 1",`URI: ${q.href}`,`Issued At: ${(l=(i=T==null?void 0:T.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&l!==void 0?l:new Date().toISOString()}`,...!((c=T==null?void 0:T.signInWithSolana)===null||c===void 0)&&c.notBefore?[`Not Before: ${T.signInWithSolana.notBefore}`]:[],...!((d=T==null?void 0:T.signInWithSolana)===null||d===void 0)&&d.expirationTime?[`Expiration Time: ${T.signInWithSolana.expirationTime}`]:[],...!((f=T==null?void 0:T.signInWithSolana)===null||f===void 0)&&f.chainId?[`Chain ID: ${T.signInWithSolana.chainId}`]:[],...!((m=T==null?void 0:T.signInWithSolana)===null||m===void 0)&&m.nonce?[`Nonce: ${T.signInWithSolana.nonce}`]:[],...!((g=T==null?void 0:T.signInWithSolana)===null||g===void 0)&&g.requestId?[`Request ID: ${T.signInWithSolana.requestId}`]:[],...!((x=(y=T==null?void 0:T.signInWithSolana)===null||y===void 0?void 0:y.resources)===null||x===void 0)&&x.length?["Resources",...T.signInWithSolana.resources.map(G=>`- ${G}`)]:[]].join(`
`);const F=await I.signMessage(new TextEncoder().encode(N),"utf8");if(!F||!(F instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=F}}try{const{data:b,error:L}=await be(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:N,signature:Wn(_)},!((j=e.options)===null||j===void 0)&&j.captchaToken?{gotrue_meta_security:{captcha_token:(w=e.options)===null||w===void 0?void 0:w.captchaToken}}:null),xform:nr});if(L)throw L;if(!b||!b.session||!b.user){const C=new Ps;return this._returnResult({data:{user:null,session:null},error:C})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:L})}catch(b){if(pe(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}}async _exchangeCodeForSession(e){const r=await Dn(this.storage,`${this.storageKey}-code-verifier`),[i,l]=(r??"").split("/");try{const{data:c,error:d}=await be(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:nr});if(await sn(this.storage,`${this.storageKey}-code-verifier`),d)throw d;if(!c||!c.session||!c.user){const f=new Ps;return this._returnResult({data:{user:null,session:null,redirectType:null},error:f})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:Object.assign(Object.assign({},c),{redirectType:l??null}),error:d})}catch(c){if(pe(c))return this._returnResult({data:{user:null,session:null,redirectType:null},error:c});throw c}}async signInWithIdToken(e){try{const{options:r,provider:i,token:l,access_token:c,nonce:d}=e,f=await be(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:l,access_token:c,nonce:d,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:nr}),{data:m,error:g}=f;if(g)return this._returnResult({data:{user:null,session:null},error:g});if(!m||!m.session||!m.user){const y=new Ps;return this._returnResult({data:{user:null,session:null},error:y})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:m,error:g})}catch(r){if(pe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,i,l,c,d;try{if("email"in e){const{email:f,options:m}=e;let g=null,y=null;this.flowType==="pkce"&&([g,y]=await Ts(this.storage,this.storageKey));const{error:x}=await be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:f,data:(r=m==null?void 0:m.data)!==null&&r!==void 0?r:{},create_user:(i=m==null?void 0:m.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:g,code_challenge_method:y},redirectTo:m==null?void 0:m.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:x})}if("phone"in e){const{phone:f,options:m}=e,{data:g,error:y}=await be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:f,data:(l=m==null?void 0:m.data)!==null&&l!==void 0?l:{},create_user:(c=m==null?void 0:m.shouldCreateUser)!==null&&c!==void 0?c:!0,gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},channel:(d=m==null?void 0:m.channel)!==null&&d!==void 0?d:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:g==null?void 0:g.message_id},error:y})}throw new Lo("You must provide either an email or phone number.")}catch(f){if(pe(f))return this._returnResult({data:{user:null,session:null},error:f});throw f}}async verifyOtp(e){var r,i;try{let l,c;"options"in e&&(l=(r=e.options)===null||r===void 0?void 0:r.redirectTo,c=(i=e.options)===null||i===void 0?void 0:i.captchaToken);const{data:d,error:f}=await be(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:c}}),redirectTo:l,xform:nr});if(f)throw f;if(!d)throw new Error("An error occurred on token verification.");const m=d.session,g=d.user;return m!=null&&m.access_token&&(await this._saveSession(m),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",m)),this._returnResult({data:{user:g,session:m},error:null})}catch(l){if(pe(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithSSO(e){var r,i,l,c,d;try{let f=null,m=null;this.flowType==="pkce"&&([f,m]=await Ts(this.storage,this.storageKey));const g=await be(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(i=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&i!==void 0?i:void 0}),!((l=e==null?void 0:e.options)===null||l===void 0)&&l.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:f,code_challenge_method:m}),headers:this.headers,xform:H1});return!((c=g.data)===null||c===void 0)&&c.url&&dt()&&!(!((d=e.options)===null||d===void 0)&&d.skipBrowserRedirect)&&window.location.assign(g.data.url),this._returnResult(g)}catch(f){if(pe(f))return this._returnResult({data:null,error:f});throw f}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:i}=e;if(i)throw i;if(!r)throw new Ut;const{error:l}=await be(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:l})})}catch(e){if(pe(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:i,type:l,options:c}=e,{error:d}=await be(this.fetch,"POST",r,{headers:this.headers,body:{email:i,type:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:d})}else if("phone"in e){const{phone:i,type:l,options:c}=e,{data:d,error:f}=await be(this.fetch,"POST",r,{headers:this.headers,body:{phone:i,type:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:f})}throw new Lo("You must provide either an email or phone number and a type")}catch(r){if(pe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),l=(async()=>(await i,await r()))();return this.pendingInLock.push((async()=>{try{await l}catch{}})()),l}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=r();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const l=[...this.pendingInLock];await Promise.all(l),this.pendingInLock.splice(0,l.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await Dn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const i=e.expires_at?e.expires_at*1e3-Date.now()<nu:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",e.expires_at),!i){if(this.userStorage){const d=await Dn(this.userStorage,this.storageKey+"-user");d!=null&&d.user?e.user=d.user:e.user=au()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const d={value:this.suppressGetSessionWarning};e.user=z1(e.user,d),d.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:l,error:c}=await this._callRefreshToken(e.refresh_token);return c?this._returnResult({data:{session:null},error:c}):this._returnResult({data:{session:l},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:on}):await this._useSession(async r=>{var i,l,c;const{data:d,error:f}=r;if(f)throw f;return!(!((i=d.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ut}:await be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(c=(l=d.session)===null||l===void 0?void 0:l.access_token)!==null&&c!==void 0?c:void 0,xform:on})})}catch(r){if(pe(r))return b1(r)&&(await this._removeSession(),await sn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async i=>{const{data:l,error:c}=i;if(c)throw c;if(!l.session)throw new Ut;const d=l.session;let f=null,m=null;this.flowType==="pkce"&&e.email!=null&&([f,m]=await Ts(this.storage,this.storageKey));const{data:g,error:y}=await be(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:f,code_challenge_method:m}),jwt:d.access_token,xform:on});if(y)throw y;return d.user=g.user,await this._saveSession(d),await this._notifyAllSubscribers("USER_UPDATED",d),this._returnResult({data:{user:d.user},error:null})})}catch(i){if(pe(i))return this._returnResult({data:{user:null},error:i});throw i}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ut;const r=Date.now()/1e3;let i=r,l=!0,c=null;const{payload:d}=iu(e.access_token);if(d.exp&&(i=d.exp,l=i<=r),l){const{data:f,error:m}=await this._callRefreshToken(e.refresh_token);if(m)return this._returnResult({data:{user:null,session:null},error:m});if(!f)return{data:{user:null,session:null},error:null};c=f}else{const{data:f,error:m}=await this._getUser(e.access_token);if(m)throw m;c={access_token:e.access_token,refresh_token:e.refresh_token,user:f.user,token_type:"bearer",expires_in:i-r,expires_at:i},await this._saveSession(c),await this._notifyAllSubscribers("SIGNED_IN",c)}return this._returnResult({data:{user:c.user,session:c},error:null})}catch(r){if(pe(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var i;if(!e){const{data:d,error:f}=r;if(f)throw f;e=(i=d.session)!==null&&i!==void 0?i:void 0}if(!(e!=null&&e.refresh_token))throw new Ut;const{data:l,error:c}=await this._callRefreshToken(e.refresh_token);return c?this._returnResult({data:{user:null,session:null},error:c}):l?this._returnResult({data:{user:l.user,session:l},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(pe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!dt())throw new Mo("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Mo(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new rp("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Mo("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new rp("No code detected.");const{data:C,error:T}=await this._exchangeCodeForSession(e.code);if(T)throw T;const I=new URL(window.location.href);return I.searchParams.delete("code"),window.history.replaceState(window.history.state,"",I.toString()),{data:{session:C.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:l,access_token:c,refresh_token:d,expires_in:f,expires_at:m,token_type:g}=e;if(!c||!f||!d||!g)throw new Mo("No session defined in URL");const y=Math.round(Date.now()/1e3),x=parseInt(f);let j=y+x;m&&(j=parseInt(m));const w=j-y;w*1e3<=Is&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${w}s, should have been closer to ${x}s`);const N=j-x;y-N>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",N,j,y):y-N<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",N,j,y);const{data:_,error:b}=await this._getUser(c);if(b)throw b;const L={provider_token:i,provider_refresh_token:l,access_token:c,expires_in:x,expires_at:j,refresh_token:d,token_type:g,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:L,redirectType:e.type},error:null})}catch(i){if(pe(i))return this._returnResult({data:{session:null,redirectType:null},error:i});throw i}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await Dn(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var i;const{data:l,error:c}=r;if(c)return this._returnResult({error:c});const d=(i=l.session)===null||i===void 0?void 0:i.access_token;if(d){const{error:f}=await this.admin.signOut(d,e);if(f&&!(v1(f)&&(f.status===404||f.status===401||f.status===403)))return this._returnResult({error:f})}return e!=="others"&&(await this._removeSession(),await sn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=C1(),i={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,i),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:i}}}async _emitInitialSession(e){return await this._useSession(async r=>{var i,l;try{const{data:{session:c},error:d}=r;if(d)throw d;await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",c)),this._debug("INITIAL_SESSION","callback id",e,"session",c)}catch(c){await((l=this.stateChangeEmitters.get(e))===null||l===void 0?void 0:l.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",c),console.error(c)}})}async resetPasswordForEmail(e,r={}){let i=null,l=null;this.flowType==="pkce"&&([i,l]=await Ts(this.storage,this.storageKey,!0));try{return await be(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:i,code_challenge_method:l,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(c){if(pe(c))return this._returnResult({data:null,error:c});throw c}}async getUserIdentities(){var e;try{const{data:r,error:i}=await this.getUser();if(i)throw i;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(pe(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:i,error:l}=await this._useSession(async c=>{var d,f,m,g,y;const{data:x,error:j}=c;if(j)throw j;const w=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(d=e.options)===null||d===void 0?void 0:d.redirectTo,scopes:(f=e.options)===null||f===void 0?void 0:f.scopes,queryParams:(m=e.options)===null||m===void 0?void 0:m.queryParams,skipBrowserRedirect:!0});return await be(this.fetch,"GET",w,{headers:this.headers,jwt:(y=(g=x.session)===null||g===void 0?void 0:g.access_token)!==null&&y!==void 0?y:void 0})});if(l)throw l;return dt()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(i==null?void 0:i.url),this._returnResult({data:{provider:e.provider,url:i==null?void 0:i.url},error:null})}catch(i){if(pe(i))return this._returnResult({data:{provider:e.provider,url:null},error:i});throw i}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var i;try{const{error:l,data:{session:c}}=r;if(l)throw l;const{options:d,provider:f,token:m,access_token:g,nonce:y}=e,x=await be(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(i=c==null?void 0:c.access_token)!==null&&i!==void 0?i:void 0,body:{provider:f,id_token:m,access_token:g,nonce:y,link_identity:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:nr}),{data:j,error:w}=x;return w?this._returnResult({data:{user:null,session:null},error:w}):!j||!j.session||!j.user?this._returnResult({data:{user:null,session:null},error:new Ps}):(j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("USER_UPDATED",j.session)),this._returnResult({data:j,error:w}))}catch(l){if(pe(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var i,l;const{data:c,error:d}=r;if(d)throw d;return await be(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(l=(i=c.session)===null||i===void 0?void 0:i.access_token)!==null&&l!==void 0?l:void 0})})}catch(r){if(pe(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const i=Date.now();return await O1(async l=>(l>0&&await R1(200*Math.pow(2,l-1)),this._debug(r,"refreshing attempt",l),await be(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:nr})),(l,c)=>{const d=200*Math.pow(2,l);return c&&su(c)&&Date.now()+d-i<Is})}catch(i){if(this._debug(r,"error",i),pe(i))return this._returnResult({data:{session:null,user:null},error:i});throw i}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const i=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",i),dt()&&!r.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}}async _recoverAndRefresh(){var e,r;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const l=await Dn(this.storage,this.storageKey);if(l&&this.userStorage){let d=await Dn(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!d&&(d={user:l.user},await Ls(this.userStorage,this.storageKey+"-user",d)),l.user=(e=d==null?void 0:d.user)!==null&&e!==void 0?e:au()}else if(l&&!l.user&&!l.user){const d=await Dn(this.storage,this.storageKey+"-user");d&&(d!=null&&d.user)?(l.user=d.user,await sn(this.storage,this.storageKey+"-user"),await Ls(this.storage,this.storageKey,l)):l.user=au()}if(this._debug(i,"session from storage",l),!this._isValidSession(l)){this._debug(i,"session is not valid"),l!==null&&await this._removeSession();return}const c=((r=l.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<nu;if(this._debug(i,`session has${c?"":" not"} expired with margin of ${nu}s`),c){if(this.autoRefreshToken&&l.refresh_token){const{error:d}=await this._callRefreshToken(l.refresh_token);d&&(console.error(d),su(d)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",d),await this._removeSession()))}}else if(l.user&&l.user.__isUserNotAvailableProxy===!0)try{const{data:d,error:f}=await this._getUser(l.access_token);!f&&(d!=null&&d.user)?(l.user=d.user,await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(d){console.error("Error getting user data:",d),this._debug(i,"error getting user data, skipping SIGNED_IN notification",d)}else await this._notifyAllSubscribers("SIGNED_IN",l)}catch(l){this._debug(i,"error",l),console.error(l);return}finally{this._debug(i,"end")}}async _callRefreshToken(e){var r,i;if(!e)throw new Ut;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const l=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(l,"begin");try{this.refreshingDeferred=new rl;const{data:c,error:d}=await this._refreshAccessToken(e);if(d)throw d;if(!c.session)throw new Ut;await this._saveSession(c.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",c.session);const f={data:c.session,error:null};return this.refreshingDeferred.resolve(f),f}catch(c){if(this._debug(l,"error",c),pe(c)){const d={data:null,error:c};return su(c)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(d),d}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(c),c}finally{this.refreshingDeferred=null,this._debug(l,"end")}}async _notifyAllSubscribers(e,r,i=!0){const l=`#_notifyAllSubscribers(${e})`;this._debug(l,"begin",r,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:e,session:r});const c=[],d=Array.from(this.stateChangeEmitters.values()).map(async f=>{try{await f.callback(e,r)}catch(m){c.push(m)}});if(await Promise.all(d),c.length>0){for(let f=0;f<c.length;f+=1)console.error(c[f]);throw c[0]}}finally{this._debug(l,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),i=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&r.user&&await Ls(this.userStorage,this.storageKey+"-user",{user:r.user});const l=Object.assign({},r);delete l.user;const c=op(l);await Ls(this.storage,this.storageKey,c)}else{const l=op(r);await Ls(this.storage,this.storageKey,l)}}async _removeSession(){this._debug("#_removeSession()"),await sn(this.storage,this.storageKey),await sn(this.storage,this.storageKey+"-code-verifier"),await sn(this.storage,this.storageKey+"-user"),this.userStorage&&await sn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&dt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Is);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:i}}=r;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const l=Math.floor((i.expires_at*1e3-e)/Is);this._debug("#_autoRefreshTokenTick()",`access token expires in ${l} ticks, a tick lasts ${Is}ms, refresh threshold is ${Bu} ticks`),l<=Bu&&await this._callRefreshToken(i.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof mx)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!dt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,i){const l=[`provider=${encodeURIComponent(r)}`];if(i!=null&&i.redirectTo&&l.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i!=null&&i.scopes&&l.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[c,d]=await Ts(this.storage,this.storageKey),f=new URLSearchParams({code_challenge:`${encodeURIComponent(c)}`,code_challenge_method:`${encodeURIComponent(d)}`});l.push(f.toString())}if(i!=null&&i.queryParams){const c=new URLSearchParams(i.queryParams);l.push(c.toString())}return i!=null&&i.skipBrowserRedirect&&l.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${e}?${l.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var i;const{data:l,error:c}=r;return c?this._returnResult({data:null,error:c}):await be(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(i=l==null?void 0:l.session)===null||i===void 0?void 0:i.access_token})})}catch(r){if(pe(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var i,l;const{data:c,error:d}=r;if(d)return this._returnResult({data:null,error:d});const f=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:m,error:g}=await be(this.fetch,"POST",`${this.url}/factors`,{body:f,headers:this.headers,jwt:(i=c==null?void 0:c.session)===null||i===void 0?void 0:i.access_token});return g?this._returnResult({data:null,error:g}):(e.factorType==="totp"&&m.type==="totp"&&(!((l=m==null?void 0:m.totp)===null||l===void 0)&&l.qr_code)&&(m.totp.qr_code=`data:image/svg+xml;utf-8,${m.totp.qr_code}`),this._returnResult({data:m,error:null}))})}catch(r){if(pe(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var i;const{data:l,error:c}=r;if(c)return this._returnResult({data:null,error:c});const d=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?lj(e.webauthn.credential_response):cj(e.webauthn.credential_response)})}:{code:e.code}),{data:f,error:m}=await be(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:d,headers:this.headers,jwt:(i=l==null?void 0:l.session)===null||i===void 0?void 0:i.access_token});return m?this._returnResult({data:null,error:m}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+f.expires_in},f)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",f),this._returnResult({data:f,error:m}))})}catch(r){if(pe(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var i;const{data:l,error:c}=r;if(c)return this._returnResult({data:null,error:c});const d=await be(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(i=l==null?void 0:l.session)===null||i===void 0?void 0:i.access_token});if(d.error)return d;const{data:f}=d;if(f.type!=="webauthn")return{data:f,error:null};switch(f.webauthn.type){case"create":return{data:Object.assign(Object.assign({},f),{webauthn:Object.assign(Object.assign({},f.webauthn),{credential_options:Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:aj(f.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},f),{webauthn:Object.assign(Object.assign({},f.webauthn),{credential_options:Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:oj(f.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(pe(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:i}=await this._challenge({factorId:e.factorId});return i?this._returnResult({data:null,error:i}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:i}=await this.getUser();if(i)return{data:null,error:i};const l={all:[],phone:[],totp:[],webauthn:[]};for(const c of(e=r==null?void 0:r.factors)!==null&&e!==void 0?e:[])l.all.push(c),c.status==="verified"&&l[c.factor_type].push(c);return{data:l,error:null}}async _getAuthenticatorAssuranceLevel(){var e,r;const{data:{session:i},error:l}=await this.getSession();if(l)return this._returnResult({data:null,error:l});if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=iu(i.access_token);let d=null;c.aal&&(d=c.aal);let f=d;((r=(e=i.user.factors)===null||e===void 0?void 0:e.filter(y=>y.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(f="aal2");const g=c.amr||[];return{data:{currentLevel:d,nextLevel:f,currentAuthenticationMethods:g},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:i},error:l}=r;return l?this._returnResult({data:null,error:l}):i?await be(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:i.access_token,xform:c=>({data:c,error:null})}):this._returnResult({data:null,error:new Ut})})}catch(r){if(pe(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async i=>{const{data:{session:l},error:c}=i;if(c)return this._returnResult({data:null,error:c});if(!l)return this._returnResult({data:null,error:new Ut});const d=await be(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:l.access_token,body:{action:"approve"},xform:f=>({data:f,error:null})});return d.data&&d.data.redirect_url&&dt()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(d.data.redirect_url),d})}catch(i){if(pe(i))return this._returnResult({data:null,error:i});throw i}}async _denyAuthorization(e,r){try{return await this._useSession(async i=>{const{data:{session:l},error:c}=i;if(c)return this._returnResult({data:null,error:c});if(!l)return this._returnResult({data:null,error:new Ut});const d=await be(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:l.access_token,body:{action:"deny"},xform:f=>({data:f,error:null})});return d.data&&d.data.redirect_url&&dt()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(d.data.redirect_url),d})}catch(i){if(pe(i))return this._returnResult({data:null,error:i});throw i}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:r},error:i}=e;return i?this._returnResult({data:null,error:i}):r?await be(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new Ut})})}catch(e){if(pe(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async r=>{const{data:{session:i},error:l}=r;return l?this._returnResult({data:null,error:l}):i?await be(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:i.access_token,query:{client_id:e.clientId},xform:()=>({data:{},error:null})}):this._returnResult({data:null,error:new Ut})})}catch(r){if(pe(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,r={keys:[]}){let i=r.keys.find(f=>f.kid===e);if(i)return i;const l=Date.now();if(i=this.jwks.keys.find(f=>f.kid===e),i&&this.jwks_cached_at+x1>l)return i;const{data:c,error:d}=await be(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(d)throw d;return!c.keys||c.keys.length===0||(this.jwks=c,this.jwks_cached_at=l,i=c.keys.find(f=>f.kid===e),!i)?null:i}async getClaims(e,r={}){try{let i=e;if(!i){const{data:w,error:N}=await this.getSession();if(N||!w.session)return this._returnResult({data:null,error:N});i=w.session.access_token}const{header:l,payload:c,signature:d,raw:{header:f,payload:m}}=iu(i);r!=null&&r.allowExpired||$1(c.exp);const g=!l.alg||l.alg.startsWith("HS")||!l.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(l.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!g){const{error:w}=await this.getUser(i);if(w)throw w;return{data:{claims:c,header:l,signature:d},error:null}}const y=F1(l.alg),x=await crypto.subtle.importKey("jwk",g,y,!0,["verify"]);if(!await crypto.subtle.verify(y,x,d,k1(`${f}.${m}`)))throw new Wu("Invalid JWT signature");return{data:{claims:c,header:l,signature:d},error:null}}catch(i){if(pe(i))return this._returnResult({data:null,error:i});throw i}}}sa.nextInstanceID={};const yj=sa;class vj extends yj{constructor(e){super(e)}}class bj{constructor(e,r,i){var l,c,d;this.supabaseUrl=e,this.supabaseKey=r;const f=h1(e);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",f),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",f),this.storageUrl=new URL("storage/v1",f),this.functionsUrl=new URL("functions/v1",f);const m=`sb-${f.hostname.split(".")[0]}-auth-token`,g={db:s1,realtime:a1,auth:Object.assign(Object.assign({},i1),{storageKey:m}),global:n1},y=d1(i??{},g);this.storageKey=(l=y.auth.storageKey)!==null&&l!==void 0?l:"",this.headers=(c=y.global.headers)!==null&&c!==void 0?c:{},y.accessToken?(this.accessToken=y.accessToken,this.auth=new Proxy({},{get:(x,j)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(j)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((d=y.auth)!==null&&d!==void 0?d:{},this.headers,y.global.fetch),this.fetch=c1(r,this._getAccessToken.bind(this),y.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},y.realtime)),this.accessToken&&this.accessToken().then(x=>this.realtime.setAuth(x)).catch(x=>console.warn("Failed to set initial Realtime auth token:",x)),this.rest=new fw(new URL("rest/v1",f).href,{headers:this.headers,schema:y.db.schema,fetch:this.fetch}),this.storage=new e1(this.storageUrl.href,this.headers,this.fetch,i==null?void 0:i.storage),y.accessToken||this._listenForAuthEvents()}get functions(){return new cw(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},i={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,r,i)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,r;if(this.accessToken)return await this.accessToken();const{data:i}=await this.auth.getSession();return(r=(e=i.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:i,storage:l,userStorage:c,storageKey:d,flowType:f,lock:m,debug:g,throwOnError:y},x,j){const w={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new vj({url:this.authUrl.href,headers:Object.assign(Object.assign({},w),x),storageKey:d,autoRefreshToken:e,persistSession:r,detectSessionInUrl:i,storage:l,userStorage:c,flowType:f,lock:m,debug:g,throwOnError:y,fetch:j,hasCustomAuthorizationHeader:Object.keys(this.headers).some(N=>N.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new Tw(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,i)=>{this._handleTokenChanged(r,"CLIENT",i==null?void 0:i.access_token)})}_handleTokenChanged(e,r,i){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==i?(this.changedAccessToken=i,this.realtime.setAuth(i)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const wj=(s,e,r)=>new bj(s,e,r);function jj(){if(typeof window<"u"||typeof process>"u")return!1;const s=process.version;if(s==null)return!1;const e=s.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}jj()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const _j="https://strhxqxvsrecfilfojtc.supabase.co",Nj="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN0cmh4cXh2c3JlY2ZpbGZvanRjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM1OTUyNDAsImV4cCI6MjA3OTE3MTI0MH0.DZE2vpUTEqAAIMzT5GUxeV99d98RjDcG-a5IhUtasrI",se=wj(_j,Nj,{auth:{persistSession:!0,autoRefreshToken:!0},db:{schema:"public"},realtime:{params:{eventsPerSecond:10}}}),xx=E.createContext(void 0),Sj=({children:s})=>{const[e,r]=E.useState(null),[i,l]=E.useState(!0),c=E.useCallback(async()=>{l(!0);const{data:m,error:g}=await se.auth.getUser();g&&console.error("Error loading auth user:",g.message),r((m==null?void 0:m.user)??null),l(!1)},[]);E.useEffect(()=>{c();const{data:{subscription:m}}=se.auth.onAuthStateChange((g,y)=>{r((y==null?void 0:y.user)??null),l(!1)});return()=>{m.unsubscribe()}},[c]);const d=E.useCallback(async()=>{const{error:m}=await se.auth.signOut();m&&console.error("Error signing out:",m.message),r(null)},[]),f={user:e,loading:i,signOut:d};return a.jsx(xx.Provider,{value:f,children:s})},nt=()=>{const s=E.useContext(xx);if(!s)throw new Error("useAuth must be used within an AuthProvider");return s},kj=[{key:"home",to:"/",label:"Home",icon:Mb},{key:"swipe",to:"/swipe",label:"Swipe",icon:bg},{key:"messages",to:"/messages",label:"Messages",icon:ua},{key:"search",to:"/search",label:"Search",icon:sd},{key:"diary",to:"/diary",label:"Diary",icon:Ob}];function Ej(s){return s.startsWith("/swipe")?"Swipe":s.startsWith("/messages")?"Messages":s.startsWith("/search")?"Search":s.startsWith("/diary")?"Diary":s.startsWith("/title/")?"Title":s.startsWith("/u/")?"Profile":s.startsWith("/settings/")?"Settings":"Home"}const Cj=()=>{var x,j;const s=lr(),e=Ej(s.pathname),{setLastVisitedTab:r}=rw(),{user:i,signOut:l}=nt(),[c,d]=Ft.useState(!1),f=s.pathname.startsWith("/messages/")&&s.pathname!=="/messages",m=f?"relative z-10 mx-auto flex h-screen w-full max-w-5xl flex-1 flex-col px-0 pt-0 pb-0 sm:px-0 sm:pb-0":"relative z-10 mx-auto flex w-full max-w-5xl flex-1 flex-col px-3 pb-20 pt-3 sm:px-4 sm:pb-24",g=f?"flex items-center justify-between gap-1 px-3 py-1.5 sm:px-4":"mx-auto flex max-w-5xl items-center justify-between gap-1 px-3 py-1.5 sm:px-4",y=w=>{r(w),d(!1)};return a.jsxs("div",{className:"flex min-h-screen flex-col bg-mn-bg text-mn-text-primary",children:[a.jsx("div",{"aria-hidden":"true",className:"pointer-events-none fixed inset-0 bg-[radial-gradient(circle_at_top,_rgba(148,163,253,0.18),_transparent_55%),_radial-gradient(circle_at_bottom,_rgba(248,113,113,0.12),_transparent_55%)]"}),a.jsxs("div",{className:m,children:[!f&&a.jsxs("header",{className:"mb-3 flex items-center justify-between gap-3 rounded-full border border-mn-border-subtle/60 bg-mn-bg-elevated/70 px-3 py-2 shadow-mn-soft backdrop-blur",children:[a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs(We,{to:"/",className:"inline-flex items-center gap-2 rounded-full px-2 py-1 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg",children:[a.jsx("span",{className:"h-7 w-7 rounded-2xl bg-mn-hero p-[2px]",children:a.jsx("span",{className:"flex h-full w-full items-center justify-center rounded-2xl bg-mn-bg-elevated/80",children:a.jsx("img",{src:_g,alt:"MoviNesta logo",className:"h-5 w-5 rounded-full object-contain"})})}),a.jsxs("span",{className:"flex flex-col leading-tight",children:[a.jsx("span",{className:"text-sm font-heading font-semibold tracking-tight",children:"MoviNesta"}),a.jsx("span",{className:"text-[10px] text-mn-text-muted",children:"Your movie life, in one nest."})]})]})}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"hidden text-xs text-mn-text-secondary sm:block",children:a.jsx("span",{className:"font-medium text-mn-text-primary",children:e})}),a.jsxs("div",{className:"relative",children:[a.jsxs("button",{type:"button",onClick:()=>d(w=>!w),className:"flex items-center gap-2 rounded-full border border-mn-border-subtle bg-mn-bg-elevated/80 px-2 py-1 text-xs shadow-mn-soft transition hover:border-mn-border-strong focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg",children:[a.jsx("span",{className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-mn-accent-violet/30 text-[11px] font-semibold text-mn-text-primary",children:((j=(x=i==null?void 0:i.email)==null?void 0:x[0])==null?void 0:j.toUpperCase())??"M"}),a.jsx("span",{className:"hidden text-[11px] font-medium text-mn-text-secondary sm:inline",children:(i==null?void 0:i.email)??"Guest"}),a.jsx(Ib,{className:"h-3 w-3 text-mn-text-muted","aria-hidden":"true"})]}),c&&a.jsxs("div",{className:"absolute right-0 mt-2 w-44 rounded-xl border border-mn-border-subtle bg-mn-bg-elevated/95 p-1 text-xs shadow-mn-card",children:[a.jsx(We,{to:"/settings/profile",className:"flex w-full items-center justify-between rounded-lg px-2 py-1.5 text-left text-mn-text-secondary transition hover:bg-mn-border-subtle/40 hover:text-mn-text-primary",onClick:()=>d(!1),children:a.jsx("span",{children:"Profile"})}),a.jsx(We,{to:"/settings/app",className:"mt-0.5 flex w-full items-center justify-between rounded-lg px-2 py-1.5 text-left text-mn-text-secondary transition hover:bg-mn-border-subtle/40 hover:text-mn-text-primary",onClick:()=>d(!1),children:a.jsx("span",{children:"App settings"})}),a.jsx("button",{type:"button",className:"mt-0.5 flex w-full items-center justify-between rounded-lg px-2 py-1.5 text-left text-mn-error transition hover:bg-mn-error/10",onClick:async()=>{d(!1),await l()},children:a.jsx("span",{children:"Sign out"})})]})]})]})]}),a.jsx("main",{className:"flex-1",children:a.jsx(eg,{})})]}),!f&&a.jsx("nav",{className:"fixed inset-x-0 bottom-0 z-20 border-t border-mn-border-subtle/80 bg-mn-bg/95 backdrop-blur",children:a.jsx("div",{className:g,children:kj.map(w=>{const N=w.icon;return a.jsxs(F0,{to:w.to,onClick:()=>y(w.key),className:({isActive:_})=>["group flex flex-1 flex-col items-center gap-0.5 rounded-full px-2 py-1 text-[10px] font-medium transition","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg",_?"text-mn-primary":"text-mn-text-muted hover:text-mn-text-secondary"].join(" "),"aria-label":w.label,children:[a.jsx("span",{className:"inline-flex h-7 w-7 items-center justify-center rounded-full border border-transparent bg-mn-bg-elevated/80 shadow-mn-soft transition group-[&.active]:border-mn-primary",children:a.jsx(N,{className:"h-4 w-4","aria-hidden":"true"})}),a.jsx("span",{className:"mt-0.5",children:w.label})]},w.to)})})})]})},Pj=()=>{const{user:s,loading:e}=nt(),r=lr();return e?a.jsx("div",{className:"flex min-h-screen items-center justify-center bg-mn-bg text-mn-text-secondary",children:a.jsx("p",{className:"text-sm",children:"Loading your MoviNesta nest"})}):s?a.jsx(eg,{}):a.jsx(k0,{to:"/auth/signin",replace:!0,state:{from:r}})},yx=s=>{E.useEffect(()=>{s?document.title=`${s}  MoviNesta`:document.title="MoviNesta"},[s])},vx=({id:s,label:e,containerClassName:r="space-y-1.5",labelClassName:i="text-xs font-medium text-mn-text-secondary",className:l="w-full rounded-lg border border-mn-border bg-mn-bg-input px-3 py-2 text-sm text-mn-text-primary placeholder:text-mn-text-muted focus:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary/40 focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg",hint:c,error:d,...f})=>{const m=d?`${s}-error`:c?`${s}-hint`:void 0;return a.jsxs("div",{className:r,children:[a.jsx("label",{htmlFor:s,className:i,children:e}),a.jsx("input",{id:s,className:l,"aria-invalid":!!d,"aria-describedby":m,...f}),c&&!d&&a.jsx("p",{id:`${s}-hint`,className:"text-xs text-mn-text-muted",children:c}),d&&a.jsx("p",{id:`${s}-error`,className:"text-xs text-mn-error",children:d})]})},Vu=({id:s,label:e,containerClassName:r="space-y-1",labelClassName:i="text-xs font-medium text-mn-text-secondary",className:l="w-full rounded-lg border border-mn-border bg-mn-bg-elevated/90 px-3 py-2 pr-10 text-sm text-mn-text-primary shadow-sm placeholder:text-mn-text-muted focus:border-mn-primary focus:outline-none focus:ring-2 focus:ring-mn-primary/40",toggleButtonClassName:c="absolute inset-y-0 right-0 flex items-center pr-3 text-[13px] text-mn-text-muted hover:text-mn-text-secondary",ariaLabelBase:d,value:f,...m})=>{const[g,y]=E.useState(!1),x=(d||e||"password").toLowerCase(),j=g?`Hide ${x}`:`Show ${x}`,w=()=>{y(N=>!N)};return a.jsxs("div",{className:r,children:[a.jsx("label",{htmlFor:s,className:i,children:e}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{id:s,type:g?"text":"password",className:l,value:f,...m}),a.jsx("button",{type:"button",onClick:w,className:c,"aria-label":j,children:a.jsx("span",{className:"select-none",children:g?"":""})})]})]})},Tj=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;function Uo(s,e){const r={};return s?Tj.test(s)||(r.email="Please enter a valid email address."):r.email="Email is required.",e||(r.password="Password is required."),r}const Rj=()=>{var _,b;yx("Sign in");const[s,e]=E.useState(""),[r,i]=E.useState(""),[l,c]=E.useState(!1),[d,f]=E.useState({}),[m,g]=E.useState(null),y=Bt(),j=((b=(_=lr().state)==null?void 0:_.from)==null?void 0:b.pathname)??"/",w=!!s&&!!r&&Object.keys(Uo(s,r)).length===0,N=async L=>{L.preventDefault();const C=Uo(s,r);if(Object.keys(C).length>0){f(C),g(null);return}try{c(!0),g(null),f({});const{error:T}=await se.auth.signInWithPassword({email:s,password:r});if(T){const I=T.message==="Invalid login credentials"?"Incorrect email or password. Please try again.":T.message||"Sign-in failed. Please try again.";g(I);return}y(j,{replace:!0})}catch(T){console.error(T),g("Something went wrong while signing you in. Please try again.")}finally{c(!1)}};return a.jsx("div",{className:"flex min-h-screen items-center justify-center bg-mn-bg px-4",children:a.jsxs("div",{className:"w-full max-w-md rounded-mn-card border border-mn-border-subtle/60 bg-mn-bg-elevated/95 p-6 shadow-mn-card backdrop-blur",children:[a.jsxs("div",{className:"mb-6 text-center",children:[a.jsx("h1",{className:"text-lg font-heading font-semibold text-mn-text-primary",children:"Welcome back to MoviNesta"}),a.jsx("p",{className:"mt-2 text-sm text-mn-text-secondary",children:"Sign in to see your diary, feed, and movie matches."})]}),m&&a.jsx("div",{role:"alert",className:"mb-4 rounded-lg border border-mn-error/40 bg-mn-error/10 px-3 py-2 text-xs text-mn-error",children:m}),a.jsxs("form",{onSubmit:N,className:"space-y-4",noValidate:!0,children:[a.jsx(vx,{id:"email",label:"Email address",type:"email",autoComplete:"email",required:!0,value:s,onChange:L=>{e(L.target.value),d.email&&f(C=>({...C,email:void 0}))},onBlur:()=>{const L=Uo(s,r);L.email&&f(C=>({...C,email:L.email}))},disabled:l,error:d.email}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("label",{htmlFor:"password",className:"text-xs font-medium text-mn-text-secondary",children:"Password"}),a.jsx(We,{to:"/auth/forgot-password",className:"text-xs font-medium text-mn-primary hover:underline",children:"Forgot password?"})]}),a.jsx(Vu,{id:"password",label:"",ariaLabelBase:"password",autoComplete:"current-password",required:!0,minLength:6,value:r,onChange:L=>{i(L.target.value),d.password&&f(C=>({...C,password:void 0}))},onBlur:()=>{const L=Uo(s,r);L.password&&f(C=>({...C,password:L.password}))},disabled:l,"aria-invalid":!!d.password,"aria-describedby":d.password?"signin-password-error":void 0}),d.password&&a.jsx("p",{id:"signin-password-error",className:"text-xs text-mn-error",children:d.password})]}),a.jsx("button",{type:"submit",disabled:l||!w,"aria-busy":l,className:"inline-flex w-full items-center justify-center rounded-lg bg-mn-primary px-4 py-2 text-sm font-medium text-white hover:bg-mn-primary-soft disabled:cursor-not-allowed disabled:opacity-60",children:l?"Signing you in":"Sign in"})]}),a.jsxs("div",{className:"mt-4 text-center text-xs text-mn-text-muted",children:[a.jsx("span",{children:"Don't have an account? "}),a.jsx(We,{to:"/auth/signup",className:"font-medium text-mn-primary hover:underline",children:"Create one"})]})]})})},Oj=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,Yi=8;function Vi(s,e,r){const i={};return s?Oj.test(s)||(i.email="Please enter a valid email address."):i.email="Email is required.",e?e.length<Yi&&(i.password=`Password must be at least ${Yi} characters.`):i.password="Password is required.",r?e!==r&&(i.confirm="Passwords do not match."):i.confirm="Please confirm your password.",i}const Aj=()=>{var T,I;const[s,e]=E.useState(""),[r,i]=E.useState(""),[l,c]=E.useState(""),[d,f]=E.useState(!1),[m,g]=E.useState({}),[y,x]=E.useState(null),[j,w]=E.useState(null),N=Bt(),b=((I=(T=lr().state)==null?void 0:T.from)==null?void 0:I.pathname)??"/",L=!!s&&!!r&&!!l&&Object.keys(Vi(s,r,l)).length===0,C=async q=>{q.preventDefault();const F=Vi(s,r,l);if(Object.keys(F).length>0){g(F),x(null),w(null);return}try{f(!0),x(null),w(null),g({});const{data:G,error:B}=await se.auth.signUp({email:s,password:r});if(B){x(B.message||"Sign-up failed. Please check your details and try again.");return}if(!G.session){w("Almost there! Check your email inbox for a confirmation link to activate your account.");return}N(b,{replace:!0})}catch(G){console.error(G),x("Something went wrong while creating your account.")}finally{f(!1)}};return a.jsx("div",{className:"flex min-h-screen items-center justify-center bg-mn-bg px-4",children:a.jsxs("div",{className:"w-full max-w-md rounded-mn-card border border-mn-border-subtle/60 bg-mn-bg-elevated/95 p-6 shadow-mn-card backdrop-blur",children:[a.jsxs("div",{className:"mb-6 text-center",children:[a.jsx("h1",{className:"text-lg font-heading font-semibold text-mn-text-primary",children:"Create your MoviNesta account"}),a.jsx("p",{className:"mt-2 text-sm text-mn-text-secondary",children:"Track what you watch, rate titles, and follow your friends."})]}),y&&a.jsx("div",{role:"alert",className:"mb-4 rounded-lg border border-mn-error/40 bg-mn-error/10 px-3 py-2 text-xs text-mn-error",children:y}),j&&a.jsx("div",{role:"status",className:"mb-4 rounded-lg border border-emerald-400/40 bg-emerald-400/10 px-3 py-2 text-xs text-emerald-800",children:j}),a.jsxs("form",{onSubmit:C,className:"space-y-4",noValidate:!0,children:[a.jsx(vx,{id:"signup-email",label:"Email address",type:"email",autoComplete:"email",required:!0,value:s,onChange:q=>{e(q.target.value),m.email&&g(F=>({...F,email:void 0}))},onBlur:()=>{const q=Vi(s,r,l);q.email&&g(F=>({...F,email:q.email}))},disabled:d,error:m.email}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Vu,{id:"signup-password",label:"Password",ariaLabelBase:"password",autoComplete:"new-password",required:!0,minLength:Yi,value:r,onChange:q=>{i(q.target.value),m.password&&g(F=>({...F,password:void 0}))},onBlur:()=>{const q=Vi(s,r,l);q.password&&g(F=>({...F,password:q.password}))},disabled:d,"aria-invalid":!!m.password,"aria-describedby":m.password?"signup-password-error":"signup-password-hint"}),!m.password&&a.jsxs("p",{id:"signup-password-hint",className:"text-xs text-mn-text-muted",children:["At least ",Yi," characters."]}),m.password&&a.jsx("p",{id:"signup-password-error",className:"text-xs text-mn-error",children:m.password})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Vu,{id:"signup-confirm",label:"Confirm password",ariaLabelBase:"password confirmation",autoComplete:"new-password",required:!0,minLength:Yi,value:l,onChange:q=>{c(q.target.value),m.confirm&&g(F=>({...F,confirm:void 0}))},onBlur:()=>{const q=Vi(s,r,l);q.confirm&&g(F=>({...F,confirm:q.confirm}))},disabled:d,"aria-invalid":!!m.confirm,"aria-describedby":m.confirm?"signup-confirm-error":void 0}),m.confirm&&a.jsx("p",{id:"signup-confirm-error",className:"text-xs text-mn-error",children:m.confirm})]}),a.jsx("button",{type:"submit",disabled:d||!L,"aria-busy":d,className:"inline-flex w-full items-center justify-center rounded-lg bg-mn-primary px-4 py-2 text-sm font-medium text-white hover:bg-mn-primary-soft disabled:cursor-not-allowed disabled:opacity-60",children:d?"Creating your account":"Create account"})]}),a.jsxs("div",{className:"mt-4 text-center text-xs text-mn-text-muted",children:[a.jsx("span",{children:"Already have an account? "}),a.jsx(We,{to:"/auth/signin",className:"font-medium text-mn-primary hover:underline",children:"Sign in instead"})]})]})})},Ij=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,Lj=()=>{const[s,e]=E.useState(""),[r,i]=E.useState(!1),[l,c]=E.useState(null),[d,f]=E.useState(null),m=async g=>{if(g.preventDefault(),c(null),f(null),!s){c("Please enter your email address.");return}if(!Ij.test(s)){c("Please enter a valid email address.");return}i(!0);try{const y=typeof window<"u"?`${window.location.origin}/auth/reset-password`:void 0,{error:x}=await se.auth.resetPasswordForEmail(s,{redirectTo:y});if(x){c(x.message||"We couldn't send the reset email. Please try again in a moment.");return}f("If an account exists for that email, we just sent a password reset link. Please check your inbox.")}catch(y){console.error(y),c("Something went wrong while requesting the reset link.")}finally{i(!1)}};return a.jsx("div",{className:"flex min-h-screen items-center justify-center bg-mn-bg px-4",children:a.jsxs("div",{className:"w-full max-w-md rounded-mn-card border border-mn-border-subtle/60 bg-mn-bg-elevated/95 p-6 shadow-mn-card backdrop-blur",children:[a.jsxs("div",{className:"mb-6 text-center",children:[a.jsx("h1",{className:"text-lg font-heading font-semibold text-mn-text-primary",children:"Forgot your password?"}),a.jsx("p",{className:"mt-2 text-sm text-mn-text-secondary",children:"Enter the email you use for MoviNesta and we'll send you a reset link."})]}),l&&a.jsx("div",{role:"alert",className:"mb-4 rounded-lg border border-mn-error/40 bg-mn-error/10 px-3 py-2 text-xs text-mn-error",children:l}),d&&a.jsx("div",{role:"status",className:"mb-4 rounded-lg border border-emerald-400/40 bg-emerald-400/10 px-3 py-2 text-xs text-emerald-800",children:d}),a.jsxs("form",{onSubmit:m,className:"space-y-4",noValidate:!0,children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{htmlFor:"forgot-email",className:"text-xs font-medium text-mn-text-secondary",children:"Email address"}),a.jsx("input",{id:"forgot-email",type:"email",autoComplete:"email",required:!0,value:s,onChange:g=>e(g.target.value),disabled:r,className:"w-full rounded-lg border border-mn-border bg-mn-bg-input px-3 py-2 text-sm text-mn-text-primary placeholder:text-mn-text-muted focus:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary/40 focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg"})]}),a.jsx("button",{type:"submit",disabled:r||!s,"aria-busy":r,className:"inline-flex w-full items-center justify-center rounded-lg bg-mn-primary px-4 py-2 text-sm font-medium text-white hover:bg-mn-primary-soft disabled:cursor-not-allowed disabled:opacity-60",children:r?"Sending reset link":"Send reset link"})]}),a.jsx("div",{className:"mt-4 text-center text-xs text-mn-text-muted",children:a.jsx(We,{to:"/auth/signin",className:"font-medium text-mn-primary hover:underline",children:"Back to sign in"})})]})})},Hi=8,Mj=()=>{const[s,e]=E.useState(""),[r,i]=E.useState(""),[l,c]=E.useState(!1),[d,f]=E.useState(!0),[m,g]=E.useState(null),[y,x]=E.useState(null),j=Bt();E.useEffect(()=>{let N=!1;return(async()=>{try{const{data:b,error:L}=await se.auth.getUser();if(N)return;(L||!b.user)&&g("This password reset link is invalid or has expired. Please request a new one.")}catch{N||g("We couldn&apos;t verify your reset link. Please request a new one.")}finally{N||f(!1)}})(),()=>{N=!0}},[]);const w=async N=>{if(N.preventDefault(),g(null),x(null),!s||s.length<Hi){g(`Password must be at least ${Hi} characters long.`);return}if(s!==r){g("Passwords do not match.");return}c(!0);try{const{error:_}=await se.auth.updateUser({password:s});if(_){g(_.message||"We couldn&apos;t update your password. Please try again.");return}x("Your password has been updated. Redirecting to sign in"),setTimeout(()=>{j("/auth/signin")},2500)}catch(_){console.error(_),g("Something went wrong while updating your password.")}finally{c(!1)}};return d?a.jsx("div",{className:"flex min-h-screen items-center justify-center bg-mn-bg px-4",children:a.jsx("p",{className:"text-sm text-mn-text-secondary",children:"Checking your reset link"})}):a.jsx("div",{className:"flex min-h-screen items-center justify-center bg-mn-bg px-4",children:a.jsxs("div",{className:"w-full max-w-md rounded-mn-card border border-mn-border-subtle/60 bg-mn-bg-elevated/95 p-6 shadow-mn-card backdrop-blur",children:[a.jsxs("div",{className:"mb-6 text-center",children:[a.jsx("h1",{className:"text-lg font-heading font-semibold text-mn-text-primary",children:"Set a new password"}),a.jsx("p",{className:"mt-2 text-sm text-mn-text-secondary",children:"Choose a new password for your MoviNesta account."})]}),m&&a.jsx("div",{role:"alert",className:"mb-4 rounded-lg border border-mn-error/40 bg-mn-error/10 px-3 py-2 text-xs text-mn-error",children:m}),y&&a.jsx("div",{role:"status",className:"mb-4 rounded-lg border border-emerald-400/40 bg-emerald-400/10 px-3 py-2 text-xs text-emerald-800",children:y}),!y&&a.jsxs("form",{onSubmit:w,className:"space-y-4",noValidate:!0,children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{htmlFor:"reset-password",className:"text-xs font-medium text-mn-text-secondary",children:"New password"}),a.jsx("input",{id:"reset-password",type:"password",autoComplete:"new-password",required:!0,minLength:Hi,value:s,onChange:N=>e(N.target.value),disabled:l,className:"w-full rounded-lg border border-mn-border bg-mn-bg-input px-3 py-2 text-sm text-mn-text-primary placeholder:text-mn-text-muted focus:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary/40 focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg"}),a.jsxs("p",{className:"text-xs text-mn-text-muted",children:["At least ",Hi," characters."]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{htmlFor:"reset-confirm",className:"text-xs font-medium text-mn-text-secondary",children:"Confirm new password"}),a.jsx("input",{id:"reset-confirm",type:"password",autoComplete:"new-password",required:!0,minLength:Hi,value:r,onChange:N=>i(N.target.value),disabled:l,className:"w-full rounded-lg border border-mn-border bg-mn-bg-input px-3 py-2 text-sm text-mn-text-primary placeholder:text-mn-text-muted focus:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary/40 focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg"})]}),a.jsx("button",{type:"submit",disabled:l,"aria-busy":l,className:"inline-flex w-full items-center justify-center rounded-lg bg-mn-primary px-4 py-2 text-sm font-medium text-white hover:bg-mn-primary-soft disabled:cursor-not-allowed disabled:opacity-60",children:l?"Updating password":"Update password"})]}),a.jsx("div",{className:"mt-4 text-center text-xs text-mn-text-muted",children:a.jsx(We,{to:"/auth/signin",className:"font-medium text-mn-primary hover:underline",children:"Back to sign in"})})]})})};function Uj(s,e){var c,d;const r=(s??e??"").trim();if(!r)return"?";const i=r.split(/\s+/);if(i.length>=2){const f=((c=i[0])==null?void 0:c[0])??"",m=((d=i[1])==null?void 0:d[0])??"",g=(f+m).trim();return g?g.toUpperCase():"?"}const l=i[0].replace(/[^A-Za-z0-9]/g,"");return l?l.length===1?l.toUpperCase():(l[0]+l[l.length-1]).toUpperCase():"?"}const Dj={teal:"bg-mn-accent-teal/25 text-mn-accent-teal",violet:"bg-mn-accent-violet/25 text-mn-accent-violet",orange:"bg-mn-primary/20 text-mn-primary"},$j=s=>{const r=((s==null?void 0:s.message)??"").toLowerCase();return r.includes("network")||r.includes("failed to fetch")||r.includes("fetch")?"We couldnt reach the server to load your feed. Check your connection and try again in a moment.":r.includes("unauthorized")||r.includes("401")||r.includes("403")?"We couldnt load your feed because your session may have expired. Try signing out and back in.":"Something went wrong while loading your feed. Please try again."},Fj=s=>{const e=new Map,r=[];s.forEach(l=>{if(l.title){const c=l.title.id,d=e.get(c);d?(d.events.push(l),l.createdAt>d.latestCreatedAt&&(d.latestCreatedAt=l.createdAt)):e.set(c,{title:l.title,events:[l],latestCreatedAt:l.createdAt})}else r.push(l)});const i=[];return e.forEach(l=>{i.push({kind:"titleGroup",id:`group-${l.title.id}`,group:l})}),r.forEach(l=>{i.push({kind:"standalone",id:l.id,event:l})}),i.sort((l,c)=>{const d=l.kind==="titleGroup"?l.group.latestCreatedAt:l.event.createdAt,f=c.kind==="titleGroup"?c.group.latestCreatedAt:c.event.createdAt;return d<f?1:d>f?-1:0}),i},lu=80,Bj=s=>{switch(s){case"rating_created":return"rating";case"review_created":return"review";case"watchlist_added":return"watchlist";case"follow_created":return"follow";default:return null}},zj=s=>{const e=new Date(s);if(Number.isNaN(e.getTime()))return"Recently";const i=new Date().getTime()-e.getTime(),l=Math.floor(i/1e3);if(l<45)return"Just now";const c=Math.floor(l/60);if(c<60)return`${c} min ago`;const d=Math.floor(c/60);if(d<24)return`${d} h ago`;const f=Math.floor(d/24);if(f===1)return"Yesterday";if(f<7)return`${f} days ago`;const m=Math.floor(f/7);if(m<4)return`${m} wk${m===1?"":"s"} ago`;const g=Math.floor(f/30);if(g<12)return`${g} mo${g===1?"":"s"} ago`;const y=Math.floor(f/365);return`${y} yr${y===1?"":"s"} ago`},qj=s=>{let e=0;for(let i=0;i<s.length;i+=1)e+=s.charCodeAt(i);const r=e%3;return r===0?"teal":r===1?"violet":"orange"},Wj=async(s,e=null)=>{var G;const{data:r,error:i}=await se.from("follows").select("followed_id").eq("follower_id",s);i&&console.warn("[HomeFeedTab] Failed to load follows",i.message);const l=(r??[]).map(B=>B.followed_id).filter(B=>!!B),c=Array.from(new Set([s,...l]));if(c.length===0)return{items:[],nextCursor:null,hasMore:!1};let d=se.from("activity_events").select("id, created_at, user_id, event_type, title_id, related_user_id, payload").in("user_id",c).order("created_at",{ascending:!1});e&&(d=d.lt("created_at",e));const{data:f,error:m}=await d.limit(lu+1);if(m)throw new Error(m.message);const g=f??[];if(!g.length)return{items:[],nextCursor:null,hasMore:!1};const y=g.length>lu,x=y?g.slice(0,lu):g,j=Array.from(new Set(x.map(B=>B.title_id).filter(B=>!!B))),w=Array.from(new Set(x.flatMap(B=>[B.user_id,B.related_user_id]).filter(B=>!!B))),[N,_]=await Promise.all([j.length?se.from("titles").select("id, title, year, poster_url").in("id",j):Promise.resolve({data:[],error:null}),w.length?se.from("profiles").select("id, display_name, username, avatar_url").in("id",w):Promise.resolve({data:[],error:null})]);N.error&&console.warn("[HomeFeedTab] Failed to load titles for feed",N.error.message),_.error&&console.warn("[HomeFeedTab] Failed to load profiles for feed",_.error.message);const b=new Map;(N.data??[]).forEach(B=>{b.set(B.id,B)});const C=new Map;(_.data??[]).forEach(B=>{C.set(B.id,B)});const I=[];x.forEach(B=>{const ae=Bj(B.event_type);if(!ae)return;const Y=C.get(B.user_id)??null,xe=B.related_user_id?C.get(B.related_user_id)??null:null,ee=(Y==null?void 0:Y.display_name)??(Y==null?void 0:Y.username)??"Someone",ue=(Y==null?void 0:Y.username)??(Y==null?void 0:Y.display_name)??"",Se={id:B.user_id,displayName:ee,username:ue,avatarInitials:Uj(ee||ue||"S"),avatarColor:qj(B.user_id)},we=B.title_id?b.get(B.title_id)??null:null,Ce=we?{id:B.title_id,name:we.title??"Untitled",year:we.year??new Date().getFullYear(),posterUrl:we.poster_url??void 0}:void 0,je=B.payload??{};let K,le,Z=je.extra,O=je.emoji;(ae==="rating"||ae==="review")&&(K=typeof je.rating=="number"?je.rating:void 0,le=je.review_snippet),ae==="follow"&&(B.related_user_id===s?Z="started following you":xe?Z=`started following ${xe.display_name??xe.username??"someone"}`:Z||(Z="started following someone")),I.push({id:B.id,type:ae,createdAt:B.created_at,createdAtLabel:zj(B.created_at),user:Se,title:Ce,rating:K,reviewSnippet:le,extra:Z,emoji:O})});const q=Fj(I),F=y?((G=x[x.length-1])==null?void 0:G.created_at)??null:null;return{items:q,nextCursor:F,hasMore:y}},Vj=()=>{const{user:s}=nt(),{data:e,isLoading:r,isFetching:i,error:l,fetchNextPage:c,isFetchingNextPage:d,hasNextPage:f}=kb({queryKey:["home-feed",s==null?void 0:s.id],enabled:!!(s!=null&&s.id),initialPageParam:null,queryFn:async({pageParam:x})=>s!=null&&s.id?Wj(s.id,x):{items:[],nextCursor:null,hasMore:!1},getNextPageParam:x=>x.hasMore?x.nextCursor:null}),m=E.useMemo(()=>((e==null?void 0:e.pages)??[]).flatMap(x=>x.items),[e]),g=E.useMemo(()=>m.length>0?m:[],[m]),y=l?$j(l):null;return l&&console.error("[HomeFeedTab] Failed to load feed",l),{items:g,isLoading:r||!e&&i,isLoadingMore:d,hasMore:!!f,error:y,loadMore:()=>{f&&c()}}},Hj=(s,e)=>{if(e==="all")return!0;const r=i=>{switch(e){case"reviews":return i.type==="review";case"ratings":return i.type==="rating";case"watchlist":return i.type==="watchlist";case"follows":return i.type==="follow";case"recommendations":return i.type==="recommendation";default:return!0}};return s.kind==="standalone"?r(s.event):s.group.events.some(r)},Kj=({isFiltersSheetOpen:s=!1,onFiltersSheetOpenChange:e})=>{const{items:r,isLoading:i,isLoadingMore:l,hasMore:c,error:d,loadMore:f}=Vj(),[m,g]=E.useState("all"),y=E.useMemo(()=>r.filter(x=>Hj(x,m)),[r,m]);return a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[a.jsx("div",{className:"inline-flex flex-wrap gap-1 text-[11px]",children:[["all","All"],["reviews","Reviews"],["ratings","Ratings"],["watchlist","Watchlist"],["follows","Follows"],["recommendations","Recs"]].map(([x,j])=>{const w=m===x;return a.jsxs("button",{type:"button","aria-pressed":w,onClick:()=>g(x),className:["inline-flex items-center gap-1 rounded-full border px-2.5 py-1 transition",w?"border-mn-primary bg-mn-primary/15 text-mn-primary":"border-mn-border-subtle/70 bg-mn-bg/80 text-mn-text-muted hover:text-mn-text-secondary"].join(" "),children:[x==="recommendations"?a.jsx(lt,{className:"h-3 w-3","aria-hidden":"true"}):x==="follows"?a.jsx(ta,{className:"h-3 w-3","aria-hidden":"true"}):x==="watchlist"?a.jsx(rs,{className:"h-3 w-3","aria-hidden":"true"}):x==="ratings"?a.jsx(yr,{className:"h-3 w-3","aria-hidden":"true"}):x==="reviews"?a.jsx(ht,{className:"h-3 w-3","aria-hidden":"true"}):null,a.jsx("span",{children:j})]},x)})}),a.jsx("p",{className:"text-[11px] text-mn-text-muted",children:i?"Loading your feed":`${y.length} story${y.length===1?"":"ies"}`})]}),s&&a.jsx("div",{className:"fixed inset-0 z-30 flex items-end justify-center bg-black/40 sm:items-center",onClick:()=>e==null?void 0:e(!1),children:a.jsxs("div",{role:"dialog","aria-modal":"true","aria-label":"Filter home feed",className:"w-full max-w-sm rounded-t-3xl bg-mn-bg-elevated p-3 pb-4 shadow-mn-soft sm:rounded-3xl",onClick:x=>x.stopPropagation(),children:[a.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[a.jsx("h2",{className:"text-[12px] font-semibold text-mn-text-primary",children:"Feed filters"}),a.jsx("button",{type:"button",onClick:()=>e==null?void 0:e(!1),className:"text-[11px] text-mn-text-muted hover:text-mn-text-secondary",children:"Close"})]}),a.jsx("div",{className:"flex flex-wrap gap-1 text-[11px]",children:[["all","All"],["reviews","Reviews"],["ratings","Ratings"],["watchlist","Watchlist"],["follows","Follows"],["recommendations","Recs"]].map(([x,j])=>{const w=m===x;return a.jsxs("button",{type:"button","aria-pressed":w,onClick:()=>{g(x),e==null||e(!1)},className:["inline-flex items-center gap-1 rounded-full border px-2.5 py-1 transition",w?"border-mn-primary bg-mn-primary/15 text-mn-primary":"border-mn-border-subtle/70 bg-mn-bg/80 text-mn-text-muted hover:text-mn-text-secondary"].join(" "),children:[x==="recommendations"?a.jsx(lt,{className:"h-3 w-3","aria-hidden":"true"}):x==="follows"?a.jsx(ta,{className:"h-3 w-3","aria-hidden":"true"}):x==="watchlist"?a.jsx(rs,{className:"h-3 w-3","aria-hidden":"true"}):x==="ratings"?a.jsx(yr,{className:"h-3 w-3","aria-hidden":"true"}):x==="reviews"?a.jsx(ht,{className:"h-3 w-3","aria-hidden":"true"}):null,a.jsx("span",{children:j})]},x)})})]})}),d&&a.jsx("div",{role:"alert",className:"rounded-2xl border border-mn-error/50 bg-mn-error/10 px-3 py-2 text-[11px] text-mn-error",children:d}),i?a.jsx(Jj,{}):y.length===0?a.jsx(Yj,{}):a.jsxs("div",{className:"space-y-3",children:[y.map(x=>x.kind==="titleGroup"?a.jsx(Qj,{group:x.group},x.id):a.jsx(Gj,{event:x.event},x.id)),c&&a.jsx("div",{className:"pt-1",children:a.jsx("button",{type:"button",onClick:f,disabled:l,className:"mx-auto flex items-center justify-center rounded-full border border-mn-border-subtle bg-mn-bg-elevated px-3 py-1.5 text-[11px] text-mn-text-secondary shadow-mn-soft disabled:opacity-60",children:l?"Loading more...":"Load more"})})]})]})},Qj=({group:s})=>{const e=E.useMemo(()=>[...s.events].sort((m,g)=>m.createdAt<g.createdAt?1:m.createdAt>g.createdAt?-1:0),[s.events]),r=e[0],i=e.slice(1),l=e.some(m=>m.type==="review"),c=e.some(m=>m.type==="rating"),d=e.some(m=>m.type==="watchlist"),f=e.some(m=>m.type==="recommendation");return a.jsxs("article",{className:"flex gap-3 rounded-mn-card border border-mn-border-subtle/85 bg-mn-bg-elevated/85 p-3 text-[11px] shadow-mn-card",children:[a.jsxs(We,{to:`/title/${s.title.id}`,className:"relative flex h-24 w-16 shrink-0 overflow-hidden rounded-mn-card bg-mn-bg/80 shadow-mn-card focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg",children:[s.title.posterUrl?a.jsx("img",{src:s.title.posterUrl,alt:s.title.name,className:"h-full w-full object-cover"}):a.jsx("div",{className:"h-full w-full bg-gradient-to-br from-mn-accent-violet/45 via-mn-bg/40 to-mn-primary/75"}),a.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-t from-black/65 via-black/20 to-transparent"}),a.jsxs("div",{className:"pointer-events-none absolute bottom-1 left-1 right-1 space-y-0.5 px-1.5",children:[a.jsx("span",{className:"block text-[9px] font-semibold uppercase tracking-[0.18em] text-mn-primary-soft",children:s.title.year}),a.jsx("span",{className:"block text-[10px] font-medium text-mn-bg line-clamp-3 drop-shadow",children:s.title.name})]})]}),a.jsxs("div",{className:"flex min-w-0 flex-1 flex-col gap-2",children:[a.jsxs("header",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{className:"min-w-0 space-y-0.5",children:[a.jsx("h2",{className:"truncate text-[13px] font-heading font-semibold text-mn-text-primary",children:s.title.name}),a.jsxs("p",{className:"flex flex-wrap items-center gap-1 text-[10px] text-mn-text-muted",children:[a.jsx("span",{children:s.title.year}),l&&a.jsx(Do,{children:"Review"}),c&&a.jsx(Do,{children:"Rating"}),d&&a.jsx(Do,{children:"Watchlist"}),f&&a.jsx(Do,{children:"Trending"})]})]}),a.jsx("button",{type:"button",className:"inline-flex h-7 w-7 items-center justify-center rounded-full border border-mn-border-subtle/70 bg-mn-bg/80 text-mn-text-muted hover:border-mn-primary/70 hover:text-mn-text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg","aria-label":"More options",children:a.jsx(Lb,{className:"h-3.5 w-3.5","aria-hidden":"true"})})]}),a.jsxs("div",{className:"space-y-1.5",children:[r&&a.jsx(wx,{event:r}),i.length>0&&a.jsxs("p",{className:"text-[10px] text-mn-text-muted",children:["+",i.length," more activity item",i.length===1?"":"s"," on this title"]})]}),a.jsx(jx,{titleId:s.title.id})]})]})},Gj=({event:s})=>s.type==="follow"?a.jsxs("article",{className:"flex items-center gap-3 rounded-mn-card border border-mn-border-subtle/80 bg-mn-bg-elevated/85 p-3 text-[11px] shadow-mn-card",children:[a.jsx(bx,{user:s.user}),a.jsxs("div",{className:"flex-1 space-y-0.5",children:[a.jsxs("p",{className:"text-[11px] text-mn-text-secondary",children:[a.jsx("span",{className:"font-medium text-mn-text-primary",children:s.user.displayName})," ",a.jsx("span",{children:s.extra??"started following you"})]}),a.jsx("p",{className:"text-[10px] text-mn-text-muted",children:s.createdAtLabel})]}),a.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full border border-mn-primary/70 bg-mn-primary/15 px-3 py-1 text-[11px] font-medium text-mn-primary hover:bg-mn-primary/25 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg",children:[a.jsx(ta,{className:"h-3.5 w-3.5","aria-hidden":"true"}),a.jsx("span",{children:"Follow back"})]})]}):a.jsxs("article",{className:"rounded-mn-card border border-mn-border-subtle/80 bg-mn-bg-elevated/85 p-3 text-[11px] shadow-mn-card",children:[a.jsx(wx,{event:s}),a.jsx(jx,{})]}),bx=({user:s})=>{const e=Dj[s.avatarColor];return a.jsx("div",{className:["inline-flex h-8 w-8 items-center justify-center rounded-full text-[11px] font-semibold",e].join(" "),"aria-hidden":"true",children:s.avatarInitials})},Do=({children:s})=>a.jsx("span",{className:"inline-flex items-center rounded-full bg-mn-bg/80 px-2 py-0.5 text-[9px] font-medium text-mn-text-muted",children:s}),wx=({event:s})=>{var c,d;const{user:e}=s;let r=null,i=null,l=null;return s.type==="review"?(r=a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"font-medium text-mn-text-primary",children:e.displayName})," ","logged a review"]}),i=a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-mn-bg/80 px-2 py-0.5 text-[10px] text-mn-text-secondary",children:[a.jsx(yr,{className:"h-3 w-3 text-mn-primary","aria-hidden":"true"}),a.jsx("span",{children:((c=s.rating)==null?void 0:c.toFixed(1))??""})]}),l=s.reviewSnippet?a.jsxs("p",{className:"mt-0.5 line-clamp-2 text-[10px] text-mn-text-secondary",children:["",s.reviewSnippet,""]}):null):s.type==="rating"?(r=a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"font-medium text-mn-text-primary",children:e.displayName})," ","rated it"]}),i=a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-mn-bg/80 px-2 py-0.5 text-[10px] text-mn-text-secondary",children:[a.jsx(yr,{className:"h-3 w-3 text-mn-primary","aria-hidden":"true"}),a.jsx("span",{children:((d=s.rating)==null?void 0:d.toFixed(1))??""})]})):s.type==="watchlist"?(r=a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"font-medium text-mn-text-primary",children:e.displayName})," ","added this to their Watchlist"]}),i=a.jsx(rs,{className:"h-3.5 w-3.5 text-mn-primary","aria-hidden":"true"})):s.type==="recommendation"?(r=a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"font-medium text-mn-text-primary",children:"MoviNesta"})," recommends this title"]}),i=a.jsx(lt,{className:"h-3.5 w-3.5 text-mn-primary","aria-hidden":"true"}),l=s.extra?a.jsx("p",{className:"mt-0.5 text-[10px] text-mn-text-secondary",children:s.extra}):null):s.type==="follow"&&(r=a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"font-medium text-mn-text-primary",children:e.displayName})," ",s.extra??"started following you"]})),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(bx,{user:e}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsxs("p",{className:"flex flex-wrap items-center gap-1 text-[11px] text-mn-text-secondary",children:[r,i]}),l,a.jsxs("p",{className:"mt-0.5 text-[10px] text-mn-text-muted",children:[s.createdAtLabel,s.emoji?a.jsx("span",{className:"ml-1",children:s.emoji}):null]})]})]})},jx=({titleId:s})=>a.jsxs("div",{className:"mt-2 flex items-center justify-between gap-2 text-[11px] text-mn-text-muted",children:[a.jsxs("div",{className:"inline-flex items-center gap-1",children:[a.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-full border border-mn-border-subtle/70 bg-mn-bg/80 px-2 py-1 hover:border-mn-primary/70 hover:text-mn-text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg","aria-label":"React with thumbs up",children:a.jsx(da,{className:"h-3.5 w-3.5","aria-hidden":"true"})}),a.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-full border border-mn-border-subtle/70 bg-mn-bg/80 px-2 py-1 hover:border-mn-primary/70 hover:text-mn-text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg","aria-label":"React with sparkles",children:a.jsx(lt,{className:"h-3.5 w-3.5","aria-hidden":"true"})})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full border border-mn-border-subtle/70 bg-mn-bg/80 px-2.5 py-1 text-[11px] hover:border-mn-primary/70 hover:text-mn-text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg",children:[a.jsx(ua,{className:"h-3.5 w-3.5","aria-hidden":"true"}),a.jsx("span",{children:"Comments"})]}),s&&a.jsx(We,{to:`/title/${s}`,className:"text-[11px] font-medium text-mn-text-secondary hover:text-mn-primary hover:underline",children:"Open"})]})]}),Jj=()=>a.jsx("div",{className:"space-y-3",children:[0,1,2].map(s=>a.jsxs("div",{className:"flex animate-pulse gap-3 rounded-mn-card border border-mn-border-subtle/80 bg-mn-bg-elevated/80 p-3",children:[a.jsx("div",{className:"h-24 w-16 rounded-xl bg-mn-border-subtle/60"}),a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx("div",{className:"h-3 w-2/3 rounded-full bg-mn-border-subtle/60"}),a.jsx("div",{className:"h-3 w-1/3 rounded-full bg-mn-border-subtle/40"}),a.jsx("div",{className:"h-3 w-full rounded-full bg-mn-border-subtle/40"}),a.jsx("div",{className:"h-3 w-5/6 rounded-full bg-mn-border-subtle/30"})]})]},s))}),Yj=()=>a.jsx("div",{className:"flex min-h-[40vh] items-center justify-center px-2",children:a.jsxs("div",{className:"max-w-sm rounded-mn-card border border-mn-border-subtle/80 bg-mn-bg-elevated/90 px-5 py-6 text-center text-[11px] text-mn-text-secondary shadow-mn-card",children:[a.jsx("div",{className:"mx-auto mb-3 flex h-10 w-10 items-center justify-center rounded-2xl bg-mn-primary/15",children:a.jsx(lt,{className:"h-5 w-5 text-mn-primary","aria-hidden":"true"})}),a.jsx("h2",{className:"text-sm font-heading font-semibold text-mn-text-primary",children:"Your feed is warming up"}),a.jsx("p",{className:"mt-1 text-[11px] text-mn-text-secondary",children:"As you follow friends, rate titles, and add to your Watchlist, this feed will turn into a cozy stream of movie moments."}),a.jsxs("p",{className:"mt-2 text-[10px] text-mn-text-muted",children:["Tip: head to ",a.jsx("span",{className:"font-medium text-mn-text-primary",children:"Swipe"})," or"," ",a.jsx("span",{className:"font-medium text-mn-text-primary",children:"Search"})," to start filling your nest."]})]})}),Xj=s=>{const r=((s==null?void 0:s.message)??"").toLowerCase();return r.includes("network")||r.includes("failed to fetch")||r.includes("fetch")?"We couldnt reach the server to load your recommendations. Check your connection and try again.":r.includes("unauthorized")||r.includes("401")||r.includes("403")?"We couldnt load your recommendations because your session may have expired. Try signing out and back in.":"Something went wrong while loading your recommendations. Please try again."},Zj=async s=>{const[e,r,i]=await Promise.all([se.from("follows").select("followed_id").eq("follower_id",s),se.from("ratings").select("title_id, rating, created_at").eq("user_id",s).order("created_at",{ascending:!1}).limit(40),se.from("library_entries").select("title_id, status, updated_at").eq("user_id",s).order("updated_at",{ascending:!1}).limit(40)]);let l=!1;if(r.error)throw new Error(r.error.message);if(i.error)throw new Error(i.error.message);const c=e.error;c&&(l=!0,console.warn("[HomeForYouTab] Failed to load follows",c.message));const d=r.data??[],f=i.data??[],g=(e.data??[]).map(ee=>ee.followed_id).filter(ee=>!!ee)??[],y=d.find(ee=>(ee.rating??0)>=4)??d[0]??null,x=(y==null?void 0:y.title_id)??null;let j=[];if(g.length>0){const{data:ee,error:ue}=await se.from("ratings").select("title_id, user_id, created_at").in("user_id",g).order("created_at",{ascending:!1}).limit(30);ue&&(l=!0,console.warn("[HomeForYouTab] Failed to load friend ratings",ue.message)),j=ee??[]}const w=[];j.forEach(ee=>{ee.title_id&&(w.includes(ee.title_id)||w.push(ee.title_id))});const N=[];x&&f.forEach(ee=>{ee.title_id&&ee.title_id!==x&&(ee.status==="want_to_watch"||ee.status==="watching")&&(N.includes(ee.title_id)||N.push(ee.title_id))});const _=[];f.forEach(ee=>{ee.title_id&&(ee.status==="watching"||ee.status==="want_to_watch")&&(_.includes(ee.title_id)||_.push(ee.title_id))});const b=await se.from("titles").select("id, title, year, runtime_minutes, type, poster_url").eq("type","anime").order("year",{ascending:!1}).limit(16);b.error&&(l=!0,console.warn("[HomeForYouTab] Failed to load anime titles",b.error.message));const L=b.data??[],C=L.map(ee=>ee.id),T=Array.from(new Set([...x?[x]:[],...w,...N,..._,...C]));if(!T.length)return{tonightPick:null,sections:[],hasPartialData:l};const I=await se.from("titles").select("id, title, year, runtime_minutes, type, poster_url").in("id",T);if(I.error)throw new Error(I.error.message);const q=I.data??[],F=new Map;q.forEach(ee=>{F.set(ee.id,ee)});let G=null;if(x&&F.has(x)){const ee=F.get(x),ue=(y==null?void 0:y.rating)??null;G={id:ee.id,name:ee.title??"Untitled",year:ee.year??new Date().getFullYear(),runtimeMinutes:ee.runtime_minutes??void 0,matchReason:ue&&ue>=4?"Because you gave this a high rating.":"Based on your recent diary activity.",moodTag:ee.type==="anime"?"Anime night":"Cinematic night",logline:void 0,moodLine:ee.type==="anime"?"Animated, emotional, and perfect for a late-night binge.":"Feels like the right vibe for tonight based on your recent watches.",friendsWatchingCount:j.filter(Se=>Se.title_id===x).length,posterUrl:ee.poster_url??null}}const B=[],ae=[];if(w.slice(0,12).forEach(ee=>{const ue=F.get(ee);if(!ue)return;const Se=j.filter(we=>we.title_id===ee).length;ae.push({id:ue.id,name:ue.title??"Untitled",year:ue.year??new Date().getFullYear(),friendsWatchingCount:Se,moodTag:ue.type==="anime"?"Anime night":"Friends love this",posterUrl:ue.poster_url??null})}),ae.length>0&&B.push({id:"friends-trending",kind:"friends-trending",title:"Trending with friends",subtitle:"What your circle has been rating and logging recently.",pillLabel:"Social picks",items:ae}),x&&F.has(x)&&N.length>0){const ee=F.get(x),ue=[];N.slice(0,12).forEach(Se=>{const we=F.get(Se);we&&ue.push({id:we.id,name:we.title??"Untitled",year:we.year??new Date().getFullYear(),matchReason:`On your watchlist after ${ee.title??"that favorite"}.`,posterUrl:we.poster_url??null})}),ue.length>0&&B.push({id:"because-you-liked",kind:"because-you-liked",title:`Because you liked ${ee.title??"this"}`,subtitle:"Watchlist picks tuned by your recent favorites.",pillLabel:"Taste match",items:ue})}const Y=[];L.slice(0,12).forEach(ee=>{Y.push({id:ee.id,name:ee.title??"Untitled",year:ee.year??new Date().getFullYear(),matchReason:"Anime in your catalog and trending in MoviNesta.",posterUrl:ee.poster_url??null})}),Y.length>0&&B.push({id:"popular-anime",kind:"anime",title:"Popular anime right now",subtitle:"Heart-punching stories, cozy vibes, and a bit of chaos.",pillLabel:"Anime corner",items:Y});const xe=[];return _.slice(0,12).forEach(ee=>{const ue=F.get(ee);if(!ue)return;const Se=f.find(Ce=>Ce.title_id===ee);let we;(Se==null?void 0:Se.status)==="watching"?we="In progress  pick up where you left off.":(Se==null?void 0:Se.status)==="want_to_watch"&&(we="On your Watchlist and waiting for a good night."),xe.push({id:ue.id,name:ue.title??"Untitled",year:ue.year??new Date().getFullYear(),runtimeMinutes:ue.runtime_minutes??void 0,matchReason:we,posterUrl:ue.poster_url??null})}),xe.length>0&&B.push({id:"continue",kind:"continue",title:"Continue swiping / watching",subtitle:"Pick up right where your last movie night left off.",pillLabel:"On deck",items:xe}),{tonightPick:G,sections:B,hasPartialData:l}},e_=()=>{const{user:s}=nt(),{data:e,isLoading:r,isFetching:i,error:l}=_t({queryKey:["home-for-you",s==null?void 0:s.id],enabled:!!(s!=null&&s.id),queryFn:async()=>s!=null&&s.id?Zj(s.id):{tonightPick:null,sections:[],hasPartialData:!1}}),c=l?Xj(l):null;return l&&console.error("[HomeForYouTab] Failed to load recommendations",l),{isLoading:r||i,error:c,tonightPick:(e==null?void 0:e.tonightPick)??null,sections:(e==null?void 0:e.sections)??[],hasPartialData:(e==null?void 0:e.hasPartialData)??!1}},t_=()=>{const{isLoading:s,error:e,tonightPick:r,sections:i,hasPartialData:l}=e_(),c=!!r||i.length>0;return a.jsxs("div",{className:"space-y-4",children:[e&&a.jsx("div",{role:"alert",className:"rounded-2xl border border-mn-error/60 bg-mn-error/10 px-3 py-2 text-[11px] text-mn-error",children:e}),s?a.jsx(i_,{}):r?a.jsx(r_,{pick:r}):a.jsx(o_,{}),s&&a.jsx(a_,{}),!s&&i.length>0&&a.jsx("div",{className:"space-y-3",children:i.map(d=>a.jsx(n_,{section:d},d.id))}),!s&&l&&!e&&a.jsx("p",{className:"rounded-2xl border border-mn-border-soft bg-mn-surface-soft px-3 py-2 text-[11px] text-mn-text-secondary",children:"Some rows might be missing while we catch up on your follows and anime data, but your main recommendations are still here."}),!s&&!c&&a.jsx(l_,{})]})},r_=({pick:s})=>a.jsxs("section",{className:"rounded-mn-card border border-mn-border-subtle bg-mn-bg-elevated/95 p-4 text-[11px] text-mn-text-secondary shadow-mn-card",children:[a.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full bg-mn-primary/15 px-2.5 py-0.5 text-[10px] font-medium text-mn-primary",children:[a.jsx(lt,{className:"h-3.5 w-3.5","aria-hidden":"true"}),a.jsx("span",{children:"Tonight's pick for you"})]}),s.runtimeMinutes?a.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full bg-mn-bg/80 px-2 py-0.5 text-[10px] text-mn-text-muted",children:[a.jsx(jn,{className:"h-3 w-3","aria-hidden":"true"}),a.jsxs("span",{children:[s.runtimeMinutes," min"]})]}):null]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs(We,{to:`/title/${s.id}`,className:"relative flex h-28 w-20 shrink-0 overflow-hidden rounded-mn-card bg-mn-bg/80 shadow-mn-card focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg",children:[s.posterUrl?a.jsx("img",{src:s.posterUrl,alt:s.name,className:"h-full w-full object-cover"}):a.jsx("div",{className:"h-full w-full bg-gradient-to-br from-mn-accent-violet/45 via-mn-bg/40 to-mn-primary/75"}),a.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-t from-black/65 via-black/20 to-transparent"}),a.jsxs("div",{className:"pointer-events-none absolute bottom-1 left-1 right-1 space-y-0.5 px-1.5",children:[a.jsx("span",{className:"inline-flex items-center rounded-full bg-mn-bg/80 px-2 py-0.5 text-[9px] font-semibold uppercase tracking-[0.18em] text-mn-primary-soft",children:s.year}),a.jsx("span",{className:"block text-[11px] font-heading font-semibold text-mn-bg line-clamp-3 drop-shadow",children:s.name})]})]}),a.jsxs("div",{className:"min-w-0 flex-1 space-y-1",children:[a.jsxs("h2",{className:"text-[13px] font-heading font-semibold text-mn-text-primary",children:["Movie night mood: ",s.moodTag??"Surprise me"]}),s.logline&&a.jsx("p",{className:"text-[11px] text-mn-text-secondary line-clamp-3",children:s.logline}),s.moodLine&&a.jsx("p",{className:"text-[10px] text-mn-text-muted",children:s.moodLine}),a.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[a.jsxs("button",{type:"button",className:"inline-flex items-center gap-1.5 rounded-full bg-mn-primary px-3 py-1.5 text-[11px] font-medium text-mn-bg shadow-mn-soft hover:bg-mn-primary/90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg",children:[a.jsx(Wb,{className:"h-3.5 w-3.5","aria-hidden":"true"}),a.jsx("span",{children:"Add to Watchlist"})]}),a.jsxs("button",{type:"button",className:"inline-flex items-center gap-1.5 rounded-full border border-mn-border-subtle bg-mn-bg/80 px-3 py-1.5 text-[11px] text-mn-text-secondary hover:border-mn-primary/70 hover:text-mn-text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg",children:[a.jsx(wg,{className:"h-3.5 w-3.5","aria-hidden":"true"}),a.jsx("span",{children:"Why this pick?"})]})]}),a.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-3 text-[10px] text-mn-text-muted",children:[s.friendsWatchingCount?a.jsxs("span",{className:"inline-flex items-center gap-1",children:[a.jsx(Ot,{className:"h-3 w-3","aria-hidden":"true"}),a.jsxs("span",{children:["Watched by ",s.friendsWatchingCount," friend(s)"]})]}):null,s.matchReason&&a.jsxs("span",{className:"line-clamp-1",children:[a.jsx("span",{className:"font-medium text-mn-text-secondary",children:"Because: "}),s.matchReason]})]})]})]})]}),n_=({section:s})=>s.items.length?a.jsxs("section",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-baseline justify-between gap-2",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("h3",{className:"text-[12px] font-heading font-semibold text-mn-text-primary",children:s.title}),s.pillLabel&&a.jsx("span",{className:"inline-flex items-center rounded-full bg-mn-bg-elevated/80 px-2 py-0.5 text-[9px] text-mn-text-muted",children:s.pillLabel})]}),s.subtitle&&a.jsx("p",{className:"mt-0.5 text-[10px] text-mn-text-secondary line-clamp-2",children:s.subtitle})]}),a.jsxs("button",{type:"button","aria-label":`See all for ${s.title}`,className:"inline-flex items-center gap-1 rounded-full border border-mn-border-subtle/80 bg-mn-bg/80 px-2.5 py-1 text-[10px] text-mn-text-secondary hover:border-mn-primary/70 hover:text-mn-text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg",children:[a.jsx("span",{children:"See all"}),a.jsx(vg,{className:"h-3 w-3","aria-hidden":"true"})]})]}),a.jsx("div",{className:"-mx-1 overflow-x-auto pb-1",children:a.jsx("div",{className:"flex snap-x snap-mandatory gap-2 px-1",children:s.items.map(e=>a.jsx(s_,{item:e,sectionKind:s.kind},e.id))})})]}):null,s_=({item:s,sectionKind:e})=>{const r=[];return s.friendsWatchingCount&&r.push(`Watched by ${s.friendsWatchingCount} friend(s)`),s.runtimeMinutes&&r.push(`${s.runtimeMinutes} min`),a.jsxs(We,{to:`/title/${s.id}`,className:"group flex w-[160px] shrink-0 snap-start flex-col overflow-hidden rounded-2xl border border-mn-border-subtle/80 bg-mn-bg-elevated/90 text-[11px] text-mn-text-secondary shadow-mn-soft no-underline outline-none ring-offset-2 ring-offset-mn-bg focus-visible:ring-2 focus-visible:ring-mn-primary",children:[a.jsxs("div",{className:"relative h-32 overflow-hidden",children:[s.posterUrl?a.jsx("img",{src:s.posterUrl,alt:s.name,className:"h-full w-full object-cover"}):null,a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-mn-accent-violet/45 via-mn-bg/40 to-mn-primary/75"}),a.jsx("div",{className:"relative flex h-full flex-col justify-between p-2.5",children:a.jsxs("div",{className:"space-y-0.5",children:[a.jsx("p",{className:"line-clamp-2 text-[11px] font-heading font-semibold text-mn-text-primary",children:s.name}),s.matchReason&&a.jsx("p",{className:"line-clamp-2 text-[9px] text-mn-text-secondary",children:s.matchReason})]})})]}),a.jsxs("div",{className:"flex flex-1 flex-col justify-between gap-1 px-2.5 py-2",children:[r.length>0&&a.jsx("p",{className:"line-clamp-1 text-[9px] text-mn-text-muted",children:r.join("  ")}),a.jsxs("div",{className:"mt-1 flex items-center justify-between gap-2 text-[10px]",children:[a.jsxs("span",{className:"inline-flex items-center gap-1 text-mn-text-muted",children:[e==="friends-trending"?a.jsx(Ot,{className:"h-3 w-3","aria-hidden":"true"}):e==="because-you-liked"?a.jsx(ht,{className:"h-3 w-3","aria-hidden":"true"}):e==="anime"?a.jsx(lt,{className:"h-3 w-3","aria-hidden":"true"}):a.jsx(jn,{className:"h-3 w-3","aria-hidden":"true"}),a.jsx("span",{children:e==="friends-trending"?"Friends":e==="because-you-liked"?"Match":e==="anime"?"Anime":"Continue"})]}),a.jsxs("span",{className:"inline-flex items-center gap-1 text-mn-primary group-hover:underline",children:[a.jsx("span",{className:"text-[10px] font-medium",children:"Open"}),a.jsx(vg,{className:"h-2.5 w-2.5","aria-hidden":"true"})]})]})]})]})},i_=()=>a.jsxs("section",{className:"animate-pulse rounded-mn-card border border-mn-border-subtle/80 bg-mn-bg-elevated/90 p-4",children:[a.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[a.jsx("div",{className:"h-4 w-32 rounded-full bg-mn-border-subtle/60"}),a.jsx("div",{className:"h-4 w-16 rounded-full bg-mn-border-subtle/40"})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("div",{className:"h-28 w-20 rounded-2xl bg-mn-border-subtle/60"}),a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx("div",{className:"h-4 w-2/3 rounded-full bg-mn-border-subtle/60"}),a.jsx("div",{className:"h-3 w-full rounded-full bg-mn-border-subtle/40"}),a.jsx("div",{className:"h-3 w-5/6 rounded-full bg-mn-border-subtle/40"}),a.jsxs("div",{className:"mt-2 flex gap-2",children:[a.jsx("div",{className:"h-7 w-28 rounded-full bg-mn-border-subtle/50"}),a.jsx("div",{className:"h-7 w-28 rounded-full bg-mn-border-subtle/40"})]})]})]})]}),a_=()=>a.jsx("div",{className:"space-y-3",children:[0,1].map(s=>a.jsxs("section",{className:"space-y-2",children:[a.jsx("div",{className:"h-4 w-40 rounded-full bg-mn-border-subtle/60"}),a.jsx("div",{className:"-mx-1 overflow-x-hidden pb-1",children:a.jsx("div",{className:"flex gap-2 px-1",children:[0,1,2].map(e=>a.jsx("div",{className:"h-40 w-[160px] shrink-0 rounded-2xl border border-mn-border-subtle/60 bg-mn-bg-elevated/80"},e))})})]},s))}),o_=()=>a.jsx("section",{className:"rounded-mn-card border border-mn-border-subtle/80 bg-mn-bg-elevated/95 px-4 py-5 text-[11px] text-mn-text-secondary shadow-mn-card",children:a.jsxs("div",{className:"mx-auto flex max-w-md flex-col items-center text-center",children:[a.jsx("div",{className:"mb-3 inline-flex h-9 w-9 items-center justify-center rounded-2xl bg-mn-primary/15",children:a.jsx(lt,{className:"h-4 w-4 text-mn-primary","aria-hidden":"true"})}),a.jsx("h2",{className:"text-sm font-heading font-semibold text-mn-text-primary",children:"Smart picks arrive as you watch"}),a.jsx("p",{className:"mt-1 text-[11px] text-mn-text-secondary",children:`Once you've logged a few titles and swiped through recommendations, MoviNesta will start surfacing a single "tonight's pick" tuned to your taste.`}),a.jsxs("p",{className:"mt-2 text-[10px] text-mn-text-muted",children:["For now, head to ",a.jsx("span",{className:"font-medium text-mn-text-primary",children:"Swipe"})," or"," ",a.jsx("span",{className:"font-medium text-mn-text-primary",children:"Diary"})," to teach the nest what you love."]})]})}),l_=()=>a.jsx("section",{className:"rounded-mn-card border border-mn-border-subtle/80 bg-mn-bg-elevated/95 px-4 py-4 text-[11px] text-mn-text-secondary shadow-mn-card",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"inline-flex h-8 w-8 items-center justify-center rounded-2xl bg-mn-primary/15",children:a.jsx(ht,{className:"h-4 w-4 text-mn-primary","aria-hidden":"true"})}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("h3",{className:"text-sm font-heading font-semibold text-mn-text-primary",children:"No personalized rows yet"}),a.jsx("p",{className:"text-[11px] text-mn-text-secondary",children:"As you rate, review, and follow friends, this tab will fill with eerily good recommendations."})]})]})}),cu=[{key:"feed",label:"Feed",icon:Ot,description:"See what you and your friends have been watching, rating, and reviewing.",badge:"Live"},{key:"forYou",label:"For You",icon:lt,description:"Lightweight recommendations based on your diary activity and library."}],c_=()=>{yx("Home");const[s,e]=E.useState("feed"),[r,i]=E.useState(!1),l=Bt(),c=cu.find(d=>d.key===s)??cu[0];return a.jsxs("div",{className:"flex flex-1 flex-col gap-4 pb-2 pt-1",children:[a.jsxs("section",{className:"rounded-mn-card border border-mn-border-subtle bg-mn-bg-elevated/80 px-4 py-3 shadow-mn-soft",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-[10px] font-medium uppercase tracking-[0.16em] text-mn-text-muted",children:"Welcome back"}),a.jsxs("h1",{className:"flex items-center gap-1.5 text-sm font-heading font-semibold text-mn-text-primary",children:[a.jsx(lt,{className:"h-4 w-4 text-mn-primary"}),"Your movie & anime nest"]}),a.jsx("p",{className:"text-[11px] leading-snug text-mn-text-secondary",children:"Track what you watch, build a cozy watchlist, and keep up with friendswithout feeling like homework."})]}),a.jsxs("div",{className:"flex flex-col items-end gap-1 text-right",children:[a.jsxs("button",{type:"button",onClick:()=>l("/swipe"),className:"inline-flex items-center gap-1.5 rounded-full bg-mn-primary px-3 py-1.5 text-[11px] font-medium text-mn-bg shadow-mn-soft hover:bg-mn-primary/90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg",children:[a.jsx(ht,{className:"h-3.5 w-3.5"}),"Start swiping"]}),a.jsxs("button",{type:"button",onClick:()=>l("/diary"),className:"inline-flex items-center gap-1 rounded-full border border-mn-border-subtle px-2 py-1 text-[10px] text-mn-text-secondary hover:bg-mn-bg-elevated/60 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg",children:[a.jsx(jn,{className:"h-3 w-3"}),"Open diary"]})]})]}),a.jsxs("div",{className:"mt-3 flex flex-wrap gap-1.5 text-[10px] text-mn-text-muted",children:[a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-mn-bg/80 px-2 py-0.5",children:[a.jsx(ht,{className:"h-3 w-3"}),"Discover titles"]}),a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-mn-bg/80 px-2 py-0.5",children:[a.jsx(Ot,{className:"h-3 w-3"}),"Follow friends"]}),a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-mn-bg/80 px-2 py-0.5",children:[a.jsx(jn,{className:"h-3 w-3"}),"Build a watch history"]})]})]}),a.jsxs("section",{className:"flex flex-col gap-2 px-1 sm:px-0",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("nav",{className:"inline-flex rounded-full bg-mn-bg-elevated/80 p-1 text-[11px]",role:"tablist","aria-label":"Home sections",children:cu.map(d=>{const f=d.key===s,m=d.icon;return a.jsxs("button",{type:"button",role:"tab","aria-selected":f,"aria-controls":`home-tabpanel-${d.key}`,className:["inline-flex items-center gap-1.5 rounded-full px-3 py-1.5 transition",f?"bg-mn-primary text-mn-bg shadow-mn-soft":"text-mn-text-secondary hover:bg-mn-bg-elevated/70"].filter(Boolean).join(" "),onClick:()=>e(d.key),children:[a.jsx(m,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:d.label}),d.badge&&a.jsx("span",{className:"rounded-full bg-mn-bg/70 px-1.5 py-0.5 text-[9px] font-semibold uppercase tracking-[0.16em]",children:d.badge})]},d.key)})}),s==="feed"&&a.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full border border-mn-border-subtle px-2.5 py-1 text-[10px] text-mn-text-secondary hover:bg-mn-bg-elevated/70 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg",onClick:()=>i(!0),children:[a.jsx(id,{className:"h-3 w-3"}),a.jsx("span",{className:"hidden sm:inline",children:"Filter feed"}),a.jsx("span",{className:"sm:hidden",children:"Filters"})]})]}),a.jsxs("p",{className:"flex items-center gap-1 text-[11px] text-mn-text-secondary",children:[a.jsx("span",{className:"inline-flex h-1.5 w-1.5 rounded-full bg-mn-primary/80"}),a.jsx("span",{children:c.description})]})]}),a.jsx("section",{"aria-live":"polite",className:"flex-1",id:`home-tabpanel-${s}`,children:s==="feed"?a.jsx(Kj,{isFiltersSheetOpen:r,onFiltersSheetOpenChange:i}):a.jsx(t_,{})})]})};function xd(s,e){var d;const r=(e==null?void 0:e.limit)??40,i=s==="for-you"?"swipe-for-you":s==="from-friends"?"swipe-from-friends":"swipe-trending",l=_t({queryKey:["swipe-deck",s,{limit:r}],queryFn:async()=>{const{data:f,error:m}=await se.functions.invoke(i,{body:{limit:r}});return m?(console.warn("[useSwipeDeck] error from",i,m),{cards:[]}):f??{cards:[]}}}),c=wn({mutationFn:async({cardId:f,direction:m})=>{const{error:g}=await se.functions.invoke("swipe-event",{body:{titleId:f,direction:m,source:s}});g&&console.warn("[useSwipeDeck] swipe-event error",g)}});return{cards:((d=l.data)==null?void 0:d.cards)??[],isLoading:l.isLoading,isError:l.isError,swipe:c.mutate}}const u_=80,d_=8,mp=(s,e,r)=>Math.min(r,Math.max(e,s)),h_=s=>{if(!s||s<=0)return null;const e=Math.floor(s/60),r=s%60;return e<=0?`${r}m`:r===0?`${e}h`:`${e}h ${r}m`},pp=s=>s==="like"?"Liked":s==="dislike"?"Disliked":"Skipped",gp=s=>s==="like"?"text-emerald-400":s==="dislike"?"text-rose-400":"text-mn-text-secondary",f_=()=>{const{cards:s,swipe:e}=xd("for-you",{limit:40}),r=E.useMemo(()=>s,[s]),[i,l]=E.useState(0),[c,d]=E.useState(null),[f,m]=E.useState({}),[g,y]=E.useState({});Ft.useEffect(()=>{if(!s.length)return;const D={},z={};for(const te of s)te.initialRating!=null&&(D[te.id]=te.initialRating),te.initiallyInWatchlist!=null&&(z[te.id]=te.initiallyInWatchlist);m(D),y(z)},[s]);const[x,j]=E.useState(0),[w,N]=E.useState(!1),_=E.useRef(null),b=E.useMemo(()=>r[i]??null,[r,i]),L=E.useMemo(()=>r[i+1]??null,[r,i]),C=E.useCallback(D=>{N(!1),j(0),_.current=null;const z=r[i];z&&(e({cardId:z.id,direction:D}),d({cardId:z.id,title:z.title,direction:D,at:new Date().toISOString()}),console.log("[SwipeForYouTab] swipe",{direction:D,cardId:z.id}),l(te=>te+1>=r.length?r.length:te+1))},[i,r,e]);E.useCallback(()=>{l(0),d(null),j(0),N(!1)},[]);const T=i<r.length,I=D=>{b&&(N(!0),_.current=D)},q=D=>{if(!w||_.current==null)return;const z=D-_.current;j(z)},F=()=>{if(!w)return;if(Math.abs(x)>u_){const z=x>0?"like":"dislike";C(z)}else N(!1),j(0),_.current=null},G=D=>{if(D.button===0){try{D.currentTarget.setPointerCapture(D.pointerId)}catch{}I(D.clientX)}},B=D=>{w&&q(D.clientX)},ae=D=>{try{D.currentTarget.releasePointerCapture(D.pointerId)}catch{}F()},Y=()=>{F()},xe=D=>{const z=D.touches[0];z&&I(z.clientX)},ee=D=>{const z=D.touches[0];z&&q(z.clientX)},ue=()=>{F()},Se=()=>{F()},we=(D,z)=>{m(te=>{const ke=te[D]??0,Xe=mp(ke+z,0,5),cr={...te,[D]:Xe};return console.log("[SwipeForYouTab] ratingChange",{cardId:D,rating:Xe}),cr})},Ce=D=>{y(z=>{const te=!z[D],ke={...z,[D]:te};return console.log("[SwipeForYouTab] watchlistToggle",{cardId:D,inWatchlist:te}),ke})};if(!T||!b)return a.jsxs("div",{className:"flex h-full flex-col items-center justify-center px-3 text-center",children:[a.jsx("div",{className:"mx-auto mb-3 flex h-10 w-10 items-center justify-center rounded-2xl bg-mn-primary/15",children:a.jsx(lt,{className:"h-5 w-5 text-mn-primary","aria-hidden":!0})}),a.jsx("h2",{className:"text-sm font-heading font-semibold text-mn-text-primary",children:"You're all caught up"}),a.jsx("p",{className:"mt-1 max-w-xs text-[11px] text-mn-text-secondary",children:"You've swiped through all your current recommendations. As you rate, log, and add titles to your watchlist, this screen will refill with more picks."}),c&&a.jsx("div",{className:"mt-3 rounded-lg border border-mn-border-subtle/60 bg-mn-surface-elevated/80 px-3 py-2 text-[11px] text-mn-text-secondary",children:a.jsxs("p",{className:"inline-flex flex-wrap items-center gap-1",children:[a.jsx("span",{className:"text-mn-text-muted",children:"Last swipe:"}),a.jsx("span",{className:`font-medium ${gp(c.direction)}`,children:pp(c.direction)})," ",a.jsx("span",{className:"font-medium text-mn-text-primary",children:c.title})]})})]});const je=h_(b.runtimeMinutes),le=mp(x/120,-1,1)*d_,Z=x>40,O=x<-40,A=f[b.id]??0,W=!!g[b.id],re=A===0?"Not rated yet":`${A.toFixed(1)}`,J=b.friendLikesCount??0,ne=J===0?"No friends have rated this yet":J===1?"1 friend liked this":`${J} friends liked this`;return a.jsxs("div",{className:"flex h-full flex-col",children:[a.jsxs("header",{className:"flex items-center justify-between gap-3 px-1 pb-1",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsx("p",{className:"text-[10px] font-medium uppercase tracking-[0.18em] text-mn-primary-soft",children:"For You  Swipe deck"}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("h2",{className:"text-sm font-heading font-semibold text-mn-text-primary",children:"Tonight's smart picks"}),a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-mn-surface-elevated/80 px-2 py-0.5 text-[10px] text-mn-text-secondary",children:[a.jsx(lt,{className:"h-3 w-3 text-mn-primary","aria-hidden":!0}),a.jsxs("span",{children:["Card ",i+1," of ",r.length]})]})]}),a.jsx("p",{className:"text-[10px] text-mn-text-muted",children:"Swipe to quickly teach MoviNesta what you love (and what to skip)."})]}),a.jsxs("div",{className:"hidden flex-col items-end gap-1 text-[10px] text-mn-text-muted sm:flex",children:[a.jsxs("div",{className:"inline-flex items-center gap-1.5 rounded-full bg-mn-bg-elevated/70 px-2 py-1",children:[a.jsx(jn,{className:"h-3.5 w-3.5","aria-hidden":!0}),a.jsx("span",{children:"Right = like  Left = skip"})]}),a.jsx("span",{className:"text-[9px]",children:"Prefer tapping? Use the controls below."})]})]}),a.jsxs("div",{className:"relative mt-2 flex flex-1 flex-col",children:[a.jsxs("div",{className:"relative flex flex-1 items-center justify-center",children:[L&&a.jsx("div",{"aria-hidden":!0,className:"pointer-events-none absolute inset-0 mx-auto h-[72%] max-h-[360px] max-w-md rounded-[26px] border border-mn-border-subtle/40 bg-mn-bg-elevated/60 shadow-mn-card blur-[0.5px]"}),a.jsxs("article",{className:`relative z-10 mx-auto h-[72%] max-h-[360px] w-full max-w-md rounded-[26px] border border-mn-border-subtle/80 bg-gradient-to-br from-mn-bg-elevated/90 via-mn-bg-elevated/85 to-purple-900/60 shadow-mn-card ${w?"":"transition-transform duration-200 ease-out"}`,style:{transform:`translateX(${x}px) rotate(${le}deg)`,touchAction:"pan-y"},onPointerDown:G,onPointerMove:B,onPointerUp:ae,onPointerCancel:Y,onTouchStart:xe,onTouchMove:ee,onTouchEnd:ue,onTouchCancel:Se,children:[a.jsxs("div",{className:"pointer-events-none absolute inset-x-0 top-3 flex items-center justify-between px-4 text-[10px] font-semibold uppercase tracking-wide",children:[a.jsx("div",{className:`rounded-md border px-2 py-1 ${O?"border-rose-400/80 bg-rose-500/10 text-rose-400":"border-transparent text-transparent"}`,children:"Nope"}),a.jsx("div",{className:`rounded-md border px-2 py-1 ${Z?"border-emerald-400/80 bg-emerald-500/10 text-emerald-400":"border-transparent text-transparent"}`,children:"Like"})]}),a.jsxs("div",{className:"flex h-full flex-col",children:[a.jsxs("div",{className:"flex-1 px-4 pb-3 pt-6",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsxs("div",{className:"relative h-32 w-24 flex-shrink-0 overflow-hidden rounded-2xl border border-mn-border-subtle/70 bg-mn-bg-elevated/80",children:[b.posterUrl?a.jsx("img",{src:b.posterUrl,alt:`${b.title} poster`,className:"h-full w-full object-cover"}):a.jsxs("div",{className:"flex h-full w-full flex-col items-center justify-center gap-1 text-[10px] text-mn-text-muted",children:[a.jsx(ht,{className:"h-4 w-4 text-mn-primary","aria-hidden":!0}),a.jsx("span",{children:"Poster preview"})]}),a.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-t from-mn-bg-elevated/70 via-transparent to-transparent"})]}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-[10px] font-semibold uppercase tracking-wide text-mn-primary-soft",children:"Tonight's pick"}),a.jsx("h3",{className:"mt-0.5 line-clamp-2 text-lg font-heading font-semibold leading-snug text-mn-text-primary",children:b.title}),a.jsxs("p",{className:"mt-1 text-[11px] text-mn-text-secondary",children:[b.year??"New",b.type?`  ${b.type}`:null,je?`  ${je}`:null]}),b.mood&&a.jsx("p",{className:"mt-0.5 text-[10px] text-mn-text-muted",children:b.mood}),b.vibeTag&&a.jsx("p",{className:"mt-0.5 text-[10px] text-mn-primary-soft",children:b.vibeTag})]})]}),b.tagline&&a.jsx("p",{className:"mt-3 text-[11px] text-mn-text-secondary line-clamp-3",children:b.tagline}),a.jsxs("div",{className:"mt-3 space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-mn-text-secondary",children:[a.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full bg-mn-surface-elevated/80 px-2 py-0.5",children:[a.jsx(Ot,{className:"h-3.5 w-3.5 text-mn-primary","aria-hidden":!0}),a.jsx("span",{children:ne})]}),b.topFriendName&&a.jsxs("span",{className:"text-mn-text-muted",children:["Best match:"," ",a.jsx("span",{className:"font-medium text-mn-text-primary",children:b.topFriendName})]})]}),b.topFriendName&&b.topFriendReviewSnippet&&a.jsxs("div",{className:"flex gap-2 rounded-xl border border-mn-border-subtle/60 bg-mn-bg-elevated/80 px-3 py-2 text-[11px] text-mn-text-secondary",children:[a.jsx("div",{className:"mt-0.5 flex h-7 w-7 flex-shrink-0 items-center justify-center rounded-full bg-mn-primary/20 text-[10px] font-semibold text-mn-primary",children:b.topFriendInitials??b.topFriendName.slice(0,2).toUpperCase()}),a.jsxs("div",{className:"min-w-0",children:[a.jsxs("p",{className:"text-[10px] font-medium text-mn-primary-soft uppercase tracking-wide",children:[b.topFriendName,"'s take"]}),a.jsxs("p",{className:"mt-0.5 line-clamp-2 italic",children:["",b.topFriendReviewSnippet,""]})]})]})]}),a.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3 text-[11px]",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-[10px] uppercase tracking-wide text-mn-text-muted",children:"Your rating"}),a.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-mn-border-subtle/70 bg-mn-surface-elevated/80 px-2 py-0.5",children:[a.jsx("button",{type:"button",className:"h-6 w-6 rounded-full text-xs font-semibold text-mn-text-primary hover:bg-mn-surface-elevated focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-1 focus-visible:ring-offset-mn-bg",onClick:()=>we(b.id,-.5),"aria-label":"Decrease rating",children:""}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(yr,{className:`h-3.5 w-3.5 ${A>0?"text-amber-300":"text-mn-text-muted"}`,"aria-hidden":!0}),a.jsx("span",{className:"min-w-[3.5rem] text-center font-medium",children:re})]}),a.jsx("button",{type:"button",className:"h-6 w-6 rounded-full text-xs font-semibold text-mn-text-primary hover:bg-mn-surface-elevated focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-1 focus-visible:ring-offset-mn-bg",onClick:()=>we(b.id,.5),"aria-label":"Increase rating",children:"+"})]})]}),a.jsxs("button",{type:"button",onClick:()=>Ce(b.id),className:`inline-flex items-center gap-1.5 rounded-full border px-3 py-1.5 text-[11px] font-medium shadow-mn-card focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-1 focus-visible:ring-offset-mn-bg ${W?"border-mn-primary/70 bg-mn-primary/15 text-mn-primary":"border-mn-border-subtle/70 bg-mn-surface-elevated/80 text-mn-text-primary hover:border-mn-primary/60 hover:bg-mn-surface-elevated"}`,children:[a.jsx(rs,{className:"h-3.5 w-3.5","aria-hidden":!0}),a.jsx("span",{children:W?"In Watchlist":"Add to Watchlist"})]})]})]}),a.jsxs("div",{className:"flex items-center justify-center gap-4 border-t border-mn-border-subtle/60 bg-mn-bg-elevated/80 px-4 py-3",children:[a.jsx("button",{type:"button",onClick:()=>C("dislike"),className:"inline-flex h-10 w-10 items-center justify-center rounded-full border border-rose-500/50 bg-rose-500/10 text-rose-300 shadow-mn-card transition hover:bg-rose-500/20 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-rose-500 focus-visible:ring-offset-1 focus-visible:ring-offset-mn-bg","aria-label":"Dislike",children:a.jsx(ad,{className:"h-4 w-4","aria-hidden":!0})}),a.jsx("button",{type:"button",onClick:()=>C("skip"),className:"inline-flex items-center justify-center rounded-full border border-mn-border-subtle/70 bg-mn-surface-elevated/80 px-3 py-1.5 text-[11px] font-medium text-mn-text-secondary shadow-mn-card hover:border-mn-primary/60 hover:text-mn-text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-1 focus-visible:ring-offset-mn-bg","aria-label":"Skip this title",children:"Skip"}),a.jsx("button",{type:"button",onClick:()=>C("like"),className:"inline-flex h-10 w-10 items-center justify-center rounded-full border border-emerald-500/60 bg-emerald-500/10 text-emerald-300 shadow-mn-card transition hover:bg-emerald-500/20 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-500 focus-visible:ring-offset-1 focus-visible:ring-offset-mn-bg","aria-label":"Like",children:a.jsx(da,{className:"h-4 w-4","aria-hidden":!0})})]})]})]})]}),c&&a.jsx("div",{className:"pointer-events-none mt-2 flex justify-center px-2",children:a.jsxs("div",{className:"pointer-events-auto inline-flex max-w-md flex-1 items-center justify-between gap-2 rounded-full border border-mn-border-subtle/70 bg-mn-surface-elevated/90 px-3 py-1.5 text-[10px] text-mn-text-secondary shadow-mn-card",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:`inline-flex items-center gap-1 rounded-full bg-mn-bg-elevated/80 px-2 py-0.5 font-medium ${gp(c.direction)}`,children:a.jsx("span",{children:pp(c.direction)})}),a.jsx("span",{className:"truncate text-mn-text-primary",children:c.title})]}),a.jsx("span",{className:"hidden text-[9px] text-mn-text-muted sm:inline",children:"Swipe to keep tuning your For You picks"})]})})]})]})},m_=80,p_=8,xp=(s,e,r)=>Math.min(r,Math.max(e,s)),g_=s=>{if(!s||s<=0)return null;const e=Math.floor(s/60),r=s%60;return e<=0?`${r}m`:r===0?`${e}h`:`${e}h ${r}m`},yp=s=>s==="like"?"Liked":s==="dislike"?"Disliked":"Skipped",vp=s=>s==="like"?"text-emerald-400":s==="dislike"?"text-rose-400":"text-mn-text-secondary",x_=()=>{const{cards:s,swipe:e}=xd("from-friends",{limit:40}),r=E.useMemo(()=>s,[s]),[i,l]=E.useState(0),[c,d]=E.useState(null),[f,m]=E.useState({}),[g,y]=E.useState({});Ft.useEffect(()=>{if(!s.length)return;const D={},z={};for(const te of s)te.initialRating!=null&&(D[te.id]=te.initialRating),te.initiallyInWatchlist!=null&&(z[te.id]=te.initiallyInWatchlist);m(D),y(z)},[s]);const[x,j]=E.useState(0),[w,N]=E.useState(!1),_=E.useRef(null),b=E.useMemo(()=>r[i]??null,[r,i]),L=E.useMemo(()=>r[i+1]??null,[r,i]),C=E.useCallback(D=>{N(!1),j(0),_.current=null;const z=r[i];z&&(e({cardId:z.id,direction:D}),d({cardId:z.id,title:z.title,direction:D,at:new Date().toISOString()}),console.log("[SwipeFromFriendsTab] swipe",{direction:D,cardId:z.id}),l(te=>te+1>=r.length?r.length:te+1))},[i,r,e]);E.useCallback(()=>{l(0),d(null),j(0),N(!1)},[]);const T=i<r.length,I=D=>{b&&(N(!0),_.current=D)},q=D=>{if(!w||_.current==null)return;const z=D-_.current;j(z)},F=()=>{if(!w)return;if(Math.abs(x)>m_){const z=x>0?"like":"dislike";C(z)}else N(!1),j(0),_.current=null},G=D=>{if(D.button===0){try{D.currentTarget.setPointerCapture(D.pointerId)}catch{}I(D.clientX)}},B=D=>{w&&q(D.clientX)},ae=D=>{try{D.currentTarget.releasePointerCapture(D.pointerId)}catch{}F()},Y=()=>{F()},xe=D=>{const z=D.touches[0];z&&I(z.clientX)},ee=D=>{const z=D.touches[0];z&&q(z.clientX)},ue=()=>{F()},Se=()=>{F()},we=(D,z)=>{m(te=>{const ke=te[D]??0,Xe=xp(ke+z,0,5),cr={...te,[D]:Xe};return console.log("[SwipeFromFriendsTab] ratingChange",{cardId:D,rating:Xe}),cr})},Ce=D=>{y(z=>{const te=!z[D],ke={...z,[D]:te};return console.log("[SwipeFromFriendsTab] watchlistToggle",{cardId:D,inWatchlist:te}),ke})};if(!T||!b)return a.jsxs("div",{className:"flex h-full flex-col items-center justify-center px-3 text-center",children:[a.jsx("div",{className:"mx-auto mb-3 flex h-10 w-10 items-center justify-center rounded-2xl bg-mn-primary/15",children:a.jsx(Ot,{className:"h-5 w-5 text-mn-primary","aria-hidden":!0})}),a.jsx("h2",{className:"text-sm font-heading font-semibold text-mn-text-primary",children:"You're all caught up on friends' picks"}),a.jsx("p",{className:"mt-1 max-w-xs text-[11px] text-mn-text-secondary",children:"You've swiped through all of your friends' latest picks. As they log new titles and update their diaries, new cards will show up here."}),c&&a.jsx("div",{className:"mt-3 rounded-lg border border-mn-border-subtle/60 bg-mn-surface-elevated/80 px-3 py-2 text-[11px] text-mn-text-secondary",children:a.jsxs("p",{className:"inline-flex flex-wrap items-center gap-1",children:[a.jsx("span",{className:"text-mn-text-muted",children:"Last swipe:"}),a.jsx("span",{className:`font-medium ${vp(c.direction)}`,children:yp(c.direction)})," ",a.jsx("span",{className:"font-medium text-mn-text-primary",children:c.title})]})})]});const je=g_(b.runtimeMinutes),le=xp(x/120,-1,1)*p_,Z=x>40,O=x<-40,A=f[b.id]??0,W=!!g[b.id],re=A===0?"Not rated yet":`${A.toFixed(1)}`,J=b.friendLikesCount??0,ne=J===0?"No friends have rated this yet":J===1?"1 friend liked this":`${J} friends liked this`;return a.jsxs("div",{className:"flex h-full flex-col",children:[a.jsxs("header",{className:"flex items-center justify-between gap-2 px-1 pb-1",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-[10px] font-medium uppercase tracking-wide text-mn-primary-soft",children:"From Friends  Swipe deck"}),a.jsx("h2",{className:"text-sm font-heading font-semibold text-mn-text-primary",children:"What your friends are watching"})]}),a.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] text-mn-text-muted",children:[a.jsx(jn,{className:"h-3.5 w-3.5","aria-hidden":!0}),a.jsx("span",{children:"Swipe through friends' picks"})]})]}),a.jsxs("div",{className:"relative mt-2 flex flex-1 flex-col",children:[a.jsxs("div",{className:"relative flex flex-1 items-center justify-center",children:[L&&a.jsx("div",{"aria-hidden":!0,className:"pointer-events-none absolute inset-0 mx-auto h-[72%] max-h-[360px] max-w-md rounded-[26px] border border-mn-border-subtle/40 bg-mn-bg-elevated/60 shadow-mn-card blur-[0.5px]"}),a.jsxs("article",{className:`relative z-10 mx-auto h-[72%] max-h-[360px] w-full max-w-md rounded-[26px] border border-mn-border-subtle/80 bg-gradient-to-br from-mn-bg-elevated/90 via-mn-bg-elevated/85 to-purple-900/60 shadow-mn-card ${w?"":"transition-transform duration-200 ease-out"}`,style:{transform:`translateX(${x}px) rotate(${le}deg)`,touchAction:"pan-y"},onPointerDown:G,onPointerMove:B,onPointerUp:ae,onPointerCancel:Y,onTouchStart:xe,onTouchMove:ee,onTouchEnd:ue,onTouchCancel:Se,children:[a.jsxs("div",{className:"pointer-events-none absolute inset-x-0 top-3 flex items-center justify-between px-4 text-[10px] font-semibold uppercase tracking-wide",children:[a.jsx("div",{className:`rounded-md border px-2 py-1 ${O?"border-rose-400/80 bg-rose-500/10 text-rose-400":"border-transparent text-transparent"}`,children:"Nope"}),a.jsx("div",{className:`rounded-md border px-2 py-1 ${Z?"border-emerald-400/80 bg-emerald-500/10 text-emerald-400":"border-transparent text-transparent"}`,children:"Like"})]}),a.jsxs("div",{className:"flex h-full flex-col",children:[a.jsxs("div",{className:"flex-1 px-4 pb-3 pt-6",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsxs("div",{className:"relative h-32 w-24 flex-shrink-0 overflow-hidden rounded-2xl border border-mn-border-subtle/70 bg-mn-bg-elevated/80",children:[b.posterUrl?a.jsx("img",{src:b.posterUrl,alt:`${b.title} poster`,className:"h-full w-full object-cover"}):a.jsxs("div",{className:"flex h-full w-full flex-col items-center justify-center gap-1 text-[10px] text-mn-text-muted",children:[a.jsx(ht,{className:"h-4 w-4 text-mn-primary","aria-hidden":!0}),a.jsx("span",{children:"Friend's pick"})]}),a.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-t from-mn-bg-elevated/70 via-transparent to-transparent"})]}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-[10px] font-semibold uppercase tracking-wide text-mn-primary-soft",children:"From your friends"}),a.jsx("h3",{className:"mt-0.5 line-clamp-2 text-lg font-heading font-semibold leading-snug text-mn-text-primary",children:b.title}),a.jsxs("p",{className:"mt-1 text-[11px] text-mn-text-secondary",children:[b.year??"New",b.type?`  ${b.type}`:null,je?`  ${je}`:null]}),b.mood&&a.jsx("p",{className:"mt-0.5 text-[10px] text-mn-text-muted",children:b.mood}),b.vibeTag&&a.jsx("p",{className:"mt-0.5 text-[10px] text-mn-primary-soft",children:b.vibeTag})]})]}),b.tagline&&a.jsx("p",{className:"mt-3 text-[11px] text-mn-text-secondary line-clamp-3",children:b.tagline}),a.jsxs("div",{className:"mt-3 space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-mn-text-secondary",children:[a.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full bg-mn-surface-elevated/80 px-2 py-0.5",children:[a.jsx(Ot,{className:"h-3.5 w-3.5 text-mn-primary","aria-hidden":!0}),a.jsx("span",{children:ne})]}),b.topFriendName&&a.jsxs("span",{className:"text-mn-text-muted",children:["Most similar taste:"," ",a.jsx("span",{className:"font-medium text-mn-text-primary",children:b.topFriendName})]})]}),b.topFriendName&&b.topFriendReviewSnippet&&a.jsxs("div",{className:"flex gap-2 rounded-xl border border-mn-border-subtle/60 bg-mn-bg-elevated/80 px-3 py-2 text-[11px] text-mn-text-secondary",children:[a.jsx("div",{className:"mt-0.5 flex h-7 w-7 flex-shrink-0 items-center justify-center rounded-full bg-mn-primary/20 text-[10px] font-semibold text-mn-primary",children:b.topFriendInitials??b.topFriendName.slice(0,2).toUpperCase()}),a.jsxs("div",{className:"min-w-0",children:[a.jsxs("p",{className:"text-[10px] font-medium text-mn-primary-soft uppercase tracking-wide",children:[b.topFriendName,"'s review"]}),a.jsxs("p",{className:"mt-0.5 line-clamp-2 italic",children:["",b.topFriendReviewSnippet,""]})]})]})]}),a.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3 text-[11px]",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-[10px] uppercase tracking-wide text-mn-text-muted",children:"Your rating"}),a.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-mn-border-subtle/70 bg-mn-surface-elevated/80 px-2 py-0.5",children:[a.jsx("button",{type:"button",className:"h-6 w-6 rounded-full text-xs font-semibold text-mn-text-primary hover:bg-mn-surface-elevated focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-1 focus-visible:ring-offset-mn-bg",onClick:()=>we(b.id,-.5),"aria-label":"Decrease rating",children:""}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(yr,{className:`h-3.5 w-3.5 ${A>0?"text-amber-300":"text-mn-text-muted"}`,"aria-hidden":!0}),a.jsx("span",{className:"min-w-[3.5rem] text-center font-medium",children:re})]}),a.jsx("button",{type:"button",className:"h-6 w-6 rounded-full text-xs font-semibold text-mn-text-primary hover:bg-mn-surface-elevated focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-1 focus-visible:ring-offset-mn-bg",onClick:()=>we(b.id,.5),"aria-label":"Increase rating",children:"+"})]})]}),a.jsxs("button",{type:"button",onClick:()=>Ce(b.id),className:`inline-flex items-center gap-1.5 rounded-full border px-3 py-1.5 text-[11px] font-medium shadow-mn-card focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-1 focus-visible:ring-offset-mn-bg ${W?"border-mn-primary/70 bg-mn-primary/15 text-mn-primary":"border-mn-border-subtle/70 bg-mn-surface-elevated/80 text-mn-text-primary hover:border-mn-primary/60 hover:bg-mn-surface-elevated"}`,children:[a.jsx(rs,{className:"h-3.5 w-3.5","aria-hidden":!0}),a.jsx("span",{children:W?"In Watchlist":"Add to Watchlist"})]})]})]}),a.jsxs("div",{className:"flex items-center justify-center gap-4 border-t border-mn-border-subtle/60 bg-mn-bg-elevated/80 px-4 py-3",children:[a.jsx("button",{type:"button",onClick:()=>C("dislike"),className:"inline-flex h-10 w-10 items-center justify-center rounded-full border border-rose-500/50 bg-rose-500/10 text-rose-300 shadow-mn-card transition hover:bg-rose-500/20 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-rose-500 focus-visible:ring-offset-1 focus-visible:ring-offset-mn-bg","aria-label":"Dislike",children:a.jsx(ad,{className:"h-4 w-4","aria-hidden":!0})}),a.jsx("button",{type:"button",onClick:()=>C("skip"),className:"inline-flex items-center justify-center rounded-full border border-mn-border-subtle/70 bg-mn-surface-elevated/80 px-3 py-1.5 text-[11px] font-medium text-mn-text-secondary shadow-mn-card hover:border-mn-primary/60 hover:text-mn-text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-1 focus-visible:ring-offset-mn-bg","aria-label":"Skip this title",children:"Skip"}),a.jsx("button",{type:"button",onClick:()=>C("like"),className:"inline-flex h-10 w-10 items-center justify-center rounded-full border border-emerald-500/60 bg-emerald-500/10 text-emerald-300 shadow-mn-card transition hover:bg-emerald-500/20 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-500 focus-visible:ring-offset-1 focus-visible:ring-offset-mn-bg","aria-label":"Like",children:a.jsx(da,{className:"h-4 w-4","aria-hidden":!0})})]})]})]})]}),c&&a.jsx("div",{className:"pointer-events-none mt-2 flex justify-center px-2",children:a.jsxs("div",{className:"pointer-events-auto inline-flex max-w-md flex-1 items-center justify-between gap-2 rounded-full border border-mn-border-subtle/70 bg-mn-surface-elevated/90 px-3 py-1.5 text-[10px] text-mn-text-secondary shadow-mn-card",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:`inline-flex items-center gap-1 rounded-full bg-mn-bg-elevated/80 px-2 py-0.5 font-medium ${vp(c.direction)}`,children:a.jsx("span",{children:yp(c.direction)})}),a.jsx("span",{className:"truncate text-mn-text-primary",children:c.title})]}),a.jsx("span",{className:"hidden text-[9px] text-mn-text-muted sm:inline",children:"Swipe to keep tuning your friends feed"})]})})]})]})},y_=80,v_=8,bp=(s,e,r)=>Math.min(r,Math.max(e,s)),b_=s=>{if(!s||s<=0)return null;const e=Math.floor(s/60),r=s%60;return e<=0?`${r}m`:r===0?`${e}h`:`${e}h ${r}m`},wp=s=>s==="like"?"Liked":s==="dislike"?"Disliked":"Skipped",jp=s=>s==="like"?"text-emerald-400":s==="dislike"?"text-rose-400":"text-mn-text-secondary",w_=()=>{const{cards:s,swipe:e}=xd("trending",{limit:40}),r=E.useMemo(()=>s,[s]),[i,l]=E.useState(0),[c,d]=E.useState(null),[f,m]=E.useState({}),[g,y]=E.useState({});Ft.useEffect(()=>{if(!s.length)return;const D={},z={};for(const te of s)te.initialRating!=null&&(D[te.id]=te.initialRating),te.initiallyInWatchlist!=null&&(z[te.id]=te.initiallyInWatchlist);m(D),y(z)},[s]);const[x,j]=E.useState(0),[w,N]=E.useState(!1),_=E.useRef(null),b=E.useMemo(()=>r[i]??null,[r,i]),L=E.useMemo(()=>r[i+1]??null,[r,i]),C=E.useCallback(D=>{N(!1),j(0),_.current=null;const z=r[i];z&&(e({cardId:z.id,direction:D}),d({cardId:z.id,title:z.title,direction:D,at:new Date().toISOString()}),console.log("[SwipeTrendingTab] swipe",{direction:D,cardId:z.id}),l(te=>te+1>=r.length?r.length:te+1))},[i,r,e]);E.useCallback(()=>{l(0),d(null),j(0),N(!1)},[]);const T=i<r.length,I=D=>{b&&(N(!0),_.current=D)},q=D=>{if(!w||_.current==null)return;const z=D-_.current;j(z)},F=()=>{if(!w)return;if(Math.abs(x)>y_){const z=x>0?"like":"dislike";C(z)}else N(!1),j(0),_.current=null},G=D=>{if(D.button===0){try{D.currentTarget.setPointerCapture(D.pointerId)}catch{}I(D.clientX)}},B=D=>{w&&q(D.clientX)},ae=D=>{try{D.currentTarget.releasePointerCapture(D.pointerId)}catch{}F()},Y=()=>{F()},xe=D=>{const z=D.touches[0];z&&I(z.clientX)},ee=D=>{const z=D.touches[0];z&&q(z.clientX)},ue=()=>{F()},Se=()=>{F()},we=(D,z)=>{m(te=>{const ke=te[D]??0,Xe=bp(ke+z,0,5),cr={...te,[D]:Xe};return console.log("[SwipeTrendingTab] ratingChange",{cardId:D,rating:Xe}),cr})},Ce=D=>{y(z=>{const te=!z[D],ke={...z,[D]:te};return console.log("[SwipeTrendingTab] watchlistToggle",{cardId:D,inWatchlist:te}),ke})};if(!T||!b)return a.jsxs("div",{className:"flex h-full flex-col items-center justify-center px-3 text-center",children:[a.jsx("div",{className:"mx-auto mb-3 flex h-10 w-10 items-center justify-center rounded-2xl bg-mn-primary/15",children:a.jsx(lt,{className:"h-5 w-5 text-mn-primary","aria-hidden":!0})}),a.jsx("h2",{className:"text-sm font-heading font-semibold text-mn-text-primary",children:"You've seen the trending stack"}),a.jsx("p",{className:"mt-1 max-w-xs text-[11px] text-mn-text-secondary",children:"You're up to date with what's hot right now. Trending will keep refreshing as MoviNesta sees new titles gaining momentum."}),c&&a.jsx("div",{className:"mt-3 rounded-lg border border-mn-border-subtle/60 bg-mn-surface-elevated/80 px-3 py-2 text-[11px] text-mn-text-secondary",children:a.jsxs("p",{className:"inline-flex flex-wrap items-center gap-1",children:[a.jsx("span",{className:"text-mn-text-muted",children:"Last swipe:"}),a.jsx("span",{className:`font-medium ${jp(c.direction)}`,children:wp(c.direction)})," ",a.jsx("span",{className:"font-medium text-mn-text-primary",children:c.title})]})})]});const je=b_(b.runtimeMinutes),le=bp(x/120,-1,1)*v_,Z=x>40,O=x<-40,A=f[b.id]??0,W=!!g[b.id],re=A===0?"Not rated yet":`${A.toFixed(1)}`,J=b.friendLikesCount??0,ne=J===0?"Not many people have logged this yet":J<1e3?`${J.toLocaleString()} people logged this`:`${(J/1e3).toFixed(1)}k+ people logged this`;return a.jsxs("div",{className:"flex h-full flex-col",children:[a.jsxs("header",{className:"flex items-center justify-between gap-2 px-1 pb-1",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-[10px] font-medium uppercase tracking-wide text-mn-primary-soft",children:"Trending  Swipe deck"}),a.jsx("h2",{className:"text-sm font-heading font-semibold text-mn-text-primary",children:"What everyone's watching"})]}),a.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] text-mn-text-muted",children:[a.jsx(jn,{className:"h-3.5 w-3.5","aria-hidden":!0}),a.jsx("span",{children:"Swipe the hottest titles"})]})]}),a.jsxs("div",{className:"relative mt-2 flex flex-1 flex-col",children:[a.jsxs("div",{className:"relative flex flex-1 items-center justify-center",children:[L&&a.jsx("div",{"aria-hidden":!0,className:"pointer-events-none absolute inset-0 mx-auto h-[72%] max-h-[360px] max-w-md rounded-[26px] border border-mn-border-subtle/40 bg-mn-bg-elevated/60 shadow-mn-card blur-[0.5px]"}),a.jsxs("article",{className:`relative z-10 mx-auto h-[72%] max-h-[360px] w-full max-w-md rounded-[26px] border border-mn-border-subtle/80 bg-gradient-to-br from-mn-bg-elevated/90 via-mn-bg-elevated/85 to-purple-900/60 shadow-mn-card ${w?"":"transition-transform duration-200 ease-out"}`,style:{transform:`translateX(${x}px) rotate(${le}deg)`,touchAction:"pan-y"},onPointerDown:G,onPointerMove:B,onPointerUp:ae,onPointerCancel:Y,onTouchStart:xe,onTouchMove:ee,onTouchEnd:ue,onTouchCancel:Se,children:[a.jsxs("div",{className:"pointer-events-none absolute inset-x-0 top-3 flex items-center justify-between px-4 text-[10px] font-semibold uppercase tracking-wide",children:[a.jsx("div",{className:`rounded-md border px-2 py-1 ${O?"border-rose-400/80 bg-rose-500/10 text-rose-400":"border-transparent text-transparent"}`,children:"Nope"}),a.jsx("div",{className:`rounded-md border px-2 py-1 ${Z?"border-emerald-400/80 bg-emerald-500/10 text-emerald-400":"border-transparent text-transparent"}`,children:"Like"})]}),a.jsxs("div",{className:"flex h-full flex-col",children:[a.jsxs("div",{className:"flex-1 px-4 pb-3 pt-6",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsxs("div",{className:"relative h-32 w-24 flex-shrink-0 overflow-hidden rounded-2xl border border-mn-border-subtle/70 bg-mn-bg-elevated/80",children:[b.posterUrl?a.jsx("img",{src:b.posterUrl,alt:`${b.title} poster`,className:"h-full w-full object-cover"}):a.jsxs("div",{className:"flex h-full w-full flex-col items-center justify-center gap-1 text-[10px] text-mn-text-muted",children:[a.jsx(ht,{className:"h-4 w-4 text-mn-primary","aria-hidden":!0}),a.jsx("span",{children:"Trending poster"})]}),a.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-t from-mn-bg-elevated/70 via-transparent to-transparent"})]}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-[10px] font-semibold uppercase tracking-wide text-mn-primary-soft",children:"Currently trending"}),a.jsx("h3",{className:"mt-0.5 line-clamp-2 text-lg font-heading font-semibold leading-snug text-mn-text-primary",children:b.title}),a.jsxs("p",{className:"mt-1 text-[11px] text-mn-text-secondary",children:[b.year??"New",b.type?`  ${b.type}`:null,je?`  ${je}`:null]}),b.mood&&a.jsx("p",{className:"mt-0.5 text-[10px] text-mn-text-muted",children:b.mood}),b.vibeTag&&a.jsx("p",{className:"mt-0.5 text-[10px] text-mn-primary-soft",children:b.vibeTag})]})]}),b.tagline&&a.jsx("p",{className:"mt-3 text-[11px] text-mn-text-secondary line-clamp-3",children:b.tagline}),a.jsxs("div",{className:"mt-3 space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-mn-text-secondary",children:[a.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full bg-mn-surface-elevated/80 px-2 py-0.5",children:[a.jsx(Ot,{className:"h-3.5 w-3.5 text-mn-primary","aria-hidden":!0}),a.jsx("span",{children:ne})]}),b.topFriendName&&a.jsxs("span",{className:"text-mn-text-muted",children:["Friends also into this:"," ",a.jsx("span",{className:"font-medium text-mn-text-primary",children:b.topFriendName})]})]}),b.topFriendName&&b.topFriendReviewSnippet&&a.jsxs("div",{className:"flex gap-2 rounded-xl border border-mn-border-subtle/60 bg-mn-bg-elevated/80 px-3 py-2 text-[11px] text-mn-text-secondary",children:[a.jsx("div",{className:"mt-0.5 flex h-7 w-7 flex-shrink-0 items-center justify-center rounded-full bg-mn-primary/20 text-[10px] font-semibold text-mn-primary",children:b.topFriendInitials??b.topFriendName.slice(0,2).toUpperCase()}),a.jsxs("div",{className:"min-w-0",children:[a.jsxs("p",{className:"text-[10px] font-medium text-mn-primary-soft uppercase tracking-wide",children:[b.topFriendName,"'s take"]}),a.jsxs("p",{className:"mt-0.5 line-clamp-2 italic",children:["",b.topFriendReviewSnippet,""]})]})]})]}),a.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3 text-[11px]",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-[10px] uppercase tracking-wide text-mn-text-muted",children:"Your rating"}),a.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-mn-border-subtle/70 bg-mn-surface-elevated/80 px-2 py-0.5",children:[a.jsx("button",{type:"button",className:"h-6 w-6 rounded-full text-xs font-semibold text-mn-text-primary hover:bg-mn-surface-elevated focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-1 focus-visible:ring-offset-mn-bg",onClick:()=>we(b.id,-.5),"aria-label":"Decrease rating",children:""}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(yr,{className:`h-3.5 w-3.5 ${A>0?"text-amber-300":"text-mn-text-muted"}`,"aria-hidden":!0}),a.jsx("span",{className:"min-w-[3.5rem] text-center font-medium",children:re})]}),a.jsx("button",{type:"button",className:"h-6 w-6 rounded-full text-xs font-semibold text-mn-text-primary hover:bg-mn-surface-elevated focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-1 focus-visible:ring-offset-mn-bg",onClick:()=>we(b.id,.5),"aria-label":"Increase rating",children:"+"})]})]}),a.jsxs("button",{type:"button",onClick:()=>Ce(b.id),className:`inline-flex items-center gap-1.5 rounded-full border px-3 py-1.5 text-[11px] font-medium shadow-mn-card focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-1 focus-visible:ring-offset-mn-bg ${W?"border-mn-primary/70 bg-mn-primary/15 text-mn-primary":"border-mn-border-subtle/70 bg-mn-surface-elevated/80 text-mn-text-primary hover:border-mn-primary/60 hover:bg-mn-surface-elevated"}`,children:[a.jsx(rs,{className:"h-3.5 w-3.5","aria-hidden":!0}),a.jsx("span",{children:W?"In Watchlist":"Add to Watchlist"})]})]})]}),a.jsxs("div",{className:"flex items-center justify-center gap-4 border-t border-mn-border-subtle/60 bg-mn-bg-elevated/80 px-4 py-3",children:[a.jsx("button",{type:"button",onClick:()=>C("dislike"),className:"inline-flex h-10 w-10 items-center justify-center rounded-full border border-rose-500/50 bg-rose-500/10 text-rose-300 shadow-mn-card transition hover:bg-rose-500/20 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-rose-500 focus-visible:ring-offset-1 focus-visible:ring-offset-mn-bg","aria-label":"Dislike",children:a.jsx(ad,{className:"h-4 w-4","aria-hidden":!0})}),a.jsx("button",{type:"button",onClick:()=>C("skip"),className:"inline-flex items-center justify-center rounded-full border border-mn-border-subtle/70 bg-mn-surface-elevated/80 px-3 py-1.5 text-[11px] font-medium text-mn-text-secondary shadow-mn-card hover:border-mn-primary/60 hover:text-mn-text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-1 focus-visible:ring-offset-mn-bg","aria-label":"Skip this title",children:"Skip"}),a.jsx("button",{type:"button",onClick:()=>C("like"),className:"inline-flex h-10 w-10 items-center justify-center rounded-full border border-emerald-500/60 bg-emerald-500/10 text-emerald-300 shadow-mn-card transition hover:bg-emerald-500/20 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-500 focus-visible:ring-offset-1 focus-visible:ring-offset-mn-bg","aria-label":"Like",children:a.jsx(da,{className:"h-4 w-4","aria-hidden":!0})})]})]})]})]}),c&&a.jsx("div",{className:"pointer-events-none mt-2 flex justify-center px-2",children:a.jsxs("div",{className:"pointer-events-auto inline-flex max-w-md flex-1 items-center justify-between gap-2 rounded-full border border-mn-border-subtle/70 bg-mn-surface-elevated/90 px-3 py-1.5 text-[10px] text-mn-text-secondary shadow-mn-card",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:`inline-flex items-center gap-1 rounded-full bg-mn-bg-elevated/80 px-2 py-0.5 font-medium ${jp(c.direction)}`,children:a.jsx("span",{children:wp(c.direction)})}),a.jsx("span",{className:"truncate text-mn-text-primary",children:c.title})]}),a.jsx("span",{className:"hidden text-[9px] text-mn-text-muted sm:inline",children:"Swipe to keep tuning what Trending shows you"})]})})]})]})},uu=[{key:"forYou",label:"For You",icon:bg,description:"Smart picks based on your taste, watchlist, and diary.",badge:"Recommended"},{key:"friends",label:"From Friends",icon:Ot,description:"Things your friends are loving, rating, and re-watching."},{key:"trending",label:"Trending",icon:lt,description:"Whats buzzing across MoviNesta right now."}],j_=()=>{const[s,e]=E.useState("forYou"),r=uu.find(l=>l.key===s)??uu[0],i=r.icon;return a.jsxs("div",{className:"flex flex-1 flex-col gap-4 pb-3 pt-1",children:[a.jsxs("header",{className:"relative overflow-hidden rounded-3xl border border-mn-border-subtle/60 bg-gradient-to-br from-mn-bg-elevated via-mn-bg-elevated to-indigo-900 px-4 py-3 shadow-mn-soft",children:[a.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 w-40 bg-[radial-gradient(circle_at_top,_rgba(248,250,252,0.12),transparent)]"}),a.jsx("div",{className:"pointer-events-none absolute -left-10 -bottom-10 h-32 w-32 rounded-full bg-[radial-gradient(circle,_rgba(56,189,248,0.12),transparent)]"}),a.jsxs("div",{className:"relative flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-[10px] font-medium uppercase tracking-[0.18em] text-mn-text-secondary",children:"Swipe deck"}),a.jsx("h1",{className:"font-heading text-xl font-semibold text-mn-text-primary",children:"Find tonight's perfect watch"}),a.jsxs("p",{className:"max-w-xl text-[12px] leading-relaxed text-mn-text-secondary",children:["Swipe to shape smarter recommendations across"," ",a.jsx("span",{className:"font-medium text-mn-text-primary",children:"For You"}),","," ",a.jsx("span",{className:"font-medium text-mn-text-primary",children:"From Friends"}),", and"," ",a.jsx("span",{className:"font-medium text-mn-text-primary",children:"Trending"})," decks."]})]}),a.jsxs("div",{className:"hidden flex-col items-end gap-2 text-[10px] text-mn-text-secondary sm:flex",children:[a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-mn-bg-elevated/80 px-3 py-1",children:[a.jsx(lt,{className:"h-3.5 w-3.5 text-mn-primary","aria-hidden":!0}),a.jsx("span",{children:"Smart, taste-aware picks"})]}),a.jsxs("span",{className:"inline-flex items-center gap-1 text-[9px] text-mn-text-secondary",children:[a.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-400"}),a.jsx("span",{children:"Recommendations refresh as you swipe and your friends log new titles."})]})]})]})]}),a.jsxs("nav",{className:"mt-1 flex items-center justify-between gap-3 px-1","aria-label":"Swipe tabs",children:[a.jsx("div",{role:"tablist","aria-orientation":"horizontal",className:"flex max-w-full gap-1.5 overflow-x-auto rounded-full border border-mn-border-subtle/60 bg-mn-bg-elevated/70 p-1.5 backdrop-blur",children:uu.map(l=>{const c=l.icon,d=l.key===s;return a.jsxs("button",{type:"button",role:"tab","aria-selected":d,"aria-controls":`swipe-tabpanel-${l.key}`,className:["inline-flex items-center gap-1.5 whitespace-nowrap rounded-full px-3 py-1.5 text-[11px] font-medium outline-none transition",d?"bg-mn-primary text-mn-bg shadow-mn-soft":"bg-transparent text-mn-text-secondary hover:bg-mn-bg-elevated/70"].join(" "),onClick:()=>e(l.key),children:[a.jsx(c,{className:"h-3.5 w-3.5","aria-hidden":!0}),a.jsx("span",{children:l.label})]},l.key)})}),a.jsxs("div",{className:"hidden flex-col items-end text-[10px] text-mn-text-secondary md:flex",children:[a.jsxs("p",{className:"inline-flex items-center gap-1",children:[a.jsx("span",{className:"h-1 w-4 rounded-full bg-gradient-to-r from-emerald-400/80 via-emerald-300/80 to-transparent"}),a.jsx("span",{children:"Right = like"})]}),a.jsxs("p",{className:"inline-flex items-center gap-1",children:[a.jsx("span",{className:"h-1 w-4 rounded-full bg-gradient-to-r from-rose-400/80 via-rose-300/80 to-transparent"}),a.jsx("span",{children:"Left = skip"})]})]})]}),a.jsx("div",{className:"px-1 text-[11px] text-mn-text-secondary",children:a.jsxs("p",{className:"flex items-center justify-between gap-2",children:[a.jsxs("span",{className:"flex items-center gap-2 truncate",children:[a.jsx("span",{className:"inline-flex h-5 w-5 items-center justify-center rounded-full bg-mn-bg-elevated/80",children:a.jsx(i,{className:"h-3 w-3 text-mn-text-primary","aria-hidden":!0})}),a.jsx("span",{className:"truncate",children:r.description})]}),r.badge?a.jsxs("span",{className:"ml-2 inline-flex flex-shrink-0 items-center gap-1 rounded-full bg-mn-primary-soft/15 px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide text-mn-primary-soft",children:[a.jsx(lt,{className:"h-3 w-3","aria-hidden":!0}),a.jsx("span",{children:r.badge})]}):null]})}),a.jsx("section",{"aria-live":"polite",className:"flex-1 px-1",children:a.jsxs("div",{className:"relative min-h-[60vh] rounded-3xl border border-mn-border-subtle/60 bg-mn-bg-elevated/70 p-3 shadow-mn-soft backdrop-blur",children:[s==="forYou"&&a.jsx("div",{id:"swipe-tabpanel-forYou",role:"tabpanel",className:"h-full w-full",children:a.jsx(f_,{})}),s==="friends"&&a.jsx("div",{id:"swipe-tabpanel-friends",role:"tabpanel",className:"h-full w-full",children:a.jsx(x_,{})}),s==="trending"&&a.jsx("div",{id:"swipe-tabpanel-trending",role:"tabpanel",className:"h-full w-full",children:a.jsx(w_,{})})]})})]})},_x=s=>{if(!s)return"";try{const e=JSON.parse(s);if(!e||typeof e!="object")return typeof e=="string"?e:s;if(typeof e.text=="string")return e.text;const r=e.blocks;if(Array.isArray(r)){const i=r.map(l=>typeof(l==null?void 0:l.text)=="string"?l.text.trim():"").filter(Boolean);if(i.length>0)return i.join(`
`)}return e.type==="image"?typeof e.caption=="string"&&e.caption.trim()?e.caption:"Photo":typeof e.message=="string"?e.message:s}catch{return s}},__=s=>s.replace(/\s+/g," ").replace(/\u200B/g,"").trim(),N_=(s,e=80)=>{if(!s)return null;const r=_x(s),i=__(r);if(!i)return null;let l=i;return l.toLowerCase()==="photo"&&(l=" Photo"),l.length<=e?l:`${l.slice(0,e-1).trimEnd()}`},S_=s=>{if(!s)return null;const e=new Date(s);if(Number.isNaN(e.getTime()))return null;const i=new Date().getTime()-e.getTime(),l=Math.floor(i/1e3);if(l<45)return"Just now";const c=Math.floor(l/60);if(c<60)return`${c} min ago`;const d=Math.floor(c/60);if(d<24)return`${d} h ago`;const f=Math.floor(d/24);if(f===1)return"Yesterday";if(f<7)return`${f} days ago`;const m=Math.floor(f/7);if(m<4)return`${m} wk${m===1?"":"s"} ago`;const g=Math.floor(f/30);if(g<12)return`${g} mo${g===1?"":"s"} ago`;const y=Math.floor(g/12);return`${y} yr${y===1?"":"s"} ago`},Nx=()=>{const{user:s}=nt(),e=(s==null?void 0:s.id)??null;return _t({queryKey:["conversations",e],enabled:!!e,refetchOnWindowFocus:!1,refetchOnReconnect:!1,queryFn:async()=>{if(!e)return[];const{data:r,error:i}=await se.from("conversation_participants").select("conversation_id").eq("user_id",e);if(i)throw console.error("[useConversations] Failed to load participants",i),new Error(i.message);if(!r||r.length===0)return[];const l=Array.from(new Set(r.map(F=>F.conversation_id).filter(F=>!!F)));if(l.length===0)return[];const{data:c,error:d}=await se.from("conversations").select("id, is_group, title, created_at, updated_at, created_by").in("id",l).order("updated_at",{ascending:!1});if(d)throw console.error("[useConversations] Failed to load conversations",d),new Error(d.message);const f=c??[],{data:m,error:g}=await se.from("conversation_participants").select("conversation_id, user_id, role, created_at").in("conversation_id",l);if(g)throw console.error("[useConversations] Failed to load conversation participants",g),new Error(g.message);const y=m??[],x=Array.from(new Set(y.map(F=>F.user_id).filter(F=>!!F)));let j=new Map;if(x.length>0){const{data:F,error:G}=await se.from("profiles").select("id, username, display_name, avatar_url").in("id",x);if(G)throw console.error("[useConversations] Failed to load profiles",G),new Error(G.message);j=new Map((F??[]).map(B=>[B.id,{id:B.id,username:B.username??null,displayName:B.display_name??null,avatarUrl:B.avatar_url??null}]))}const{data:w,error:N}=await se.from("messages").select("id, conversation_id, sender_id, body, created_at").in("conversation_id",l).order("created_at",{ascending:!1});if(N)throw console.error("[useConversations] Failed to load messages",N),new Error(N.message);const _=w??[],b=new Map;for(const F of _){const G=F.conversation_id;b.has(G)||b.set(G,[]),b.get(G).push(F)}const{data:L,error:C}=await se.from("message_read_receipts").select("conversation_id, user_id, last_read_at").in("conversation_id",l);if(C)throw console.error("[useConversations] Failed to load read receipts",C),new Error(C.message);const T=new Map;for(const F of L??[]){const G=F.conversation_id,B=F.user_id,ae=F.last_read_at??null;let Y=T.get(G);Y||(Y={selfLastReadAt:null,others:[]},T.set(G,Y)),B===e?Y.selfLastReadAt=ae:Y.others.push({userId:B,lastReadAt:ae})}return[...f.map(F=>{const G=F.id,B=!!F.is_group,Y=y.filter(J=>J.conversation_id===G).map(J=>{const ne=j.get(J.user_id),D=(ne==null?void 0:ne.displayName)??(ne==null?void 0:ne.username)??"Unknown user";return{id:(ne==null?void 0:ne.id)??J.user_id,displayName:D,username:(ne==null?void 0:ne.username)??null,avatarUrl:(ne==null?void 0:ne.avatarUrl)??null,isSelf:J.user_id===e}}),xe=Y.filter(J=>!J.isSelf),ee=Y.some(J=>J.isSelf);let ue,Se;if(B)ue=F.title??(xe.length>0?xe.slice(0,3).map(J=>J.displayName).join(", "):"Group conversation"),Se=xe.length>0?`${Y.length} participants`:"Group conversation";else{const J=xe[0]??Y[0];ue=(J==null?void 0:J.displayName)??"Direct message",Se=(J==null?void 0:J.username)!=null?`@${J.username}`:ee&&xe.length===0?"Just you":"Direct message"}const Ce=(b.get(G)??[])[0],je=Ce?N_(Ce.body):null,K=Ce?Ce.created_at:F.updated_at??F.created_at,le=S_(K),Z=T.get(G),O=(Z==null?void 0:Z.selfLastReadAt)??null,A=!!K&&(!O||new Date(K).getTime()>new Date(O).getTime()),W=!!Ce&&Ce.sender_id===e;let re=!1;if(!B&&Ce&&W&&K){const ne=((Z==null?void 0:Z.others)??[])[0];if(ne!=null&&ne.lastReadAt){const D=new Date(K).getTime(),z=new Date(ne.lastReadAt).getTime();!Number.isNaN(D)&&!Number.isNaN(z)&&z>=D&&(re=!0)}}return{id:G,isGroup:B,title:ue,subtitle:Se,participants:Y,lastMessagePreview:je,lastMessageAt:K??null,lastMessageAtLabel:le,hasUnread:A,lastMessageIsFromSelf:W,lastMessageSeenByOthers:re}})].sort((F,G)=>{const B=F.lastMessageAt?new Date(F.lastMessageAt).getTime():0,ae=G.lastMessageAt?new Date(G.lastMessageAt).getTime():0,Y=Number.isNaN(B)?0:B;return(Number.isNaN(ae)?0:ae)-Y})}})},k_=()=>{const s=Bt(),{data:e,isLoading:r,isError:i,error:l}=Nx(),[c,d]=E.useState(""),f=Mr();E.useEffect(()=>{const x=se.channel("supabase_realtime_messages_publication:messages-list").on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},j=>{console.log("[MessagesPage] Realtime message for list",j),f.invalidateQueries({queryKey:["conversations"]})});return x.subscribe(j=>{console.log("[MessagesPage] Realtime channel status (list)",j)}),()=>{se.removeChannel(x)}},[f]);const m=c.trim().toLowerCase(),g=E.useMemo(()=>(e??[]).filter(x=>m?[x.title,x.subtitle,x.lastMessagePreview??"",...x.participants.map(w=>w.displayName),...x.participants.map(w=>w.username).filter(w=>!!w)].join(" ").toLowerCase().includes(m):!0),[e,m]),y=()=>{s("/search?tab=people&from=messages")};return a.jsxs("div",{className:"flex flex-1 flex-col gap-4 px-3 pb-4 pt-2 sm:px-4 lg:px-6",children:[a.jsxs("section",{className:"rounded-mn-card border border-mn-border-subtle bg-mn-bg-elevated/80 px-4 py-3 shadow-mn-soft",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-[11px] font-medium uppercase tracking-[0.18em] text-mn-text-muted",children:"Messages"}),a.jsx("h1",{className:"mt-1 text-[18px] font-heading font-semibold text-mn-text-primary sm:text-[20px]",children:"Pick up the conversation."}),a.jsx("p",{className:"mt-1 text-[11px] text-mn-text-secondary",children:"Chat with friends about what you're watching, plan movie nights, and share recommendations."})]}),a.jsxs("div",{className:"hidden shrink-0 items-center gap-1.5 rounded-mn-pill border border-mn-border-subtle bg-mn-bg px-2.5 py-2 text-[11px] text-mn-text-secondary shadow-mn-soft sm:flex",children:[a.jsx(Ot,{className:"h-3.5 w-3.5 text-mn-primary","aria-hidden":"true"}),a.jsx("span",{children:"Start a group chat to plan a watch party."})]})]}),a.jsxs("div",{className:"mt-3 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"sr-only",htmlFor:"messages-search",children:"Search conversations"}),a.jsxs("div",{className:"flex items-center gap-2 rounded-mn-pill border border-mn-border-subtle bg-mn-bg px-3 py-2 text-[12px] text-mn-text-secondary shadow-mn-soft",children:[a.jsx(sd,{className:"h-3.5 w-3.5 text-mn-text-muted","aria-hidden":"true"}),a.jsx("input",{id:"messages-search",type:"search",value:c,onChange:x=>d(x.target.value),placeholder:"Search by name or message",className:"h-6 flex-1 border-none bg-transparent text-[12px] text-mn-text-primary outline-none placeholder:text-mn-text-muted"})]})]}),a.jsx("div",{className:"mt-1.5 flex justify-end sm:mt-0 sm:ml-3",children:a.jsxs("button",{type:"button",onClick:y,className:"inline-flex items-center gap-1.5 rounded-mn-pill bg-mn-primary px-3 py-2 text-[12px] font-medium text-mn-primary-foreground shadow-mn-soft transition hover:bg-mn-primary/90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg",children:[a.jsx(Vb,{className:"h-3.5 w-3.5","aria-hidden":"true"}),a.jsx("span",{children:"New conversation"})]})})]})]}),a.jsx("section",{"aria-live":"polite",className:"flex-1",children:a.jsxs("div",{className:"rounded-mn-card border border-mn-border-subtle bg-mn-bg-elevated/80 py-1 shadow-mn-card",children:[r&&a.jsxs("div",{className:"flex min-h-[160px] flex-col items-center justify-center gap-2 px-4 py-6 text-[12px] text-mn-text-secondary",children:[a.jsx(bn,{className:"h-4 w-4 animate-spin text-mn-primary","aria-hidden":"true"}),a.jsx("p",{children:"Loading your conversations"})]}),i&&!r&&a.jsxs("div",{className:"flex min-h-[160px] flex-col items-center justify-center gap-2 px-4 py-6 text-[12px] text-mn-text-secondary",children:[a.jsx("p",{className:"font-medium text-mn-text-primary",children:"Something went wrong."}),a.jsx("p",{className:"text-[11px] text-mn-text-muted",children:(l==null?void 0:l.message)??"We couldn&apos;t load your messages. Please try again in a moment."})]}),!r&&!i&&g.length===0&&a.jsxs("div",{className:"flex min-h-[160px] flex-col items-center justify-center gap-2 px-4 py-6 text-center text-[12px] text-mn-text-secondary",children:[a.jsx("div",{className:"inline-flex h-10 w-10 items-center justify-center rounded-full bg-mn-primary/10 text-mn-primary",children:a.jsx(ua,{className:"h-5 w-5","aria-hidden":"true"})}),a.jsx("p",{className:"mt-1 text-[13px] font-medium text-mn-text-primary",children:"No conversations yet."}),a.jsxs("p",{className:"mt-1 max-w-xs text-[11px] text-mn-text-secondary",children:["When you start chatting with friends, your conversations will show up here. Tap",a.jsx("span",{className:"mx-1 rounded border border-mn-border-subtle px-1 text-[10px]",children:"New conversation"}),"to get started."]})]}),!r&&!i&&g.length>0&&a.jsx("ul",{className:"divide-y divide-mn-border-subtle px-1 py-1 sm:px-2",children:g.map(x=>{var N,_,b,L,C,T,I,q,F,G,B,ae,Y,xe,ee,ue,Se,we,Ce,je,K,le;const j=x.participants.find(Z=>!Z.isSelf)??x.participants[0]??null,w=((_=(N=j==null?void 0:j.displayName)==null?void 0:N[0])==null?void 0:_.toUpperCase())??((L=(b=j==null?void 0:j.username)==null?void 0:b[0])==null?void 0:L.toUpperCase())??"?";return a.jsx("li",{className:"py-0.5 sm:py-1",children:a.jsxs(We,{to:`/messages/${x.id}`,className:"group flex items-center gap-3 rounded-mn-card border border-transparent px-3 py-2.5 transition hover:border-mn-border-subtle hover:bg-mn-bg-elevated/80 hover:shadow-mn-soft focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg",children:[a.jsx("div",{className:"relative flex h-10 w-10 items-center justify-center",children:x.isGroup&&x.participants.length>1?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"absolute left-0 top-0 inline-flex h-7 w-7 items-center justify-center rounded-full bg-mn-bg-elevated text-[11px] font-semibold text-mn-primary ring-1 ring-mn-border-subtle",children:(C=x.participants[0])!=null&&C.avatarUrl?a.jsx("img",{src:((T=x.participants[0])==null?void 0:T.avatarUrl)??"",alt:((I=x.participants[0])==null?void 0:I.displayName)??void 0,className:"h-full w-full rounded-full object-cover",loading:"lazy"}):((G=(F=(q=x.participants[0])==null?void 0:q.displayName)==null?void 0:F[0])==null?void 0:G.toUpperCase())??((Y=(ae=(B=x.participants[0])==null?void 0:B.username)==null?void 0:ae[0])==null?void 0:Y.toUpperCase())??"?"}),a.jsx("div",{className:"absolute bottom-0 right-0 inline-flex h-7 w-7 items-center justify-center rounded-full bg-mn-bg-elevated text-[11px] font-semibold text-mn-primary ring-2 ring-mn-bg",children:(xe=x.participants[1])!=null&&xe.avatarUrl?a.jsx("img",{src:((ee=x.participants[1])==null?void 0:ee.avatarUrl)??"",alt:((ue=x.participants[1])==null?void 0:ue.displayName)??void 0,className:"h-full w-full rounded-full object-cover",loading:"lazy"}):((Ce=(we=(Se=x.participants[1])==null?void 0:Se.displayName)==null?void 0:we[0])==null?void 0:Ce.toUpperCase())??((le=(K=(je=x.participants[1])==null?void 0:je.username)==null?void 0:K[0])==null?void 0:le.toUpperCase())??"+"})]}):a.jsx("div",{className:"inline-flex h-9 w-9 items-center justify-center rounded-full bg-mn-bg-elevated text-[11px] font-semibold text-mn-primary ring-1 ring-mn-border-subtle",children:j!=null&&j.avatarUrl?a.jsx("img",{src:j.avatarUrl,alt:j.displayName??void 0,className:"h-full w-full rounded-full object-cover",loading:"lazy"}):w})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("p",{className:"flex-1 truncate text-[13px] "+(x.hasUnread?"font-semibold text-mn-text-primary":"font-medium text-mn-text-primary"),children:x.title}),a.jsxs("div",{className:"flex items-center gap-1",children:[x.lastMessageAtLabel&&a.jsx("span",{className:"shrink-0 text-[10px] text-mn-text-muted",children:x.lastMessageAtLabel}),x.lastMessageIsFromSelf&&x.lastMessageSeenByOthers&&!x.hasUnread&&a.jsx("span",{className:"shrink-0 text-[9px] text-mn-text-muted",children:"Seen"})]})]}),x.subtitle&&a.jsx("p",{className:"mt-0.5 truncate text-[11px] text-mn-text-muted",children:x.subtitle}),x.lastMessagePreview&&a.jsx("p",{className:"mt-0.5 line-clamp-1 text-[11px] text-mn-text-secondary",children:x.lastMessagePreview})]}),a.jsx("div",{className:"ml-2 flex items-center",children:x.hasUnread?a.jsx("span",{className:"inline-flex h-2.5 w-2.5 rounded-full bg-mn-primary","aria-hidden":"true"}):null})]})},x.id)})})]})})]})},E_=s=>{var j,w;const{user:e}=nt(),r=(e==null?void 0:e.id)??null,i=Mr(),l=["block-status",r,s],c=_t({queryKey:l,enabled:!!(r&&s&&r!==s),staleTime:3e4,queryFn:async()=>{if(!r||!s||r===s)return{youBlocked:!1,blockedYou:!1};const{data:N,error:_}=await se.from("blocked_users").select("blocker_id, blocked_id").or(`and(blocker_id.eq.${r},blocked_id.eq.${s}),and(blocker_id.eq.${s},blocked_id.eq.${r})`);if(_)throw console.error("[useBlockStatus] Failed to load block status",_),new Error(_.message);const b=N??[],L=b.some(T=>T.blocker_id===r&&T.blocked_id===s),C=b.some(T=>T.blocker_id===s&&T.blocked_id===r);return{youBlocked:L,blockedYou:C}}}),d=wn({mutationFn:async()=>{if(!r||!s)throw new Error("Missing user ids for block operation.");const{error:N}=await se.from("blocked_users").upsert({blocker_id:r,blocked_id:s},{onConflict:"blocker_id,blocked_id"});if(N)throw console.error("[useBlockStatus] Failed to block user",N),new Error(N.message)},onSuccess:()=>{i.invalidateQueries({queryKey:l})}}),f=wn({mutationFn:async()=>{if(!r||!s)throw new Error("Missing user ids for unblock operation.");const{error:N}=await se.from("blocked_users").delete().eq("blocker_id",r).eq("blocked_id",s);if(N)throw console.error("[useBlockStatus] Failed to unblock user",N),new Error(N.message)},onSuccess:()=>{i.invalidateQueries({queryKey:l})}}),m=((j=c.data)==null?void 0:j.youBlocked)??!1,g=((w=c.data)==null?void 0:w.blockedYou)??!1,y=m||g,x=d.isPending||f.isPending;return{youBlocked:m,blockedYou:g,isBlocked:y,isLoading:c.isLoading||x,isError:c.isError,error:c.error??null,block:d,unblock:f}},_p=s=>{const e=new Date(s);return Number.isNaN(e.getTime())?"":e.toLocaleTimeString(void 0,{hour:"numeric",minute:"2-digit",hour12:!0})},C_=s=>_t({queryKey:["conversation",s,"messages"],enabled:!!s,refetchOnWindowFocus:!1,refetchOnReconnect:!1,queryFn:async()=>{if(!s)return[];const{data:e,error:r}=await se.from("messages").select("id, conversation_id, sender_id, body, attachment_url, created_at").eq("conversation_id",s).order("created_at",{ascending:!0});if(r)throw console.error("[ConversationPage] Failed to load messages",r),new Error(r.message);return(e??[]).map(i=>({id:i.id,conversationId:i.conversation_id,senderId:i.sender_id,body:i.body??null,attachmentUrl:i.attachment_url??null,createdAt:i.created_at}))}}),P_=s=>_t({queryKey:["conversation",s,"readReceipts"],enabled:!!s,refetchOnWindowFocus:!1,refetchOnReconnect:!1,queryFn:async()=>{if(!s)return[];const{data:e,error:r}=await se.from("message_read_receipts").select("user_id, conversation_id, last_read_at, last_read_message_id").eq("conversation_id",s);if(r)throw console.error("[ConversationPage] Failed to load read receipts",r),new Error(r.message);return(e??[]).map(i=>({userId:i.user_id,lastReadAt:i.last_read_at??null,lastReadMessageId:i.last_read_message_id??null}))}}),T_=s=>{const{user:e}=nt(),r=(e==null?void 0:e.id)??null,i=Mr();return wn({mutationFn:async l=>{const c=l.trim();if(!c)return null;if(!s)throw new Error("Missing conversation id.");if(!r)throw new Error("You must be signed in to send messages.");const d=JSON.stringify({type:"text",text:c}),{data:f,error:m}=await se.from("messages").insert({conversation_id:s,sender_id:r,body:d}).select("id, conversation_id, sender_id, body, attachment_url, created_at").single();if(m)throw console.error("[ConversationPage] Failed to send message",m),new Error(m.message);const g={id:f.id,conversationId:f.conversation_id,senderId:f.sender_id,body:f.body??null,attachmentUrl:f.attachment_url??null,createdAt:f.created_at};try{await se.from("conversations").update({updated_at:new Date().toISOString()}).eq("id",s)}catch(y){console.error("[ConversationPage] Failed to update conversation timestamp",y)}return i.setQueriesData({queryKey:["conversation",s,"messages"]},y=>{const x=y??[];return x.some(w=>w.id===g.id)?x:[...x,g]}),i.invalidateQueries({queryKey:["conversations"]}),g}})},R_=()=>{const{conversationId:s}=Zu(),e=s??null,r=Bt(),{user:i}=nt(),l=Mr(),{data:c,isLoading:d}=Nx(),{data:f,isLoading:m,isError:g,error:y}=C_(e),x=T_(e),[j,w]=E.useState(""),N=E.useRef(null),_=E.useMemo(()=>!e||!c?null:c.find(A=>A.id===e)??null,[e,c]),b=E.useMemo(()=>{const A=new Map;if(!_)return A;for(const W of _.participants)A.set(W.id,W);return A},[_]),L=(_==null?void 0:_.isGroup)??!1,C=E.useMemo(()=>{if(!_)return null;const A=_.participants.filter(W=>!W.isSelf);return A.length>0?A[0]:_.participants.length===1?_.participants[0]:null},[_]),{youBlocked:T,blockedYou:I,isBlocked:q,isLoading:F,block:G,unblock:B}=E_(L?null:(C==null?void 0:C.id)??null),ae=((f==null?void 0:f.length)??0)>0,Y=d||m||F;E.useEffect(()=>{if(!e||!f||f.length===0||!(i!=null&&i.id))return;const A=f[f.length-1];se.from("message_read_receipts").upsert({conversation_id:e,user_id:i.id,last_read_message_id:A.id,last_read_at:new Date().toISOString()},{onConflict:"conversation_id,user_id"}).then(({error:W})=>{W&&console.error("[ConversationPage] Failed to upsert read receipt",W)})},[e,f,i==null?void 0:i.id]);const[xe,ee]=E.useState([]),ue=E.useRef(new Map),Se=E.useRef(null),we=E.useRef({isTyping:!1,timeoutId:null}),{data:Ce}=P_(e),je=E.useMemo(()=>{if(!f||!(i!=null&&i.id))return null;const A=f.filter(W=>W.senderId===i.id);return A.length>0?A[A.length-1]:null},[f,i==null?void 0:i.id]),K=E.useMemo(()=>{if(!_||!je||!Ce||!(i!=null&&i.id))return null;const A=_.participants.filter(J=>!J.isSelf);if(A.length===0)return null;const W=[];let re=null;for(const J of A){const ne=Ce.find(te=>te.userId===J.id);if(!ne||!ne.lastReadAt)continue;const D=new Date(ne.lastReadAt).getTime(),z=new Date(je.createdAt).getTime();Number.isNaN(D)||Number.isNaN(z)||D>=z&&(W.push(J),(!re||D<new Date(re).getTime())&&(re=ne.lastReadAt))}return W.length===0?null:{seenParticipants:W,earliestSeenAt:re}},[_,je,Ce,i==null?void 0:i.id]);E.useEffect(()=>{var A;!f||f.length===0||(A=N.current)==null||A.scrollIntoView({behavior:"smooth"})},[f==null?void 0:f.length]),E.useEffect(()=>{if(!e||!(i!=null&&i.id))return;const A=se.channel(`supabase_realtime_typing:conversation:${e}`,{config:{broadcast:{self:!1}}});return Se.current=A,A.on("broadcast",{event:"typing"},({payload:W})=>{const re=W;if(!re||re.userId===i.id)return;const J=b.get(re.userId),ne=(J==null?void 0:J.displayName)??"Someone",D=re.userId,z=ue.current.get(D);if(z!=null&&window.clearTimeout(z),re.isTyping){ee(ke=>ke.includes(ne)?ke:[...ke,ne]);const te=window.setTimeout(()=>{ue.current.delete(D),ee(ke=>ke.filter(Xe=>Xe!==ne))},4e3);ue.current.set(D,te)}else ue.current.delete(D),ee(te=>te.filter(ke=>ke!==ne))}).subscribe(W=>{console.log("[ConversationPage] Typing channel status",W)}),()=>{ue.current.forEach(W=>window.clearTimeout(W)),ue.current.clear(),A&&se.removeChannel(A),Se.current=null}},[e,i==null?void 0:i.id,b]),E.useEffect(()=>{if(!e)return;const A=se.channel(`supabase_realtime_messages_publication:conversation:${e}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`conversation_id=eq.${e}`},W=>{console.log("[ConversationPage] Realtime message payload",W);const re=W.new;if(i!=null&&i.id&&re.sender_id===i.id)return;const J={id:re.id,conversationId:re.conversation_id,senderId:re.sender_id,body:re.body,attachmentUrl:re.attachment_url,createdAt:re.created_at};l.setQueryData(["conversation",e,"messages"],ne=>{const D=ne??[];if(D.some(ke=>ke.id===J.id))return D;const te=[...D,J];return te.sort((ke,Xe)=>new Date(ke.createdAt).getTime()-new Date(Xe.createdAt).getTime()),te}),l.invalidateQueries({queryKey:["conversations"]})});return A.subscribe(W=>{console.log("[ConversationPage] Realtime channel status (messages)",W),W==="CHANNEL_ERROR"&&console.error("[ConversationPage] Realtime channel error for messages",W)}),()=>{se.removeChannel(A)}},[e,l,i==null?void 0:i.id]),E.useEffect(()=>{if(!e||!f||f.length===0||!(i!=null&&i.id))return;const A=f[f.length-1];se.from("message_read_receipts").upsert({conversation_id:e,user_id:i.id,last_read_message_id:A.id,last_read_at:new Date().toISOString()},{onConflict:"conversation_id,user_id"}).then(()=>{l.invalidateQueries({queryKey:["conversations"]})}).catch(W=>{console.error("[ConversationPage] Failed to update read receipt",W)})},[e,f,i==null?void 0:i.id,l]),E.useEffect(()=>{if(!e)return;const A=se.channel(`supabase_realtime_read_receipts:conversation:${e}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"message_read_receipts",filter:`conversation_id=eq.${e}`},()=>{l.invalidateQueries({queryKey:["conversation",e,"readReceipts"]})}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"message_read_receipts",filter:`conversation_id=eq.${e}`},()=>{l.invalidateQueries({queryKey:["conversation",e,"readReceipts"]})}).subscribe(W=>{console.log("[ConversationPage] Realtime channel status (read receipts)",W),W==="CHANNEL_ERROR"&&console.error("[ConversationPage] Realtime channel error for read receipts",W)});return()=>{se.removeChannel(A)}},[e,l]);const le=A=>{const W=Se.current;if(!W||!e||!i)return;const J=A.trim().length>0,ne=we.current.isTyping;J&&!ne&&(we.current.isTyping=!0,W.send({type:"broadcast",event:"typing",payload:{userId:i.id,isTyping:!0}})),we.current.timeoutId!=null&&window.clearTimeout(we.current.timeoutId),J?we.current.timeoutId=window.setTimeout(()=>{we.current.isTyping=!1,W.send({type:"broadcast",event:"typing",payload:{userId:i.id,isTyping:!1}})},3e3):!J&&ne&&(we.current.isTyping=!1,W.send({type:"broadcast",event:"typing",payload:{userId:i.id,isTyping:!1}}))},Z=A=>{const W=A.target.value;w(W),le(W)},O=async A=>{if(A.preventDefault(),q)return;const W=j.trim();if(!(!W||x.isPending))try{await x.mutateAsync(W),w(""),le("")}catch(re){console.error("[ConversationPage] handleSubmit failed",re)}};return e?a.jsx("div",{className:"flex h-full min-h-[60vh] flex-1 flex-col items-stretch bg-gradient-to-b from-mn-bg-elevated/80 to-mn-bg",children:a.jsxs("div",{className:"mx-auto flex h-full w-full max-w-2xl flex-1 flex-col items-stretch border-x border-mn-border-subtle/60 bg-mn-bg/95",children:[a.jsxs("header",{className:"sticky top-0 z-20 flex items-center justify-between border-b border-mn-border-subtle/70 bg-mn-bg/95 px-3 py-2.5 backdrop-blur-md",children:[a.jsxs("div",{className:"flex min-w-0 items-center gap-3",children:[a.jsxs("button",{type:"button",onClick:()=>r("/messages"),className:"inline-flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-full text-mn-text-primary hover:bg-mn-bg-elevated/80 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg",children:[a.jsx(Tb,{className:"h-4 w-4","aria-hidden":"true"}),a.jsx("span",{className:"sr-only",children:"Back to messages"})]}),a.jsxs("div",{className:"flex min-w-0 items-center gap-2",children:[a.jsx("div",{className:"flex h-9 w-9 flex-shrink-0 items-center justify-center overflow-hidden rounded-full bg-mn-bg-elevated/90 ring-1 ring-mn-border-subtle",children:!L&&C?C.avatarUrl?a.jsx("img",{src:C.avatarUrl,alt:C.displayName??void 0,className:"h-full w-full object-cover",loading:"lazy"}):a.jsx("span",{className:"text-[13px] font-semibold text-mn-text-primary",children:(C.displayName??"U").slice(0,2).toUpperCase()}):a.jsx(Ot,{className:"h-4 w-4 text-mn-text-secondary","aria-hidden":"true"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("h1",{className:"truncate text-[15px] font-heading font-semibold text-mn-text-primary",children:(_==null?void 0:_.title)??(C==null?void 0:C.displayName)??"Conversation"}),a.jsx("p",{className:"truncate text-[11px] text-mn-text-secondary",children:_?_.lastMessageAtLabel?`Active ${_.lastMessageAtLabel}`:_.subtitle??(L?`${_.participants.length} participants`:"Active"):d?"Loading":"Details unavailable"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-1.5 text-mn-text-secondary",children:[_&&_.participants.length>1&&a.jsx("button",{type:"button",className:"inline-flex h-8 w-8 items-center justify-center rounded-full hover:bg-mn-bg-elevated/80","aria-label":"Audio call",children:a.jsx(qb,{className:"h-4 w-4","aria-hidden":"true"})}),_&&_.participants.length>1&&a.jsx("button",{type:"button",className:"inline-flex h-8 w-8 items-center justify-center rounded-full hover:bg-mn-bg-elevated/80","aria-label":"Video call",children:a.jsx(Jb,{className:"h-4 w-4","aria-hidden":"true"})}),_&&a.jsx("button",{type:"button",className:"inline-flex h-8 w-8 items-center justify-center rounded-full hover:bg-mn-bg-elevated/80","aria-label":"Conversation info",children:a.jsx(Db,{className:"h-4 w-4","aria-hidden":"true"})}),!L&&C&&a.jsxs("button",{type:"button",disabled:G.isPending||B.isPending,onClick:()=>{T?B.mutate():G.mutate()},className:"ml-1 hidden items-center gap-1 rounded-full border border-mn-border-subtle bg-mn-bg-elevated/80 px-2.5 py-1 text-[10px] text-mn-text-secondary hover:border-mn-primary/70 hover:text-mn-text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg disabled:opacity-60 sm:inline-flex",children:[(G.isPending||B.isPending)&&a.jsx(bn,{className:"h-3 w-3 animate-spin","aria-hidden":"true"}),a.jsx("span",{children:T?"Unblock":"Block"})]})]})]}),a.jsx("section",{className:"flex min-h-0 flex-1 flex-col",children:a.jsxs("div",{className:"flex min-h-0 flex-1 flex-col bg-mn-bg/95",children:[a.jsxs("div",{className:"flex flex-1 flex-col overflow-y-auto px-3 py-3 text-sm",children:[Y&&!ae&&a.jsx("div",{className:"flex h-full items-center justify-center",children:a.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-mn-border-subtle bg-mn-bg/80 px-3 py-1.5 text-[12px] text-mn-text-secondary",children:[a.jsx(bn,{className:"h-3.5 w-3.5 animate-spin","aria-hidden":"true"}),a.jsx("span",{children:"Loading messages"})]})}),g&&a.jsxs("div",{className:"mb-3 rounded-md border border-mn-border-subtle bg-mn-bg/90 px-3 py-2 text-[12px] text-mn-error",children:[a.jsx("p",{className:"font-medium",children:"We couldn't load this conversation."}),y instanceof Error&&a.jsx("p",{className:"mt-1 text-[11px] text-mn-text-secondary",children:y.message})]}),!Y&&!g&&!ae&&a.jsx("div",{className:"flex h-full items-center justify-center",children:a.jsxs("div",{className:"text-center text-[12px] text-mn-text-secondary",children:[a.jsx("p",{className:"font-medium",children:L?"No messages in this group yet.":"No messages yet."}),a.jsx("p",{className:"mt-1",children:L?"Be the first to start the conversation.":"Say hi to start the conversation."})]})}),f==null?void 0:f.map((A,W)=>{const re=b.get(A.senderId),J=(re==null?void 0:re.isSelf)??((i==null?void 0:i.id)!=null&&A.senderId===i.id),ne=je!=null&&je.id===A.id,D=W>0?(f==null?void 0:f[W-1])??null:null,z=W<((f==null?void 0:f.length)??0)-1?(f==null?void 0:f[W+1])??null:null,te=D!=null&&D.senderId===A.senderId,ke=z!=null&&z.senderId===A.senderId,Xe=te&&Np(D.createdAt,A.createdAt),cr=ke&&Np(A.createdAt,z.createdAt),ns=!(te&&Xe),ss=!(ke&&cr),ri=W===0||D!=null&&!Hu(new Date(D.createdAt),new Date(A.createdAt)),fa=W===0||ri?"mt-0":ns?"mt-3":"mt-1.5",ni=J?"bg-gradient-to-r from-mn-primary to-mn-primary/80 text-mn-bg":"border border-mn-border-subtle bg-mn-bg/95 text-mn-text-primary",ma=J?"rounded-tr-3xl rounded-tl-3xl rounded-bl-3xl rounded-br-lg":"rounded-tr-3xl rounded-tl-3xl rounded-br-3xl rounded-bl-lg",si=(re==null?void 0:re.displayName)??(J?"You":"Someone"),Ur=_x(A.body),Dr=!J&&ss,ii=ss,pa=J?"text-right":"text-left";return a.jsxs(Ft.Fragment,{children:[ri&&a.jsx("div",{className:"my-3 flex items-center justify-center",children:a.jsxs("div",{className:"inline-flex items-center gap-2 text-[11px] text-mn-text-muted",children:[a.jsx("span",{className:"h-px w-10 bg-mn-border-subtle","aria-hidden":"true"}),a.jsx("span",{className:"rounded-full bg-mn-bg/95 px-2.5 py-0.5 shadow-mn-soft/50",children:O_(A.createdAt)}),a.jsx("span",{className:"h-px w-10 bg-mn-border-subtle","aria-hidden":"true"})]})}),a.jsxs("div",{className:`flex w-full flex-col gap-0.5 ${fa}`,children:[a.jsxs("div",{className:`flex w-full items-end gap-2 ${J?"justify-end":"justify-start"}`,children:[!J&&a.jsx(a.Fragment,{children:Dr?a.jsx("div",{className:"mt-auto h-7 w-7 flex-shrink-0 overflow-hidden rounded-full bg-mn-bg/80 ring-1 ring-mn-border-subtle",children:re!=null&&re.avatarUrl?a.jsx("img",{src:re.avatarUrl,alt:re.displayName??void 0,className:"h-full w-full object-cover",loading:"lazy"}):a.jsx("div",{className:"flex h-full w-full items-center justify-center text-[11px] font-medium text-mn-text-secondary",children:si.slice(0,2).toUpperCase()})}):a.jsx("div",{className:"mt-auto h-7 w-7 flex-shrink-0"})}),a.jsx("div",{className:`inline-flex max-w-[80%] px-3 py-2 text-[13px] shadow-mn-soft ${ma} ${ni}`,children:a.jsxs("div",{className:"flex flex-col",children:[Ur&&a.jsx("p",{className:"whitespace-pre-wrap break-all text-[13px] leading-snug",children:Ur}),A.attachmentUrl&&a.jsxs("a",{href:A.attachmentUrl,target:"_blank",rel:"noreferrer",className:"mt-1 inline-flex text-[12px] font-medium underline-offset-2 hover:underline",children:[a.jsx(Um,{className:"mr-1 h-3 w-3","aria-hidden":"true"}),"Attachment"]})]})})]}),a.jsx("div",{className:`flex w-full ${J?"justify-end":"justify-start"}`,children:ii&&a.jsx("p",{className:`mt-0.5 text-[10px] text-mn-text-muted ${pa}`,children:_p(A.createdAt)})}),J&&ne&&K&&a.jsx("div",{className:"flex w-full justify-end",children:a.jsx("p",{className:"mt-0.5 text-[10px] text-mn-text-muted",children:L?K.seenParticipants.length===1?`Seen by ${K.seenParticipants[0].displayName}`:`Seen by ${K.seenParticipants[0].displayName} and ${K.seenParticipants.length-1} others`:K.earliestSeenAt?`Seen ${_p(K.earliestSeenAt)}`:"Seen"})})]})]},A.id)}),xe.length>0&&a.jsxs("div",{className:"mt-1 flex items-center justify-start gap-2 text-[11px] text-mn-text-muted",children:[a.jsx("span",{children:L?xe.length===1?`${xe[0]} is typing`:xe.length===2?`${xe[0]} and ${xe[1]} are typing`:"Several people are typing":"Typing"}),a.jsxs("span",{className:"inline-flex items-center gap-0.5","aria-hidden":"true",children:[a.jsx("span",{className:"h-1.5 w-1.5 animate-bounce rounded-full bg-mn-text-muted"}),a.jsx("span",{className:"h-1.5 w-1.5 animate-bounce rounded-full bg-mn-text-muted"}),a.jsx("span",{className:"h-1.5 w-1.5 animate-bounce rounded-full bg-mn-text-muted"})]})]}),a.jsx("div",{ref:N})]}),!q&&!I&&a.jsx("form",{onSubmit:O,className:"sticky bottom-0 z-20 border-t border-mn-border-subtle bg-mn-bg/95 px-3 py-2",children:a.jsxs("div",{className:"flex items-end gap-2",children:[a.jsx("button",{type:"button",className:"inline-flex h-9 w-9 flex-shrink-0 items-center justify-center rounded-full text-mn-text-secondary hover:bg-mn-bg-elevated/80 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg","aria-label":"Add emoji",children:a.jsx(Qb,{className:"h-4 w-4","aria-hidden":"true"})}),a.jsxs("div",{className:"flex min-h-[40px] max-h-[120px] flex-1 items-end rounded-full border border-mn-border-subtle/80 bg-mn-bg-elevated/90 px-3 py-2",children:[a.jsx("textarea",{id:"conversation-message",value:j,onChange:Z,onKeyDown:A=>{var W;A.key==="Enter"&&!A.shiftKey&&(A.preventDefault(),j.trim()&&((W=A.currentTarget.form)==null||W.requestSubmit()))},placeholder:"Message",rows:1,className:"max-h-[72px] flex-1 resize-none bg-transparent text-[13px] text-mn-text-primary outline-none placeholder:text-mn-text-muted"}),a.jsx("button",{type:"button",className:"ml-1 inline-flex h-7 w-7 flex-shrink-0 items-center justify-center rounded-full text-mn-text-secondary hover:bg-mn-bg/80","aria-label":"Add attachment",children:a.jsx(Um,{className:"h-3.5 w-3.5","aria-hidden":"true"})})]}),a.jsx("button",{type:"submit",disabled:!j.trim()||x.isPending,className:"inline-flex h-9 w-9 flex-shrink-0 items-center justify-center rounded-full bg-mn-primary text-mn-bg shadow-mn-soft transition disabled:cursor-not-allowed disabled:opacity-50","aria-label":"Send message",children:x.isPending?a.jsx(bn,{className:"h-4 w-4 animate-spin","aria-hidden":"true"}):a.jsx(Hb,{className:"h-4 w-4","aria-hidden":"true"})})]})}),I&&a.jsx("div",{className:"border-t border-mn-border-subtle bg-mn-bg/95 px-4 py-3 text-center text-[11px] text-mn-text-muted",children:a.jsx("p",{children:"You can't send messages because this user has blocked you."})}),q&&!I&&a.jsx("div",{className:"border-t border-mn-border-subtle bg-mn-bg/95 px-4 py-3 text-center text-[11px] text-mn-text-muted",children:a.jsx("p",{children:"You've blocked this user. Unblock them to continue the conversation."})})]})})]})}):a.jsx("div",{className:"flex min-h-[60vh] items-center justify-center px-4",children:a.jsxs("div",{className:"max-w-md rounded-mn-card border border-mn-border-subtle bg-mn-bg-elevated/80 px-5 py-6 text-center text-sm text-mn-text-primary shadow-mn-card",children:[a.jsx("h1",{className:"text-base font-heading font-semibold",children:"Conversation not found"}),a.jsx("p",{className:"mt-2 text-xs text-mn-text-secondary",children:"This page is meant to be opened from your messages list."}),a.jsx("p",{className:"mt-4",children:a.jsx(We,{to:"/messages",className:"inline-flex items-center justify-center rounded-full border border-mn-border-subtle bg-mn-bg px-3 py-1.5 text-[12px] font-medium text-mn-text-primary shadow-mn-soft transition hover:border-mn-primary/70 hover:text-mn-text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg",children:"Back to messages"})})]})})},Hu=(s,e)=>s.getFullYear()===e.getFullYear()&&s.getMonth()===e.getMonth()&&s.getDate()===e.getDate(),O_=s=>{const e=new Date(s);if(Number.isNaN(e.getTime()))return"";const r=new Date,i=new Date;return i.setDate(r.getDate()-1),Hu(e,r)?"Today":Hu(e,i)?"Yesterday":e.toLocaleDateString(void 0,{day:"numeric",month:"short",year:"numeric"})},Np=(s,e,r=180*1e3)=>{const i=new Date(s),l=new Date(e);return Number.isNaN(i.getTime())||Number.isNaN(l.getTime())?!1:l.getTime()-i.getTime()<=r},A_=(s,e)=>{const[r,i]=E.useState(s);return E.useEffect(()=>{const l=window.setTimeout(()=>{i(s)},e);return()=>{window.clearTimeout(l)}},[s,e]),r};function Sx(s){return{imdbId:s.imdbID,title:s.Title??"Untitled",year:s.Year&&Number.parseInt(s.Year,10)||null,posterUrl:s.Poster&&s.Poster!=="N/A"?s.Poster:null,source:"omdb"}}async function Sp(s){const e="df7bc25c",r=s.trim();if(!r)return[];const i=new URL("https://www.omdbapi.com/");i.searchParams.set("apikey",e),i.searchParams.set("s",r),i.searchParams.set("type","movie"),i.searchParams.set("page","1");const l=await fetch(i.toString());if(!l.ok)return console.warn("[externalMovieSearch] OMDb fallback returned HTTP error:",l.status),[];if(!(l.headers.get("content-type")??"").toLowerCase().includes("application/json")){const f=await l.text();return console.warn("[externalMovieSearch] OMDb fallback returned non-JSON response:",f.slice(0,120)),[]}const d=await l.json();return d.Response==="False"||!d.Search||d.Search.length===0?[]:d.Search.map(Sx)}async function I_(s){const e=s.trim();if(!e)return[];try{const{data:r,error:i}=await se.functions.invoke("omdb-search",{method:"POST",body:{query:e,type:"movie"}});return i?(console.warn("[externalMovieSearch] edge function error:",i),Sp(e)):!r||r.Response==="False"||!r.Search||r.Search.length===0?[]:r.Search.map(Sx)}catch(r){return console.warn("[externalMovieSearch] unexpected error, falling back to direct OMDb:",r),Sp(e)}}const L_=s=>{const{query:e,filters:r}=s,i=e.trim();return _t({queryKey:["search","titles",{query:i,filters:r}],enabled:i.length>0,queryFn:async()=>{let l=se.from("titles").select("id, title, year, type, poster_url, original_language, age_rating").order("year",{ascending:!1}).limit(20);i&&(i.length>=3?l=l.textSearch("search_vector",i,{type:"plain"}):l=l.ilike("title",`%${i}%`)),r!=null&&r.type&&r.type!=="all"&&(l=l.eq("type",r.type)),typeof(r==null?void 0:r.minYear)=="number"&&(l=l.gte("year",r.minYear)),typeof(r==null?void 0:r.maxYear)=="number"&&(l=l.lte("year",r.maxYear)),r!=null&&r.originalLanguage&&(l=l.eq("original_language",r.originalLanguage));const{data:c,error:d}=await l;if(d)throw new Error(d.message);const f=c??[];return!f.length&&i.length>=3?I_(i):f.map(m=>({id:m.id,title:m.title??"Untitled",year:m.year??null,type:m.type??null,posterUrl:m.poster_url??null,originalLanguage:m.original_language??null,ageRating:m.age_rating??null}))}})},M_=({query:s,filters:e})=>{const r=s.trim(),{data:i,isLoading:l,isError:c,error:d}=L_({query:r,filters:e});if(!r)return a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-[12px] text-mn-text-secondary",children:"Start typing a title, director, or genre to search the catalog. As you wire Supabase search, results will appear here."}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("p",{className:"text-[11px] font-medium text-mn-text-primary",children:"Try searching for"}),a.jsx("div",{className:"flex flex-wrap gap-1.5 text-[11px]",children:["Comfort movie for a rainy night","Slow & cozy drama","Animated comfort series","Scifi with found family"].map(m=>a.jsxs("span",{className:"inline-flex items-center rounded-full border border-mn-border-subtle bg-mn-bg px-2 py-1 text-[11px] text-mn-text-secondary",children:[a.jsx(ht,{className:"mr-1 h-3 w-3 text-mn-text-muted","aria-hidden":"true"}),m]},m))})]}),a.jsxs("div",{className:"space-y-1.5 rounded-mn-card border border-mn-border-subtle bg-mn-bg/60 p-3",children:[a.jsxs("p",{className:"flex items-center gap-1 text-[11px] font-medium text-mn-text-primary",children:[a.jsx(yr,{className:"h-3.5 w-3.5 text-mn-primary","aria-hidden":"true"}),a.jsx("span",{children:"Trending this week"})]}),a.jsx("p",{className:"text-[11px] text-mn-text-muted",children:"Once analytics are wired up, you can show what your friends and the community are watching the most here."})]})]});if(l)return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("div",{className:"h-3 w-40 rounded bg-mn-border-subtle/40"}),a.jsx("div",{className:"h-3 w-32 rounded bg-mn-border-subtle/30"})]}),a.jsx("div",{className:"space-y-1.5 rounded-mn-card border border-mn-border-subtle bg-mn-bg/60 p-2.5",children:[0,1,2].map(m=>a.jsxs("div",{className:"flex items-center gap-3 rounded-xl px-1 py-1.5",children:[a.jsx("div",{className:"h-9 w-9 rounded-lg bg-mn-border-subtle/40"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("div",{className:"h-3 w-32 rounded bg-mn-border-subtle/40"}),a.jsx("div",{className:"h-2.5 w-24 rounded bg-mn-border-subtle/30"})]})]},m))})]});if(c)return a.jsxs("div",{role:"alert",className:"space-y-1 rounded-mn-card border border-mn-error/60 bg-mn-error/10 p-3 text-[11px] text-mn-error",children:[a.jsx("p",{className:"font-medium",children:"We couldn't search titles right now."}),a.jsx("p",{className:"text-[10px] opacity-90",children:d instanceof Error?d.message:"Unknown error. Please try again."})]});const f=i??[];return f.length?a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("p",{className:"text-[11px] text-mn-text-secondary",children:["Showing ",f.length," title",f.length===1?"":"s"," for"," ",a.jsxs("span",{className:"rounded border border-mn-border-subtle/80 bg-mn-bg px-1.5 py-0.5 text-[11px] font-medium text-mn-text-primary",children:["",r,""]}),"."]}),a.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-mn-border-subtle/70 bg-mn-bg/80 px-2 py-0.5 text-[10px] text-mn-text-muted",children:[a.jsx(id,{className:"h-3 w-3","aria-hidden":"true"}),a.jsx("span",{children:"Filters coming soon"})]})]}),a.jsx("ul",{className:"divide-y divide-mn-border-subtle/60 rounded-mn-card border border-mn-border-subtle bg-mn-bg/60",children:f.map(m=>{const g=[];return m.type&&g.push(m.type==="movie"?"Movie":m.type==="series"?"Series":m.type==="anime"?"Anime":"Short"),m.ageRating&&g.push(m.ageRating),m.originalLanguage&&g.push(m.originalLanguage.toUpperCase()),a.jsx("li",{children:a.jsxs(We,{to:`/title/${m.id}`,className:"flex gap-3 px-3 py-2 transition hover:bg-mn-border-subtle/40 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg",children:[a.jsx("div",{className:"mt-0.5 inline-flex h-9 w-9 shrink-0 items-center justify-center rounded-md bg-mn-primary/20 text-mn-primary",children:a.jsx(ht,{className:"h-4 w-4","aria-hidden":"true"})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsxs("p",{className:"truncate text-[13px] font-medium text-mn-text-primary",children:[m.title,m.year?a.jsxs("span",{className:"ml-1 text-[11px] font-normal text-mn-text-muted",children:["(",m.year,")"]}):null]}),g.length>0&&a.jsx("p",{className:"mt-0.5 text-[11px] text-mn-text-secondary",children:g.join("  ")})]})]})},m.id)})})]}):a.jsx("div",{className:"space-y-3",children:a.jsxs("p",{className:"text-[12px] text-mn-text-secondary",children:["No titles found for"," ",a.jsxs("span",{className:"rounded border border-mn-border-subtle/80 bg-mn-bg px-1.5 py-0.5 text-[11px] font-medium text-mn-text-primary",children:["",r,""]}),". Try another spelling, or a different title."]})})},U_=s=>{const e=s.trim(),{user:r}=nt();return _t({queryKey:["search","people",{query:e,userId:(r==null?void 0:r.id)??null}],enabled:e.length>0,queryFn:async()=>{const i=e.replace(/%/g,"\\%").replace(/_/g,"\\_"),l=await se.from("profiles").select("id, username, display_name, avatar_url, bio").or(`username.ilike.%${i}%,display_name.ilike.%${i}%`).limit(20);if(l.error)throw new Error(l.error.message);const c=l.data??[],d=c.map(y=>y.id);let f=new Map;if(d.length){const y=await se.from("user_stats").select("user_id, followers_count, following_count").in("user_id",d);y.error?console.warn("[useSearchPeople] Failed to load user_stats",y.error.message):f=new Map((y.data??[]).map(x=>[x.user_id,{followersCount:x.followers_count??0,followingCount:x.following_count??0}]))}if(!(r!=null&&r.id))return c.map(y=>{const x=f.get(y.id);return{id:y.id,username:y.username,displayName:y.display_name,avatarUrl:y.avatar_url,bio:y.bio,followersCount:(x==null?void 0:x.followersCount)??null,followingCount:(x==null?void 0:x.followingCount)??null,isFollowing:!1}});const m=await se.from("follows").select("followed_id").eq("follower_id",r.id);m.error&&console.warn("[useSearchPeople] Failed to load follows for current user",m.error.message);const g=new Set((m.data??[]).map(y=>y.followed_id));return c.map(y=>{const x=f.get(y.id);return{id:y.id,username:y.username,displayName:y.display_name,avatarUrl:y.avatar_url,bio:y.bio,followersCount:(x==null?void 0:x.followersCount)??null,followingCount:(x==null?void 0:x.followingCount)??null,isFollowing:g.has(y.id)}})}})},kx=()=>{const{user:s}=nt(),e=Mr();return wn({mutationFn:async({targetUserId:r,currentlyFollowing:i})=>{if(!s)throw new Error("You need to be signed in to follow people.");if(s.id===r)throw new Error("You cant follow yourself.");if(i){const{error:c}=await se.from("follows").delete().eq("follower_id",s.id).eq("followed_id",r);if(c)throw c;return{isFollowing:!1}}const{error:l}=await se.from("follows").insert({follower_id:s.id,followed_id:r});if(l&&l.code!=="23505")throw l;return{isFollowing:!0}},onSuccess:(r,i)=>{const{targetUserId:l}=i,{isFollowing:c}=r;e.setQueriesData({queryKey:["search","people"]},d=>d&&d.map(f=>f.id===l?{...f,isFollowing:c}:f)),e.invalidateQueries({queryKey:["profile"]})}})},D_=({query:s})=>{const e=s.trim(),{data:r,isLoading:i,isError:l,error:c}=U_(e),d=kx(),f=Bt(),{user:m}=nt(),[g,y]=E.useState(null),x=r??[],j=async w=>{if(!(m!=null&&m.id)){alert("You need to be signed in to start a conversation.");return}if(m.id===w){alert("You can't start a conversation with yourself.");return}y(w);try{const N=m.id,{data:_,error:b}=await se.from("conversation_participants").select("conversation_id").eq("user_id",N);if(b)throw b;const L=(_??[]).map(T=>T.conversation_id);let C=null;if(L.length>0){const{data:T,error:I}=await se.from("conversation_participants").select("conversation_id").eq("user_id",w).in("conversation_id",L);if(I)throw I;const q=Array.from(new Set((T??[]).map(F=>F.conversation_id)));if(q.length>0){const{data:F,error:G}=await se.from("conversations").select("id, is_group, updated_at").in("id",q).eq("is_group",!1).order("updated_at",{ascending:!1}).limit(1);if(G)throw G;F&&F.length>0&&(C=F[0].id)}}if(!C){const{data:T,error:I}=await se.from("conversations").insert({is_group:!1,title:null,created_by:N}).select("id").single();if(I)throw I;const q=T==null?void 0:T.id,{error:F}=await se.from("conversation_participants").insert([{conversation_id:q,user_id:N,role:"member"},{conversation_id:q,user_id:w,role:"member"}]);if(F)throw F;C=q}if(!C)throw new Error("Failed to determine conversation id.");f(`/messages/${C}`)}catch(N){console.error("[SearchPeopleTab] Failed to start conversation",N),alert((N==null?void 0:N.message)??"Something went wrong while starting the conversation. Please try again.")}finally{y(null)}};return e?i?a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-[12px] text-mn-text-secondary",children:"Searching for people"}),a.jsx("div",{className:"rounded-mn-card border border-mn-border-subtle bg-mn-bg-elevated/80 px-3 py-4 text-[11px] text-mn-text-muted",children:"We'll show matching profiles here as soon as the results come back."})]}):l?a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-[12px] text-mn-text-primary",children:"Something went wrong."}),a.jsx("p",{className:"text-[11px] text-mn-text-muted",children:(c==null?void 0:c.message)??"We couldn&apos;t search for people right now. Please try again."})]}):!x||x.length===0?a.jsx("div",{className:"space-y-3",children:a.jsxs("p",{className:"text-[12px] text-mn-text-secondary",children:["No people found for"," ",a.jsxs("span",{className:"rounded border border-mn-border-subtle bg-mn-bg-elevated px-1.5 py-0.5 text-[11px] font-medium text-mn-text-primary",children:["",e,""]}),". Try a different name or username."]})}):a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"flex items-center justify-between gap-2",children:a.jsxs("p",{className:"text-[11px] text-mn-text-secondary",children:["Showing ",x.length," profile",x.length===1?"":"s"," for"," ",a.jsxs("span",{className:"rounded border border-mn-border-subtle bg-mn-bg-elevated px-1.5 py-0.5 text-[11px] font-medium text-mn-text-primary",children:["",e,""]})]})}),a.jsx("ul",{className:"divide-y divide-mn-border-subtle/60 rounded-mn-card border border-mn-border-subtle bg-mn-bg-elevated/80",children:x.map(w=>{var b;const N=w.displayName??w.username??"Unknown user",_=w.username?`@${w.username}`:null;return a.jsxs("li",{className:"flex items-center justify-between gap-3 px-3 py-2 hover:bg-mn-bg-elevated/80",children:[a.jsxs(We,{to:w.username?`/profile/${w.username}`:`/profile/${w.id}`,className:"flex min-w-0 flex-1 items-center gap-3",children:[a.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-mn-bg-elevated/80 text-[14px] font-semibold text-mn-text-primary",children:w.avatarUrl?a.jsx("img",{src:w.avatarUrl,alt:N,className:"h-8 w-8 rounded-full object-cover"}):N?(b=N[0])==null?void 0:b.toUpperCase():a.jsx(od,{className:"h-4 w-4","aria-hidden":"true"})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"truncate text-[13px] font-medium text-mn-text-primary",children:N}),_&&a.jsx("p",{className:"mt-0.5 text-[11px] text-mn-text-muted",children:_}),w.bio&&a.jsx("p",{className:"mt-0.5 line-clamp-2 text-[11px] text-mn-text-secondary",children:w.bio}),(typeof w.followersCount=="number"||typeof w.followingCount=="number")&&a.jsxs("p",{className:"mt-0.5 text-[10px] text-mn-text-muted",children:[typeof w.followersCount=="number"&&a.jsxs("span",{children:[w.followersCount," follower",w.followersCount===1?"":"s"]}),typeof w.followersCount=="number"&&typeof w.followingCount=="number"&&a.jsx("span",{children:"  "}),typeof w.followingCount=="number"&&a.jsxs("span",{children:["following ",w.followingCount]})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:()=>d.mutate({targetUserId:w.id,currentlyFollowing:w.isFollowing}),disabled:d.isPending,className:`inline-flex items-center justify-center rounded-full px-2.5 py-1.5 text-[10px] font-medium transition ${w.isFollowing?"border border-mn-border-subtle/80 bg-mn-bg-elevated/80 text-mn-text-primary hover:border-mn-primary/70 hover:text-mn-text-primary disabled:opacity-60":"border border-transparent bg-mn-primary text-mn-bg hover:bg-mn-primary/90 disabled:opacity-60"}`,children:w.isFollowing?a.jsxs(a.Fragment,{children:[a.jsx(jg,{className:"h-3 w-3","aria-hidden":"true"}),a.jsx("span",{children:"Following"})]}):a.jsxs(a.Fragment,{children:[a.jsx(ta,{className:"h-3 w-3","aria-hidden":"true"}),a.jsx("span",{children:"Follow"})]})}),(m==null?void 0:m.id)!==w.id&&a.jsx("button",{type:"button",onClick:()=>j(w.id),disabled:g===w.id,className:"inline-flex items-center justify-center rounded-full border border-mn-border-subtle/80 bg-mn-bg-elevated/80 px-2.5 py-1.5 text-[10px] font-medium text-mn-text-primary shadow-mn-soft hover:border-mn-primary/70 hover:text-mn-text-primary disabled:cursor-not-allowed disabled:opacity-60",children:g===w.id?a.jsx("span",{children:"Starting"}):a.jsxs(a.Fragment,{children:[a.jsx(ua,{className:"h-3 w-3","aria-hidden":"true"}),a.jsx("span",{children:"Message"})]})})]})]},w.id)})})]}):a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-[12px] text-mn-text-secondary",children:"Start typing a name or @username to find people. Once the social graph is wired up, you'll be able to follow friends and start conversations from here."}),a.jsxs("div",{className:"flex items-center gap-2 rounded-mn-card border border-dashed border-mn-border-subtle bg-mn-bg-elevated/60 px-3 py-2 text-[11px] text-mn-text-muted",children:[a.jsx(Ot,{className:"h-4 w-4","aria-hidden":"true"}),a.jsx("span",{children:"Search for people you know, then follow or message them."})]})]})},$_=()=>{const[s]=q0(),e=s.get("tab")??"titles",[r,i]=E.useState(e),[l,c]=E.useState(""),d=A_(l,300),[f,m]=E.useState(!1),[g,y]=E.useState({type:"all",minYear:void 0,maxYear:void 0,originalLanguage:void 0}),x=()=>{c("")},j=w=>{w.preventDefault()};return a.jsxs("div",{className:"flex flex-1 flex-col gap-4 pb-2 pt-1",children:[a.jsx("section",{className:"rounded-mn-card border border-mn-border-subtle bg-mn-bg-elevated/80 px-4 py-3 shadow-mn-soft",children:a.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-[11px] font-medium uppercase tracking-[0.18em] text-mn-text-muted",children:"Search"}),a.jsx("h1",{className:"mt-0.5 text-[15px] font-heading font-semibold text-mn-text-primary",children:"Find the right movie  or the right people."}),a.jsx("p",{className:"mt-1 text-[11px] text-mn-text-secondary",children:"Start typing a title, director, or a friend's name. Use tabs to switch between titles and people."})]}),a.jsxs("div",{className:"hidden shrink-0 rounded-mn-pill border border-mn-border-subtle/70 bg-mn-bg/70 px-3 py-2 text-[11px] text-mn-text-secondary shadow-mn-soft sm:flex sm:flex-col sm:items-start",children:[a.jsx("p",{className:"font-medium text-mn-text-primary",children:"Pro tip"}),a.jsxs("p",{className:"mt-0.5 text-[10px] text-mn-text-muted",children:["Tap ",a.jsx("span",{className:"rounded border border-mn-border-subtle px-1",children:"/"})," to jump to search from anywhere."]})]})]})}),a.jsx("section",{className:"rounded-mn-card border border-mn-border-subtle bg-mn-bg-elevated/80 px-3 py-2 shadow-mn-soft",children:a.jsxs("form",{onSubmit:j,className:"flex flex-col gap-2 sm:flex-row sm:items-center",children:[a.jsxs("div",{className:"flex flex-1 items-center gap-2 rounded-full border border-mn-border-subtle bg-mn-bg px-3 py-2 text-[13px] shadow-mn-soft focus-within:border-mn-primary/70",children:[a.jsx(sd,{className:"h-3.5 w-3.5 text-mn-text-muted","aria-hidden":"true"}),a.jsx("input",{type:"search",value:l,onChange:w=>c(w.target.value),placeholder:"Search for movies, shows, or people...",className:"flex-1 bg-transparent text-[13px] text-mn-text-primary placeholder:text-mn-text-muted focus:outline-none",autoCorrect:"off",autoCapitalize:"none"}),l?a.jsx("button",{type:"button",onClick:x,className:"inline-flex h-6 w-6 items-center justify-center rounded-full text-[10px] text-mn-text-muted hover:bg-mn-border-subtle/60 hover:text-mn-text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg","aria-label":"Clear search",children:a.jsx(Yb,{className:"h-3 w-3","aria-hidden":"true"})}):null]}),a.jsxs("button",{type:"button",onClick:()=>{r==="titles"&&m(w=>!w)},className:`inline-flex items-center justify-center gap-1 rounded-full border px-3 py-2 text-[11px] font-medium shadow-mn-soft focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg ${r==="titles"?"border-mn-border-subtle bg-mn-bg text-mn-text-secondary hover:border-mn-primary/70 hover:text-mn-text-primary":"border-mn-border-subtle/60 bg-mn-bg/70 text-mn-text-muted cursor-not-allowed"}`,children:[a.jsx(id,{className:"h-3.5 w-3.5","aria-hidden":"true"}),a.jsx("span",{children:"Filters"})]})]})}),a.jsxs("section",{className:"flex flex-1 flex-col gap-3",children:[a.jsx("div",{className:"inline-flex items-center gap-1 rounded-full border border-mn-border-subtle bg-mn-bg-elevated/80 p-1 text-[11px] shadow-mn-soft",children:[{key:"titles",label:"Titles"},{key:"people",label:"People"}].map(w=>{const N=r===w.key;return a.jsx("button",{type:"button",onClick:()=>i(w.key),className:["inline-flex min-w-[70px] items-center justify-center rounded-full px-3 py-1.5 transition",N?"bg-mn-primary text-mn-bg text-[11px] font-semibold":"text-[11px] font-medium text-mn-text-secondary hover:bg-mn-border-subtle/40 hover:text-mn-text-primary"].join(" "),"aria-pressed":N,children:w.label},w.key)})}),a.jsx("div",{"aria-live":"polite",className:"flex-1 rounded-mn-card border border-dashed border-mn-border-subtle/80 bg-mn-bg-elevated/60 px-3 py-3 text-[12px] text-mn-text-secondary",children:r==="titles"?a.jsx(M_,{query:d,filters:g}):a.jsx(D_,{query:d})})]})]})},F_=s=>{switch(s){case"rating_created":return"rating";case"review_created":return"review";case"watchlist_added":return"watchlist";case"follow_created":return"follow";default:return"other"}},B_=()=>{var i;const{user:s}=nt(),e=(s==null?void 0:s.id)??null,r=_t({queryKey:["diary","timeline",e],enabled:!!e,queryFn:async()=>{if(!e)return[];const{data:l,error:c}=await se.from("activity_events").select("id, created_at, event_type, title_id, payload").eq("user_id",e).order("created_at",{ascending:!1}).limit(100);if(c)throw new Error(c.message);const d=l??[];if(!d.length)return[];const f=Array.from(new Set(d.map(g=>g.title_id).filter(g=>!!g)));let m=new Map;if(f.length){const{data:g,error:y}=await se.from("titles").select("id, title, year, poster_url").in("id",f);!y&&g?m=new Map(g.map(x=>[x.id,x])):y&&console.warn("[useDiaryTimeline] Failed to load titles",y.message)}return d.map(g=>{const y=g.title_id?m.get(g.title_id)??null:null,x=F_(g.event_type),j=g.payload??{};return{id:g.id,createdAt:g.created_at,kind:x,titleId:g.title_id,title:(y==null?void 0:y.title)??null,year:(y==null?void 0:y.year)??null,posterUrl:(y==null?void 0:y.poster_url)??null,rating:j.rating??null,reviewSnippet:j.review_snippet??null,headline:j.headline??null,extra:j.extra??null,emoji:j.emoji??null}})}});return{items:r.data??[],isLoading:r.isLoading,isError:r.isError,error:((i=r.error)==null?void 0:i.message)??null}},z_=s=>{const e=new Date(s);return Number.isNaN(e.getTime())?"":e.toLocaleString(void 0,{month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})},q_=s=>{switch(s.kind){case"rating":return s.rating!=null?`Rated ${s.rating.toFixed(1)}`:"Rated";case"review":return"Wrote a review";case"watchlist":return"Updated watchlist";case"follow":return"Followed someone";default:return"Activity"}},W_=s=>{switch(s){case"rating":return yr;case"review":return ua;case"watchlist":return rs;case"follow":return Ot;default:return lt}},Ex=()=>{const{items:s,isLoading:e,isError:r,error:i}=B_();return e?a.jsx("div",{className:"px-2 pb-4",children:a.jsx("div",{className:"space-y-3",children:Array.from({length:4}).map((l,c)=>a.jsxs("div",{className:"flex gap-3 rounded-mn-card border border-mn-border-subtle/60 bg-mn-bg-elevated/80 p-3 shadow-mn-card",children:[a.jsx("div",{className:"h-12 w-8 rounded bg-mn-bg/60"}),a.jsxs("div",{className:"flex flex-1 flex-col gap-2",children:[a.jsx("div",{className:"h-3 w-1/3 rounded bg-mn-bg/70"}),a.jsx("div",{className:"h-3 w-2/3 rounded bg-mn-bg/80"}),a.jsx("div",{className:"h-2.5 w-1/2 rounded bg-mn-bg/80"})]})]},c))})}):r?a.jsx("div",{className:"flex min-h-[40vh] items-center justify-center px-4",children:a.jsxs("div",{className:"max-w-sm rounded-mn-card border border-mn-error/40 bg-mn-error/5 p-4 text-center text-[11px] text-mn-text-primary shadow-mn-card",children:[a.jsx("p",{className:"font-semibold",children:"Unable to load your diary timeline."}),a.jsx("p",{className:"mt-1 text-[10px] text-mn-text-secondary",children:i??"Please try again in a moment."})]})}):s.length?a.jsx("div",{className:"px-2 pb-4",children:a.jsx("ol",{className:"space-y-3",children:s.map(l=>{const c=W_(l.kind),d=l.titleId?`/title/${l.titleId}`:null;return a.jsx("li",{children:a.jsxs("article",{className:"flex gap-3 rounded-mn-card border border-mn-border-subtle/60 bg-mn-bg-elevated/80 p-3 shadow-mn-card",children:[a.jsx("div",{className:"relative h-16 w-11 overflow-hidden rounded bg-mn-bg/70",children:l.posterUrl?a.jsx("img",{src:l.posterUrl,alt:l.title??"",className:"h-full w-full object-cover"}):a.jsxs("div",{className:"flex h-full w-full items-center justify-center text-[10px] text-mn-text-muted",children:[a.jsx(ht,{className:"mr-1 h-3.5 w-3.5"}),"No poster"]})}),a.jsxs("div",{className:"flex min-w-0 flex-1 flex-col gap-1.5",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("div",{className:"flex items-center gap-1.5 text-[11px] text-mn-text-secondary",children:a.jsxs("span",{className:"flex items-center gap-1 rounded-full bg-mn-primary/10 px-2 py-0.5 text-[10px] font-medium text-mn-text-primary",children:[a.jsx(c,{className:"h-3 w-3","aria-hidden":"true"}),q_(l)]})}),a.jsx("span",{className:"shrink-0 text-[10px] text-mn-text-muted",children:z_(l.createdAt)})]}),a.jsx("div",{className:"min-w-0",children:d?a.jsxs(We,{to:d,className:"line-clamp-2 text-sm font-medium text-mn-text-primary hover:underline",children:[l.title??"Untitled",l.year?a.jsxs("span",{className:"ml-1 text-[11px] text-mn-text-secondary",children:["(",l.year,")"]}):null]}):a.jsx("p",{className:"line-clamp-2 text-sm font-medium text-mn-text-primary",children:l.title??"Activity"})}),l.reviewSnippet&&a.jsxs("p",{className:"line-clamp-2 text-[11px] text-mn-text-secondary",children:["",l.reviewSnippet,""]}),l.extra&&a.jsx("p",{className:"text-[10px] text-mn-text-muted",children:l.extra})]})]})},l.id)})})}):a.jsx("div",{className:"flex min-h-[40vh] items-center justify-center px-4",children:a.jsxs("div",{className:"max-w-sm rounded-mn-card border border-mn-border-subtle bg-mn-bg-elevated/80 p-5 text-center text-[11px] text-mn-text-secondary shadow-mn-card",children:[a.jsx("div",{className:"mx-auto mb-3 flex h-10 w-10 items-center justify-center rounded-2xl bg-mn-primary/15",children:a.jsx(ht,{className:"h-5 w-5 text-mn-primary","aria-hidden":"true"})}),a.jsx("p",{className:"font-heading text-sm font-semibold text-mn-text-primary",children:"Your diary is waiting"}),a.jsx("p",{className:"mt-1 text-[11px]",children:"As you rate titles, write reviews, and update your library, they'll show up here in a cozy, chronological timeline."})]})})},V_=s=>{var c;const{user:e}=nt(),r=(e==null?void 0:e.id)??null,i=_t({queryKey:["diary","library",r],enabled:!!r,queryFn:async()=>{if(!r)return[];const{data:d,error:f}=await se.from("library_entries").select("id, title_id, status, updated_at, titles!inner ( id, title, year, type, poster_url )").eq("user_id",r).order("updated_at",{ascending:!1}).limit(500);if(f)throw new Error(f.message);const m=d??[];if(!m.length)return[];const g=Array.from(new Set(m.map(x=>x.title_id).filter(x=>!!x)));let y=new Map;if(g.length){const{data:x,error:j}=await se.from("ratings").select("title_id, rating").eq("user_id",r).in("title_id",g);!j&&x?y=new Map(x.map(w=>[w.title_id,w.rating])):j&&console.warn("[useDiaryLibrary] Failed to load ratings for library entries",j.message)}return m.map(x=>{const j=x.titles,w=y.get(x.title_id)??null;return{id:x.id,titleId:x.title_id,status:x.status,updatedAt:x.updated_at,title:(j==null?void 0:j.title)??"Untitled",year:(j==null?void 0:j.year)??null,type:(j==null?void 0:j.type)??null,posterUrl:(j==null?void 0:j.poster_url)??null,rating:w}})}});return{entries:(i.data??[]).filter(d=>!(s.status&&s.status!=="all"&&d.status!==s.status||s.type&&s.type!=="all"&&d.type!==s.type)),isLoading:i.isLoading,isError:i.isError,error:((c=i.error)==null?void 0:c.message)??null}},H_=()=>{const{user:s}=nt(),e=(s==null?void 0:s.id)??null,r=Mr(),i=wn({mutationFn:async({titleId:c,status:d})=>{if(!e)throw new Error("Not authenticated");const{error:f}=await se.from("library_entries").upsert({user_id:e,title_id:c,status:d,updated_at:new Date().toISOString()},{onConflict:"user_id,title_id"});if(f)throw new Error(f.message);return{titleId:c,status:d}},onSuccess:()=>{e&&(r.invalidateQueries({queryKey:["diary","library",e]}),r.invalidateQueries({queryKey:["diary","stats",e]}),r.invalidateQueries({queryKey:["home-for-you",e]}))}}),l=wn({mutationFn:async({titleId:c,rating:d})=>{if(!e)throw new Error("Not authenticated");if(d==null){const{error:m}=await se.from("ratings").delete().eq("user_id",e).eq("title_id",c);if(m)throw new Error(m.message);return{titleId:c,rating:null}}const{error:f}=await se.from("ratings").upsert({user_id:e,title_id:c,rating:d,updated_at:new Date().toISOString()},{onConflict:"user_id,title_id"});if(f)throw new Error(f.message);return{titleId:c,rating:d}},onSuccess:()=>{e&&(r.invalidateQueries({queryKey:["diary","library",e]}),r.invalidateQueries({queryKey:["diary","stats",e]}),r.invalidateQueries({queryKey:["home-for-you",e]}))}});return{updateStatus:i,updateRating:l}},K_=[{value:"all",label:"All"},{value:"want_to_watch",label:"Want to Watch"},{value:"watching",label:"Watching"},{value:"watched",label:"Watched"},{value:"dropped",label:"Dropped"}],Q_=[{value:"all",label:"All types"},{value:"movie",label:"Movies"},{value:"series",label:"Series"},{value:"anime",label:"Anime"},{value:"short",label:"Shorts"}],G_=s=>{switch(s){case"want_to_watch":return"border-amber-500/40 bg-amber-500/10 text-amber-200";case"watching":return"border-sky-500/40 bg-sky-500/10 text-sky-200";case"watched":return"border-emerald-500/40 bg-emerald-500/10 text-emerald-200";case"dropped":return"border-rose-500/40 bg-rose-500/10 text-rose-200";default:return"border-mn-border-subtle bg-mn-bg/60 text-mn-text-secondary"}},Cx=()=>{const[s,e]=E.useState("all"),[r,i]=E.useState("all"),{entries:l,isLoading:c,isError:d,error:f}=V_({status:s==="all"?void 0:s,type:r==="all"?void 0:r}),{updateStatus:m,updateRating:g}=H_(),y=m.isPending||g.isPending;return c?a.jsxs("div",{className:"px-2 pb-4",children:[a.jsx("div",{className:"mb-3 flex items-center justify-between gap-2 px-1 text-[11px] text-mn-text-secondary",children:a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Lm,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:"Loading your library"})]})}),a.jsx("div",{className:"grid grid-cols-2 gap-3",children:Array.from({length:6}).map((x,j)=>a.jsxs("div",{className:"overflow-hidden rounded-mn-card border border-mn-border-subtle/60 bg-mn-bg-elevated/80 shadow-mn-card",children:[a.jsx("div",{className:"h-40 w-full bg-mn-bg/70"}),a.jsxs("div",{className:"space-y-1.5 p-2.5",children:[a.jsx("div",{className:"h-3 w-3/4 rounded bg-mn-bg/70"}),a.jsx("div",{className:"h-2.5 w-1/2 rounded bg-mn-bg/80"}),a.jsx("div",{className:"h-2.5 w-2/3 rounded bg-mn-bg/80"})]})]},j))})]}):d?a.jsx("div",{className:"flex min-h-[40vh] items-center justify-center px-4",children:a.jsxs("div",{className:"max-w-sm rounded-mn-card border border-mn-error/40 bg-mn-error/5 p-4 text-center text-[11px] text-mn-text-primary shadow-mn-card",children:[a.jsx("p",{className:"font-semibold",children:"Unable to load your library."}),a.jsx("p",{className:"mt-1 text-[10px] text-mn-text-secondary",children:f??"Please try again in a moment."})]})}):l.length?a.jsxs("div",{className:"px-2 pb-4",children:[a.jsxs("div",{className:"mb-3 flex flex-wrap items-center justify-between gap-2 px-1 text-[11px]",children:[a.jsx("div",{className:"flex flex-wrap gap-1",children:K_.map(x=>{const j=s===x.value;return a.jsx("button",{type:"button",onClick:()=>e(x.value),className:`rounded-full border px-2.5 py-1 text-[10px] transition ${j?"border-mn-primary/60 bg-mn-primary-soft text-mn-text-primary shadow-sm":"border-mn-border-subtle bg-mn-bg-elevated/80 text-mn-text-secondary hover:border-mn-border-subtle/80 hover:text-mn-text-primary"}`,children:x.label},x.value)})}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Lm,{className:"h-3.5 w-3.5 text-mn-text-muted","aria-hidden":"true"}),a.jsxs("label",{className:"flex items-center gap-1 text-[10px] text-mn-text-secondary",children:[a.jsx("span",{children:"Type"}),a.jsx("select",{value:r,onChange:x=>i(x.target.value),className:"rounded-full border border-mn-border-subtle bg-mn-bg-elevated/80 px-2 py-1 text-[10px] text-mn-text-primary",children:Q_.map(x=>a.jsx("option",{value:x.value,children:x.label},x.value))})]})]})]}),a.jsx("div",{className:"grid grid-cols-2 gap-3 sm:grid-cols-3",children:l.map(x=>{const j=()=>{const _=["want_to_watch","watching","watched","dropped"],b=_.indexOf(x.status),L=_[(b+1)%_.length];m.mutate({titleId:x.titleId,status:L})},w=_=>{const b=x.rating===_?null:_;g.mutate({titleId:x.titleId,rating:b})},N=`/title/${x.titleId}`;return a.jsxs("article",{className:"group flex flex-col overflow-hidden rounded-mn-card border border-mn-border-subtle/60 bg-mn-bg-elevated/80 shadow-mn-card",children:[a.jsx(We,{to:N,className:"relative block",children:a.jsx("div",{className:"aspect-[2/3] w-full overflow-hidden bg-mn-bg/80",children:x.posterUrl?a.jsx("img",{src:x.posterUrl,alt:x.title,className:"h-full w-full object-cover transition-transform duration-200 group-hover:scale-[1.03]"}):a.jsxs("div",{className:"flex h-full w-full items-center justify-center text-[10px] text-mn-text-muted",children:[a.jsx(ht,{className:"mr-1 h-4 w-4"}),"No poster"]})})}),a.jsxs("div",{className:"flex flex-1 flex-col gap-1.5 p-2.5",children:[a.jsxs("div",{className:"min-h-[2.4rem]",children:[a.jsx(We,{to:N,className:"line-clamp-2 text-[13px] font-medium text-mn-text-primary hover:underline",children:x.title}),x.year&&a.jsxs("p",{className:"text-[10px] text-mn-text-secondary",children:["(",x.year,")"]})]}),a.jsxs("div",{className:"flex items-center justify-between gap-1",children:[a.jsx("button",{type:"button",onClick:j,disabled:y,className:`rounded-full border px-2 py-0.5 text-[9px] font-medium transition ${G_(x.status)} ${y?"opacity-70":"hover:border-mn-primary/70 hover:bg-mn-primary-soft"}`,children:x.status==="want_to_watch"?"Want to Watch":x.status==="watching"?"Watching":x.status==="watched"?"Watched":"Dropped"}),a.jsx("div",{className:"flex items-center gap-0.5",children:Array.from({length:5}).map((_,b)=>{const L=b+1,C=(x.rating??0)>=L;return a.jsx("button",{type:"button",className:"p-0.5",disabled:y,onClick:()=>w(L),children:a.jsx(yr,{className:`h-3.5 w-3.5 ${C?"fill-yellow-400 text-yellow-300":"text-mn-text-muted"}`})},b)})})]})]})]},x.id)})})]}):a.jsx("div",{className:"flex min-h-[40vh] items-center justify-center px-4",children:a.jsxs("div",{className:"max-w-sm rounded-mn-card border border-mn-border-subtle bg-mn-bg-elevated/80 p-5 text-center text-[11px] text-mn-text-secondary shadow-mn-card",children:[a.jsx("div",{className:"mx-auto mb-3 flex h-10 w-10 items-center justify-center rounded-2xl bg-mn-primary/15",children:a.jsx(ht,{className:"h-5 w-5 text-mn-primary","aria-hidden":"true"})}),a.jsx("p",{className:"font-heading text-sm font-semibold text-mn-text-primary",children:"Your library is empty"}),a.jsx("p",{className:"mt-1 text-[11px]",children:"As you add titles to your Watchlist and mark them as watched, this tab will turn into a sortable diary of everything you've seen."})]})})},kp={totalRated:0,totalWatched:0,averageRating:null,ratingDistribution:[],topGenres:[],watchCountByMonth:[]},J_=()=>{var i;const{user:s}=nt(),e=(s==null?void 0:s.id)??null,r=_t({queryKey:["diary","stats",e],enabled:!!e,queryFn:async()=>{if(!e)return kp;const[l,c]=await Promise.all([se.from("ratings").select("rating, created_at, title_id").eq("user_id",e).order("created_at",{ascending:!1}).limit(500),se.from("library_entries").select("title_id, status, updated_at").eq("user_id",e).order("updated_at",{ascending:!1}).limit(500)]);if(l.error)throw new Error(l.error.message);if(c.error)throw new Error(c.error.message);const d=l.data??[],m=(c.data??[]).filter(C=>C.status==="watched"),g=new Map;let y=0,x=0;d.forEach(C=>{const T=typeof C.rating=="number"?C.rating:C.rating==null?null:Number(C.rating);if(T==null||Number.isNaN(T))return;const I=Math.round(T*2)/2;g.set(I,(g.get(I)??0)+1),y+=T,x+=1});const j=Array.from(g.entries()).sort((C,T)=>C[0]-T[0]).map(([C,T])=>({rating:C,count:T})),w=x>0?y/x:null,N=new Map;m.forEach(C=>{const T=new Date(C.updated_at);if(Number.isNaN(T.getTime()))return;const I=`${T.getFullYear()}-${String(T.getMonth()+1).padStart(2,"0")}`;N.set(I,(N.get(I)??0)+1)});const _=Array.from(N.entries()).sort((C,T)=>C[0].localeCompare(T[0])).map(([C,T])=>({month:C,count:T})),b=Array.from(new Set(m.map(C=>C.title_id).filter(C=>!!C)));let L=[];if(b.length){const{data:C,error:T}=await se.from("title_genres").select("title_id, genre_id").in("title_id",b);if(!T&&C){const I=C,q=Array.from(new Set(I.map(B=>B.genre_id).filter(B=>typeof B=="number")));let F=new Map;if(q.length){const{data:B,error:ae}=await se.from("genres").select("id, name").in("id",q);!ae&&B?F=new Map(B.map(Y=>[Y.id,Y.name])):ae&&console.warn("[useDiaryStats] Failed to load genres",ae.message)}const G=new Map;I.forEach(B=>{const ae=F.get(B.genre_id);ae&&G.set(ae,(G.get(ae)??0)+1)}),L=Array.from(G.entries()).sort((B,ae)=>ae[1]-B[1]).slice(0,8).map(([B,ae])=>({genre:B,count:ae}))}else T&&console.warn("[useDiaryStats] Failed to load title_genres",T.message)}return{totalRated:d.length,totalWatched:m.length,averageRating:w,ratingDistribution:j,topGenres:L,watchCountByMonth:_}}});return{stats:r.data??kp,isLoading:r.isLoading,isError:r.isError,error:((i=r.error)==null?void 0:i.message)??null}},Y_=s=>{const[e,r]=s.split("-"),i=Number(e),l=Number(r);return!i||!l?s:new Date(i,l-1,1).toLocaleDateString(void 0,{month:"short",year:"numeric"})},X_=()=>{const{stats:s,isLoading:e,isError:r,error:i}=J_();if(e)return a.jsx("div",{className:"px-2 pb-4",children:a.jsx("div",{className:"space-y-3",children:Array.from({length:3}).map((f,m)=>a.jsxs("div",{className:"rounded-mn-card border border-mn-border-subtle/60 bg-mn-bg-elevated/80 p-3 shadow-mn-card",children:[a.jsx("div",{className:"mb-2 h-3 w-1/3 rounded bg-mn-bg/70"}),a.jsx("div",{className:"flex gap-1.5",children:Array.from({length:6}).map((g,y)=>a.jsx("div",{className:"h-10 flex-1 rounded bg-mn-bg/70"},y))})]},m))})});if(r)return a.jsx("div",{className:"flex min-h-[40vh] items-center justify-center px-4",children:a.jsxs("div",{className:"max-w-sm rounded-mn-card border border-mn-error/40 bg-mn-error/5 p-4 text-center text-[11px] text-mn-text-primary shadow-mn-card",children:[a.jsx("p",{className:"font-semibold",children:"Unable to load your stats."}),a.jsx("p",{className:"mt-1 text-[10px] text-mn-text-secondary",children:i??"Please try again in a moment."})]})});if(s.totalRated===0&&s.totalWatched===0&&!s.ratingDistribution.length&&!s.topGenres.length&&!s.watchCountByMonth.length)return a.jsx("div",{className:"flex min-h-[40vh] items-center justify-center px-4",children:a.jsxs("div",{className:"max-w-sm rounded-mn-card border border-mn-border-subtle bg-mn-bg-elevated/80 p-5 text-center text-[11px] text-mn-text-secondary shadow-mn-card",children:[a.jsx("div",{className:"mx-auto mb-3 flex h-10 w-10 items-center justify-center rounded-2xl bg-mn-primary/15",children:a.jsx(lt,{className:"h-5 w-5 text-mn-primary","aria-hidden":"true"})}),a.jsx("p",{className:"font-heading text-sm font-semibold text-mn-text-primary",children:"No stats yet"}),a.jsx("p",{className:"mt-1 text-[11px]",children:"Once you start rating titles and marking them as watched, you'll see your rating distribution, top genres, and watch streaks here."})]})});const l=s.ratingDistribution.reduce((f,m)=>m.count>f?m.count:f,0),c=s.watchCountByMonth.reduce((f,m)=>m.count>f?m.count:f,0),d=s.topGenres.slice(0,6);return a.jsxs("div",{className:"space-y-3 px-2 pb-4",children:[a.jsxs("section",{className:"grid grid-cols-2 gap-3 sm:grid-cols-3",children:[a.jsxs("div",{className:"rounded-mn-card border border-mn-border-subtle/60 bg-mn-bg-elevated/80 p-3 shadow-mn-card",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-[11px] text-mn-text-secondary",children:"Watched"}),a.jsx(ht,{className:"h-3.5 w-3.5 text-mn-text-muted","aria-hidden":"true"})]}),a.jsx("p",{className:"mt-1 text-lg font-semibold text-mn-text-primary",children:s.totalWatched}),a.jsxs("p",{className:"mt-0.5 text-[10px] text-mn-text-muted",children:["Titles marked as ",a.jsx("span",{className:"font-medium text-mn-text-primary",children:"Watched"}),"."]})]}),a.jsxs("div",{className:"rounded-mn-card border border-mn-border-subtle/60 bg-mn-bg-elevated/80 p-3 shadow-mn-card",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-[11px] text-mn-text-secondary",children:"Rated"}),a.jsx(yg,{className:"h-3.5 w-3.5 text-mn-text-muted","aria-hidden":"true"})]}),a.jsx("p",{className:"mt-1 text-lg font-semibold text-mn-text-primary",children:s.totalRated}),a.jsx("p",{className:"mt-0.5 text-[10px] text-mn-text-muted",children:"Ratings you've logged across movies, series, and anime."})]}),a.jsxs("div",{className:"col-span-2 rounded-mn-card border border-mn-border-subtle/60 bg-mn-bg-elevated/80 p-3 text-[11px] text-mn-text-secondary shadow-mn-card sm:col-span-1",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-[11px] text-mn-text-secondary",children:"Average rating"}),a.jsx(Ab,{className:"h-3.5 w-3.5 text-mn-text-muted","aria-hidden":"true"})]}),a.jsx("p",{className:"mt-1 text-lg font-semibold text-mn-text-primary",children:s.averageRating!=null?s.averageRating.toFixed(1):""}),a.jsx("p",{className:"mt-0.5 text-[10px] text-mn-text-muted",children:"Quick glance at how generous you typically are with stars."})]})]}),a.jsxs("section",{className:"rounded-mn-card border border-mn-border-subtle/60 bg-mn-bg-elevated/80 p-3 shadow-mn-card",children:[a.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[a.jsx("h2",{className:"text-xs font-semibold text-mn-text-primary",children:"Rating distribution"}),a.jsxs("span",{className:"text-[10px] text-mn-text-muted",children:["0.5  5.0  ",s.totalRated," ratings"]})]}),s.ratingDistribution.length===0?a.jsx("p",{className:"text-[11px] text-mn-text-secondary",children:"Once you start rating titles, you'll see how your scores cluster here."}):a.jsx("div",{className:"flex items-end gap-1.5",children:s.ratingDistribution.map(f=>{const m=l>0?Math.max(f.count/l*52,6):6;return a.jsxs("div",{className:"flex flex-1 flex-col items-center gap-1",children:[a.jsx("div",{className:"w-full rounded-t bg-mn-primary/25",style:{height:m},"aria-hidden":"true"}),a.jsxs("span",{className:"text-[9px] text-mn-text-secondary",children:[f.rating.toFixed(1),""]})]},f.rating)})})]}),a.jsxs("section",{className:"rounded-mn-card border border-mn-border-subtle/60 bg-mn-bg-elevated/80 p-3 shadow-mn-card",children:[a.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[a.jsx("h2",{className:"text-xs font-semibold text-mn-text-primary",children:"Top genres"}),a.jsx("span",{className:"text-[10px] text-mn-text-muted",children:"Based on titles you've marked as watched"})]}),d.length?a.jsx("div",{className:"flex flex-wrap gap-1.5",children:d.map(f=>a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-mn-primary-soft/15 px-2.5 py-1 text-[10px] text-mn-text-primary",children:[a.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-mn-primary","aria-hidden":"true"}),a.jsx("span",{className:"font-medium",children:f.genre}),a.jsxs("span",{className:"text-[9px] text-mn-text-muted",children:["",f.count]})]},f.genre))}):a.jsx("p",{className:"text-[11px] text-mn-text-secondary",children:"Watch and rate a few titles to reveal your go-to genres."})]}),a.jsxs("section",{className:"rounded-mn-card border border-mn-border-subtle/60 bg-mn-bg-elevated/80 p-3 shadow-mn-card",children:[a.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[a.jsx("h2",{className:"text-xs font-semibold text-mn-text-primary",children:"Watch count over time"}),a.jsx("span",{className:"text-[10px] text-mn-text-muted",children:"Month by month, based on your library"})]}),s.watchCountByMonth.length?a.jsx("div",{className:"space-y-1.5",children:a.jsx("div",{className:"flex items-end gap-1.5",children:s.watchCountByMonth.map(f=>{const m=c>0?Math.max(f.count/c*52,6):6;return a.jsxs("div",{className:"flex flex-1 flex-col items-center gap-1",children:[a.jsx("div",{className:"w-full rounded-t bg-mn-primary/20",style:{height:m},"aria-hidden":"true"}),a.jsx("span",{className:"text-[9px] text-mn-text-secondary",children:Y_(f.month)})]},f.month)})})}):a.jsx("p",{className:"text-[11px] text-mn-text-secondary",children:"As you mark titles as watched, you'll see your movie-watching streaks here."})]})]})},du=[{key:"timeline",label:"Timeline",icon:jn,description:"Chronological history of your ratings, reviews, and library updates."},{key:"library",label:"Library",icon:wg,description:"Filter your watchlist and history by status and type."},{key:"stats",label:"Stats",icon:yg,description:"Rating distribution, top genres, and watch trends over time."}],Z_=()=>{const[s,e]=E.useState("timeline"),r=du.find(i=>i.key===s)??du[0];return a.jsxs("div",{className:"flex flex-1 flex-col gap-4 pb-2 pt-1",children:[a.jsxs("header",{className:"space-y-1 px-4 pt-1",children:[a.jsx("p",{className:"text-[11px] font-medium uppercase tracking-[0.18em] text-mn-text-muted",children:"Diary"}),a.jsx("h1",{className:"text-xl font-heading font-semibold text-mn-text-primary",children:"Your movie diary"}),a.jsx("p",{className:"text-[11px] text-mn-text-secondary",children:"Track what you watch, manage your library, and keep an eye on your movie habits."})]}),a.jsxs("section",{className:"px-2",children:[a.jsx("nav",{className:"mt-1 flex items-center justify-between gap-3","aria-label":"Diary tabs",children:a.jsx("div",{role:"tablist","aria-orientation":"horizontal",className:"flex max-w-full gap-1.5 overflow-x-auto rounded-full border border-mn-border-subtle/60 bg-mn-bg-elevated/80 p-1.5 backdrop-blur",children:du.map(i=>{const l=i.icon,c=i.key===s;return a.jsxs("button",{type:"button",role:"tab","aria-selected":c,"aria-controls":`diary-tabpanel-${i.key}`,className:`flex min-w-[90px] flex-1 items-center justify-center gap-1 rounded-full px-3 py-1.5 text-xs font-medium transition
                    ${c?"bg-mn-primary-soft text-mn-text-primary shadow-sm":"text-mn-text-secondary hover:bg-mn-bg-elevated/80 hover:text-mn-text-primary"}`,onClick:()=>e(i.key),children:[a.jsx(l,{className:"h-3.5 w-3.5 shrink-0","aria-hidden":"true"}),a.jsx("span",{className:"truncate",children:i.label})]},i.key)})})}),a.jsx("p",{className:"mt-1 px-1 text-[10px] text-mn-text-secondary",children:r.description})]}),a.jsxs("section",{"aria-live":"polite",className:"flex-1",children:[s==="timeline"&&a.jsx("div",{id:"diary-tabpanel-timeline",role:"tabpanel",className:"h-full w-full",children:a.jsx(Ex,{})}),s==="library"&&a.jsx("div",{id:"diary-tabpanel-library",role:"tabpanel",className:"h-full w-full",children:a.jsx(Cx,{})}),s==="stats"&&a.jsx("div",{id:"diary-tabpanel-stats",role:"tabpanel",className:"h-full w-full",children:a.jsx(X_,{})})]})]})};function eN(s,e){return _t({queryKey:["trailer",s,e],enabled:!!s,queryFn:async()=>{const{data:r,error:i}=await se.functions.invoke("fetch-trailer",{method:"POST",body:{title:s,year:e}});return i?(console.warn("[TitleDetailPage] trailer fetch error:",i),null):r??null},staleTime:1e3*60*60})}const tN=()=>{const{titleId:s}=Zu(),{data:e,isLoading:r,isError:i,error:l}=_t({queryKey:["title-detail",s],enabled:!!s,queryFn:async()=>{if(!s)return null;const{data:m,error:g}=await se.from("titles").select("id, title, year, type, poster_url, backdrop_url").eq("id",s).maybeSingle();if(g)throw g;return m}}),c=eN((e==null?void 0:e.title)??null,(e==null?void 0:e.year)??null),d=c.data;if(!s)return a.jsx("div",{className:"flex min-h-[60vh] items-center justify-center px-4",children:a.jsx("p",{className:"max-w-md text-center text-sm text-mn-text-secondary",children:"No title specified. Try opening this page from search, your diary, or the home feed."})});if(r)return a.jsx("div",{className:"flex min-h-[60vh] items-center justify-center px-4",children:a.jsx("p",{className:"text-sm text-mn-text-secondary",children:"Loading title"})});if(i||!e)return a.jsx("div",{className:"flex min-h-[60vh] items-center justify-center px-4",children:a.jsxs("div",{className:"max-w-md text-center text-sm text-mn-text-secondary",children:[a.jsx("p",{children:"We couldn't find that title."}),a.jsx(We,{to:"/search",className:"mt-2 inline-block text-mn-primary underline",children:"Back to search"})]})});const f=[];return e.year&&f.push(String(e.year)),e.type&&f.push(e.type),a.jsxs("div",{className:"mx-auto flex min-h-[60vh] max-w-4xl flex-col gap-4 px-4 py-6",children:[e.backdrop_url&&a.jsxs("div",{className:"relative mb-2 overflow-hidden rounded-3xl border border-mn-border-subtle bg-mn-surface-elevated",children:[a.jsx("img",{src:e.backdrop_url,alt:e.title??"Backdrop",className:"h-48 w-full object-cover sm:h-56 md:h-64"}),a.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-t from-mn-bg/90 via-mn-bg/30 to-transparent"})]}),a.jsxs("div",{className:"flex flex-col gap-4 md:flex-row",children:[a.jsx("div",{className:"w-28 flex-shrink-0 sm:w-32 md:w-40",children:e.poster_url?a.jsx("img",{src:e.poster_url,alt:e.title??"Poster",className:"aspect-[2/3] w-full rounded-mn-card object-cover shadow-mn-card"}):a.jsx("div",{className:"flex aspect-[2/3] items-center justify-center rounded-mn-card border border-dashed border-mn-border-subtle bg-mn-surface-elevated text-xs text-mn-text-muted",children:"No poster available"})}),a.jsxs("div",{className:"flex flex-1 flex-col gap-3",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-heading font-semibold text-mn-text-primary sm:text-2xl",children:e.title??"Untitled"}),f.length>0&&a.jsx("p",{className:"mt-1 text-sm text-mn-text-secondary",children:f.join("  ")})]}),c.isLoading&&a.jsx("p",{className:"text-xs text-mn-text-secondary",children:"Loading trailer"}),d&&d.videoId&&a.jsx("div",{className:"mt-3 aspect-video w-full max-w-2xl",children:a.jsx("iframe",{className:"h-full w-full rounded-2xl",src:`https://www.youtube.com/embed/${d.videoId}`,title:`${e.title??"Trailer"}`,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}),a.jsx("p",{className:"text-xs text-mn-text-muted",children:"This is the early version of the title page. Over time it will show your rating, diary entry, where to watch, and what your friends think about it."})]})]})]})},rN=s=>{if(!s)return null;const e=s.trim();return e?e.startsWith("@")?e.slice(1):e:null},nN=s=>{const{user:e}=nt(),r=rN(s);return _t({queryKey:["profile","byUsername",r,(e==null?void 0:e.id)??null],enabled:!!r,queryFn:async()=>{if(!r)return null;const{data:i,error:l}=await se.from("profiles").select("id, username, display_name, avatar_url, bio").eq("username",r).maybeSingle();if(l)throw l.code==="PGRST116"?new Error("Profile not found"):l;if(!i)throw new Error("Profile not found");const c=i.id,{data:d,error:f}=await se.from("user_stats").select("followers_count, following_count").eq("user_id",c).maybeSingle();if(f)throw f;const m=(d==null?void 0:d.followers_count)??0,g=(d==null?void 0:d.following_count)??0;let y=!1;if(e&&e.id!==c){const{data:x,error:j}=await se.from("follows").select("follower_id").eq("follower_id",e.id).eq("followed_id",c).maybeSingle();if(j&&j.code!=="PGRST116")throw j;y=!!x}return{id:c,username:i.username,displayName:i.display_name,avatarUrl:i.avatar_url,bio:i.bio,followersCount:m,followingCount:g,isFollowing:y,isCurrentUser:!!e&&e.id===c}}})},sN=()=>{const{user:s}=nt();return _t({queryKey:["profile","current",(s==null?void 0:s.id)??null],enabled:!!s,queryFn:async()=>{if(!s)return null;const{data:e,error:r}=await se.from("profiles").select("id, username, display_name, avatar_url, bio").eq("id",s.id).maybeSingle();if(r)throw r.code==="PGRST116"?new Error("Profile not found for current user"):r;if(!e)throw new Error("Profile not found for current user");const i=e.id,{data:l,error:c}=await se.from("user_stats").select("followers_count, following_count").eq("user_id",i).maybeSingle();if(c)throw c;const d=(l==null?void 0:l.followers_count)??0,f=(l==null?void 0:l.following_count)??0;return{id:i,username:e.username,displayName:e.display_name,avatarUrl:e.avatar_url,bio:e.bio,followersCount:d,followingCount:f,isFollowing:!1,isCurrentUser:!0}}})},iN=()=>a.jsx("div",{className:"mt-2",children:a.jsx(Ex,{})}),aN=()=>a.jsx("div",{className:"mt-2",children:a.jsx(Cx,{})}),Ep=s=>s>=1e6?`${(s/1e6).toFixed(1).replace(/\.0$/,"")}M`:s>=1e3?`${(s/1e3).toFixed(1).replace(/\.0$/,"")}K`:String(s??0),oN=(s,e)=>{const i=(s||e||"").replace(/^@/,"").trim();if(!i)return"?";const l=i.split(/\s+/);return l.length===1?l[0].slice(0,2).toUpperCase():(l[0][0]+l[1][0]).toUpperCase()},lN=()=>{const{username:s}=Zu(),e=Bt(),[r,i]=E.useState("activity"),{data:l,isLoading:c,isError:d,error:f}=nN(s??null),m=kx(),g=E.useMemo(()=>l?l.displayName||l.username||"Profile":s?`@${s}`:"Profile",[l,s]);if(!s)return a.jsx("div",{className:"flex min-h-[60vh] items-center justify-center px-4",children:a.jsxs("div",{className:"max-w-md rounded-mn-card border border-mn-border-subtle bg-mn-bg-elevated/80 px-4 py-6 text-center text-sm text-mn-text-primary shadow-mn-card",children:[a.jsx("h1",{className:"text-base font-heading font-semibold",children:"Profile"}),a.jsxs("p",{className:"mt-2 text-xs text-mn-text-secondary",children:["This profile route is missing a username. Make sure you are visiting a URL like"," ",a.jsx("span",{className:"mx-1 rounded bg-mn-bg-elevated px-1.5 py-0.5 font-mono text-[11px]",children:"/u/<username>"}),"."]})]})});if(c)return a.jsx("div",{className:"flex min-h-[60vh] items-center justify-center px-4",children:a.jsxs("div",{className:"flex items-center gap-2 rounded-mn-card border border-mn-border-subtle bg-mn-bg-elevated/80 px-4 py-3 text-sm text-mn-text-secondary shadow-mn-card",children:[a.jsx(bn,{className:"h-4 w-4 animate-spin","aria-hidden":"true"}),a.jsx("span",{children:"Loading profile"})]})});if(d||!l)return a.jsx("div",{className:"flex min-h-[60vh] items-center justify-center px-4",children:a.jsxs("div",{className:"max-w-md rounded-mn-card border border-mn-border-subtle bg-mn-bg-elevated/80 px-4 py-6 text-center text-sm text-mn-text-primary shadow-mn-card",children:[a.jsx("h1",{className:"text-base font-heading font-semibold",children:"Profile not found"}),a.jsxs("p",{className:"mt-2 text-xs text-mn-text-secondary",children:["We couldn't find a profile for username"," ",a.jsxs("span",{className:"rounded bg-mn-bg-elevated px-1.5 py-0.5 font-mono text-[11px]",children:["@",s]}),"."]}),(f==null?void 0:f.message)&&a.jsxs("p",{className:"mt-2 text-[11px] text-mn-text-muted",children:[a.jsx("span",{className:"font-semibold",children:"Details:"})," ",f.message]})]})});const y=async()=>{if(l){if(l.isCurrentUser){e("/settings/profile");return}m.isPending||m.mutate({targetUserId:l.id,currentlyFollowing:l.isFollowing})}},x=l.isCurrentUser?"Edit profile":l.isFollowing?"Following":"Follow",j=l.isCurrentUser?Kb:l.isFollowing?jg:ta;return a.jsxs("div",{className:"flex flex-1 flex-col gap-4 pb-2 pt-1",children:[a.jsx("header",{className:"px-3 pt-1",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-mn-accent-teal/20 text-base font-semibold text-mn-accent-teal",children:l.avatarUrl?a.jsx("img",{src:l.avatarUrl,alt:l.displayName||l.username||"Profile avatar",className:"h-16 w-16 rounded-full object-cover"}):a.jsx("span",{"aria-hidden":"true",children:oN(l.displayName,l.username)})}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h1",{className:"text-base font-heading font-semibold text-mn-text-primary",children:g}),l.username&&a.jsxs("span",{className:"rounded bg-mn-bg-elevated px-1.5 py-0.5 text-[11px] font-mono text-mn-text-secondary",children:["@",l.username]})]}),l.bio&&a.jsx("p",{className:"whitespace-pre-line text-[11px] leading-snug text-mn-text-secondary",children:l.bio}),a.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-3 text-[11px] text-mn-text-secondary",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Ot,{className:"h-3.5 w-3.5","aria-hidden":"true"}),a.jsxs("span",{children:[a.jsx("span",{className:"font-semibold text-mn-text-primary",children:Ep(l.followersCount)})," ","followers"]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(od,{className:"h-3.5 w-3.5","aria-hidden":"true"}),a.jsxs("span",{children:[a.jsx("span",{className:"font-semibold text-mn-text-primary",children:Ep(l.followingCount)})," ","following"]})]})]})]}),a.jsx("div",{className:"flex items-start",children:a.jsxs("button",{type:"button",onClick:y,disabled:m.isPending,className:"inline-flex items-center gap-1.5 rounded-full border border-mn-border-subtle bg-mn-bg-elevated px-3 py-1.5 text-[11px] font-medium text-mn-text-primary shadow-mn-card hover:bg-mn-bg-elevated/80 disabled:opacity-60",children:[m.isPending?a.jsx(bn,{className:"h-3.5 w-3.5 animate-spin","aria-hidden":"true"}):a.jsx(j,{className:"h-3.5 w-3.5","aria-hidden":"true"}),a.jsx("span",{children:x})]})})]})}),a.jsx("section",{className:"px-3",children:a.jsxs("nav",{className:"mt-2 flex items-center gap-2 rounded-full bg-mn-bg-elevated/70 p-1 text-[11px]","aria-label":"Profile tabs",children:[a.jsx("button",{type:"button",onClick:()=>i("activity"),className:`flex-1 rounded-full px-3 py-1.5 text-center font-medium ${r==="activity"?"bg-mn-bg-elevated shadow-mn-card text-mn-text-primary":"text-mn-text-secondary hover:text-mn-text-primary"}`,"aria-pressed":r==="activity",children:"Activity"}),a.jsx("button",{type:"button",onClick:()=>i("diary"),className:`flex-1 rounded-full px-3 py-1.5 text-center font-medium ${r==="diary"?"bg-mn-bg-elevated shadow-mn-card text-mn-text-primary":"text-mn-text-secondary hover:text-mn-text-primary"}`,"aria-pressed":r==="diary",children:"Diary"})]})}),a.jsx("section",{"aria-live":"polite",className:"flex-1",children:r==="activity"?a.jsx(iN,{}):a.jsx(aN,{})})]})},cN=()=>{var x;const{user:s}=nt(),{data:e,isLoading:r,isError:i,error:l}=sN(),c=Mr(),[d,f]=E.useState({displayName:"",bio:""});E.useEffect(()=>{e&&f({displayName:e.displayName??"",bio:e.bio??""})},[e]);const m=wn({mutationFn:async({displayName:j,bio:w})=>{if(!s)throw new Error("You need to be signed in to update your profile.");const{error:N}=await se.from("profiles").update({display_name:j.trim()||null,bio:w.trim()||null}).eq("id",s.id);if(N)throw N},onSuccess:()=>{c.invalidateQueries({queryKey:["profile"]})}}),g=j=>w=>{f(N=>({...N,[j]:w.target.value}))},y=async j=>{j.preventDefault(),!(!s||!e||m.isPending)&&await m.mutateAsync({displayName:d.displayName,bio:d.bio})};return s?r?a.jsx("div",{className:"flex min-h-[60vh] items-center justify-center px-4",children:a.jsxs("div",{className:"flex items-center gap-2 rounded-mn-card border border-mn-border-subtle/80 bg-mn-bg-elevated/80 px-4 py-3 text-sm text-mn-text-secondary shadow-mn-card",children:[a.jsx(bn,{className:"h-4 w-4 animate-spin","aria-hidden":"true"}),a.jsx("span",{children:"Loading your profile"})]})}):i||!e?a.jsx("div",{className:"flex min-h-[60vh] items-center justify-center px-4",children:a.jsxs("div",{className:"max-w-md rounded-mn-card border border-mn-border-subtle/80 bg-mn-bg-elevated/80 px-4 py-6 text-center text-sm text-mn-text-primary shadow-mn-card",children:[a.jsx("h1",{className:"text-base font-heading font-semibold",children:"Profile unavailable"}),a.jsx("p",{className:"mt-2 text-xs text-mn-text-secondary",children:"We couldn't load your profile right now."}),(l==null?void 0:l.message)&&a.jsxs("p",{className:"mt-2 text-[11px] text-mn-text-muted",children:[a.jsx("span",{className:"font-semibold",children:"Details:"})," ",l.message]})]})}):a.jsxs("div",{className:"flex flex-1 flex-col gap-4 pb-2 pt-1",children:[a.jsxs("header",{className:"space-y-1 px-4 pt-1",children:[a.jsx("p",{className:"text-[11px] font-medium uppercase tracking-[0.18em] text-mn-text-muted",children:"Settings"}),a.jsx("h1",{className:"text-xl font-heading font-semibold text-mn-text-primary",children:"Profile"}),a.jsx("p",{className:"text-[11px] text-mn-text-secondary",children:"Update how your profile looks across MoviNesta."})]}),a.jsx("section",{className:"px-4 pb-24",children:a.jsxs("form",{onSubmit:y,className:"space-y-4 rounded-mn-card border border-mn-border-subtle/80 bg-mn-bg-elevated/80 p-4 shadow-mn-card",children:[a.jsxs("div",{className:"mb-2 flex items-start gap-3",children:[a.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-mn-border-subtle/50",children:a.jsx(od,{className:"h-4 w-4 text-mn-text-secondary","aria-hidden":"true"})}),a.jsxs("div",{className:"space-y-0.5",children:[a.jsx("h2",{className:"text-sm font-heading font-semibold text-mn-text-primary",children:"Public profile"}),a.jsx("p",{className:"text-[11px] text-mn-text-secondary",children:"Your profile is shown on your diary, reviews, and social features."})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{htmlFor:"displayName",className:"block text-[11px] font-medium uppercase tracking-[0.16em] text-mn-text-muted",children:"Display name"}),a.jsx("input",{id:"displayName",type:"text",value:d.displayName,onChange:g("displayName"),maxLength:80,className:"w-full rounded-md border border-mn-border-subtle bg-mn-bg px-3 py-2 text-sm text-mn-text-primary shadow-sm outline-none ring-0 placeholder:text-mn-text-muted focus:border-mn-border-strong focus:ring-2 focus:ring-mn-border-strong/40",placeholder:"How should we show your name?"}),a.jsx("p",{className:"text-[10px] text-mn-text-muted",children:"This is the name other people see on your profile and activity."})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{htmlFor:"bio",className:"block text-[11px] font-medium uppercase tracking-[0.16em] text-mn-text-muted",children:"Bio"}),a.jsx("textarea",{id:"bio",value:d.bio,onChange:g("bio"),rows:4,maxLength:280,className:"w-full resize-none rounded-md border border-mn-border-subtle bg-mn-bg px-3 py-2 text-sm text-mn-text-primary shadow-sm outline-none ring-0 placeholder:text-mn-text-muted focus:border-mn-border-strong focus:ring-2 focus:ring-mn-border-strong/40",placeholder:"Tell people a bit about your taste in movies."}),a.jsx("p",{className:"text-[10px] text-mn-text-muted",children:"You can use multiple lines. Keep it short and cinematic."})]})]}),(m.isError||m.isSuccess)&&a.jsxs("div",{className:"pt-1 text-[11px]",children:[m.isError&&a.jsxs("div",{className:"flex items-center gap-1.5 text-mn-error",children:[a.jsx(el,{className:"h-3.5 w-3.5","aria-hidden":"true"}),a.jsx("span",{children:((x=m.error)==null?void 0:x.message)??"Couldnt save changes."})]}),m.isSuccess&&!m.isError&&a.jsxs("div",{className:"flex items-center gap-1.5 text-emerald-400",children:[a.jsx(Vo,{className:"h-3.5 w-3.5","aria-hidden":"true"}),a.jsx("span",{children:"Profile updated."})]})]}),a.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[a.jsx("button",{type:"button",className:"rounded-full border border-transparent px-3 py-1.5 text-xs font-medium text-mn-text-secondary hover:bg-mn-border-subtle/40",onClick:()=>{e&&(f({displayName:e.displayName??"",bio:e.bio??""}),m.reset())},children:"Reset"}),a.jsxs("button",{type:"submit",disabled:m.isPending,className:"inline-flex items-center gap-1.5 rounded-full bg-mn-accent/90 px-3.5 py-1.5 text-xs font-medium text-black shadow-mn-card transition hover:bg-mn-accent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-accent/70 focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg disabled:cursor-not-allowed disabled:opacity-70",children:[m.isPending&&a.jsx(bn,{className:"h-3.5 w-3.5 animate-spin","aria-hidden":"true"}),a.jsx("span",{children:"Save changes"})]})]})]})})]}):a.jsx("div",{className:"flex flex-1 flex-col items-center justify-center px-4",children:a.jsxs("div",{className:"max-w-md rounded-mn-card border border-mn-border-subtle/80 bg-mn-bg-elevated/80 px-4 py-6 text-center text-sm text-mn-text-primary shadow-mn-card",children:[a.jsx("h1",{className:"text-base font-heading font-semibold",children:"You're signed out"}),a.jsx("p",{className:"mt-2 text-xs text-mn-text-secondary",children:"Sign in to edit your profile settings."})]})})},uN=()=>{const{user:s,signOut:e}=nt(),r=Bt(),[i,l]=Ft.useState(!1),[c,d]=Ft.useState(null),f=s!=null&&s.created_at?new Date(s.created_at):null,m=async()=>{if(!i){l(!0),d(null);try{await e(),r("/auth/signin")}catch(g){d(g.message??"Something went wrong while signing out."),l(!1)}}};return s?a.jsxs("div",{className:"flex flex-1 flex-col gap-4 pb-2 pt-1",children:[a.jsxs("header",{className:"space-y-1 px-4 pt-1",children:[a.jsx("p",{className:"text-[11px] font-medium uppercase tracking-[0.18em] text-mn-text-muted",children:"Settings"}),a.jsx("h1",{className:"text-xl font-heading font-semibold text-mn-text-primary",children:"Account"}),a.jsx("p",{className:"text-[11px] text-mn-text-secondary",children:"Manage the account you use to sign in to MoviNesta."})]}),a.jsxs("section",{className:"space-y-4 px-4 pb-24",children:[a.jsxs("div",{className:"space-y-3 rounded-mn-card border border-mn-border-subtle/80 bg-mn-bg-elevated/80 p-4 shadow-mn-card",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-mn-border-subtle/50",children:a.jsx(Bb,{className:"h-4 w-4 text-mn-text-secondary","aria-hidden":"true"})}),a.jsxs("div",{className:"space-y-0.5",children:[a.jsx("h2",{className:"text-sm font-heading font-semibold text-mn-text-primary",children:"Email"}),a.jsx("p",{className:"text-[11px] text-mn-text-secondary",children:"This is the email you use to sign in."})]})]}),a.jsxs("div",{className:"rounded-md border border-dashed border-mn-border-subtle/70 bg-mn-bg/40 px-3 py-2 text-[11px] text-mn-text-secondary",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsx("span",{className:"font-mono text-xs text-mn-text-primary",children:s.email??"No email on file"}),a.jsx("span",{className:"rounded-full bg-mn-bg px-2 py-0.5 text-[10px] uppercase tracking-[0.18em] text-mn-text-muted",children:"Primary"})]}),f&&a.jsxs("p",{className:"mt-1 text-[10px] text-mn-text-muted",children:["Joined on"," ",f.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"2-digit"})]})]})]}),a.jsxs("div",{className:"space-y-3 rounded-mn-card border border-mn-border-subtle/80 bg-mn-bg-elevated/80 p-4 shadow-mn-card",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-mn-border-subtle/50",children:a.jsx($b,{className:"h-4 w-4 text-mn-text-secondary","aria-hidden":"true"})}),a.jsxs("div",{className:"space-y-0.5",children:[a.jsx("h2",{className:"text-sm font-heading font-semibold text-mn-text-primary",children:"Password & security"}),a.jsx("p",{className:"text-[11px] text-mn-text-secondary",children:"Password resets and more advanced security can be wired up here later."})]})]}),a.jsx("p",{className:"text-[11px] text-mn-text-muted",children:"TODO: Wire up password reset using Supabase auth (e.g. magic links or email reset flow)."})]}),a.jsxs("div",{className:"space-y-2 rounded-mn-card border border-mn-border-subtle/80 bg-mn-bg-elevated/80 p-4 shadow-mn-card",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsx("h2",{className:"text-sm font-heading font-semibold text-mn-text-primary",children:"Sign out"}),a.jsx("p",{className:"text-[11px] text-mn-text-secondary",children:"You'll need to sign in again to use MoviNesta on this device."})]}),a.jsxs("button",{type:"button",onClick:m,disabled:i,className:"inline-flex items-center gap-1.5 rounded-full border border-mn-border-subtle/80 px-3 py-1.5 text-xs font-medium text-mn-text-secondary transition hover:border-mn-error/70 hover:bg-mn-error/10 hover:text-mn-error disabled:opacity-70",children:[a.jsx(Fb,{className:"h-3.5 w-3.5","aria-hidden":"true"}),a.jsx("span",{children:i?"Signing out":"Sign out"})]})]}),c&&a.jsxs("p",{className:"mt-1 flex items-center gap-1.5 text-[11px] text-mn-error",children:[a.jsx(el,{className:"h-3.5 w-3.5","aria-hidden":"true"}),a.jsx("span",{children:c})]})]})]})]}):a.jsx("div",{className:"flex flex-1 flex-col items-center justify-center px-4",children:a.jsxs("div",{className:"max-w-md rounded-mn-card border border-mn-border-subtle/80 bg-mn-bg-elevated/80 px-4 py-6 text-center text-sm text-mn-text-primary shadow-mn-card",children:[a.jsx("h1",{className:"text-base font-heading font-semibold",children:"You're signed out"}),a.jsx("p",{className:"mt-2 text-xs text-mn-text-secondary",children:"Sign in to view and manage your account."})]})})},Cp="moviNesta.notifications",Pp={emailActivity:!0,emailRecommendations:!0,inAppSocial:!0,inAppSystem:!0},dN=()=>{const[s,e]=E.useState(Pp),[r,i]=E.useState("idle");E.useEffect(()=>{try{const d=window.localStorage.getItem(Cp);if(d){const f=JSON.parse(d);e({...Pp,...f})}}catch{}},[]);const l=d=>f=>{e(m=>({...m,[d]:f.target.checked})),i("idle")},c=()=>{try{window.localStorage.setItem(Cp,JSON.stringify(s)),i("saved")}catch{i("error")}};return a.jsxs("div",{className:"flex flex-1 flex-col gap-4 pb-2 pt-1",children:[a.jsxs("header",{className:"space-y-1 px-4 pt-1",children:[a.jsx("p",{className:"text-[11px] font-medium uppercase tracking-[0.18em] text-mn-text-muted",children:"Settings"}),a.jsx("h1",{className:"text-xl font-heading font-semibold text-mn-text-primary",children:"Notifications"}),a.jsx("p",{className:"text-[11px] text-mn-text-secondary",children:"Control how MoviNesta keeps in touch with you."})]}),a.jsxs("section",{className:"space-y-4 px-4 pb-24",children:[a.jsxs("div",{className:"space-y-3 rounded-mn-card border border-mn-border-subtle/80 bg-mn-bg-elevated/80 p-4 shadow-mn-card",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-mn-border-subtle/50",children:a.jsx(Ub,{className:"h-4 w-4 text-mn-text-secondary","aria-hidden":"true"})}),a.jsxs("div",{className:"space-y-0.5",children:[a.jsx("h2",{className:"text-sm font-heading font-semibold text-mn-text-primary",children:"Email"}),a.jsx("p",{className:"text-[11px] text-mn-text-secondary",children:"Occasional updates from MoviNesta in your inbox."})]})]}),a.jsxs("div",{className:"space-y-2 pt-2 text-[12px]",children:[a.jsxs("label",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("span",{className:"block text-mn-text-primary",children:"Activity on your content"}),a.jsx("span",{className:"block text-[11px] text-mn-text-secondary",children:"New followers, comments, and reactions."})]}),a.jsx("input",{type:"checkbox",checked:s.emailActivity,onChange:l("emailActivity"),className:"mt-1 h-4 w-4 rounded border-mn-border-subtle bg-mn-bg text-mn-accent"})]}),a.jsxs("label",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("span",{className:"block text-mn-text-primary",children:"Recommendations"}),a.jsx("span",{className:"block text-[11px] text-mn-text-secondary",children:"Personalized movie picks and weekly digests."})]}),a.jsx("input",{type:"checkbox",checked:s.emailRecommendations,onChange:l("emailRecommendations"),className:"mt-1 h-4 w-4 rounded border-mn-border-subtle bg-mn-bg text-mn-accent"})]})]})]}),a.jsxs("div",{className:"space-y-3 rounded-mn-card border border-mn-border-subtle/80 bg-mn-bg-elevated/80 p-4 shadow-mn-card",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-mn-border-subtle/50",children:a.jsx(Rb,{className:"h-4 w-4 text-mn-text-secondary","aria-hidden":"true"})}),a.jsxs("div",{className:"space-y-0.5",children:[a.jsx("h2",{className:"text-sm font-heading font-semibold text-mn-text-primary",children:"In-app notifications"}),a.jsx("p",{className:"text-[11px] text-mn-text-secondary",children:"What shows up inside the app. Push and OS-level settings still apply."})]})]}),a.jsxs("div",{className:"space-y-2 pt-2 text-[12px]",children:[a.jsxs("label",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("span",{className:"block text-mn-text-primary",children:"Social activity"}),a.jsx("span",{className:"block text-[11px] text-mn-text-secondary",children:"Follows, reactions, and friend activity."})]}),a.jsx("input",{type:"checkbox",checked:s.inAppSocial,onChange:l("inAppSocial"),className:"mt-1 h-4 w-4 rounded border-mn-border-subtle bg-mn-bg text-mn-accent"})]}),a.jsxs("label",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("span",{className:"block text-mn-text-primary",children:"System messages"}),a.jsx("span",{className:"block text-[11px] text-mn-text-secondary",children:"Account notices, billing, and other important updates."})]}),a.jsx("input",{type:"checkbox",checked:s.inAppSystem,onChange:l("inAppSystem"),className:"mt-1 h-4 w-4 rounded border-mn-border-subtle bg-mn-bg text-mn-accent"})]})]})]}),a.jsxs("div",{className:"flex items-center justify-between gap-3 pt-1",children:[a.jsxs("div",{className:"min-h-[20px] flex-1 text-[11px]",children:[r==="saved"&&a.jsxs("div",{className:"flex items-center gap-1.5 text-emerald-400",children:[a.jsx(Vo,{className:"h-3.5 w-3.5","aria-hidden":"true"}),a.jsx("span",{children:"Notification preferences saved to this device."})]}),r==="error"&&a.jsxs("div",{className:"flex items-center gap-1.5 text-mn-error",children:[a.jsx(el,{className:"h-3.5 w-3.5","aria-hidden":"true"}),a.jsx("span",{children:"Couldn't save preferences. Try again."})]})]}),a.jsxs("button",{type:"button",onClick:c,className:"inline-flex items-center gap-1.5 rounded-full bg-mn-accent/90 px-3.5 py-1.5 text-xs font-medium text-black shadow-mn-card transition hover:bg-mn-accent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-accent/70 focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg",children:[a.jsx(da,{className:"h-3.5 w-3.5","aria-hidden":"true"}),a.jsx("span",{children:"Save preferences"})]})]})]})]})},Tp="moviNesta.appSettings",Rp={startTab:"home",theme:"dark",reduceMotion:!1},hN=()=>{const[s,e]=E.useState(Rp),[r,i]=E.useState("idle");E.useEffect(()=>{try{const d=window.localStorage.getItem(Tp);if(d){const f=JSON.parse(d);e({...Rp,...f})}}catch{}},[]);const l=d=>f=>{e(m=>({...m,[d]:f})),i("idle")},c=()=>{try{window.localStorage.setItem(Tp,JSON.stringify(s)),i("saved")}catch{i("error")}};return a.jsxs("div",{className:"flex flex-1 flex-col gap-4 pb-2 pt-1",children:[a.jsxs("header",{className:"space-y-1 px-4 pt-1",children:[a.jsx("p",{className:"text-[11px] font-medium uppercase tracking-[0.18em] text-mn-text-muted",children:"Settings"}),a.jsx("h1",{className:"text-xl font-heading font-semibold text-mn-text-primary",children:"App"}),a.jsx("p",{className:"text-[11px] text-mn-text-secondary",children:"Customize how MoviNesta behaves on this device."})]}),a.jsxs("section",{className:"space-y-4 px-4 pb-24",children:[a.jsxs("div",{className:"space-y-3 rounded-mn-card border border-mn-border-subtle/80 bg-mn-bg-elevated/80 p-4 shadow-mn-card",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-mn-border-subtle/50",children:a.jsx(ht,{className:"h-4 w-4 text-mn-text-secondary","aria-hidden":"true"})}),a.jsxs("div",{className:"space-y-0.5",children:[a.jsx("h2",{className:"text-sm font-heading font-semibold text-mn-text-primary",children:"Start screen"}),a.jsx("p",{className:"text-[11px] text-mn-text-secondary",children:"Choose which tab you land on when you open MoviNesta."})]})]}),a.jsx("div",{className:"mt-2 grid grid-cols-3 gap-2 text-[12px]",children:[{key:"home",label:"Home"},{key:"swipe",label:"Swipe"},{key:"diary",label:"Diary"}].map(d=>{const f=s.startTab===d.key;return a.jsx("button",{type:"button",onClick:()=>l("startTab")(d.key),className:`flex items-center justify-center gap-1 rounded-full border px-3 py-1.5 text-xs transition ${f?"border-mn-accent bg-mn-accent/20 text-mn-accent":"border-mn-border-subtle/80 bg-mn-bg text-mn-text-secondary hover:border-mn-border-strong/80 hover:bg-mn-bg-elevated"}`,children:a.jsx("span",{children:d.label})},d.key)})}),a.jsx("p",{className:"mt-1 text-[10px] text-mn-text-muted",children:"This is stored locally. You can later hook it into navigation logic if needed."})]}),a.jsxs("div",{className:"space-y-3 rounded-mn-card border border-mn-border-subtle/80 bg-mn-bg-elevated/80 p-4 shadow-mn-card",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-mn-border-subtle/50",children:a.jsx(zb,{className:"h-4 w-4 text-mn-text-secondary","aria-hidden":"true"})}),a.jsxs("div",{className:"space-y-0.5",children:[a.jsx("h2",{className:"text-sm font-heading font-semibold text-mn-text-primary",children:"Theme"}),a.jsx("p",{className:"text-[11px] text-mn-text-secondary",children:"MoviNesta currently runs in dark mode. Light mode can be added later."})]})]}),a.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-[12px]",children:[a.jsxs("button",{type:"button",onClick:()=>l("theme")("system"),className:`inline-flex items-center gap-1.5 rounded-full border px-3 py-1.5 text-xs transition ${s.theme==="system"?"border-mn-accent bg-mn-accent/20 text-mn-accent":"border-mn-border-subtle/80 bg-mn-bg text-mn-text-secondary hover:border-mn-border-strong/80 hover:bg-mn-bg-elevated"}`,children:[a.jsx(Gb,{className:"h-3.5 w-3.5","aria-hidden":"true"}),a.jsx("span",{children:"Match system"})]}),a.jsxs("button",{type:"button",onClick:()=>l("theme")("dark"),className:`inline-flex items-center gap-1.5 rounded-full border px-3 py-1.5 text-xs transition ${s.theme==="dark"?"border-mn-accent bg-mn-accent/20 text-mn-accent":"border-mn-border-subtle/80 bg-mn-bg text-mn-text-secondary hover:border-mn-border-strong/80 hover:bg-mn-bg-elevated"}`,children:[a.jsx(Mm,{className:"h-3.5 w-3.5","aria-hidden":"true"}),a.jsx("span",{children:"Always dark"})]})]}),a.jsx("p",{className:"mt-1 text-[10px] text-mn-text-muted",children:"TODO: Wire this into a real theme switcher once light mode is supported."})]}),a.jsxs("div",{className:"space-y-3 rounded-mn-card border border-mn-border-subtle/80 bg-mn-bg-elevated/80 p-4 shadow-mn-card",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-mn-border-subtle/50",children:a.jsx(Mm,{className:"h-4 w-4 text-mn-text-secondary","aria-hidden":"true"})}),a.jsxs("div",{className:"space-y-0.5",children:[a.jsx("h2",{className:"text-sm font-heading font-semibold text-mn-text-primary",children:"Motion"}),a.jsx("p",{className:"text-[11px] text-mn-text-secondary",children:"Reduce some of the more cinematic animations."})]})]}),a.jsxs("label",{className:"mt-2 flex items-center justify-between gap-3 text-[12px]",children:[a.jsxs("div",{children:[a.jsx("span",{className:"block text-mn-text-primary",children:"Reduce motion"}),a.jsx("span",{className:"block text-[11px] text-mn-text-secondary",children:"Fewer transitions and subtle effects. Great if you prefer a calmer UI."})]}),a.jsx("input",{type:"checkbox",checked:s.reduceMotion,onChange:d=>l("reduceMotion")(d.target.checked),className:"h-4 w-4 rounded border-mn-border-subtle bg-mn-bg text-mn-accent"})]})]}),a.jsxs("div",{className:"flex items-center justify-between gap-3 pt-1",children:[a.jsxs("div",{className:"min-h-[20px] flex-1 text-[11px]",children:[r==="saved"&&a.jsxs("div",{className:"flex items-center gap-1.5 text-emerald-400",children:[a.jsx(Vo,{className:"h-3.5 w-3.5","aria-hidden":"true"}),a.jsx("span",{children:"App settings saved to this device."})]}),r==="error"&&a.jsxs("div",{className:"flex items-center gap-1.5 text-mn-error",children:[a.jsx(el,{className:"h-3.5 w-3.5","aria-hidden":"true"}),a.jsx("span",{children:"Couldn't save settings. Try again."})]})]}),a.jsxs("button",{type:"button",onClick:c,className:"inline-flex items-center gap-1.5 rounded-full bg-mn-accent/90 px-3.5 py-1.5 text-xs font-medium text-black shadow-mn-card transition hover:bg-mn-accent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-accent/70 focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg",children:[a.jsx(Vo,{className:"h-3.5 w-3.5","aria-hidden":"true"}),a.jsx("span",{children:"Save settings"})]})]})]})]})},fN=()=>{const s=Bt();return a.jsx("div",{className:"flex min-h-screen items-center justify-center bg-mn-bg px-4",children:a.jsxs("div",{className:"max-w-md rounded-mn-card border border-mn-border-subtle bg-mn-bg-elevated/90 p-6 text-center shadow-mn-card backdrop-blur",children:[a.jsx("h1",{className:"text-lg font-heading font-semibold text-mn-text-primary",children:"Page not found"}),a.jsx("p",{className:"mt-2 text-sm text-mn-text-secondary",children:"We couldn't find that screen. Maybe it got lost in the credits."}),a.jsx("button",{type:"button",onClick:()=>s("/",{replace:!0}),className:"mt-4 inline-flex items-center justify-center rounded-full bg-mn-primary px-4 py-2 text-xs font-semibold text-black shadow-mn-soft transition hover:bg-mn-accent-teal focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg",children:"Back to Home"}),a.jsxs("p",{className:"mt-3 text-xs text-mn-text-secondary",children:["If you keep seeing this screen, try"," ",a.jsx("button",{type:"button",onClick:()=>s("/auth/sign-in"),className:"underline underline-offset-2",children:"signing in again"}),"."]})]})})},mN=()=>a.jsxs("div",{className:"flex min-h-screen flex-col bg-mn-bg text-mn-text-primary",children:[a.jsx("div",{"aria-hidden":"true",className:"pointer-events-none fixed inset-0 bg-[radial-gradient(circle_at_top,_rgba(244,114,182,0.24),_transparent_55%),_radial-gradient(circle_at_bottom,_rgba(56,189,248,0.18),_transparent_55%)]"}),a.jsxs("div",{className:"relative z-10 mx-auto flex w-full max-w-5xl flex-1 flex-col items-center justify-center px-4 py-10 text-center",children:[a.jsxs("div",{className:"mb-8 flex flex-col items-center gap-5",children:[a.jsx("div",{className:"flex h-28 w-28 items-center justify-center rounded-full bg-mn-bg-elevated/90 shadow-mn-card ring-2 ring-mn-primary/40",children:a.jsx("img",{src:_g,alt:"MoviNesta logo",className:"h-24 w-24 rounded-full object-contain"})}),a.jsxs("div",{className:"max-w-md space-y-2",children:[a.jsx("h1",{className:"text-2xl font-heading font-semibold",children:"Your movie life, in one nest."}),a.jsx("p",{className:"text-sm text-mn-text-secondary",children:"MoviNesta keeps your watchlist, recommendations, and movie memories in a single cozy, cinematic space. Swipe to discover, log what you watch, and see what your friends are into."})]})]}),a.jsxs("div",{className:"flex flex-col items-center gap-3",children:[a.jsx(We,{to:"/auth/signup",className:"inline-flex min-w-[200px] items-center justify-center rounded-full bg-mn-primary px-5 py-2.5 text-sm font-medium text-white shadow-mn-soft transition hover:bg-mn-primary/90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mn-primary focus-visible:ring-offset-2 focus-visible:ring-offset-mn-bg",children:"Get started"}),a.jsx(We,{to:"/auth/signin",className:"text-xs font-medium text-mn-text-secondary hover:text-mn-primary hover:underline",children:"I already have an account"})]})]})]}),pN=()=>a.jsxs(C0,{children:[a.jsx(Ge,{path:"/auth/signin",element:a.jsx(Rj,{})}),a.jsx(Ge,{path:"/auth/signup",element:a.jsx(Aj,{})}),a.jsx(Ge,{path:"/auth/forgot-password",element:a.jsx(Lj,{})}),a.jsx(Ge,{path:"/auth/reset-password",element:a.jsx(Mj,{})}),a.jsx(Ge,{path:"/welcome",element:a.jsx(mN,{})}),a.jsx(Ge,{element:a.jsx(Pj,{}),children:a.jsxs(Ge,{element:a.jsx(Cj,{}),children:[a.jsx(Ge,{index:!0,element:a.jsx(c_,{})}),a.jsx(Ge,{path:"/swipe",element:a.jsx(j_,{})}),a.jsx(Ge,{path:"/messages",element:a.jsx(k_,{})}),a.jsx(Ge,{path:"/messages/:conversationId",element:a.jsx(R_,{})}),a.jsx(Ge,{path:"/search",element:a.jsx($_,{})}),a.jsx(Ge,{path:"/diary",element:a.jsx(Z_,{})}),a.jsx(Ge,{path:"/title/:titleId",element:a.jsx(tN,{})}),a.jsx(Ge,{path:"/u/:username",element:a.jsx(lN,{})}),a.jsx(Ge,{path:"/settings/profile",element:a.jsx(cN,{})}),a.jsx(Ge,{path:"/settings/account",element:a.jsx(uN,{})}),a.jsx(Ge,{path:"/settings/notifications",element:a.jsx(dN,{})}),a.jsx(Ge,{path:"/settings/app",element:a.jsx(hN,{})})]})}),a.jsx(Ge,{path:"*",element:a.jsx(fN,{})})]}),gN=()=>a.jsx(pN,{}),xN=new mb({defaultOptions:{queries:{staleTime:1e3*60,refetchOnWindowFocus:!1,retry:1}}});Lv.createRoot(document.getElementById("root")).render(a.jsx(Ft.StrictMode,{children:a.jsx(Sj,{children:a.jsxs(pb,{client:xN,children:[a.jsx(U0,{basename:"/MoviNesta",children:a.jsx(gN,{})}),!1]})})}));
