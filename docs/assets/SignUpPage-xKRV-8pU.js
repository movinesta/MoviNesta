import{r as d,u as E,a as P,j as s,B as k,L,s as A}from"./index-C0YC7Lqk.js";import{u as B}from"./useDocumentTitle-qe37jqeh.js";import{T as q,P as y}from"./PasswordField-J7mlC0zS.js";import{A as T}from"./AuthLayout-COhaL2wk.js";import"./brand-Ma_ngRFQ.js";import"./sparkles-BsAyD2aC.js";import"./film-BhU7UJY3.js";const F=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,p=8;function m(t,c,i){const o={};return t?F.test(t)||(o.email="Please enter a valid email address."):o.email="Email is required.",c?c.length<p&&(o.password=`Password must be at least ${p} characters.`):o.password="Password is required.",i?c!==i&&(o.confirm="Passwords do not match."):o.confirm="Please confirm your password.",o}const V=()=>{B("Create account");const[t,c]=d.useState(""),[i,o]=d.useState(""),[l,j]=d.useState(""),[u,h]=d.useState(!1),[a,n]=d.useState({}),[w,f]=d.useState(null),[b,g]=d.useState(null),S=E();P().state?.from?.pathname;const N=!!t&&!!i&&!!l&&Object.keys(m(t,i,l)).length===0,C=async e=>{e.preventDefault();const r=m(t,i,l);if(Object.keys(r).length>0){n(r),f(null),g(null);return}try{h(!0),f(null),g(null),n({});const{data:x,error:v}=await A.auth.signUp({email:t,password:i});if(v){f(v.message||"Sign-up failed. Please check your details and try again.");return}if(!x.session){g("Almost there! Check your email inbox for a confirmation link to activate your account.");return}S("/onboarding",{replace:!0})}catch(x){console.error(x),f("Something went wrong while creating your account.")}finally{h(!1)}};return s.jsxs(T,{kicker:"Join MoviNesta",title:"Create your account",description:"Track what you watch, swap recommendations, and keep a cozy cinematic diary.",footer:s.jsxs("span",{children:["Already have an account?"," ",s.jsx(L,{to:"/auth/signin",className:"font-medium text-primary hover:underline",children:"Sign in instead"})]}),children:[w&&s.jsx("div",{role:"alert",className:"rounded-xl border border-destructive/40 bg-destructive/10 px-3 py-2 text-xs text-destructive",children:w}),b&&s.jsx("div",{role:"status",className:"rounded-xl border border-emerald-400/40 bg-emerald-400/10 px-3 py-2 text-xs text-emerald-800",children:b}),s.jsxs("form",{onSubmit:C,className:"space-y-4",noValidate:!0,children:[s.jsx(q,{id:"signup-email",label:"Email address",type:"email",autoComplete:"email",required:!0,value:t,onChange:e=>{c(e.target.value),a.email&&n(r=>({...r,email:void 0}))},onBlur:()=>{const e=m(t,i,l);e.email&&n(r=>({...r,email:e.email}))},disabled:u,error:a.email}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsx(y,{id:"signup-password",label:"Password",ariaLabelBase:"password",autoComplete:"new-password",required:!0,minLength:p,value:i,onChange:e=>{o(e.target.value),a.password&&n(r=>({...r,password:void 0}))},onBlur:()=>{const e=m(t,i,l);e.password&&n(r=>({...r,password:e.password}))},disabled:u,"aria-invalid":!!a.password,"aria-describedby":a.password?"signup-password-error":"signup-password-hint"}),!a.password&&s.jsxs("p",{id:"signup-password-hint",className:"text-xs text-muted-foreground",children:["At least ",p," characters."]}),a.password&&s.jsx("p",{id:"signup-password-error",className:"text-xs text-destructive",children:a.password})]}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsx(y,{id:"signup-confirm",label:"Confirm password",ariaLabelBase:"password confirmation",autoComplete:"new-password",required:!0,minLength:p,value:l,onChange:e=>{j(e.target.value),a.confirm&&n(r=>({...r,confirm:void 0}))},onBlur:()=>{const e=m(t,i,l);e.confirm&&n(r=>({...r,confirm:e.confirm}))},disabled:u,"aria-invalid":!!a.confirm,"aria-describedby":a.confirm?"signup-confirm-error":void 0}),a.confirm&&s.jsx("p",{id:"signup-confirm-error",className:"text-xs text-destructive",children:a.confirm})]}),s.jsx(k,{type:"submit",className:"w-full",disabled:u||!N,children:u?"Creating your accountâ€¦":"Create account"})]})]})};export{V as default};
