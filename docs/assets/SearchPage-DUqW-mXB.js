import{c as z,R as P,j as e,B as S,s as M,L as B,b as D,e as H,u as V,r as k,M as W,o as G,p as K}from"./index-yaS868vE.js";import{C as X}from"./Chip-CvTp_SM0.js";import{I as U}from"./input-eTUG8pOx.js";import{T as Z,a as J,b as A}from"./Tabs-CmYZfAHu.js";import{S as ee}from"./SearchField-6So5ppG5.js";import{P as re}from"./PageChrome-DtwQ8A91.js";import{T as te}from"./TopBar-DVbOlr27.js";import{u as se,a as ae}from"./useSearchTitles-yTnLkWqc.js";import{Y as oe}from"./index-3WBCh0tp.js";import{F as Q}from"./film-Did84F3L.js";import{S as ne}from"./star-BfXtR-rq.js";import{u as le}from"./useToggleFollow-18dQkAwo.js";import{U as ie}from"./users-DGRv-nuh.js";import{U as de}from"./user-DB0UbwXK.js";import{U as ce,a as ue}from"./user-plus-Rsyw3nCt.js";import{X as E}from"./x-DNY9LJhZ.js";import"./index-B227mAYG.js";import"./useMutation-WGdhQwN_.js";const me=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],I=z("funnel",me);const xe=[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]],fe=z("languages",xe);const pe=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],$=z("sliders-horizontal",pe),ge=["all","movie","series","anime"],q=a=>a.get("tab")==="people"?"people":"titles",L=a=>{if(typeof a!="number")return;const n=new Date().getFullYear();return Math.min(Math.max(a,1900),n)},he=a=>{const n=a.get("type"),x=ge.includes(n)?n:"all",d=l=>{if(!l)return;const p=Number(l);return Number.isFinite(p)?p:void 0},b=L(d(a.get("minYear"))),m=L(d(a.get("maxYear"))),N=a.get("lang")||void 0;return b&&m&&b>m?{type:x,minYear:m,maxYear:b,originalLanguage:N}:{type:x,minYear:b,maxYear:m,originalLanguage:N}},be=({item:a})=>{const n=[];a.year&&n.push(String(a.year)),a.type==="movie"&&n.push("Movie"),a.type==="series"&&n.push("Series"),a.type==="anime"&&n.push("Anime"),a.originalLanguage&&n.push(`Language: ${a.originalLanguage}`),a.ageRating&&n.push(a.ageRating),a.imdbRating&&n.push(`IMDb ${a.imdbRating.toFixed(1)}`),a.rtTomatoMeter&&n.push(`RT ${a.rtTomatoMeter}%`);const x={library:"Library","external-synced":"Synced","external-only":"External"},d={library:"bg-primary/10 text-primary border-primary/40","external-synced":"bg-emerald-500/10 text-emerald-400 border-emerald-500/30","external-only":"bg-card text-muted-foreground border-border"};return e.jsx("div",{children:e.jsxs(B,{to:`/title/${a.id}`,className:"flex gap-3 rounded-2xl border border-border bg-background/60 p-2 hover:bg-card/80",children:[a.posterUrl?e.jsx("img",{src:a.posterUrl,alt:a.title,className:"h-20 w-14 rounded-2xl object-cover",loading:"lazy"}):e.jsx("div",{className:"flex h-20 w-14 items-center justify-center rounded-2xl bg-muted",children:e.jsx(Q,{className:"h-5 w-5 text-muted-foreground","aria-hidden":"true"})}),e.jsxs("div",{className:"flex min-w-0 flex-1 flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"truncate text-[12px] font-medium text-foreground",children:a.title}),e.jsx("span",{className:`shrink-0 rounded-full border px-2 py-0.5 text-xs font-medium ${d[a.source]}`,children:x[a.source]})]}),n.length>0&&e.jsx("p",{className:"text-xs text-muted-foreground",children:n.join(" • ")})]})]})})},ye=({query:a,filters:n,onResetFilters:x})=>{const d=a.trim(),{data:b,isLoading:m,isError:N,error:l,fetchNextPage:p,hasNextPage:w,isFetchingNextPage:f}=se({query:d,filters:n}),g=b?.pages.flatMap(r=>r.results)??[],C=g.length,h=[];if(n.type&&n.type!=="all"){const r={movie:"Movies",series:"Series",anime:"Anime",all:"All"};h.push(r[n.type])}typeof n.minYear=="number"&&h.push(`From ${n.minYear}`),typeof n.maxYear=="number"&&h.push(`Up to ${n.maxYear}`),n.originalLanguage&&h.push(`Language: ${n.originalLanguage==="en"?"English":n.originalLanguage}`);const F=h.length?h.join(" • "):"No filters applied",s=P.useRef(new Set);return P.useEffect(()=>{if(!g||!Array.isArray(g))return;const r=s.current,o=g.filter(i=>!(r.has(i.id)||!i.imdbId&&!i.tmdbId||i.imdbRating||i.rtTomatoMeter)).slice(0,3);(async()=>{for(const i of o){r.add(i.id);try{const{error:y}=await M.from("media_items").upsert({tmdb_id:i.tmdbId??null,omdb_imdb_id:i.imdbId??null,kind:i.type==="series"?"series":i.type??"movie",tmdb_title:i.title,tmdb_release_date:i.year?`${i.year}-01-01`:null},{onConflict:"kind,tmdb_id"}).select("id");y&&console.warn("[SearchTitlesTab] media_items upsert failed for",i.id,y.message)}catch(y){console.warn("[SearchTitlesTab] media_items upsert threw for",i.id,y)}}})()},[g]),d?m?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-[12px] text-muted-foreground",children:["Searching for ",e.jsx("span",{className:"font-semibold text-foreground",children:d}),"…"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Fetching matching titles from your catalog and external sources."}),e.jsx("div",{className:"space-y-2",children:[0,1,2].map(r=>e.jsxs("div",{className:"flex gap-3 rounded-2xl border border-border bg-background/60 p-2",children:[e.jsx("div",{className:"h-16 w-11 animate-pulse rounded-xl bg-card/60"}),e.jsxs("div",{className:"flex flex-1 flex-col justify-center space-y-1.5",children:[e.jsx("div",{className:"h-3 w-2/3 animate-pulse rounded bg-card/60"}),e.jsx("div",{className:"h-3 w-1/3 animate-pulse rounded bg-card/40"})]})]},r))})]}):N?e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-[12px] text-destructive",children:"Something went wrong while searching for titles."}),l&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-semibold",children:"Details: "}),l.message]})]}):C?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Showing ",e.jsx("span",{className:"font-semibold text-foreground",children:C})," result",C===1?"":"s"," across your catalog and external sources for"," ",e.jsx("span",{className:"font-semibold text-foreground",children:d}),"."]}),e.jsxs(S,{type:"button",variant:"outline",size:"sm",className:"h-auto rounded-full border-border px-2 py-1 text-muted-foreground hover:border-border hover:text-foreground",onClick:x,children:[e.jsx($,{className:"h-3 w-3","aria-hidden":"true"}),e.jsx("span",{children:"Reset filters"})]})]}),e.jsx("div",{className:"rounded-2xl border border-border bg-background/60 p-3",children:e.jsxs("p",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx("span",{className:"inline-flex h-5 w-5 items-center justify-center rounded-full bg-muted text-xs font-medium text-muted-foreground",children:e.jsx($,{className:"h-3 w-3","aria-hidden":"true"})}),e.jsx("span",{className:"truncate",children:F})]})}),e.jsx(oe,{style:{height:"70vh"},data:g,endReached:()=>{w&&!f&&p()},components:{List:P.forwardRef(function(o,c){return e.jsx("div",{ref:c,className:"space-y-2",...o})}),Footer:()=>w?e.jsx("div",{className:"flex justify-center py-3",children:e.jsx(S,{type:"button",className:"inline-flex items-center justify-center rounded-full bg-primary/90 disabled:cursor-not-allowed disabled:opacity-70",onClick:()=>p(),disabled:f,children:f?"Loading more…":"Load more results"})}):null},itemContent:(r,o)=>e.jsx(be,{item:o})})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-[12px] text-muted-foreground",children:["No titles found matching"," ",e.jsx("span",{className:"font-semibold text-foreground",children:d}),"."]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Try adjusting your search or removing some filters to see more results."})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-[12px] text-muted-foreground",children:"Start typing a title, director, or genre to search the catalog. As you wire Supabase search, results will appear here."}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-xs font-medium text-foreground",children:"Try searching for"}),e.jsx("div",{className:"flex flex-wrap gap-1.5 text-xs",children:["Sci-fi romance","Feel-good comedies","Films from 2020s","Cozy rainy-day movies"].map(r=>e.jsxs("span",{className:"inline-flex items-center rounded-full border border-border px-2 py-1 text-muted-foreground",children:[e.jsx(Q,{className:"mr-1 h-3 w-3 text-muted-foreground","aria-hidden":"true"}),r]},r))})]}),e.jsxs("div",{className:"space-y-1.5 rounded-2xl border border-border bg-background/60 p-3",children:[e.jsxs("p",{className:"flex items-center gap-1 text-xs font-medium text-foreground",children:[e.jsx(ne,{className:"h-3.5 w-3.5 text-primary","aria-hidden":"true"}),e.jsx("span",{children:"Trending this week"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Once analytics are wired up, you can show what your friends and the community are watching the most here."})]})]})},_=a=>{if(a?.aborted)throw a.reason??new DOMException("Aborted","AbortError")},je=a=>{const x=a.trim().replace(/^@+/,""),d=x.toLowerCase(),{user:b}=D();return H({queryKey:["search","people",{query:x,userId:b?.id??null}],enabled:x.length>0,staleTime:1e3*60*15,gcTime:1e3*60*30,queryFn:async({signal:m})=>{_(m);const N=x.replace(/%/g,"\\%").replace(/_/g,"\\_");let l=M.from("profiles_public").select("id, username, display_name, avatar_url, bio").or(`username.ilike.%${N}%,display_name.ilike.%${N}%`).limit(20);m&&(l=l.abortSignal(m));const p=await l;if(_(m),p.error)throw new Error(p.error.message);const w=p.data??[],f=w.map(r=>r.id);let g=new Map;if(f.length){let r=M.from("user_stats").select("user_id, followers_count, following_count").in("user_id",f);m&&(r=r.abortSignal(m));const o=await r;_(m),o.error?console.warn("[useSearchPeople] Failed to load user_stats",o.error.message):g=new Map((o.data??[]).map(c=>[c.user_id,{followersCount:c.followers_count??0,followingCount:c.following_count??0}]))}if(!b?.id)return w.map(r=>{const o=g.get(r.id);return{id:r.id,username:r.username,displayName:r.display_name,avatarUrl:r.avatar_url,bio:r.bio,followersCount:o?.followersCount??null,followingCount:o?.followingCount??null,isFollowing:!1}});let C=M.from("follows").select("followed_id").eq("follower_id",b.id);m&&(C=C.abortSignal(m));const h=await C;_(m),h.error&&console.warn("[useSearchPeople] Failed to load follows for current user",h.error.message);const F=new Set((h.data??[]).map(r=>r.followed_id));return w.map(r=>{const o=g.get(r.id),c=r.username??"",i=r.display_name??"",y=c.toLowerCase(),T=i.toLowerCase();let Y=0;y===d?Y+=100:y.startsWith(d)?Y+=80:T.startsWith(d)?Y+=60:y.includes(d)?Y+=40:T.includes(d)&&(Y+=30);const t=Math.min(15,Math.floor((o?.followersCount??0)/500));return{id:r.id,username:r.username,displayName:r.display_name,avatarUrl:r.avatar_url,bio:r.bio,followersCount:o?.followersCount??null,followingCount:o?.followingCount??null,isFollowing:F.has(r.id),relevance:Y+t}}).sort((r,o)=>{if(o.relevance!==r.relevance)return o.relevance-r.relevance;const c=(r.displayName??r.username??"").toLowerCase(),i=(o.displayName??o.username??"").toLowerCase();return c.localeCompare(i)}).map(({relevance:r,...o})=>o)}})},ve=({query:a})=>{const n=a.trim(),x=n.replace(/^@+/,""),d=x||n,{data:b,isLoading:m,isError:N,error:l}=je(x),p=le(),w=V(),{user:f}=D(),[g,C]=k.useState(null),h=b??[],F=async s=>{if(!f?.id){alert("You need to be signed in to start a conversation.");return}if(f.id===s){alert("You can't start a conversation with yourself.");return}C(s);try{const r=await G("create-direct-conversation",{targetUserId:s},{timeoutMs:25e3});if(!r?.ok||!r.conversationId){const o=r?.code;let c=r?.error??"Failed to get conversation id. Please try again.";o==="UNAUTHORIZED"?c="You need to be signed in to start a conversation.":o==="BAD_REQUEST_SELF_TARGET"?c="You can't start a conversation with yourself.":o==="SERVER_MISCONFIGURED"&&(c="Messaging is temporarily unavailable due to a server issue. Please try again later.");const i=new Error(c);throw i.code=o,i}w(`/messages/${r.conversationId}`)}catch(r){console.error("[SearchPeopleTab] Failed to start conversation",r);const o=r instanceof Error?r.message:"Something went wrong while starting the conversation. Please try again.";alert(o)}finally{C(null)}};return x?m?e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-[12px] text-muted-foreground",children:"Searching for people…"}),e.jsx("div",{className:"rounded-2xl border border-border bg-card/80 px-3 py-4 text-xs text-muted-foreground",children:"We'll show matching profiles here as soon as the results come back."})]}):N?e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-[12px] text-foreground",children:"Something went wrong."}),e.jsx("p",{className:"text-xs text-muted-foreground",children:l?.message??"We couldn&apos;t search for people right now. Please try again."})]}):!h||h.length===0?e.jsx("div",{className:"space-y-3",children:e.jsxs("p",{className:"text-[12px] text-muted-foreground",children:["No people found for"," ",e.jsxs("span",{className:"rounded border border-border bg-card px-1.5 py-0.5 text-xs font-medium text-foreground",children:["“",d,"”"]}),". Try a different name or username."]})}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex items-center justify-between gap-2",children:e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Showing ",h.length," profile",h.length===1?"":"s"," for"," ",e.jsxs("span",{className:"rounded border border-border bg-card px-1.5 py-0.5 text-xs font-medium text-foreground",children:["“",d,"”"]})]})}),e.jsx("ul",{className:"divide-y divide-border/60 rounded-2xl border border-border bg-card/80",children:h.map(s=>{const r=s.displayName??s.username??"Unknown user",o=s.username?`@${s.username}`:null,c=p.isPending&&p.variables?.targetUserId===s.id,i=!!(f?.id&&f.id===s.id);return e.jsxs("li",{className:"flex items-center justify-between gap-3 px-3 py-2 hover:bg-card/80",children:[e.jsxs(B,{to:s.username?`/u/${s.username}`:`/u/${s.id}`,className:"flex min-w-0 flex-1 items-center gap-3",children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-card/80 text-[14px] font-semibold text-foreground",children:s.avatarUrl?e.jsx("img",{src:s.avatarUrl,alt:r,className:"h-8 w-8 rounded-full object-cover",loading:"lazy"}):r?r[0]?.toUpperCase():e.jsx(de,{className:"h-4 w-4","aria-hidden":"true"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"truncate text-sm font-medium text-foreground",children:r}),i&&e.jsx("span",{className:"rounded-full border border-border bg-card px-2 py-0.5 text-[10px] text-muted-foreground",children:"You"})]}),o&&e.jsx("p",{className:"mt-0.5 text-xs text-muted-foreground",children:o}),s.bio&&e.jsx("p",{className:"mt-0.5 line-clamp-2 text-xs text-muted-foreground",children:s.bio}),(typeof s.followersCount=="number"||typeof s.followingCount=="number")&&e.jsxs("p",{className:"mt-0.5 text-xs text-muted-foreground",children:[typeof s.followersCount=="number"&&e.jsxs("span",{children:[s.followersCount," follower",s.followersCount===1?"":"s"]}),typeof s.followersCount=="number"&&typeof s.followingCount=="number"&&e.jsx("span",{children:" · "}),typeof s.followingCount=="number"&&e.jsxs("span",{children:["following ",s.followingCount]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!i&&e.jsx(S,{type:"button",onClick:()=>p.mutate({targetUserId:s.id,currentlyFollowing:s.isFollowing}),disabled:c,variant:s.isFollowing?"outline":"default",size:"sm",className:`h-auto rounded-full px-2.5 py-1.5 text-xs font-medium ${s.isFollowing?"border-border bg-card/80 text-foreground hover:border-primary/70 hover:text-foreground disabled:opacity-60":"border border-transparent bg-primary text-primary-foreground hover:bg-primary/90 disabled:opacity-60"}`,children:c?e.jsx("span",{children:"Updating…"}):s.isFollowing?e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"h-3 w-3","aria-hidden":"true"}),e.jsx("span",{children:"Following"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"h-3 w-3","aria-hidden":"true"}),e.jsx("span",{children:"Follow"})]})}),f?.id!==s.id&&e.jsx(S,{type:"button",onClick:()=>F(s.id),disabled:g===s.id,variant:"outline",size:"sm",className:"h-auto rounded-full border-border bg-card/80 px-2.5 py-1.5 text-xs font-medium text-foreground shadow-md hover:border-primary/70 hover:text-foreground disabled:cursor-not-allowed disabled:opacity-60",children:g===s.id?e.jsx("span",{children:"Starting…"}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"h-3 w-3","aria-hidden":"true"}),e.jsx("span",{children:"Message"})]})})]})]},s.id)})})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-[12px] text-muted-foreground",children:"Start typing a name or @username to find people. Once the social graph is wired up, you'll be able to follow friends and start conversations from here."}),e.jsxs("div",{className:"flex items-center gap-2 rounded-2xl border border-dashed border-border bg-card/60 px-3 py-2 text-xs text-muted-foreground",children:[e.jsx(ie,{className:"h-4 w-4","aria-hidden":"true"}),e.jsx("span",{children:"Search for people you know, then follow or message them."})]})]})},Ie=()=>{const[a,n]=K(),x=k.useMemo(()=>q(a),[a]),d=a.get("q")??"",[b,m]=k.useState(d),N=ae(b,300),l=k.useMemo(()=>he(a),[a]),[p,w]=k.useState(!1),f=k.useCallback(t=>{const u=new URLSearchParams(a);t(u),n(u,{replace:!0})},[a,n]),g=k.useCallback(t=>{t.delete("type"),t.delete("minYear"),t.delete("maxYear"),t.delete("lang")},[]),C=k.useCallback(t=>{const u=t;f(j=>{j.set("tab",u),j.get("q")||g(j)}),u!=="titles"&&w(!1)},[g,f]),h=()=>{m(""),f(t=>{t.delete("q"),g(t)}),w(!1)},F=k.useCallback(t=>{const u=t.trim();f(j=>{const R=q(j);u?(j.set("q",u),j.set("tab",R)):(j.delete("q"),g(j))}),u||w(!1)},[g,f]);k.useEffect(()=>{F(N)},[N,F]),k.useEffect(()=>{d!==b&&m(d)},[d]);const s=k.useCallback(t=>{f(u=>{const j={...l,...t},R=L(j.minYear),O=L(j.maxYear),v={...j,minYear:R??void 0,maxYear:O??void 0};v.minYear&&v.maxYear&&v.minYear>v.maxYear&&([v.minYear,v.maxYear]=[v.maxYear,v.minYear]),u.set("tab","titles"),u.set("type",v.type??"all"),v.minYear?u.set("minYear",String(v.minYear)):u.delete("minYear"),v.maxYear?u.set("maxYear",String(v.maxYear)):u.delete("maxYear"),v.originalLanguage?u.set("lang",v.originalLanguage):u.delete("lang")})},[l,f]),r=()=>{f(t=>{t.set("tab","titles"),t.set("type","all"),t.delete("minYear"),t.delete("maxYear"),t.delete("lang")}),w(!1)},o=k.useMemo(()=>{const t=[];if(l.type&&l.type!=="all"&&t.push({label:`Type: ${l.type.charAt(0).toUpperCase()}${l.type.slice(1)}`,onRemove:()=>s({type:"all"})}),l.minYear||l.maxYear){const u=l.minYear??"Any",j=l.maxYear??"Now";t.push({label:`Year: ${u} – ${j}`,onRemove:()=>s({minYear:void 0,maxYear:void 0})})}return l.originalLanguage&&t.push({label:`Language: ${l.originalLanguage.toUpperCase()}`,onRemove:()=>s({originalLanguage:void 0})}),t},[l,s]),c=o.length,i=c>0?`Filters (${c} active)`:"Filters (none applied)",y=x==="titles"&&(!!d.trim()||c>0),T=y?i:"Filters are locked until you start typing a title",Y=t=>{t.preventDefault()};return e.jsxs("div",{className:"flex flex-1 flex-col gap-4 pb-4",children:[e.jsx(te,{title:"Search",below:e.jsx(Z,{value:x,onValueChange:C,children:e.jsxs(J,{className:"w-full",children:[e.jsx(A,{value:"titles",children:"Titles"}),e.jsx(A,{value:"people",children:"People"})]})})}),e.jsxs(re,{tone:"default",padded:!0,children:[e.jsxs("form",{onSubmit:Y,className:"flex flex-col gap-2 sm:flex-row sm:items-center",children:[e.jsxs("div",{className:"flex flex-1 items-center gap-2",children:[e.jsx(ee,{placeholder:"Search for movies, shows, or people...",value:b,onChange:t=>m(t.target.value),autoCorrect:"off",autoCapitalize:"none",className:"flex-1"}),b?e.jsx(S,{type:"button",onClick:h,variant:"ghost",size:"icon",className:"h-7 w-7 rounded-full text-xs text-muted-foreground hover:bg-border/60 hover:text-foreground","aria-label":"Clear search",children:e.jsx(E,{className:"h-3 w-3","aria-hidden":"true"})}):null]}),e.jsxs(S,{type:"button",onClick:()=>{y&&w(t=>!t)},variant:"outline",size:"sm",className:`inline-flex items-center justify-center gap-1 rounded-full px-3 py-2 text-xs font-medium shadow-md ${y?"border-border bg-background text-muted-foreground hover:border-primary/70 hover:text-foreground":"cursor-not-allowed border-border bg-background/70 text-muted-foreground"} ${p?"border-primary/70 text-foreground":""}`,disabled:!y,"aria-pressed":y&&p,"aria-expanded":y&&p,"aria-controls":"search-title-filters","aria-label":T,title:T,children:[e.jsx($,{className:"h-3.5 w-3.5","aria-hidden":"true"}),e.jsx("span",{children:p?"Hide filters":"Filters"}),c>0?e.jsx("span",{className:"inline-flex h-5 min-w-[20px] items-center justify-center rounded-full bg-primary/15 px-1 text-xs font-semibold text-primary",children:c}):null]})]}),x==="titles"&&e.jsx("div",{className:"mt-2 flex flex-wrap items-center gap-2 text-xs text-muted-foreground",children:o.length?e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"gap-1 px-2 py-0.5 text-[11px] font-semibold uppercase tracking-wide text-muted-foreground",children:"Active filters"}),o.map(t=>e.jsxs(S,{type:"button",onClick:t.onRemove,variant:"outline",size:"sm",className:"h-auto rounded-full border-border bg-background px-2 py-1 text-xs text-foreground shadow-sm hover:border-primary/70 hover:text-foreground",children:[e.jsx("span",{children:t.label}),e.jsx(E,{className:"h-3 w-3 text-muted-foreground","aria-hidden":!0})]},t.label)),e.jsx(S,{type:"button",onClick:r,variant:"ghost",size:"sm",className:"h-auto rounded-full bg-primary/10 px-3 py-1 text-xs font-semibold uppercase tracking-wide text-primary hover:bg-primary/15",children:"Reset all"})]}):e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-card/50 px-2.5 py-1 text-xs font-medium text-muted-foreground",children:[e.jsx(I,{className:"h-3 w-3","aria-hidden":!0}),"No filters applied"]})}),x==="titles"&&p&&e.jsxs("div",{id:"search-title-filters",className:"mt-3 space-y-3 rounded-xl border border-dashed border-border bg-background/70 p-3 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-foreground",children:[e.jsx(I,{className:"h-3.5 w-3.5","aria-hidden":"true"}),e.jsx("span",{children:"Filter titles"})]}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-[1.4fr_1fr_1fr]",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.16em] text-muted-foreground",children:"Type"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:[{key:"all",label:"All"},{key:"movie",label:"Movies"},{key:"series",label:"Series"},{key:"anime",label:"Anime"}].map(t=>{const u=l.type===t.key;return e.jsx(S,{type:"button",variant:u?"default":"outline",size:"sm",className:`h-auto rounded-full px-2.5 py-1 text-xs font-medium ${u?"bg-primary text-primary-foreground shadow-md":"border-border bg-background/80 text-muted-foreground hover:border-primary/60 hover:text-foreground"}`,onClick:()=>s({type:t.key}),"aria-pressed":u,children:t.label},t.key)})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.16em] text-muted-foreground",children:"Years"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1.5",children:[e.jsx(U,{type:"number",min:1900,max:new Date().getFullYear(),value:l.minYear??"",onChange:t=>s({minYear:t.target.value?Number(t.target.value):void 0}),placeholder:"Min",className:"h-9 w-full border-border bg-background px-2 py-1.5 text-xs text-foreground shadow-sm","aria-label":"Minimum year"}),e.jsx(U,{type:"number",min:1900,max:new Date().getFullYear(),value:l.maxYear??"",onChange:t=>s({maxYear:t.target.value?Number(t.target.value):void 0}),placeholder:"Max",className:"h-9 w-full border-border bg-background px-2 py-1.5 text-xs text-foreground shadow-sm","aria-label":"Maximum year"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Use a minimum, maximum, or both."})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.16em] text-muted-foreground",children:"Original language"}),e.jsxs("div",{className:"flex items-center gap-1.5 rounded-md border border-border bg-background px-2 py-1.5 shadow-sm",children:[e.jsx(fe,{className:"h-3.5 w-3.5 text-muted-foreground","aria-hidden":"true"}),e.jsx(U,{type:"text",value:l.originalLanguage??"",onChange:t=>s({originalLanguage:t.target.value||void 0}),placeholder:"e.g. en, ja",className:"h-8 w-full border-none bg-transparent p-0 text-xs text-foreground shadow-none placeholder:text-muted-foreground focus-visible:ring-0"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Two-letter codes keep things simple."})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("p",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx("span",{className:"inline-flex h-1.5 w-1.5 rounded-full bg-primary/80"}),"Filters shape the recommendations shown below."]}),e.jsx(S,{type:"button",variant:"link",size:"sm",className:"h-auto p-0 text-xs font-semibold text-foreground hover:text-primary",onClick:r,children:"Reset filters"})]})]})]}),e.jsx("section",{className:"flex flex-1 flex-col gap-3",children:e.jsx("div",{"aria-live":"polite",className:"flex-1 rounded-2xl border border-dashed border-border bg-card/60 px-3 py-3 text-[12px] text-muted-foreground",children:x==="titles"?e.jsx(ye,{query:N,filters:l,onResetFilters:r}):e.jsx(ve,{query:N})})})]})};export{Ie as default};
