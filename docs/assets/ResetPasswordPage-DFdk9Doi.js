import{r as a,u as j,j as e,B as v,L as S,s as x}from"./index-n01z0Q-I.js";import{u as L}from"./useDocumentTitle-DUCKsSGw.js";import{A as C}from"./AuthLayout-Z3ZDimkM.js";import{M as n}from"./material-icon-ik9c9RPC.js";import"./brand-BkRQ_qNJ.js";import"./sparkles-DuMEjElL.js";import"./film-C7XtA2vE.js";const r=8,T=()=>{L("Reset password");const[o,h]=a.useState(""),[c,w]=a.useState(""),[d,u]=a.useState(!1),[f,g]=a.useState(!0),[m,s]=a.useState(null),[i,p]=a.useState(null),b=j();a.useEffect(()=>{let t=!1;return(async()=>{try{const{data:y,error:N}=await x.auth.getUser();if(t)return;(N||!y.user)&&s("This password reset link is invalid or has expired. Please request a new one.")}catch{t||s("We couldn&apos;t verify your reset link. Please request a new one.")}finally{t||g(!1)}})(),()=>{t=!0}},[]);const k=async t=>{if(t.preventDefault(),s(null),p(null),!o||o.length<r){s(`Password must be at least ${r} characters long.`);return}if(o!==c){s("Passwords do not match.");return}u(!0);try{const{error:l}=await x.auth.updateUser({password:o});if(l){s(l.message||"We couldn&apos;t update your password. Please try again.");return}p("Your password has been updated. Redirecting to sign in…"),setTimeout(()=>{b("/auth/signin")},2500)}catch(l){console.error(l),s("Something went wrong while updating your password.")}finally{u(!1)}};return e.jsx(C,{kicker:"Reset password",title:"Set a new password",description:"Choose a strong password to protect your MoviNesta account.",footer:e.jsx(S,{to:"/auth/signin",className:"font-medium text-primary hover:underline",children:"Back to sign in"}),children:f?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500 dark:text-slate-400",children:[e.jsx(n,{name:"autorenew",className:"text-[18px] animate-spin",ariaLabel:"Loading"}),"Checking your reset link…"]}):e.jsxs(e.Fragment,{children:[m&&e.jsx("div",{role:"alert",className:"rounded-2xl border border-red-200/70 bg-red-50 px-4 py-3 text-sm text-red-600 dark:border-red-500/30 dark:bg-red-500/10 dark:text-red-200",children:m}),i&&e.jsx("div",{role:"status",className:"rounded-2xl border border-emerald-200/70 bg-emerald-50 px-4 py-3 text-sm text-emerald-700 dark:border-emerald-400/40 dark:bg-emerald-400/10 dark:text-emerald-100",children:i}),!i&&e.jsxs("form",{onSubmit:k,className:"space-y-4",noValidate:!0,children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"reset-password",className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:"New password"}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx(n,{name:"lock",className:"absolute left-4 text-[18px] text-slate-400 dark:text-slate-500",ariaLabel:"Password"}),e.jsx("input",{id:"reset-password",type:"password",autoComplete:"new-password",required:!0,minLength:r,value:o,onChange:t=>h(t.target.value),disabled:d,placeholder:`At least ${r} characters`,className:"w-full rounded-2xl border border-slate-200 bg-white px-4 py-3 pl-11 text-sm text-slate-900 placeholder:text-slate-400 shadow-sm transition-all focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30 dark:border-white/10 dark:bg-slate-900 dark:text-white dark:placeholder:text-slate-500"})]}),e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:["At least ",r," characters."]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"reset-confirm",className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:"Confirm new password"}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx(n,{name:"lock_reset",className:"absolute left-4 text-[18px] text-slate-400 dark:text-slate-500",ariaLabel:"Confirm password"}),e.jsx("input",{id:"reset-confirm",type:"password",autoComplete:"new-password",required:!0,minLength:r,value:c,onChange:t=>w(t.target.value),disabled:d,placeholder:"Re-enter your password",className:"w-full rounded-2xl border border-slate-200 bg-white px-4 py-3 pl-11 text-sm text-slate-900 placeholder:text-slate-400 shadow-sm transition-all focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30 dark:border-white/10 dark:bg-slate-900 dark:text-white dark:placeholder:text-slate-500"})]})]}),e.jsxs(v,{type:"submit",className:"w-full rounded-2xl text-sm font-semibold shadow-lg shadow-primary/30",disabled:d,children:[d?"Updating password…":"Update password",e.jsx(n,{name:"arrow_forward",className:"text-[18px]",ariaLabel:"Submit"})]})]})]})})};export{T as default};
