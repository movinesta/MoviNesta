import{r as d,u as P,a as k,j as s,B as L,L as A,s as B}from"./index-fug2llhW.js";import{u as q}from"./useDocumentTitle-C9CzS5g0.js";import{T,P as y}from"./PasswordField-BQLOcHCY.js";import{A as F}from"./AuthLayout-wgmA5CPz.js";import"./brand-QLu8PXAi.js";import"./sparkles-Bpg1Ayxy.js";import"./film-U7k7qJw1.js";const D=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,p=8;function m(t,c,i){const o={};return t?D.test(t)||(o.email="Please enter a valid email address."):o.email="Email is required.",c?c.length<p&&(o.password=`Password must be at least ${p} characters.`):o.password="Password is required.",i?c!==i&&(o.confirm="Passwords do not match."):o.confirm="Please confirm your password.",o}const $=()=>{q("Create account");const[t,c]=d.useState(""),[i,o]=d.useState(""),[l,j]=d.useState(""),[u,h]=d.useState(!1),[a,n]=d.useState({}),[w,f]=d.useState(null),[v,x]=d.useState(null),S=P(),N=k().state?.from?.pathname??"/",C=!!t&&!!i&&!!l&&Object.keys(m(t,i,l)).length===0,E=async e=>{e.preventDefault();const r=m(t,i,l);if(Object.keys(r).length>0){n(r),f(null),x(null);return}try{h(!0),f(null),x(null),n({});const{data:g,error:b}=await B.auth.signUp({email:t,password:i});if(b){f(b.message||"Sign-up failed. Please check your details and try again.");return}if(!g.session){x("Almost there! Check your email inbox for a confirmation link to activate your account.");return}S(N,{replace:!0})}catch(g){console.error(g),f("Something went wrong while creating your account.")}finally{h(!1)}};return s.jsxs(F,{kicker:"Join MoviNesta",title:"Create your account",description:"Track what you watch, swap recommendations, and keep a cozy cinematic diary.",footer:s.jsxs("span",{children:["Already have an account?"," ",s.jsx(A,{to:"/auth/signin",className:"font-medium text-primary hover:underline",children:"Sign in instead"})]}),children:[w&&s.jsx("div",{role:"alert",className:"rounded-xl border border-destructive/40 bg-destructive/10 px-3 py-2 text-xs text-destructive",children:w}),v&&s.jsx("div",{role:"status",className:"rounded-xl border border-emerald-400/40 bg-emerald-400/10 px-3 py-2 text-xs text-emerald-800",children:v}),s.jsxs("form",{onSubmit:E,className:"space-y-4",noValidate:!0,children:[s.jsx(T,{id:"signup-email",label:"Email address",type:"email",autoComplete:"email",required:!0,value:t,onChange:e=>{c(e.target.value),a.email&&n(r=>({...r,email:void 0}))},onBlur:()=>{const e=m(t,i,l);e.email&&n(r=>({...r,email:e.email}))},disabled:u,error:a.email}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsx(y,{id:"signup-password",label:"Password",ariaLabelBase:"password",autoComplete:"new-password",required:!0,minLength:p,value:i,onChange:e=>{o(e.target.value),a.password&&n(r=>({...r,password:void 0}))},onBlur:()=>{const e=m(t,i,l);e.password&&n(r=>({...r,password:e.password}))},disabled:u,"aria-invalid":!!a.password,"aria-describedby":a.password?"signup-password-error":"signup-password-hint"}),!a.password&&s.jsxs("p",{id:"signup-password-hint",className:"text-xs text-muted-foreground",children:["At least ",p," characters."]}),a.password&&s.jsx("p",{id:"signup-password-error",className:"text-xs text-destructive",children:a.password})]}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsx(y,{id:"signup-confirm",label:"Confirm password",ariaLabelBase:"password confirmation",autoComplete:"new-password",required:!0,minLength:p,value:l,onChange:e=>{j(e.target.value),a.confirm&&n(r=>({...r,confirm:void 0}))},onBlur:()=>{const e=m(t,i,l);e.confirm&&n(r=>({...r,confirm:e.confirm}))},disabled:u,"aria-invalid":!!a.confirm,"aria-describedby":a.confirm?"signup-confirm-error":void 0}),a.confirm&&s.jsx("p",{id:"signup-confirm-error",className:"text-xs text-destructive",children:a.confirm})]}),s.jsx(L,{type:"submit",className:"w-full",disabled:u||!C,children:u?"Creating your accountâ€¦":"Create account"})]})]})};export{$ as default};
