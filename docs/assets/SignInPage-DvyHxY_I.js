import{r as d,u as E,a as P,j as e,L as w,s as N}from"./index-D8UbFo8l.js";import{u as k}from"./useDocumentTitle-DE2z2dc5.js";import{T as F,P as L}from"./PasswordField-B1_Zl6ez.js";import{A as I}from"./AuthLayout-D7SOiETi.js";import"./brand-DTIDtbc4.js";import"./film-E5LDX5VI.js";import"./heart-handshake-BSWC6PUm.js";const C=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;function c(a,u){const s={};return a?C.test(a)||(s.email="Please enter a valid email address."):s.email="Email is required.",u||(s.password="Password is required."),s}const V=()=>{var g,x;k("Sign in");const[a,u]=d.useState(""),[s,h]=d.useState(""),[n,p]=d.useState(!1),[i,o]=d.useState({}),[f,m]=d.useState(null),y=E(),b=((x=(g=P().state)==null?void 0:g.from)==null?void 0:x.pathname)??"/",v=!!a&&!!s&&Object.keys(c(a,s)).length===0,j=async r=>{r.preventDefault();const t=c(a,s);if(Object.keys(t).length>0){o(t),m(null);return}try{p(!0),m(null),o({});const{error:l}=await N.auth.signInWithPassword({email:a,password:s});if(l){const S=l.message==="Invalid login credentials"?"Incorrect email or password. Please try again.":l.message||"Sign-in failed. Please try again.";m(S);return}y(b,{replace:!0})}catch(l){console.error(l),m("Something went wrong while signing you in. Please try again.")}finally{p(!1)}};return e.jsxs(I,{kicker:"Welcome back",title:"Sign in to MoviNesta",description:"Pick up where you left off with your diary, recommendations, and watch crew.",footer:e.jsxs("span",{children:["Don't have an account?"," ",e.jsx(w,{to:"/auth/signup",className:"font-medium text-mn-primary hover:underline",children:"Create one"})]}),children:[f&&e.jsx("div",{role:"alert",className:"rounded-xl border border-mn-error/40 bg-mn-error/10 px-3 py-2 text-xs text-mn-error",children:f}),e.jsxs("form",{onSubmit:j,className:"space-y-4",noValidate:!0,children:[e.jsx(F,{id:"email",label:"Email address",type:"email",autoComplete:"email",required:!0,value:a,onChange:r=>{u(r.target.value),i.email&&o(t=>({...t,email:void 0}))},onBlur:()=>{const r=c(a,s);r.email&&o(t=>({...t,email:r.email}))},disabled:n,error:i.email}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{htmlFor:"password",className:"text-xs font-medium text-mn-text-secondary",children:"Password"}),e.jsx(w,{to:"/auth/forgot-password",className:"text-xs font-medium text-mn-primary hover:underline",children:"Forgot password?"})]}),e.jsx(L,{id:"password",label:"",ariaLabelBase:"password",autoComplete:"current-password",required:!0,minLength:6,value:s,onChange:r=>{h(r.target.value),i.password&&o(t=>({...t,password:void 0}))},onBlur:()=>{const r=c(a,s);r.password&&o(t=>({...t,password:r.password}))},disabled:n,"aria-invalid":!!i.password,"aria-describedby":i.password?"signin-password-error":void 0}),i.password&&e.jsx("p",{id:"signin-password-error",className:"text-xs text-mn-error",children:i.password})]}),e.jsx("button",{type:"submit",disabled:n||!v,"aria-busy":n,className:"inline-flex w-full items-center justify-center rounded-lg bg-mn-primary px-4 py-2 text-sm font-medium text-white shadow-mn-soft hover:bg-mn-primary-soft disabled:cursor-not-allowed disabled:opacity-60",children:n?"Signing you inâ€¦":"Sign in"})]})]})};export{V as default};
