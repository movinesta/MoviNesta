import{r as l,u as j,a as S,j as e,L as f,B as E,s as P}from"./index-DlWPTL3h.js";import{u as N}from"./useDocumentTitle-BJSCRSPC.js";import{T as k,P as F}from"./PasswordField-CO36AMT_.js";import{A as L}from"./AuthLayout-DabhXwTz.js";import"./brand-CkjIdo0x.js";import"./sparkles-DPhqB8vR.js";import"./film-CIWe68xj.js";const I=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;function u(a,m){const s={};return a?I.test(a)||(s.email="Please enter a valid email address."):s.email="Email is required.",m||(s.password="Password is required."),s}const R=()=>{N("Sign in");const[a,m]=l.useState(""),[s,w]=l.useState(""),[d,p]=l.useState(!1),[i,o]=l.useState({}),[g,c]=l.useState(null),x=j(),h=S().state?.from?.pathname??"/",v=!!a&&!!s&&Object.keys(u(a,s)).length===0,y=async r=>{r.preventDefault();const t=u(a,s);if(Object.keys(t).length>0){o(t),c(null);return}try{p(!0),c(null),o({});const{error:n}=await P.auth.signInWithPassword({email:a,password:s});if(n){const b=n.message==="Invalid login credentials"?"Incorrect email or password. Please try again.":n.message||"Sign-in failed. Please try again.";c(b);return}x(h,{replace:!0})}catch(n){console.error(n),c("Something went wrong while signing you in. Please try again.")}finally{p(!1)}};return e.jsxs(L,{kicker:"Welcome back",title:"Sign in to MoviNesta",description:"Pick up where you left off with your diary, recommendations, and watch crew.",footer:e.jsxs("span",{children:["Don't have an account?"," ",e.jsx(f,{to:"/auth/signup",className:"font-medium text-primary hover:underline",children:"Create one"})]}),children:[g&&e.jsx("div",{role:"alert",className:"rounded-xl border border-destructive/40 bg-destructive/10 px-3 py-2 text-xs text-destructive",children:g}),e.jsxs("form",{onSubmit:y,className:"space-y-4",noValidate:!0,children:[e.jsx(k,{id:"email",label:"Email address",type:"email",autoComplete:"email",required:!0,value:a,onChange:r=>{m(r.target.value),i.email&&o(t=>({...t,email:void 0}))},onBlur:()=>{const r=u(a,s);r.email&&o(t=>({...t,email:r.email}))},disabled:d,error:i.email}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{htmlFor:"password",className:"text-xs font-medium text-muted-foreground",children:"Password"}),e.jsx(f,{to:"/auth/forgot-password",className:"text-xs font-medium text-primary hover:underline",children:"Forgot password?"})]}),e.jsx(F,{id:"password",label:"",ariaLabelBase:"password",autoComplete:"current-password",required:!0,minLength:6,value:s,onChange:r=>{w(r.target.value),i.password&&o(t=>({...t,password:void 0}))},onBlur:()=>{const r=u(a,s);r.password&&o(t=>({...t,password:r.password}))},disabled:d,"aria-invalid":!!i.password,"aria-describedby":i.password?"signin-password-error":void 0}),i.password&&e.jsx("p",{id:"signin-password-error",className:"text-xs text-destructive",children:i.password})]}),e.jsx(E,{type:"submit",className:"w-full",disabled:d||!v,children:d?"Signing you inâ€¦":"Sign in"})]})]})};export{R as default};
