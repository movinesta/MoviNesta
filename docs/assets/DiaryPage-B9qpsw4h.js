import{D as _,r as f,j as e,b as q,c as Y,s as A,m as z,E as I,R as P,L as w,M as V,J as G}from"./index-BhYCkKJ1.js";import{T as K}from"./TopBar-Bg4ZNmLN.js";import{Y as Q}from"./index-CU6THGDM.js";import{f as J,a as X}from"./format-BXv9LLlt.js";import{F as v}from"./film-DzeGNKC8.js";import{S as R}from"./sparkles-DiUSdMk5.js";import{U as H}from"./users-BOZAcCjM.js";import{B as Z,S as U}from"./star-BI9e52uT.js";import{a as O,u as ee}from"./useDiaryLibrary-DjiZyGrD.js";import{C as te}from"./clock-D5sp4i7x.js";import"./arrow-left-BlxqK35Q.js";const se=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],W=_("chart-column",se);const re=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],ae=_("chart-pie",re);const ne=[["path",{d:"M13 5h8",key:"a7qcls"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 19h8",key:"c3s6r1"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}]],le=_("list-checks",ne);const ie=[["path",{d:"M2 5h20",key:"1fs1ex"}],["path",{d:"M6 12h12",key:"8npq4p"}],["path",{d:"M9 19h6",key:"456am0"}]],L=_("list-filter",ie),E=f.createContext(null),de=({value:t,defaultValue:l,onValueChange:a,className:n="",children:c})=>{const[x,u]=f.useState(l??""),d=f.useId(),s=t??x,m=r=>{t===void 0&&u(r),a?.(r)};return e.jsx(E.Provider,{value:{value:s,setValue:m,idBase:d},children:e.jsx("div",{className:n,children:c})})};function oe(){const t=f.useContext(E);if(!t)throw new Error("Tabs.* components must be used within <Tabs>");return t}const ce=({className:t="",children:l})=>{const a="flex w-full max-w-full justify-center gap-1.5 overflow-x-auto rounded-lg bg-white/80 p-1.5 text-xs text-slate-600 ring-1 ring-slate-200/80 "+t;return e.jsx("div",{role:"tablist",className:a,children:l})},me=({value:t,icon:l,className:a="",children:n,...c})=>{const{value:x,setValue:u,idBase:d}=oe(),s=x===t,m=`${d}-tab-${t}`,o=["inline-flex flex-1 items-center justify-center gap-1.5 whitespace-nowrap rounded-md px-3 py-1.5 text-xs font-medium ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 transition-all",s?"bg-white text-slate-900 shadow-sm":"text-slate-600 hover:bg-white/70",a].filter(Boolean).join(" ");return e.jsxs("button",{type:"button",role:"tab","aria-selected":s,"aria-controls":`${d}-tabpanel-${t}`,id:m,className:o,onClick:()=>u(t),...c,children:[l&&e.jsx("span",{className:"inline-flex h-3.5 w-3.5",children:l}),e.jsx("span",{children:n})]})},xe=t=>{switch(t){case"rating_created":return"rating";case"review_created":return"review";case"watchlist_added":return"watchlist";case"follow_created":return"follow";default:return"other"}},ue=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,D=t=>typeof t=="string"&&ue.test(t),h=t=>typeof t=="string"?t:void 0,$=t=>typeof t=="number"&&Number.isFinite(t)?t:void 0,he=(t,l)=>{if(!l||typeof l!="object")return null;const a=l;switch(t){case"rating_created":{const n=$(a.rating);return n===void 0?null:{event_type:t,rating:n,headline:h(a.headline),emoji:h(a.emoji)}}case"review_created":return{event_type:t,rating:$(a.rating),review_snippet:h(a.review_snippet),headline:h(a.headline),emoji:h(a.emoji)};case"watchlist_added":case"watchlist_removed":return{event_type:t,extra:h(a.extra)};case"follow_created":return{event_type:t,extra:h(a.extra)};case"comment_created":case"reply_created":return{event_type:t,extra:h(a.extra)};case"list_created":case"list_item_added":return{event_type:t,extra:h(a.extra)};case"message_sent":return{event_type:t,extra:h(a.extra)};default:return null}},pe=t=>{const{user:l}=q(),a=t??l?.id??null,n=Y({queryKey:["diary","timeline",a],enabled:!!a,queryFn:async()=>{if(!a)return[];const{data:c,error:x}=await A.from("activity_events").select("id, created_at, event_type, title_id, media_item_id, payload").eq("user_id",a).order("created_at",{ascending:!1}).limit(100);if(x)throw new Error(x.message);if(!c?.length)return[];const u=Array.from(new Set(c.map(s=>s.media_item_id??(D(s.title_id)?s.title_id:null)).filter(s=>!!s)));let d=new Map;if(u.length){const{data:s,error:m}=await A.from("media_items").select(`id,
             kind,
             tmdb_title,
             tmdb_name,
             tmdb_original_title,
             tmdb_original_name,
             tmdb_release_date,
             tmdb_first_air_date,
             tmdb_poster_path,
             tmdb_backdrop_path,
             tmdb_original_language,
             omdb_title,
             omdb_year,
             omdb_language,
             omdb_imdb_id,
             omdb_imdb_rating,
             omdb_rating_rotten_tomatoes,
             omdb_poster,
             omdb_rated,
             tmdb_id`).in("id",u);!m&&s?d=new Map(s.map(r=>[r.id,z(r)])):m&&console.warn("[useDiaryTimeline] Failed to load titles",m.message)}return c.map(s=>{const m=s.media_item_id??(D(s.title_id)?s.title_id:null),r=m?d.get(m)??null:null,p=xe(s.event_type),o=he(s.event_type,s.payload);return{id:s.id,createdAt:s.created_at,kind:p,titleId:m??null,title:r?.title??null,year:r?.year??null,posterUrl:r?.posterUrl??r?.backdropUrl??null,rating:o?.event_type==="rating_created"?I(o.rating):o?.event_type==="review_created"?I(o.rating??null):null,reviewSnippet:o?.event_type==="review_created"?o.review_snippet??null:null,headline:o?.event_type==="rating_created"||o?.event_type==="review_created"?o.headline??null:null,extra:o?.extra??null,emoji:o?.event_type==="rating_created"||o?.event_type==="review_created"?o.emoji??null:null}})}});return{items:n.data??[],isLoading:n.isLoading,isError:n.isError,error:n.error instanceof Error?n.error.message:null}},ge=t=>{switch(t.kind){case"rating":return t.rating!=null?`Rated ${t.rating.toFixed(1)}★`:"Rated";case"review":return"Wrote a review";case"watchlist":return"Updated watchlist";case"follow":return"Followed someone";default:return"Activity"}},fe=t=>{switch(t){case"rating":return U;case"review":return V;case"watchlist":return Z;case"follow":return H;default:return R}},be=({userId:t,isOwnProfile:l=!1,displayName:a,username:n})=>{const{items:c,isLoading:x,isError:u,error:d}=pe(t),s=a||(n?`@${n}`:"this user");return x?e.jsx("div",{className:"page-pad pb-[var(--page-pad-y)]",children:e.jsx("div",{className:"space-y-2",children:Array.from({length:4}).map((m,r)=>e.jsxs("div",{className:"soft-row-card flex gap-3 row-pad animate-pulse",children:[e.jsx("div",{className:"h-12 w-8 rounded bg-background/60"}),e.jsxs("div",{className:"flex flex-1 flex-col gap-2",children:[e.jsx("div",{className:"h-3 w-1/3 rounded bg-background/70"}),e.jsx("div",{className:"h-3 w-2/3 rounded bg-background/80"}),e.jsx("div",{className:"h-2.5 w-1/2 rounded bg-background/80"})]})]},r))})}):u?e.jsx("div",{className:"flex min-h-[40vh] items-center justify-center px-4",children:e.jsxs("div",{className:"max-w-sm rounded-2xl border border-destructive/40 bg-destructive/5 p-4 text-center text-xs text-foreground shadow-sm",children:[e.jsxs("p",{className:"font-semibold",children:["Unable to load ",l?"your":"this profile&apos;s"," activity."]}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:d??"Please try again in a moment."})]})}):c.length?e.jsx("div",{className:"page-pad pb-[var(--page-pad-y)]",children:e.jsx(Q,{style:{height:"70vh"},data:c,computeItemKey:(m,r)=>r.id,components:{List:P.forwardRef(function(r,p){return e.jsx("ol",{ref:p,className:"space-y-2",...r})})},itemContent:(m,r)=>{const p=fe(r.kind),o=r.titleId?`/title/${r.titleId}`:null;return e.jsx("li",{className:"pb-1",children:e.jsxs("article",{className:"soft-row-card flex gap-3 row-pad",children:[e.jsx("div",{className:"relative h-16 w-11 overflow-hidden rounded bg-background/70",children:r.posterUrl?e.jsx("img",{src:r.posterUrl,alt:r.title??"",className:"h-full w-full object-cover"}):e.jsxs("div",{className:"flex h-full w-full items-center justify-center text-xs text-muted-foreground",children:[e.jsx(v,{className:"mr-1 h-3.5 w-3.5"}),"No poster"]})}),e.jsxs("div",{className:"flex min-w-0 flex-1 flex-col gap-1.5",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:e.jsxs("span",{className:"flex items-center gap-1 rounded-full bg-primary/10 px-2 py-0.5 text-xs font-medium text-foreground",children:[e.jsx(p,{className:"h-3 w-3","aria-hidden":"true"}),ge(r)]})}),e.jsx("span",{className:"shrink-0 text-xs text-muted-foreground",children:J(r.createdAt)})]}),e.jsx("div",{className:"min-w-0",children:o?e.jsxs(w,{to:o,className:"line-clamp-2 text-sm font-medium text-foreground hover:underline focus-visible:outline-none",children:[r.title??"Untitled",r.year?e.jsxs("span",{className:"ml-1 text-xs text-muted-foreground",children:["(",r.year,")"]}):null]}):e.jsx("p",{className:"line-clamp-2 text-sm font-medium text-foreground",children:r.title??"Activity"})}),r.reviewSnippet&&e.jsxs("p",{className:"line-clamp-2 text-xs text-muted-foreground",children:["“",r.reviewSnippet,"”"]}),r.extra&&e.jsx("p",{className:"text-xs text-muted-foreground",children:r.extra})]})]})},r.id)}})}):e.jsx("div",{className:"flex min-h-[40vh] items-center justify-center px-4",children:e.jsxs("div",{className:"max-w-sm rounded-2xl border border-border bg-card/80 p-5 text-center text-xs text-muted-foreground shadow-sm",children:[e.jsx("div",{className:"mx-auto mb-3 flex h-10 w-10 items-center justify-center rounded-2xl bg-primary/15",children:e.jsx(v,{className:"h-5 w-5 text-primary","aria-hidden":"true"})}),e.jsx("p",{className:"font-heading text-sm font-semibold text-foreground",children:l?"Your diary is waiting":`${s}'s diary is quiet`}),e.jsx("p",{className:"mt-1 text-xs",children:l?"As you rate titles, write reviews, and update your library, they’ll show up here in a cozy, chronological timeline.":"When they rate titles, share reviews, or log films, their updates will collect here for you to browse."})]})})},ye=t=>{switch(t){case"want_to_watch":return"Want to watch";case"watching":return"Watching";case"watched":return"Watched";case"dropped":return"Dropped";default:return"Tap to add status"}},je=t=>{switch(t){case"want_to_watch":return"border-amber-500/40 bg-amber-500/10 text-amber-200";case"watching":return"border-sky-500/40 bg-sky-500/10 text-sky-200";case"watched":return"border-emerald-500/40 bg-emerald-500/10 text-emerald-200";case"dropped":return"border-rose-500/40 bg-rose-500/10 text-rose-200";default:return"border-border bg-background/60 text-muted-foreground"}},ve=[{value:"all",label:"All"},{value:"want_to_watch",label:"Want to Watch"},{value:"watching",label:"Watching"},{value:"watched",label:"Watched"},{value:"dropped",label:"Dropped"}],Ne=[{value:"all",label:"All types"},{value:"movie",label:"Movies"},{value:"series",label:"Series"},{value:"anime",label:"Anime"}],we=({userId:t,isOwnProfile:l=!1,displayName:a,username:n})=>{const[c,x]=f.useState("all"),[u,d]=f.useState("all"),{entries:s,isLoading:m,isError:r,error:p}=O({status:c==="all"?void 0:c,type:u==="all"?void 0:u},t),{updateStatus:o,updateRating:T}=ee(),k=o.isPending||T.isPending,y=l,M=a||(n?`@${n}`:"this user");return m?e.jsxs("div",{className:"px-2 pb-4",children:[e.jsx("div",{className:"mb-3 flex items-center justify-between gap-2 px-1 text-xs text-muted-foreground",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(L,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:l?"Loading your library…":`Loading ${M}’s library…`})]})}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Array.from({length:6}).map((i,j)=>e.jsxs("div",{className:"overflow-hidden rounded-2xl border border-border/60 bg-card/60 shadow-sm",children:[e.jsx("div",{className:"h-40 w-full bg-background/70"}),e.jsxs("div",{className:"space-y-1.5 p-2.5",children:[e.jsx("div",{className:"h-3 w-3/4 rounded bg-background/70"}),e.jsx("div",{className:"h-2.5 w-1/2 rounded bg-background/80"}),e.jsx("div",{className:"h-2.5 w-2/3 rounded bg-background/80"})]})]},j))})]}):r?e.jsx("div",{className:"flex min-h-[40vh] items-center justify-center px-4",children:e.jsxs("div",{className:"max-w-sm rounded-2xl border border-destructive/40 bg-destructive/5 p-4 text-center text-xs text-foreground shadow-sm",children:[e.jsxs("p",{className:"font-semibold",children:["Unable to load ",l?"your":"their"," library."]}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:p??"Please try again in a moment."})]})}):s.length?e.jsxs("div",{className:"px-2 pb-4",children:[e.jsxs("div",{className:"mb-3 flex flex-wrap items-center justify-between gap-2 px-1 text-xs",children:[e.jsx("div",{className:"flex flex-wrap gap-1",children:ve.map(i=>{const j=c===i.value;return e.jsx("button",{type:"button",onClick:()=>x(i.value),className:`rounded-full border px-2.5 py-1 text-xs transition ${j?"border-primary/60 bg-primary text-foreground shadow-sm":"border-border bg-card/80 text-muted-foreground hover:border-border hover:text-foreground"}`,children:i.label},i.value)})}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(L,{className:"h-3.5 w-3.5 text-muted-foreground","aria-hidden":"true"}),e.jsxs("label",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx("span",{children:"Type"}),e.jsx("select",{value:u,onChange:i=>d(i.target.value),className:"rounded-full border border-border bg-card/80 px-2 py-1 text-xs text-foreground",children:Ne.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:s.length===0?e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center py-12 text-center text-sm text-muted-foreground",children:[e.jsx("p",{className:"font-medium text-foreground",children:l?"Your diary is empty":"No diary entries yet"}),e.jsx("p",{className:"mt-1 max-w-xs text-xs text-muted-foreground",children:l?"Start by searching for a movie or show and adding it to your diary.":"When they start logging what they watch, it will show up here."}),l&&e.jsx(w,{to:"/search",className:"mt-4 inline-flex items-center rounded-full bg-primary px-4 py-1.5 text-xs font-medium text-primary-foreground shadow-sm hover:bg-primary/90",children:"Search titles"})]}):s.map(i=>{const j=()=>{if(!y)return;const g=["want_to_watch","watching","watched","dropped"],b=g.indexOf(i.status),N=g[(b+1)%g.length];o.mutate({titleId:i.titleId,status:N,type:i.type})},B=g=>{if(!y)return;const b=i.rating===g?null:g;T.mutate({titleId:i.titleId,rating:b,type:i.type})},C=`/title/${i.titleId}`;return e.jsxs("article",{className:"group flex flex-col overflow-hidden rounded-2xl border border-border/60 bg-card/60 shadow-sm",children:[e.jsx(w,{to:C,className:"relative block",children:e.jsx("div",{className:"aspect-[2/3] w-full overflow-hidden bg-background/80",children:i.posterUrl?e.jsx("img",{src:i.posterUrl,alt:i.title,className:"h-full w-full object-cover transition-transform duration-200 group-hover:scale-[1.03]"}):e.jsxs("div",{className:"flex h-full w-full items-center justify-center text-xs text-muted-foreground",children:[e.jsx(v,{className:"mr-1 h-4 w-4"}),"No poster"]})})}),e.jsxs("div",{className:"flex flex-1 flex-col gap-1.5 p-2.5",children:[e.jsxs("div",{className:"min-h-[2.4rem]",children:[e.jsx(w,{to:C,className:"line-clamp-2 text-sm font-medium text-foreground hover:underline",children:i.title}),i.year&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["(",i.year,")"]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-1",children:[e.jsx("button",{type:"button",onClick:j,disabled:k||!y,className:`rounded-full border px-2 py-0.5 text-[9px] font-medium transition ${je(i.status??null)} ${k?"opacity-70":y?"hover:border-primary/70 hover:bg-primary":"opacity-80"}`,children:ye(i.status??null)}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"flex items-center gap-0.5",children:Array.from({length:5}).map((g,b)=>{const N=b+1,F=(i.rating??0)>=N;return e.jsx("button",{type:"button",className:"p-0.5",disabled:k||!y,onClick:()=>B(N),children:e.jsx(U,{className:`h-3.5 w-3.5 ${F?"fill-yellow-400 text-yellow-300":"text-muted-foreground"}`})},b)})}),e.jsx("span",{className:"text-xs text-muted-foreground",children:i.rating!=null?`${i.rating}/5`:"No rating"})]})]})]})]},i.id)})})]}):e.jsx("div",{className:"flex min-h-[40vh] items-center justify-center px-4",children:e.jsxs("div",{className:"max-w-sm rounded-2xl border border-border/60 bg-card/60 p-5 text-center text-xs text-muted-foreground shadow-sm",children:[e.jsx("div",{className:"mx-auto mb-3 flex h-10 w-10 items-center justify-center rounded-2xl bg-primary/15",children:e.jsx(v,{className:"h-5 w-5 text-primary","aria-hidden":"true"})}),e.jsx("p",{className:"font-heading text-sm font-semibold text-foreground",children:l?"Your library is empty":`${M}'s library is empty`}),e.jsx("p",{className:"mt-1 text-xs",children:l?"As you add titles to your Watchlist and mark them as watched, this tab will turn into a sortable diary of everything you’ve seen.":"When they add titles to their Watchlist or mark them watched, you’ll be able to browse their picks here."})]})})},_e=t=>{const[l,a]=t.split("-"),n=Number(l),c=Number(a);if(!n||!c)return t;const x=new Date(n,c-1,1);return X(x,{month:"short",year:"numeric"})},ke=()=>{const{stats:t,isLoading:l,isError:a,error:n}=G();if(l)return e.jsx("div",{className:"px-2 pb-4",children:e.jsx("div",{className:"space-y-3",children:Array.from({length:3}).map((d,s)=>e.jsxs("div",{className:"rounded-2xl border border-border bg-card/80 p-3 shadow-lg",children:[e.jsx("div",{className:"mb-2 h-3 w-1/3 rounded bg-background/70"}),e.jsx("div",{className:"flex gap-1.5",children:Array.from({length:6}).map((m,r)=>e.jsx("div",{className:"h-10 flex-1 rounded bg-background/70"},r))})]},s))})});if(a)return e.jsx("div",{className:"flex min-h-[40vh] items-center justify-center px-4",children:e.jsxs("div",{className:"max-w-sm rounded-2xl border border-destructive/40 bg-destructive/5 p-4 text-center text-xs text-foreground shadow-lg",children:[e.jsx("p",{className:"font-semibold",children:"Unable to load your stats."}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:n??"Please try again in a moment."})]})});if(t.totalRated===0&&t.totalWatched===0&&!t.ratingDistribution.length&&!t.topGenres.length&&!t.watchCountByMonth.length)return e.jsx("div",{className:"flex min-h-[40vh] items-center justify-center px-4",children:e.jsxs("div",{className:"max-w-sm rounded-2xl border border-border bg-card/80 p-5 text-center text-xs text-muted-foreground shadow-lg",children:[e.jsx("div",{className:"mx-auto mb-3 flex h-10 w-10 items-center justify-center rounded-2xl bg-primary/15",children:e.jsx(R,{className:"h-5 w-5 text-primary","aria-hidden":"true"})}),e.jsx("p",{className:"font-heading text-sm font-semibold text-foreground",children:"No stats yet"}),e.jsx("p",{className:"mt-1 text-xs",children:"Once you start rating titles and marking them as watched, you'll see your rating distribution, top genres, and watch streaks here."})]})});const c=t.ratingDistribution.reduce((d,s)=>s.count>d?s.count:d,0),x=t.watchCountByMonth.reduce((d,s)=>s.count>d?s.count:d,0),u=t.topGenres.slice(0,6);return e.jsxs("div",{className:"space-y-3 px-2 pb-4",children:[e.jsxs("section",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"rounded-2xl border border-border bg-card/80 p-3 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Watched"}),e.jsx(v,{className:"h-3.5 w-3.5 text-muted-foreground","aria-hidden":"true"})]}),e.jsx("p",{className:"mt-1 text-lg font-semibold text-foreground",children:t.totalWatched}),e.jsxs("p",{className:"mt-0.5 text-xs text-muted-foreground",children:["Titles marked as ",e.jsx("span",{className:"font-medium text-foreground",children:"Watched"}),"."]})]}),e.jsxs("div",{className:"rounded-2xl border border-border bg-card/80 p-3 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Rated"}),e.jsx(W,{className:"h-3.5 w-3.5 text-muted-foreground","aria-hidden":"true"})]}),e.jsx("p",{className:"mt-1 text-lg font-semibold text-foreground",children:t.totalRated}),e.jsx("p",{className:"mt-0.5 text-xs text-muted-foreground",children:"Ratings you've logged across movies, series, and anime."})]}),e.jsxs("div",{className:"col-span-2 rounded-2xl border border-border bg-card/80 p-3 text-xs text-muted-foreground shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Average rating"}),e.jsx(ae,{className:"h-3.5 w-3.5 text-muted-foreground","aria-hidden":"true"})]}),e.jsx("p",{className:"mt-1 text-lg font-semibold text-foreground",children:t.averageRating!=null?t.averageRating.toFixed(1):"–"}),e.jsx("p",{className:"mt-0.5 text-xs text-muted-foreground",children:"Quick glance at how generous you typically are with stars."})]})]}),e.jsxs("section",{className:"rounded-2xl border border-border bg-card/80 p-3 shadow-lg",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[e.jsx("h2",{className:"text-xs font-semibold text-foreground",children:"Rating distribution"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["0.5 – 5.0 • ",t.totalRated," ratings"]})]}),t.ratingDistribution.length===0?e.jsx("p",{className:"text-xs text-muted-foreground",children:"Once you start rating titles, you'll see how your scores cluster here."}):e.jsx("div",{className:"flex items-end gap-1.5",children:t.ratingDistribution.map(d=>{const s=c>0?Math.max(d.count/c*52,6):6;return e.jsxs("div",{className:"flex flex-1 flex-col items-center gap-1",children:[e.jsx("div",{className:"w-full rounded-t bg-primary/25",style:{height:s},"aria-hidden":"true"}),e.jsxs("span",{className:"text-[9px] text-muted-foreground",children:[d.rating.toFixed(1),"★"]})]},d.rating)})})]}),e.jsxs("section",{className:"rounded-2xl border border-border bg-card/80 p-3 shadow-lg",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[e.jsx("h2",{className:"text-xs font-semibold text-foreground",children:"Top genres"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Based on titles you've marked as watched"})]}),u.length?e.jsx("div",{className:"flex flex-wrap gap-1.5",children:u.map(d=>e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-primary/15 px-2.5 py-1 text-xs text-foreground",children:[e.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-primary","aria-hidden":"true"}),e.jsx("span",{className:"font-medium",children:d.genre}),e.jsxs("span",{className:"text-[9px] text-muted-foreground",children:["×",d.count]})]},d.genre))}):e.jsx("p",{className:"text-xs text-muted-foreground",children:"Watch and rate a few titles to reveal your go-to genres."})]}),e.jsxs("section",{className:"rounded-2xl border border-border bg-card/80 p-3 shadow-lg",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[e.jsx("h2",{className:"text-xs font-semibold text-foreground",children:"Watch count over time"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Month by month, based on your library"})]}),t.watchCountByMonth.length?e.jsx("div",{className:"space-y-1.5",children:e.jsx("div",{className:"flex items-end gap-1.5",children:t.watchCountByMonth.map(d=>{const s=x>0?Math.max(d.count/x*52,6):6;return e.jsxs("div",{className:"flex flex-1 flex-col items-center gap-1",children:[e.jsx("div",{className:"w-full rounded-t bg-primary/20",style:{height:s},"aria-hidden":"true"}),e.jsx("span",{className:"text-[9px] text-muted-foreground",children:_e(d.month)})]},d.month)})})}):e.jsx("p",{className:"text-xs text-muted-foreground",children:"As you mark titles as watched, you'll see your movie-watching streaks here."})]})]})},S=[{key:"timeline",label:"Timeline",icon:te,description:"Chronological history of your ratings, reviews, and library updates."},{key:"library",label:"Library",icon:le,description:"Filter your watchlist and history by status and type."},{key:"stats",label:"Stats",icon:W,description:"Rating distribution, top genres, and watch trends over time."}],We=()=>{const[t,l]=f.useState("timeline"),a=S.find(n=>n.key===t)??S[0];return e.jsxs("div",{className:"flex flex-1 flex-col gap-[var(--section-gap)] pb-[var(--page-pad-y)]",children:[e.jsx(K,{title:"Diary"}),e.jsx("section",{className:"page-pad",children:e.jsxs("div",{className:"rounded-2xl border border-border/60 bg-card/80 p-[var(--card-pad)] shadow-sm",children:[e.jsx(de,{value:t,onValueChange:n=>l(n),children:e.jsx(ce,{className:"w-full",children:S.map(n=>e.jsx(me,{value:n.key,icon:e.jsx(n.icon,{className:"h-3.5 w-3.5","aria-hidden":"true"}),children:n.label},n.key))})}),e.jsx("p",{className:"mt-2 px-1 text-xs text-muted-foreground",children:a.description})]})}),e.jsxs("section",{"aria-live":"polite",className:"flex-1",children:[t==="timeline"&&e.jsx("div",{id:"diary-tabpanel-timeline",role:"tabpanel",className:"h-full w-full",children:e.jsx(be,{})}),t==="library"&&e.jsx("div",{id:"diary-tabpanel-library",role:"tabpanel",className:"h-full w-full",children:e.jsx(we,{})}),t==="stats"&&e.jsx("div",{id:"diary-tabpanel-stats",role:"tabpanel",className:"h-full w-full",children:e.jsx(ke,{})})]})]})};export{We as default};
