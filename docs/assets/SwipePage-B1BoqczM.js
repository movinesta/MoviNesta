import{c as X,j as e,B as mn,b as xn,r as c,d as kt,e as fn,f as pn,F as xt,g as hn,S as gn,q as bn,s as wn}from"./index-fug2llhW.js";import{T as yn}from"./TopBar-Cwkp26YK.js";import{u as jn,a as vn}from"./useDiaryLibrary-D1rQWxL6.js";import{u as Nn}from"./dialog-D5JMvrax.js";import{C as kn}from"./circle-alert-D1FeqQXB.js";import{I as _n,T as ft}from"./thumbs-up-ByWp07T5.js";import{S as Me}from"./sparkles-Bpg1Ayxy.js";import{C as Ie}from"./circle-check-CHj4IJre.js";import{S as Sn}from"./star-COq6dKFa.js";import"./index-Ab52zN-Q.js";import"./users-BhnP_LC4.js";import"./format-DWLSBLoY.js";const Cn=[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M10.41 10.41a2 2 0 1 1-2.83-2.83",key:"1bzlo9"}],["line",{x1:"13.5",x2:"6",y1:"13.5",y2:"21",key:"1q0aeu"}],["line",{x1:"18",x2:"21",y1:"12",y2:"15",key:"5mozeu"}],["path",{d:"M3.59 3.59A1.99 1.99 0 0 0 3 5v14a2 2 0 0 0 2 2h14c.55 0 1.052-.22 1.41-.59",key:"mmje98"}],["path",{d:"M21 15V5a2 2 0 0 0-2-2H9",key:"43el77"}]],Rn=X("image-off",Cn);const Tn=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],Mn=X("link-2",Tn);const An=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],In=X("rotate-cw",An);const Ln=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],_t=X("share-2",Ln);const $n=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],Fn=X("skip-forward",$n);const Dn=[["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}],["path",{d:"M17 14V2",key:"8ymqnk"}]],pt=X("thumbs-down",Dn),ce=(r,i,o)=>Math.min(o,Math.max(i,r)),w=r=>{if(!r)return null;const i=r.trim();return!i||i.toUpperCase()==="N/A"?null:i},En=r=>{if(!r||r<=0)return null;const i=Math.floor(r/60),o=r%60;return i===0?`${o}m`:o===0?`${i}h`:`${i}h ${o}m`},Pn=r=>{const i=w(r);if(!i)return null;const o=i.toLowerCase();return o==="united states"||o==="united states of america"?"US":o==="united kingdom"||o==="great britain"?"UK":o==="canada"?"CA":o==="australia"?"AU":o==="germany"?"DE":o==="france"?"FR":o==="spain"?"ES":o==="italy"?"IT":o==="japan"?"JP":o==="south korea"||o==="republic of korea"?"KR":i.length<=3?i.toUpperCase():i},v=r=>{if(r==null)return null;if(typeof r=="number")return Number.isNaN(r)?null:r;const i=parseFloat(r);return Number.isNaN(i)?null:i},de=r=>{const i=v(r);return i==null?null:Math.round(i).toLocaleString()},Un=r=>{switch(r){case"from-friends":return"Friends’ picks";case"trending":return"Trending now";default:return"Matched for you"}},Ae=r=>{if(!r)return;const i=[];r.year&&i.push(String(r.year));const o=[];typeof r.imdbRating=="number"&&!Number.isNaN(r.imdbRating)&&o.push(`IMDb ${r.imdbRating.toFixed(1)}`),typeof r.rtTomatoMeter=="number"&&!Number.isNaN(r.rtTomatoMeter)&&o.push(`${r.rtTomatoMeter}% Rotten Tomatoes`);const p=[...i,...o].filter(Boolean).join(" · ");return p?`${r.title} (${p})`:r.title},On=({message:r,onRetry:i,isRetrying:o})=>r?e.jsx("div",{className:"mx-3 mb-3 rounded-md border border-amber-500/60 bg-amber-500/10 px-3 py-2 text-xs text-amber-50",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(kn,{className:"mt-0.5 h-3.5 w-3.5 flex-shrink-0","aria-hidden":!0}),e.jsxs("div",{className:"flex flex-1 flex-col gap-1 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("p",{className:"leading-snug",children:r}),e.jsxs(mn,{type:"button",variant:"outline",size:"sm",onClick:i,disabled:o,children:[e.jsx(In,{className:"h-3.5 w-3.5","aria-hidden":!0}),o?"Retrying…":"Retry"]})]})]})}):null,Yn=({card:r,metaLine:i,highlightLabel:o})=>e.jsxs("div",{className:"space-y-2 text-left leading-relaxed","aria-label":"Swipe card summary",children:[e.jsx("div",{className:"flex items-start justify-between gap-3",children:e.jsxs("div",{className:"min-w-0 space-y-1",children:[e.jsx("h2",{className:"line-clamp-2 text-2xl font-heading font-semibold text-foreground",children:r.title}),i&&e.jsx("p",{className:"truncate text-xs text-muted-foreground/90",children:i}),o&&e.jsx("p",{className:"text-xs font-medium text-primary/90",children:o})]})}),r.tagline&&!r.tagline.trim().startsWith("Plot")&&e.jsx("p",{className:"line-clamp-2 text-xs text-muted-foreground/90",children:r.tagline})]}),ht=({title:r})=>e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-gradient-to-br from-background via-card to-background text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2 text-muted-foreground",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-card/70 shadow-md",children:e.jsx(Rn,{className:"h-6 w-6 text-muted-foreground"})}),e.jsx("span",{className:"text-[12px] font-semibold",children:"Artwork unavailable"}),r&&e.jsxs("span",{className:"max-w-[240px] truncate text-xs text-muted-foreground/80",children:["for ",r]})]})}),ue="mn_swipe_onboarding_seen",gt=88,bt=.32,wt=220,Xn=16,Bn=360,yt=14,jt=32,vt="want_to_watch",Nt="watched",dr=()=>{const{cards:r,isLoading:i,isError:o,swipe:p,fetchMore:y,trimConsumed:C,swipeSyncError:F,retryFailedSwipe:B,isRetryingSwipe:A}=xn("combined",{limit:72}),[g,D]=c.useState(0),n=r[g],h=r[g+1],[E,me]=c.useState(!1),[St,xe]=c.useState(()=>typeof window>"u"?!1:!localStorage.getItem(ue)),[Le,$e]=c.useState(!1),[Fe,Ct]=c.useState([]),De=(t,s)=>{t&&Ct(a=>{const l=a.includes(t);return s?l?a:[...a,t]:l?a.filter(u=>u!==t):a})},Ee=t=>De(n?.id,t),Pe=t=>De(h?.id,t),Rt=!!n?.id&&Fe.includes(n.id),Tt=!!h?.id&&Fe.includes(h.id),[Ue,Q]=c.useState(null),[Mt,ee]=c.useState(0),[k,Oe]=c.useState(!1),[te,fe]=c.useState(!1),[ne,pe]=c.useState(!1),[W,Ye]=c.useState(null),[At,he]=c.useState(!1),R=c.useRef(null),[Xe,Be]=c.useState(null),z=c.useRef(null),[Kn,It]=c.useState(0),[Lt,We]=c.useState(0),ge=c.useRef(null),ze=c.useRef(!1),[Zn,$t]=c.useState(!1),[Ft,He]=c.useState(!1),_=n?.id??null,{user:Dt}=kt(),{updateStatus:qe,updateRating:Ge}=jn(),{data:Et}=vn(_),Ve=Et??{status:null,rating:null},[Pt,Ke]=c.useState(null),N=c.useRef(null),H=c.useRef(!1),q=c.useRef(null),re=c.useRef({x:0,y:0}),Ze=()=>{if(typeof window>"u")return null;if(q.current)return q.current;const t=window.AudioContext||window.webkitAudioContext;if(!t)return null;const s=new t;return q.current=s,s},be=t=>{typeof navigator>"u"||typeof navigator.vibrate!="function"||navigator.vibrate(t)},Je=(t,s)=>{const a=Ze();if(!a)return;a.state==="suspended"&&a.resume().catch(()=>{});const l=a.createOscillator(),u=a.createGain();let x=440,f=440;t==="like"?(x=420,f=660):t==="dislike"?(x=280,f=190):(x=360,f=320);const j=a.currentTime,m=.08+s*.07;l.type="triangle",l.frequency.setValueAtTime(x,j),l.frequency.linearRampToValueAtTime(f,j+m);const b=.18+s*.18;u.gain.setValueAtTime(b,j),u.gain.exponentialRampToValueAtTime(.001,j+m),l.connect(u),u.connect(a.destination),l.start(j),l.stop(j+m+.02)},{data:d}=fn({queryKey:bn.titleDetail(_),enabled:!!(_&&k),staleTime:1e3*60*30,gcTime:1e3*60*60,refetchOnWindowFocus:!1,queryFn:async()=>{if(!_)return null;const{data:t,error:s}=await wn.from("titles").select(`
          title_id,
          content_type,
          plot,
          tmdb_overview,
          tagline,
          omdb_director,
          omdb_writer,
          omdb_actors,
          genres,
          tmdb_genre_names,
          language,
          omdb_language,
          tmdb_original_language,
          country,
          omdb_country,
          imdb_rating,
          imdb_votes,
          metascore,
          rt_tomato_pct,
          poster_url,
          tmdb_poster_path,
          backdrop_url,
          omdb_awards,
          omdb_box_office_str,
          omdb_box_office,
          omdb_released,
          tmdb_vote_average,
          tmdb_vote_count,
          tmdb_popularity,
          tmdb_episode_run_time
        `).eq("title_id",_).maybeSingle();if(s)throw s;return t}}),Qe=w(d?.plot)??w(d?.tmdb_overview)??w(n?.overview)??null,S=d?.tmdb_genre_names??d?.genres??n?.genres??null,Ut=d?.language??d?.omdb_language??d?.tmdb_original_language??n?.language??null;w(Ut);const Ot=d?.country??d?.omdb_country??n?.country??null,Yt=w(Ot),et=Pn(Yt),we=w(d?.omdb_director),ye=w(d?.omdb_writer),P=w(d?.omdb_actors),je=d?.imdb_rating??n?.imdbRating??null;d?.rt_tomato_pct??n?.rtTomatoMeter;const se=d?.metascore??null,ae=d?.imdb_votes??null,ie=d?.tmdb_vote_average??null,oe=d?.tmdb_vote_count??null,le=d?.tmdb_popularity??null,ve=w(d?.omdb_awards),Ne=w(d?.omdb_box_office_str),ke=w(d?.omdb_released),G=d?.content_type==="movie"||d?.content_type==="series"?d.content_type:n?.type??null,tt=n,Xt=tt?.certification??tt?.rated??d?.omdb_rated??null,nt=w(Xt),rt=(Array.isArray(S)?S:S?String(S).split(",").map(t=>t.trim()):[])??[],_e=rt.length>3?rt.slice(3).filter(Boolean):[],Bt=[d?.language??null,d?.omdb_language??null,d?.tmdb_original_language??null,n?.language??null],Se=Array.from(new Set(Bt.map(t=>w(t)).filter(t=>!!t)));let V=null;Array.isArray(d?.tmdb_episode_run_time)?d.tmdb_episode_run_time.length>0&&(V=v(d.tmdb_episode_run_time[0])??null):d?.tmdb_episode_run_time!=null&&(V=v(d.tmdb_episode_run_time));const st=()=>Dt?!0:(alert("Sign in to save this title, rate it, or add it to your watchlist."),!1),at=t=>{if(!_||!st()||qe.isPending)return;const s=G??"movie";qe.mutate({titleId:_,status:t,type:s})},Wt=t=>{if(!_||!st()||Ge.isPending)return;const s=G??"movie";Ge.mutate({titleId:_,rating:t,type:s})},it=t=>Ve?.status===t,ot=Ve?.rating??null,Ce=Pt??ot;c.useEffect(()=>{Ke(null)},[_,ot]);const zt=t=>{const s=Ce===t?null:t;Ke(s),Wt(s)},lt=()=>typeof window<"u"?`${window.location.origin}/title/${n?.id??""}`:`/title/${n?.id??""}`,Ht=lt(),qt=async t=>{if(!n)return;const s=lt(),a=`Check this out: ${n.title}`,l=t??a;try{navigator.share?await navigator.share({title:n.title,text:l,url:s}):navigator.clipboard?.writeText?(await navigator.clipboard.writeText(`${l}

${s}`),alert("Link copied to clipboard")):alert(`${l}

${s}`)}catch{}},Gt=!!(n?.posterUrl&&!Rt),Vt=!!(h?.posterUrl&&!Tt),U=c.useRef(null),O=c.useRef(null),T=c.useRef(0),K=c.useRef(),I=c.useRef(null),L=c.useRef(null),M=c.useRef(0);c.useEffect(()=>{if(typeof window>"u")return;const t=localStorage.getItem(ue);xe(!t)},[]),c.useEffect(()=>{Ee(!1),pe(!1),Oe(!1),fe(!1),$t(!1)},[n?.id]),c.useEffect(()=>{Pe(!1)},[h?.id]),c.useEffect(()=>{if(typeof window>"u")return;(window.requestIdleCallback??(s=>window.setTimeout(s,180)))(()=>{const s=r.slice(g+1,g+4);for(const a of s){if(!a?.posterUrl)continue;const l=new Image;l.loading="lazy",l.decoding="async",l.src=a.posterUrl}})},[r,g]),c.useEffect(()=>()=>{K.current&&cancelAnimationFrame(K.current),N.current!=null&&window.clearTimeout(N.current),R.current!=null&&window.clearTimeout(R.current),z.current!=null&&window.clearTimeout(z.current),q.current&&q.current.close().catch(()=>{})},[]),c.useEffect(()=>{if(!h)return;$e(!1);const t=window.setTimeout(()=>$e(!0),16);return()=>window.clearTimeout(t)},[h?.id]),c.useEffect(()=>{const t=r.length-g;t<3&&y(Math.max(24,t+12))},[r.length,g,y]),c.useEffect(()=>{if(g<=10)return;const t=Math.min(Math.max(g-6,0),r.length);t>0&&(C(t),D(s=>Math.max(4,s-t)))},[r.length,g,C]);const Z=(t,s=!1)=>{const a=U.current;if(!a)return;const l=ce(t,-wt,wt),u=ce(l/yt,-12,12),x=ce(l/26,-10,10),f=1.02,j=Math.min(Math.abs(l)/900,.04),m=f+j,b=re.current,Y=b.y*-4,dn=b.x*5,un=b.y*-4;a.style.transition=s?"transform 260ms cubic-bezier(0.22,0.61,0.36,1)":"none",a.style.transform=`
      perspective(1400px)
      translateX(${l}px)
      translateY(${un}px)
      rotateX(${Y}deg)
      rotateY(${x+dn}deg)
      rotateZ(${u}deg)
      scale(${m})
    `,T.current=l},Re=()=>{re.current={x:0,y:0},Z(0,!0),T.current=0,O.current=null,I.current=null,L.current=null,M.current=0,Q(null),ee(0)},Kt=(t,s)=>{Ye({card:t,direction:s}),he(!0),R.current!=null&&window.clearTimeout(R.current),R.current=window.setTimeout(()=>he(!1),2800)},Zt=()=>{he(!1),Ye(null),R.current!=null&&(window.clearTimeout(R.current),R.current=null)},Jt=()=>{W&&(D(t=>{const s=t-1;if(s<0)return t;const a=r[s];return a&&a.id===W.card.id?s:t}),Zt())},ct=t=>{Be(t),z.current!=null&&window.clearTimeout(z.current),t&&(z.current=window.setTimeout(()=>Be(null),3200))},Qt=(t,s)=>{const a=t.runtimeMinutes??0,l=S??t.genres??[],u=G==="series"||t.type==="series",x=l.map(f=>f.toLowerCase());return s==="like"?x.some(f=>f.includes("horror")||f.includes("thriller"))?"We’ll show more intense picks like this.":x.some(f=>f.includes("comedy"))?"We’ll show more light and funny picks like this.":u?"Nice — we’ll bring in more series that match this vibe.":je!=null&&v(je)!=null&&v(je)>=7.5?"Nice pick — we’ll show more highly rated titles like this.":t.friendLikesCount&&t.friendLikesCount>=3?"Your friends are into this — we’ll pull in more friend-favorites.":"Got it — we’ll keep tuning around this kind of title.":s==="dislike"?u?"Looks like this series isn’t your thing — we’ll dial down similar shows.":a>130&&Lt+1>=3?"You’ve skipped a few long movies — we’ll lean toward shorter runtimes.":a>130?"Noted — we’ll be more careful with super long movies.":"Okay, we’ll dial down similar titles in your feed.":s==="skip"?"We’ll move this out of your way and keep the feed feeling fresh.":null},$=(t,s=0)=>{if(!n)return;if(xe(!1),typeof window<"u"&&localStorage.setItem(ue,"1"),Kt(n,t),p({cardId:n.id,direction:t,rating:n.initialRating??null,inWatchlist:n.initiallyInWatchlist??void 0,sourceOverride:n.source}),Q(null),ee(0),t==="dislike"&&(n.runtimeMinutes??0)>130?We(m=>m+1):We(0),It(m=>{const b=m+1,Y=Qt(n,t);return Y&&b>=4&&b%4===0?ct(Y):ct(null),b}),t==="skip"){const m=U.current;m&&(m.style.transition="transform 220ms cubic-bezier(0.22,0.61,0.36,1), opacity 220ms ease-out",m.style.transform="perspective(1400px) translateX(0px) translateY(4px) scale(1.03) rotateZ(-1deg)",window.setTimeout(()=>{m.style.transform="perspective(1400px) translateX(0px) translateY(24px) scale(0.95)"},16),m.style.opacity="0");const b=.4;be(16+b*40),Je(t,b),window.setTimeout(()=>{D(Y=>Math.min(Y+1,r.length)),m&&(m.style.transition="none",m.style.transform="translateX(0px) translateY(0px) scale(1)",m.style.opacity="1")},220);return}const a=t==="like"?1:-1,l=Math.max(Bn,Math.abs(T.current)+Math.abs(s)*Xn),u=l*a,x=U.current;if(x){const m=ce(u/yt,-18,18),b=a*12;x.style.transition="transform 260ms cubic-bezier(0.22,0.61,0.36,1)",x.style.transform=`
        perspective(1400px)
        translateX(${u}px)
        translateY(-4px)
        rotateZ(${m}deg)
        rotateY(${b}deg)
        scale(1.04)
      `}const f=Math.abs(l),j=Math.min(1,f/520);be(22+j*60),Je(t,j),window.setTimeout(()=>{D(m=>Math.min(m+1,r.length)),Re()},260)},en=(t,s,a)=>{if(!n)return;me(!0),O.current=t,T.current=0,I.current=t,L.current=performance.now(),M.current=0,Q(null),ee(0),Ze(),N.current!=null&&window.clearTimeout(N.current),H.current=!1,N.current=window.setTimeout(()=>{H.current=!0,me(!1),Re(),be(20),Oe(x=>!x),fe(!1)},550);const l=k&&ge.current&&ge.current.contains(a);ze.current=l;const u=U.current;if(u)try{u.setPointerCapture(s)}catch{}},tn=t=>{if(!E||O.current===null)return;const s=performance.now(),a=t-O.current;N.current!=null&&Math.abs(a)>10&&!H.current&&(window.clearTimeout(N.current),N.current=null),Z(a),ee(-a*.06);let l=null;if(a>jt?l="like":a<-jt&&(l="dislike"),Q(l),I.current!==null&&L.current!==null){const u=s-L.current;if(u>0){const x=(t-I.current)/u;M.current=x}}I.current=t,L.current=s,K.current&&cancelAnimationFrame(K.current),K.current=window.requestAnimationFrame(()=>Z(T.current))},dt=()=>{if(N.current!=null&&(window.clearTimeout(N.current),N.current=null),H.current){H.current=!1,O.current=null,I.current=null,L.current=null,M.current=0;return}if(!E)return;me(!1);const s=T.current+M.current*180,a=k&&ze.current,l=a?gt*1.6:gt,u=a?bt*1.4:bt;if(Math.abs(s)>=l||Math.abs(M.current)>=u){$(s>=0?"like":"dislike",M.current),O.current=null,I.current=null,L.current=null,M.current=0;return}Re()},nn=Un(n?.source),J=!n||i||o;c.useEffect(()=>{const t=s=>{!n||J||E||(s.key==="ArrowLeft"?(s.preventDefault(),$("dislike")):s.key==="ArrowRight"?(s.preventDefault(),$("like")):(s.key==="ArrowDown"||s.key===" ")&&(s.preventDefault(),$("skip")))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[n,J,E]);const rn=()=>{if(!r.length)return null;const s=Math.min(r.length,8),a=Math.floor(s/2);let l=Math.max(0,g-a);return l+s>r.length&&(l=Math.max(0,r.length-s)),e.jsx("div",{className:"mb-3 flex justify-center","aria-hidden":"true",children:e.jsx("div",{className:"flex items-center gap-1.5",children:Array.from({length:s}).map((u,x)=>{const f=l+x,j=f===g;return e.jsx("span",{className:`h-1.5 rounded-md transition-all ${j?"w-4 bg-primary":"w-2 bg-border/70"}`},f)})})})},sn=()=>{if(!At||!W)return null;const t=W.direction==="like"?"Loved it":W.direction==="dislike"?"Marked as ‘No thanks’":"Saved for ‘Not now’";return e.jsx("div",{className:"pointer-events-none fixed inset-x-0 bottom-4 z-40 flex justify-center px-4 sm:px-0",children:e.jsxs("div",{className:"pointer-events-auto inline-flex items-center gap-3 rounded-md border border-border bg-background/95 px-3 py-2 text-[12px] text-foreground shadow-lg backdrop-blur",children:[e.jsx("span",{children:t}),e.jsx("button",{type:"button",onClick:Jt,className:"text-xs font-semibold uppercase tracking-[0.14em] text-primary hover:text-primary/80",children:"Undo"})]})})},an=()=>Xe?e.jsx("div",{className:"pointer-events-none absolute inset-x-0 top-2 z-30 flex justify-center px-4 sm:px-0",children:e.jsxs("div",{className:"pointer-events-auto inline-flex max-w-md items-start gap-2 rounded-md border border-border bg-background/95 px-3 py-2 text-xs text-muted-foreground shadow-lg backdrop-blur",children:[e.jsx(Me,{className:"mt-0.5 h-3.5 w-3.5 text-primary"}),e.jsx("span",{children:Xe})]})}):null,ut=typeof n?.imdbRating=="number"&&!Number.isNaN(n.imdbRating)?n.imdbRating:typeof d?.imdb_rating=="number"&&!Number.isNaN(d.imdb_rating)?d.imdb_rating:v(d?.imdb_rating),mt=typeof n?.rtTomatoMeter=="number"&&!Number.isNaN(n.rtTomatoMeter)?n.rtTomatoMeter:typeof d?.rt_tomato_pct=="number"&&!Number.isNaN(d.rt_tomato_pct)?d.rt_tomato_pct:v(d?.rt_tomato_pct),Te=n?(()=>{const t=[];n.year&&t.push(String(n.year));const s=(G??n.type)==="series"?"Series":"Movie";return t.push(s),ut!=null&&t.push(`IMDb ${ut.toFixed(1)}`),mt!=null&&t.push(`RT ${mt}%`),typeof n.runtimeMinutes=="number"&&n.runtimeMinutes>0&&t.push(`${n.runtimeMinutes} min`),t.join(" · ")})():"",on=n?n.why?n.why:n.friendLikesCount&&n.friendLikesCount>=3?"Friends love this":null:null,ln=t=>{if(typeof window<"u"&&window.matchMedia&&window.matchMedia("(pointer: coarse)").matches||E)return;const s=U.current;if(!s)return;const a=s.getBoundingClientRect(),l=(t.clientX-a.left)/a.width,u=(t.clientY-a.top)/a.height;re.current={x:(l-.5)*2,y:(u-.5)*2},Z(T.current)},cn=()=>{E||(re.current={x:0,y:0},Z(T.current,!0))};return e.jsxs("div",{className:"flex min-h-[calc(100vh-6rem)] flex-1 flex-col gap-4 pb-4",children:[e.jsx(yn,{title:"Swipe",subtitle:"Combined For You, friends, and trending picks"}),e.jsx(On,{message:F,onRetry:B,isRetrying:A}),e.jsxs("div",{className:"relative mt-2 flex flex-1 flex-col overflow-visible",children:[rn(),e.jsxs("div",{className:"relative flex flex-1 items-center justify-center overflow-visible [perspective:1400px]","aria-live":"polite",children:[i&&!n&&!o&&e.jsx(pn,{}),o&&!i&&e.jsxs("div",{className:"flex h-full w-full flex-col items-center justify-center gap-3 text-center text-sm text-muted-foreground",children:[e.jsx(_n,{className:"h-8 w-8 text-amber-400"}),e.jsx("p",{children:"We couldn't load your swipe deck."}),e.jsx("button",{type:"button",onClick:()=>y(32),className:"mt-1 rounded-md border border-border px-3 py-1.5 text-[12px] font-semibold text-foreground hover:bg-card/70",children:"Retry"})]}),!i&&!o&&!n&&e.jsxs("div",{className:"flex h-full w-full flex-col items-center justify-center gap-3 text-center text-sm text-muted-foreground",children:[e.jsx(Me,{className:"h-8 w-8 text-primary"}),e.jsx("p",{children:"All caught up. New cards will appear soon."}),e.jsx("button",{type:"button",onClick:()=>y(36),className:"mt-1 rounded-md border border-border px-3 py-1.5 text-[12px] font-semibold text-foreground hover:bg-card/70",children:"Refresh deck"})]}),!i&&n&&e.jsxs(e.Fragment,{children:[h&&e.jsx("div",{"aria-hidden":"true",className:"pointer-events-none absolute inset-0 mx-auto flex h-[72%] max-h-[480px] w-full max-w-md items-center justify-center rounded-2xl transition-all duration-300 ease-out",style:{transform:`${Le?"translateY(-40px) scale(0.9)":"translateY(-10px) scale(0.84)"} translateX(${Mt}px)`,opacity:Le?1:0},children:e.jsx("div",{className:"relative h-full w-full overflow-hidden rounded-2xl border border-border/40 shadow-lg",children:Vt&&h.posterUrl?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:h.posterUrl,alt:Ae(h)??h.title,className:"h-full w-full object-cover blur-[7px] brightness-[0.8]",loading:"lazy",draggable:!1,onError:()=>Pe(!0)}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-background/0 via-background/30 to-background/90"})]}):e.jsx(ht,{title:h?.title})})}),e.jsxs("article",{ref:U,role:"group","aria-roledescription":"Movie card","aria-label":Ae(n),className:`relative z-10 mx-auto flex h-[72%] max-h-[480px] w-full max-w-md select-none flex-col overflow-hidden rounded-2xl bg-gradient-to-br from-card/95 via-background/95 to-card/90 shadow-[0_28px_80px_rgba(0,0,0,0.85)] backdrop-blur transform-gpu will-change-transform ${k?"ring-1 ring-primary/40":"border border-white/5"}`,onPointerDown:t=>{t.pointerType==="mouse"&&t.button!==0||en(t.clientX,t.pointerId,t.target)},onPointerMove:t=>tn(t.clientX),onPointerUp:dt,onPointerCancel:dt,onMouseMove:ln,onMouseLeave:cn,style:{touchAction:"pan-y"},children:[e.jsx("div",{"aria-hidden":"true",className:"pointer-events-none absolute inset-0 mix-blend-screen opacity-[0.14]"}),e.jsxs("div",{className:`relative overflow-hidden bg-gradient-to-br from-background/90 via-background/85 to-background/95 transition-all duration-300 ease-out ${k?"h-[40%]":"h-[58%]"}`,children:[Gt&&n.posterUrl?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:n.posterUrl,alt:Ae(n)??`${n.title} poster`,className:"h-full w-full object-cover",draggable:!1,loading:"lazy",onError:()=>Ee(!0),style:{filter:k?"blur(4px) brightness(0.65)":"none",transform:k?"scale(1.12)":"scale(1)",transition:"filter 260ms cubic-bezier(0.22,0.61,0.36,1), transform 260ms cubic-bezier(0.22,0.61,1)"}}),k&&e.jsx("div",{className:"pointer-events-none absolute left-3 flex items-start",style:{top:"3.4rem"},children:e.jsx("div",{className:"overflow-hidden rounded-2xl border border-border bg-background shadow-[0_14px_40px_rgba(0,0,0,0.85)]",style:{height:"clamp(120px, 22vh, 220px)",aspectRatio:"2 / 3"},children:e.jsx("img",{src:n.posterUrl,alt:n.title,className:"h-full w-full object-cover",draggable:!1})})})]}):e.jsx(ht,{title:n.title}),e.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-black/10 via-black/40 to-background/95"}),Ue==="like"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pointer-events-none absolute inset-x-8 bottom-3 flex justify-start",children:e.jsxs("div",{className:"flex items-center gap-2 rounded-md bg-emerald-500/14 px-3 py-1.5 text-xs font-semibold uppercase tracking-[0.14em] text-emerald-200 shadow-md backdrop-blur-sm",children:[e.jsx(ft,{className:"h-4 w-4 text-emerald-300"}),e.jsx("span",{children:"Love it"})]})}),e.jsx("div",{className:"pointer-events-none absolute inset-y-8 right-2 w-1 rounded-full bg-gradient-to-b from-emerald-400/0 via-emerald-400/40 to-emerald-400/0"})]}),Ue==="dislike"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pointer-events-none absolute inset-x-8 bottom-3 flex justify-end",children:e.jsxs("div",{className:"flex items-center gap-2 rounded-md bg-rose-500/14 px-3 py-1.5 text-xs font-semibold uppercase tracking-[0.14em] text-rose-200 shadow-md backdrop-blur-sm",children:[e.jsx(pt,{className:"h-4 w-4 text-rose-300"}),e.jsx("span",{children:"No thanks"})]})}),e.jsx("div",{className:"pointer-events-none absolute inset-y-8 left-2 w-1 rounded-full bg-gradient-to-b from-rose-400/0 via-rose-400/40 to-rose-400/0"})]}),e.jsxs("div",{className:"absolute left-3 right-3 top-3 flex flex-wrap items-center justify-between gap-2 text-xs",children:[e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-md bg-background/80 px-2 py-1 text-xs font-semibold text-foreground shadow-md",children:[e.jsx("span",{className:"h-1.5 w-1.5 rounded-sm bg-primary"}),nn]}),e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-md bg-background/70 px-2 py-1 text-xs font-medium text-muted-foreground/85 shadow-md",children:[e.jsx(Me,{className:"h-3 w-3 text-primary/80"}),g+1," / ",r.length||1]})]})]}),e.jsxs("div",{className:"relative flex flex-1 flex-col bg-gradient-to-b from-background/92 via-background/96 to-background px-4 pb-4 pt-3 backdrop-blur-md",children:[!k&&e.jsxs(e.Fragment,{children:[e.jsx(Yn,{card:n,metaLine:Te,highlightLabel:on}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-start gap-2 text-xs text-muted-foreground",children:[typeof n.friendLikesCount=="number"&&n.friendLikesCount>0&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(xt,{className:"h-4 w-4 text-primary/80"}),n.friendLikesCount===1?"1 friend likes this":`${n.friendLikesCount} friends like this`]}),n.topFriendName&&n.topFriendReviewSnippet&&e.jsxs("button",{type:"button",onClick:()=>pe(t=>!t),className:"inline-flex flex-1 items-start gap-2 rounded-2xl bg-card/80 px-3 py-2 text-left text-foreground shadow-md hover:bg-card",children:[e.jsx(Ie,{className:"mt-0.5 h-4 w-4 text-primary"}),e.jsx("div",{className:`overflow-hidden transition-all duration-200 ${ne?"max-h-32":"max-h-10"}`,children:e.jsxs("span",{className:`block text-xs ${ne?"":"line-clamp-2"}`,children:[n.topFriendName,": “",n.topFriendReviewSnippet,"”"]})})]})]})]}),k&&n&&e.jsxs("div",{ref:ge,id:"swipe-detail-panel","aria-label":te?"Full details":"Details summary","aria-live":"polite",className:"mt-2 flex flex-1 flex-col text-left text-xs text-muted-foreground",children:[e.jsx("div",{className:"flex-1 overflow-hidden pr-1",children:te?e.jsxs("div",{className:"h-full space-y-3 text-xs leading-relaxed text-muted-foreground/90",children:[(_e.length>0||Se.length>0||V)&&e.jsxs("section",{"aria-label":"Detailed info",children:[e.jsx("h3",{className:"text-xs font-semibold uppercase tracking-[0.16em] text-muted-foreground/80",children:"Info"}),e.jsxs("div",{className:"mt-1 grid gap-1.5 rounded-2xl bg-background/60 px-3 py-2 text-[10.5px]",children:[_e.length>0&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium text-foreground/90",children:"More genres:"})," ",e.jsx("span",{children:_e.join(", ")})]}),Se.length>0&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium text-foreground/90",children:"Languages:"})," ",e.jsx("span",{children:Se.join(", ")})]}),V&&G==="series"&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium text-foreground/90",children:"Episode runtime:"})," ",e.jsx("span",{children:En(V)})]})]})]}),(ae||se||ie||oe||le)&&e.jsxs("section",{"aria-label":"Ratings breakdown",className:"mt-1",children:[e.jsx("h3",{className:"text-xs font-semibold uppercase tracking-[0.16em] text-muted-foreground/80",children:"Ratings"}),e.jsxs("div",{className:"mt-1 grid gap-1.5",children:[ae&&de(ae)&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground/90",children:"IMDb votes"}),e.jsx("span",{className:"font-medium text-foreground/90",children:de(ae)})]}),se&&v(se)!=null&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground/90",children:"Metascore"}),e.jsx("span",{className:"font-medium text-foreground/90",children:v(se)})]}),ie&&v(ie)!=null&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground/90",children:"TMDB score"}),e.jsx("span",{className:"font-medium text-foreground/90",children:v(ie)?.toFixed(1)})]}),oe&&de(oe)&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground/90",children:"TMDB votes"}),e.jsx("span",{className:"font-medium text-foreground/90",children:de(oe)})]}),le&&v(le)!=null&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground/90",children:"TMDB popularity"}),e.jsx("span",{className:"font-medium text-foreground/90",children:v(le)?.toFixed(1)})]})]})]}),P||ye?e.jsxs("section",{"aria-label":"Credits",className:"mt-1",children:[e.jsx("h3",{className:"text-xs font-semibold uppercase tracking-[0.16em] text-muted-foreground/80",children:"Credits"}),e.jsxs("div",{className:"mt-1 space-y-1.5 text-xs",children:[ye&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium text-foreground/90",children:"Writers:"})," ",e.jsx("span",{children:ye})]}),P&&(()=>{const s=P.split(",").map(a=>a.trim()).filter(Boolean).slice(3);return s.length?e.jsxs("p",{children:[e.jsx("span",{className:"font-medium text-foreground/90",children:"More cast:"})," ",e.jsx("span",{children:s.join(", ")})]}):null})()]})]}):null,(ke||ve||Ne)&&e.jsxs("section",{"aria-label":"Release and production",className:"mt-1",children:[e.jsx("h3",{className:"text-xs font-semibold uppercase tracking-[0.16em] text-muted-foreground/80",children:"Release & production"}),e.jsxs("div",{className:"mt-1 space-y-1.5 text-xs",children:[ke&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium text-foreground/90",children:"Released:"})," ",e.jsx("span",{children:ke})]}),ve&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium text-foreground/90",children:"Awards:"})," ",e.jsx("span",{children:ve})]}),Ne&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium text-foreground/90",children:"Box office:"})," ",e.jsx("span",{children:Ne})]})]})]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("h3",{className:"line-clamp-2 text-base font-semibold text-foreground sm:text-lg",children:n.title}),Te&&e.jsx("p",{className:"text-xs text-muted-foreground/90",children:Te}),e.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-1.5 text-xs text-muted-foreground/90",children:[S&&e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("span",{className:"font-medium text-foreground/90",children:"Genres"}),e.jsx("span",{className:"truncate max-w-[180px]",children:Array.isArray(S)?S.slice(0,3).join(", "):String(S).split(",").map(t=>t.trim()).slice(0,3).join(", ")})]}),nt&&e.jsx("span",{className:"rounded-full bg-card/80 px-2 py-0.5 text-xs font-medium text-foreground/90",children:nt}),et&&e.jsx("span",{className:"rounded-full bg-card/80 px-2 py-0.5 text-xs text-muted-foreground/90",children:et})]})]}),Qe&&e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.16em] text-muted-foreground/70",children:"Overview"}),e.jsx("p",{className:"line-clamp-3 text-xs leading-relaxed text-muted-foreground/90",children:Qe})]}),(we||P)&&e.jsxs("div",{className:"space-y-1.5 text-[10.5px]",children:[we&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium text-foreground/90",children:"Director:"})," ",e.jsx("span",{children:we})]}),P&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium text-foreground/90",children:"Cast:"})," ",e.jsx("span",{children:P.split(",").map(t=>t.trim()).filter(Boolean).slice(0,3).join(", ")})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 pt-1",children:[e.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full bg-card/80 px-2.5 py-1",children:[e.jsx("span",{className:"text-xs text-muted-foreground/80",children:"Your rating"}),e.jsx("div",{className:"flex items-center gap-0.5","aria-label":"Your rating",children:Array.from({length:5}).map((t,s)=>{const a=s+1,l=Ce!=null&&Ce>=a;return e.jsx("button",{type:"button",onClick:()=>zt(a),className:"flex h-5 w-5 items-center justify-center rounded-full hover:scale-105 focus-visible:outline-none",children:e.jsx(Sn,{className:`h-3.5 w-3.5 ${l?"fill-yellow-400 text-yellow-400":"text-muted-foreground"}`})},a)})})]}),e.jsxs("div",{className:"ml-auto flex flex-wrap items-center gap-1.5",children:[e.jsx("button",{type:"button",onClick:()=>at(vt),className:`inline-flex items-center rounded-full px-2.5 py-1 text-xs font-medium transition-colors ${it(vt)?"bg-primary/90 text-primary-foreground":"border border-border bg-card/80 text-muted-foreground hover:border-primary/70 hover:text-primary"}`,children:"Watchlist"}),e.jsx("button",{type:"button",onClick:()=>at(Nt),className:`inline-flex items-center rounded-full px-2.5 py-1 text-xs font-medium transition-colors ${it(Nt)?"bg-emerald-500/90 text-primary-foreground":"border border-border bg-card/80 text-muted-foreground hover:border-emerald-400/80 hover:text-emerald-300"}`,children:"Watched"}),e.jsxs("button",{type:"button",onClick:()=>He(!0),className:"inline-flex items-center gap-1 rounded-full border border-border bg-card/80 px-2.5 py-1 text-xs font-medium text-muted-foreground hover:border-primary/70 hover:text-primary",children:[e.jsx(_t,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Share"})]})]})]}),typeof n.friendLikesCount=="number"&&n.friendLikesCount>0||n.topFriendName&&n.topFriendReviewSnippet?e.jsxs("div",{className:"space-y-1.5 rounded-2xl bg-card/80 px-3 py-2 text-xs text-foreground shadow-md",children:[typeof n.friendLikesCount=="number"&&n.friendLikesCount>0&&e.jsxs("div",{className:"inline-flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(xt,{className:"h-4 w-4 text-primary/80"}),n.friendLikesCount===1?"1 friend likes this":`${n.friendLikesCount} friends like this`]}),n.topFriendName&&n.topFriendReviewSnippet&&e.jsxs("button",{type:"button",onClick:()=>pe(t=>!t),className:"mt-1 inline-flex w-full items-start gap-2 text-left",children:[e.jsx(Ie,{className:"mt-0.5 h-4 w-4 text-primary"}),e.jsx("div",{className:`overflow-hidden transition-all duration-200 ${ne?"max-h-32":"max-h-10"}`,children:e.jsxs("span",{className:`block text-xs ${ne?"":"line-clamp-2"}`,children:[n.topFriendName,": “",n.topFriendReviewSnippet,"”"]})})]})]}):null]})}),e.jsx("div",{className:"mt-2 flex justify-end",children:e.jsx("button",{type:"button",onClick:()=>fe(t=>!t),"aria-expanded":te,"aria-controls":"swipe-detail-panel",className:"inline-flex items-center gap-1 rounded-full border border-border px-2.5 py-1 text-xs font-medium text-foreground hover:border-primary/70 hover:text-primary",children:e.jsx("span",{children:te?"Collapse":"Full details"})})})]})]})]}),St&&e.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center bg-gradient-to-b from-background/70 via-background/50 to-background/80",children:e.jsxs("div",{className:"pointer-events-auto max-w-xs rounded-2xl border border-border bg-background/95 p-4 text-center shadow-lg",children:[e.jsx("p",{className:"text-sm font-semibold text-foreground",children:"Swipe to decide"}),e.jsx("p",{className:"mt-1 text-[12px] text-muted-foreground",children:"Swipe left to pass, right to save what you love."}),e.jsx("button",{type:"button",className:"mt-3 w-full rounded-xl bg-primary px-3 py-2 text-sm font-semibold text-white shadow-md",onClick:()=>{xe(!1),typeof window<"u"&&localStorage.setItem(ue,"1")},children:"Got it"})]})})]}),an()]}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 gap-3","aria-label":"Swipe actions",children:[e.jsxs("button",{type:"button",onClick:()=>$("dislike"),disabled:J,className:"flex min-h-[44px] items-center justify-center gap-2 rounded-xl border border-border bg-background px-3 py-3 text-sm font-semibold text-rose-400 shadow-md disabled:cursor-not-allowed disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-rose-300 focus-visible:ring-offset-2 focus-visible:ring-offset-background active:translate-y-[1px] active:scale-[0.99] active:shadow-none transition-all duration-150","aria-label":"No thanks",children:[e.jsx(pt,{className:"h-5 w-5"}),e.jsx("span",{className:"hidden sm:inline",children:"No thanks"})]}),e.jsxs("button",{type:"button",onClick:()=>$("skip"),disabled:J,className:"flex min-h-[44px] items-center justify-center gap-2 rounded-xl border border-border bg-background px-3 py-3 text-sm font-semibold text-muted-foreground shadow-md disabled:cursor-not-allowed disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-border focus-visible:ring-offset-2 focus-visible:ring-offset-background active:translate-y-[1px] active:scale-[0.99] active:shadow-none transition-all duration-150","aria-label":"Not now",children:[e.jsx(Fn,{className:"h-5 w-5"}),e.jsx("span",{className:"hidden sm:inline",children:"Not now"})]}),e.jsxs("button",{type:"button",onClick:()=>$("like"),disabled:J,className:"flex min-h-[44px] items-center justify-center gap-2 rounded-xl border border-transparent bg-primary/95 px-3 py-3 text-sm font-semibold text-primary-foreground shadow-md disabled:cursor-not-allowed disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 focus-visible:ring-offset-background active:translate-y-[1px] active:scale-[0.99] active:shadow-none transition-all duration-150","aria-label":"Love it",children:[e.jsx(ft,{className:"h-5 w-5"}),e.jsx("span",{className:"hidden sm:inline",children:"Love it"})]})]}),e.jsx(Wn,{isOpen:Ft,onClose:()=>He(!1),activeCard:n,shareUrl:Ht,onShareExternal:qt}),sn()]})]})},Wn=({isOpen:r,onClose:i,activeCard:o,shareUrl:p,onShareExternal:y})=>{const{user:C}=kt(),{data:F=[],isLoading:B}=hn();if(c.useEffect(()=>{if(!r)return;const n=h=>{h.key==="Escape"&&i()};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[r,i]),!r||!o)return null;const A=`Check this out: ${o.title}

${p}`,g=n=>{n.target===n.currentTarget&&i()},D=n=>{(n.key==="Enter"||n.key===" ")&&i()};return e.jsx("div",{role:"button",tabIndex:0,className:"fixed inset-0 z-[9999] flex flex-col justify-end bg-black/55",onClick:g,onKeyDown:D,children:e.jsxs("div",{role:"dialog","aria-modal":"true",className:"pointer-events-auto mb-[72px] w-full max-w-md self-center rounded-t-2xl bg-card pb-3 pt-2 shadow-[0_-18px_45px_rgba(0,0,0,0.65)]",onClick:n=>n.stopPropagation(),onKeyDown:n=>n.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-4 pb-2",children:[e.jsx("button",{type:"button",className:"rounded-full p-1 text-muted-foreground hover:bg-background/80",children:e.jsx(gn,{className:"h-4 w-4"})}),e.jsx("span",{className:"text-sm font-semibold text-foreground",children:"Send to"}),e.jsx("button",{type:"button",onClick:i,className:"rounded-full p-1 text-muted-foreground hover:bg-background/80",children:e.jsx("span",{className:"text-[18px] leading-none",children:"×"})})]}),e.jsxs("section",{className:"border-t border-border px-4 pt-3 pb-2",children:[e.jsx("h2",{className:"mb-2 text-[12px] font-medium uppercase tracking-[0.08em] text-muted-foreground/90",children:"Send to"}),B?e.jsx("div",{className:"flex gap-3 overflow-hidden",children:Array.from({length:4}).map((n,h)=>e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:"h-11 w-11 animate-pulse rounded-full bg-border/50"}),e.jsx("div",{className:"h-2.5 w-12 animate-pulse rounded bg-border/40"})]},h))}):C?F.length===0?e.jsx("p",{className:"text-[12px] text-muted-foreground/80",children:"No conversations yet. Start a chat from a profile or the Messages tab."}):e.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1 pt-0.5",children:F.map(n=>e.jsx(zn,{conversation:n,text:A},n.id))}):e.jsx("p",{className:"text-[12px] text-muted-foreground/80",children:"Sign in to share via messages."})]}),e.jsx("section",{className:"border-t border-border px-4 pt-3 pb-3",children:e.jsxs("div",{className:"flex gap-3 overflow-x-auto pb-1 pt-0.5",children:[e.jsx(qn,{shareUrl:p,title:o.title}),e.jsx(Gn,{shareUrl:p,title:o.title}),e.jsx(Vn,{onShareExternal:y}),e.jsx(Hn,{shareUrl:p})]})})]})})},zn=({conversation:r,text:i})=>{const o=r.isGroup?null:r.participants?.find(A=>!A.isSelf)??r.participants?.[0],p=o?.displayName??r.title??"Conversation",y=o?.avatarUrl,C=Nn(r.id),F=()=>{C.isPending||C.mutate({text:i})},B=p.split(" ").map(A=>A.charAt(0).toUpperCase()).slice(0,2).join("");return e.jsxs("button",{type:"button",onClick:F,className:"flex w-[72px] flex-col items-center gap-1 text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex h-11 w-11 items-center justify-center overflow-hidden rounded-full bg-muted text-xs text-muted-foreground",children:y?e.jsx("img",{src:y,alt:p,className:"h-full w-full object-cover"}):e.jsx("span",{children:B})}),C.isSuccess&&e.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 flex h-4 w-4 items-center justify-center rounded-full bg-emerald-500",children:e.jsx(Ie,{className:"h-3 w-3 text-primary-foreground"})})]}),e.jsx("span",{className:"line-clamp-2 max-w-[72px] text-xs text-foreground",children:p})]})},Hn=({shareUrl:r})=>{const i=async()=>{if(navigator.clipboard?.writeText)try{await navigator.clipboard.writeText(r)}catch{}};return e.jsxs("button",{type:"button",onClick:i,className:"flex w-[72px] flex-col items-center gap-1 text-center",children:[e.jsx("div",{className:"flex h-11 w-11 items-center justify-center rounded-full bg-primary",children:e.jsx(Mn,{className:"h-4 w-4 text-primary-foreground"})}),e.jsx("span",{className:"line-clamp-2 max-w-[72px] text-xs text-foreground",children:"Copy link"})]})},qn=({shareUrl:r,title:i})=>{const o=()=>{if(typeof window>"u")return;const p=`Check this out: ${i}

${r}`,y=`https://api.whatsapp.com/send?text=${encodeURIComponent(p)}`;window.open(y,"_blank","noopener,noreferrer")};return e.jsxs("button",{type:"button",onClick:o,className:"flex w-[72px] flex-col items-center gap-1 text-center",children:[e.jsx("div",{className:"flex h-11 w-11 items-center justify-center rounded-full bg-primary",children:e.jsx("span",{className:"text-[16px] font-semibold text-white",children:"W"})}),e.jsx("span",{className:"line-clamp-2 max-w-[72px] text-xs text-foreground",children:"WhatsApp"})]})},Gn=({shareUrl:r,title:i})=>{const o=()=>{if(typeof window>"u")return;const p=`Check this out: ${i}

${r}`,y=`https://t.me/share/url?url=${encodeURIComponent(r)}&text=${encodeURIComponent(p)}`;window.open(y,"_blank","noopener,noreferrer")};return e.jsxs("button",{type:"button",onClick:o,className:"flex w-[72px] flex-col items-center gap-1 text-center",children:[e.jsx("div",{className:"flex h-11 w-11 items-center justify-center rounded-full bg-primary",children:e.jsx("span",{className:"text-[16px] font-semibold text-white",children:"T"})}),e.jsx("span",{className:"line-clamp-2 max-w-[72px] text-xs text-foreground",children:"Telegram"})]})},Vn=({onShareExternal:r})=>{const i=async()=>{await r()};return e.jsxs("button",{type:"button",onClick:i,className:"flex w-[72px] flex-col items-center gap-1 text-center",children:[e.jsx("div",{className:"flex h-11 w-11 items-center justify-center rounded-full border border-border bg-muted",children:e.jsx(_t,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx("span",{className:"line-clamp-2 max-w-[72px] text-xs text-foreground",children:"More"})]})};export{dr as default};
