import{c as $e,u as Sn,r as o,b as Et,d as Cn,e as kt,j as e,f as Mn,F as St,g as Tn,S as Rn,h as An,s as Ct,q as In}from"./index-C9fHGWeV.js";import{T as Pn}from"./TopBar-C-VicUv8.js";import{u as Fn}from"./useMutation-Cbgapksf.js";import{u as Ln}from"./scroll-area-CnoFzb4R.js";import"./dialog-DjKMkZCg.js";import{u as Dn,c as k,a as $n,s as R,g as En,S as Un,b as Fe,P as Mt,C as Yn,F as On,e as Tt,d as ue}from"./FriendAvatarStack-HjrY3RCv.js";import{D as Xn,a as qn,b as Wn,c as Rt}from"./dropdown-menu-KxXGdxwY.js";import{M as Bn}from"./menu-DOwJkYef.js";import{I as Hn,T as At}from"./thumbs-up-D_Dm-nz6.js";import{S as Le}from"./sparkles-C2-yvYY7.js";import{C as De}from"./circle-check-CJxNvjkQ.js";import{S as zn}from"./star-D0Ye5NZ1.js";import{S as Ut}from"./share-2-CVKcGcoK.js";import"./format-DMUSBM01.js";import"./circle-alert-C2ornUjM.js";import"./index-DDwuZX7F.js";import"./index-B5ogGJIu.js";import"./index-DBHTwg8d.js";const Gn=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],Kn=$e("link-2",Gn);const Vn=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],Zn=$e("skip-forward",Vn);const Qn=[["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}],["path",{d:"M17 14V2",key:"8ymqnk"}]],It=$e("thumbs-down",Qn),me="mn_swipe_onboarding_seen",Pt=88,Ft=.32,Lt=220,Jn=16,er=360,Dt=14,$t=32,tr=s=>{if(s==null)return null;const d=String(s).trim();if(!d)return null;const f=d.replace(/%/g,""),u=Number(f);return Number.isFinite(u)?u:null},nr=s=>{if(s==null)return null;const d=typeof s=="number"?s:Number(String(s).trim());if(!Number.isFinite(d))return null;const f=Math.round(d/2);return f<=0?null:Math.min(5,Math.max(1,f))},rr=s=>{if(s==null)return null;const d=Math.round(s);return d<=0?null:Math.min(10,Math.max(2,d*2))},sr=s=>{const d=(()=>{const M=String(s?.source??"").trim();if(!M)return null;const x=M.replace("-","_");return x==="for_you"||x==="for-you"?"for-you":x==="friends"||x==="from_friends"||x==="from-friends"?"from-friends":x==="trending"?"trending":x==="popular"?"popular":x==="combined"?"combined":x==="explore"?"explore":null})(),f=s?.kind==="series"?"series":(s?.kind==="movie","movie"),u=typeof s?.releaseYear=="number"?s.releaseYear:s?.releaseYear!=null?Number(s.releaseYear):null,w=typeof s?.runtimeMinutes=="number"?s.runtimeMinutes:s?.runtimeMinutes!=null?Number(s.runtimeMinutes):null;return{id:String(s?.id??""),title:String(s?.title??"Untitled"),year:Number.isFinite(u)?u:null,type:f,runtimeMinutes:Number.isFinite(w)?w:null,posterUrl:s?.posterUrl??null,tmdbPosterPath:s?.tmdbPosterPath??null,tmdbBackdropPath:s?.tmdbBackdropPath??null,source:d,why:s?.why??null,friendIds:Array.isArray(s?.friendIds)?s.friendIds:null,friendProfiles:Array.isArray(s?.friendProfiles)?s.friendProfiles:null,friendLikesCount:typeof s?.friendLikesCount=="number"?s.friendLikesCount:Array.isArray(s?.friendProfiles)?s.friendProfiles.length:Array.isArray(s?.friendIds)?s.friendIds.length:null,topFriendName:Array.isArray(s?.friendProfiles)&&s.friendProfiles[0]?String(s.friendProfiles[0].display_name??s.friendProfiles[0].username??""):s?.topFriendName??null,overview:s?.overview??null}},Y="want_to_watch",O="watched",Ar=()=>{const s=Sn(),{cards:d,sessionId:f,isLoading:u,isError:w,swipe:M,fetchMore:x,trimConsumed:X,swipeSyncError:L,retryFailedSwipe:fe,isRetryingSwipe:pe,trackImpression:b,trackDwell:D}=Dn("combined",{limit:72}),y=o.useMemo(()=>d.map(sr),[d]),[v,ie]=o.useState(0),g=d[v];d[v+1];const n=y[v],N=y[v+1],[q,xe]=o.useState(!1),[Yt,be]=o.useState(()=>typeof window>"u"?!1:!localStorage.getItem(me)),[Ee,Ue]=o.useState(!1),[Ye,Ot]=o.useState([]),Oe=(t,r)=>{t&&Ot(i=>{const a=i.includes(t);return r?a?i:[...i,t]:a?i.filter(c=>c!==t):i})},Xe=t=>Oe(n?.id,t),qe=t=>Oe(N?.id,t),Xt=!!n?.id&&Ye.includes(n.id),qt=!!N?.id&&Ye.includes(N.id),[We,oe]=o.useState(null),[Wt,ae]=o.useState(0),[T,Be]=o.useState(!1),[le,he]=o.useState(!1),[He,ze]=o.useState(!1),[G,Ge]=o.useState(null),[Bt,ge]=o.useState(!1),I=o.useRef(null),[Ke,Ve]=o.useState(null),K=o.useRef(null),[ur,Ht]=o.useState(0),[zt,Ze]=o.useState(0),we=o.useRef(null),Qe=o.useRef(!1),[mr,Gt]=o.useState(!1),[Kt,Je]=o.useState(!1),S=n?.id??null,{user:W}=Et(),Vt=Cn(),et=["mediaFeedback",{userId:W?.id??null,mediaItemId:S}],{data:ye}=kt({queryKey:et,enabled:!!(W?.id&&S),staleTime:1e3*30,gcTime:1e3*60*10,refetchOnWindowFocus:!1,queryFn:async()=>{if(!W?.id||!S)return null;const{data:t,error:r}=await Ct.from("media_feedback").select("in_watchlist, rating_0_10, last_action").eq("user_id",W.id).eq("media_item_id",S).maybeSingle();if(r)throw r;return t??null}}),tt=ye?.in_watchlist?Y:ye?.last_action==="like"?O:null,Zt=nr(ye?.rating_0_10),[Qt,ve]=o.useState(null),[nt,je]=o.useState(null),Ne={status:Qt??tt,rating:nt??Zt},V=Fn({mutationFn:async t=>{if(!W?.id||!g)return;const r={sessionId:f,deckId:g.deckId??null,position:g.position??null,mediaItemId:g.id,source:g.source??null,payload:{ui:"SwipePage",action:t.status?"status":t.ratingStars!=null?"rating":"feedback"}},i=[];if(t.status!==void 0&&(t.status===O?i.push({...r,eventType:"like"}):i.push({...r,eventType:"watchlist",inWatchlist:t.status===Y})),t.ratingStars!==void 0&&i.push({...r,eventType:"rating",rating0_10:rr(t.ratingStars)}),!!i.length)for(const a of i)await An(a)},onSuccess:()=>{Vt.invalidateQueries({queryKey:et})}}),C=o.useRef(null),Z=o.useRef(!1),Q=o.useRef(null),de=o.useRef({x:0,y:0}),rt=()=>{if(typeof window>"u")return null;if(Q.current)return Q.current;const t=window.AudioContext||window.webkitAudioContext;if(!t)return null;const r=new t;return Q.current=r,r},_e=t=>{typeof navigator>"u"||typeof navigator.vibrate!="function"||navigator.vibrate(t)},st=(t,r)=>{const i=rt();if(!i)return;i.state==="suspended"&&i.resume().catch(()=>{});const a=i.createOscillator(),c=i.createGain();let p=440,h=440;t==="like"?(p=420,h=660):t==="dislike"?(p=280,h=190):(p=360,h=320);const _=i.currentTime,m=.08+r*.07;a.type="triangle",a.frequency.setValueAtTime(p,_),a.frequency.linearRampToValueAtTime(h,_+m);const j=.18+r*.18;c.gain.setValueAtTime(j,_),c.gain.exponentialRampToValueAtTime(.001,_+m),a.connect(c),c.connect(i.destination),a.start(_),a.stop(_+m+.02)},{data:l}=kt({queryKey:In.titleDetail(S),enabled:!!(S&&T),staleTime:1e3*60*30,gcTime:1e3*60*60,refetchOnWindowFocus:!1,queryFn:async()=>{if(!S)return null;const{data:t,error:r}=await Ct.from("media_items").select("id, kind, omdb_plot, tmdb_overview, omdb_director, omdb_writer, omdb_actors, omdb_genre, omdb_language, tmdb_original_language, omdb_country, omdb_imdb_rating, omdb_imdb_votes, omdb_metascore, omdb_rating_rotten_tomatoes, omdb_poster, tmdb_poster_path, tmdb_backdrop_path, omdb_awards, omdb_box_office, omdb_released, tmdb_vote_average, tmdb_vote_count, tmdb_popularity, omdb_rated, omdb_runtime").eq("id",S).maybeSingle();if(r)throw r;if(!t)return null;const i=t.omdb_genre!=null?String(t.omdb_genre).split(",").map(c=>c.trim()).filter(Boolean):null,a=tr(t.omdb_rating_rotten_tomatoes);return{title_id:t.id,content_type:t.kind??null,plot:t.omdb_plot??null,tmdb_overview:t.tmdb_overview??null,tagline:null,omdb_director:t.omdb_director??null,omdb_writer:t.omdb_writer??null,omdb_actors:t.omdb_actors??null,genres:i,tmdb_genre_names:null,language:null,omdb_language:t.omdb_language??null,tmdb_original_language:t.tmdb_original_language??null,country:null,omdb_country:t.omdb_country??null,imdb_rating:t.omdb_imdb_rating??null,imdb_votes:t.omdb_imdb_votes??null,metascore:t.omdb_metascore??null,rt_tomato_pct:a,poster_url:t.omdb_poster??null,tmdb_poster_path:t.tmdb_poster_path??null,backdrop_url:t.tmdb_backdrop_path??null,omdb_awards:t.omdb_awards??null,omdb_box_office_str:t.omdb_box_office??null,omdb_box_office:null,omdb_released:t.omdb_released??null,tmdb_vote_average:t.tmdb_vote_average??null,tmdb_vote_count:t.tmdb_vote_count??null,tmdb_popularity:t.tmdb_popularity??null,tmdb_episode_run_time:null,omdb_rated:t.omdb_rated??null}}}),ce=k(l?.plot)??k(l?.tmdb_overview)??k(n?.overview)??null,A=l?.tmdb_genre_names??l?.genres??n?.genres??null,Jt=l?.language??l?.omdb_language??l?.tmdb_original_language??n?.language??null;k(Jt);const en=l?.country??l?.omdb_country??n?.country??null,tn=k(en),it=$n(tn),ke=k(l?.omdb_director),ot=k(l?.omdb_writer),J=k(l?.omdb_actors),Se=l?.imdb_rating??n?.imdbRating??null;l?.rt_tomato_pct??n?.rtTomatoMeter;const Ce=l?.metascore??null,Me=l?.imdb_votes??null,Te=l?.tmdb_vote_average??null;l?.tmdb_vote_count,l?.tmdb_popularity;const at=k(l?.omdb_awards),lt=k(l?.omdb_box_office_str),dt=k(l?.omdb_released),ct=l?.content_type==="movie"||l?.content_type==="series"?l.content_type:n?.type??null,ut=n,nn=ut?.certification??ut?.rated??l?.omdb_rated??null,mt=k(nn),ft=(Array.isArray(A)?A:A?String(A).split(",").map(t=>t.trim()):[])??[],pt=ft.length>3?ft.slice(3).filter(Boolean):[],rn=[l?.language??null,l?.omdb_language??null,l?.tmdb_original_language??null,n?.language??null],xt=Array.from(new Set(rn.map(t=>k(t)).filter(t=>!!t)));Array.isArray(l?.tmdb_episode_run_time)?l.tmdb_episode_run_time.length>0&&R(l.tmdb_episode_run_time[0]):l?.tmdb_episode_run_time!=null&&R(l.tmdb_episode_run_time);const bt=()=>W?!0:(alert("Sign in to save this title, rate it, or add it to your watchlist."),!1),ht=t=>{if(!(!S||!g||!bt()||V.isPending)){if(t===Y){const r=Ne.status===Y?null:Y;ve(r),V.mutate({status:r});return}t===O&&(ve(O),V.mutate({status:O}))}},sn=t=>{!S||!g||!bt()||V.isPending||(je(t),V.mutate({ratingStars:t}))},gt=t=>Ne?.status===t,wt=Ne?.rating??null,Re=nt??wt;o.useEffect(()=>{je(null),ve(null)},[S,wt,tt]);const on=t=>{const r=Re===t?null:t;je(r),sn(r)},yt=()=>typeof window<"u"?`${window.location.origin}/title/${n?.id??""}`:`/title/${n?.id??""}`,an=yt(),ln=async t=>{if(!n||!g)return;const r=yt(),i=`Check this out: ${n.title}`,a=t??i;try{navigator.share?await navigator.share({title:n.title,text:a,url:r}):navigator.clipboard?.writeText?(await navigator.clipboard.writeText(`${a}

${r}`),alert("Link copied to clipboard")):alert(`${a}

${r}`)}catch{}},dn=!!(n?.posterUrl&&!Xt),cn=!!(N?.posterUrl&&!qt),B=o.useRef(null),H=o.useRef(null),P=o.useRef(0),ee=o.useRef(null),$=o.useRef(null),E=o.useRef(null),F=o.useRef(0),Ae=o.useRef(null),Ie=o.useRef(null),te=o.useRef(null);o.useEffect(()=>{if(typeof window>"u")return;const t=localStorage.getItem(me);be(!t)},[]),o.useEffect(()=>{Xe(!1),ze(!1),Be(!1),he(!1),Gt(!1)},[n?.id]),o.useEffect(()=>{qe(!1)},[N?.id]),o.useEffect(()=>{if(!g)return;const t=performance.now();if(te.current&&Ie.current&&Ie.current!==g.id){const r=Ae.current;if(r!=null){const i=Math.max(0,Math.round(t-r));D(te.current,i)}}b(g),te.current=g,Ie.current=g.id,Ae.current=t},[g?.id,D,b]),o.useEffect(()=>()=>{if(!te.current)return;const t=Ae.current;if(t==null)return;const r=Math.max(0,Math.round(performance.now()-t));D(te.current,r)},[]),o.useEffect(()=>{if(typeof window>"u")return;(window.requestIdleCallback??(r=>window.setTimeout(r,180)))(()=>{const r=y.slice(v+1,v+4);for(const i of r){if(!i?.posterUrl)continue;const a=new Image;a.loading="lazy",a.decoding="async",a.src=i.posterUrl}})},[y,v]),o.useEffect(()=>()=>{ee.current&&cancelAnimationFrame(ee.current),C.current!=null&&window.clearTimeout(C.current),I.current!=null&&window.clearTimeout(I.current),K.current!=null&&window.clearTimeout(K.current),Q.current&&Q.current.close().catch(()=>{})},[]),o.useEffect(()=>{if(!N)return;Ue(!1);const t=window.setTimeout(()=>Ue(!0),16);return()=>window.clearTimeout(t)},[N?.id]),o.useEffect(()=>{const t=y.length-v;t<12&&x(Math.max(60,t+24))},[y.length,v,x]),o.useEffect(()=>{if(v<=10)return;const t=Math.min(Math.max(v-6,0),y.length);t>0&&(X(t),ie(r=>Math.max(4,r-t)))},[y.length,v,X]);const ne=(t,r=!1)=>{const i=B.current;if(!i)return;const a=ue(t,-Lt,Lt),c=ue(a/Dt,-12,12),p=ue(a/26,-10,10),h=1.02,_=Math.min(Math.abs(a)/900,.04),m=h+_,j=de.current,z=j.y*-4,_n=j.x*5,kn=j.y*-4;i.style.transition=r?"transform 260ms cubic-bezier(0.22,0.61,0.36,1)":"none",i.style.transform=`
      perspective(1400px)
      translateX(${a}px)
      translateY(${kn}px)
      rotateX(${z}deg)
      rotateY(${p+_n}deg)
      rotateZ(${c}deg)
      scale(${m})
    `,P.current=a},Pe=()=>{de.current={x:0,y:0},ne(0,!0),P.current=0,H.current=null,$.current=null,E.current=null,F.current=0,oe(null),ae(0)},un=(t,r)=>{Ge({card:t,direction:r}),ge(!0),I.current!=null&&window.clearTimeout(I.current),I.current=window.setTimeout(()=>ge(!1),2800)},mn=()=>{ge(!1),Ge(null),I.current!=null&&(window.clearTimeout(I.current),I.current=null)},fn=()=>{G&&(ie(t=>{const r=t-1;if(r<0)return t;const i=y[r];return i&&i.id===G.card.id?r:t}),mn())},vt=t=>{Ve(t),K.current!=null&&window.clearTimeout(K.current),t&&(K.current=window.setTimeout(()=>Ve(null),3200))},pn=(t,r)=>{const i=t.runtimeMinutes??0,a=A??t.genres??[],c=ct==="series"||t.type==="series",p=a.map(h=>h.toLowerCase());return r==="like"?p.some(h=>h.includes("horror")||h.includes("thriller"))?"We’ll show more intense picks like this.":p.some(h=>h.includes("comedy"))?"We’ll show more light and funny picks like this.":c?"Nice — we’ll bring in more series that match this vibe.":Se!=null&&R(Se)!=null&&R(Se)>=7.5?"Nice pick — we’ll show more highly rated titles like this.":t.friendLikesCount&&t.friendLikesCount>=3?"Your friends are into this — we’ll pull in more friend-favorites.":"Got it — we’ll keep tuning around this kind of title.":r==="dislike"?c?"Looks like this series isn’t your thing — we’ll dial down similar shows.":i>130&&zt+1>=3?"You’ve skipped a few long movies — we’ll lean toward shorter runtimes.":i>130?"Noted — we’ll be more careful with super long movies.":"Okay, we’ll dial down similar titles in your feed.":r==="skip"?"We’ll move this out of your way and keep the feed feeling fresh.":null},U=(t,r=0)=>{if(!n||!g)return;if(be(!1),typeof window<"u"&&localStorage.setItem(me,"1"),un(n,t),M({card:g,direction:t}),oe(null),ae(0),t==="dislike"&&(n.runtimeMinutes??0)>130?Ze(m=>m+1):Ze(0),Ht(m=>{const j=m+1,z=pn(n,t);return z&&j>=4&&j%4===0?vt(z):vt(null),j}),t==="skip"){const m=B.current;m&&(m.style.transition="transform 220ms cubic-bezier(0.22,0.61,0.36,1), opacity 220ms ease-out",m.style.transform="perspective(1400px) translateX(0px) translateY(4px) scale(1.03) rotateZ(-1deg)",window.setTimeout(()=>{m.style.transform="perspective(1400px) translateX(0px) translateY(24px) scale(0.95)"},16),m.style.opacity="0");const j=.4;_e(16+j*40),st(t,j),window.setTimeout(()=>{ie(z=>Math.min(z+1,y.length)),m&&(m.style.transition="none",m.style.transform="translateX(0px) translateY(0px) scale(1)",m.style.opacity="1")},220);return}const i=t==="like"?1:-1,a=Math.max(er,Math.abs(P.current)+Math.abs(r)*Jn),c=a*i,p=B.current;if(p){const m=ue(c/Dt,-18,18),j=i*12;p.style.transition="transform 260ms cubic-bezier(0.22,0.61,0.36,1)",p.style.transform=`
        perspective(1400px)
        translateX(${c}px)
        translateY(-4px)
        rotateZ(${m}deg)
        rotateY(${j}deg)
        scale(1.04)
      `}const h=Math.abs(a),_=Math.min(1,h/520);_e(22+_*60),st(t,_),window.setTimeout(()=>{ie(m=>Math.min(m+1,y.length)),Pe()},260)},xn=(t,r,i)=>{if(!n||!g)return;xe(!0),H.current=t,P.current=0,$.current=t,E.current=performance.now(),F.current=0,oe(null),ae(0),rt(),C.current!=null&&window.clearTimeout(C.current),Z.current=!1,C.current=window.setTimeout(()=>{Z.current=!0,xe(!1),Pe(),_e(20),Be(p=>!p),he(!1)},550);const a=T&&we.current&&we.current.contains(i);Qe.current=!!a;const c=B.current;if(c)try{c.setPointerCapture(r)}catch{}},bn=t=>{if(!q||H.current===null)return;const r=performance.now(),i=t-H.current;C.current!=null&&Math.abs(i)>10&&!Z.current&&(window.clearTimeout(C.current),C.current=null),ne(i),ae(-i*.06);let a=null;if(i>$t?a="like":i<-$t&&(a="dislike"),oe(a),$.current!==null&&E.current!==null){const c=r-E.current;if(c>0){const p=(t-$.current)/c;F.current=p}}$.current=t,E.current=r,ee.current&&cancelAnimationFrame(ee.current),ee.current=window.requestAnimationFrame(()=>ne(P.current))},jt=()=>{if(C.current!=null&&(window.clearTimeout(C.current),C.current=null),Z.current){Z.current=!1,H.current=null,$.current=null,E.current=null,F.current=0;return}if(!q)return;xe(!1);const r=P.current+F.current*180,i=T&&Qe.current,a=i?Pt*1.6:Pt,c=i?Ft*1.4:Ft;if(Math.abs(r)>=a||Math.abs(F.current)>=c){U(r>=0?"like":"dislike",F.current),H.current=null,$.current=null,E.current=null,F.current=0;return}Pe()},hn=n?.why??En(n?.source??void 0),re=!n||u||w;o.useEffect(()=>{const t=r=>{!n||re||q||(r.key==="ArrowLeft"?(r.preventDefault(),U("dislike")):r.key==="ArrowRight"?(r.preventDefault(),U("like")):(r.key==="ArrowDown"||r.key===" ")&&(r.preventDefault(),U("skip")))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[n,re,q]);const gn=()=>{if(!y.length)return null;const r=Math.min(y.length,8),i=Math.floor(r/2);let a=Math.max(0,v-i);return a+r>y.length&&(a=Math.max(0,y.length-r)),e.jsx("div",{className:"mb-3 flex justify-center","aria-hidden":"true",children:e.jsx("div",{className:"flex items-center gap-1.5",children:Array.from({length:r}).map((c,p)=>{const h=a+p,_=h===v;return e.jsx("span",{className:`h-1.5 rounded-md transition-all ${_?"w-4 bg-primary":"w-2 bg-border/70"}`},h)})})})},wn=()=>{if(!Bt||!G)return null;const t=G.direction==="like"?"Loved it":G.direction==="dislike"?"Marked as ‘No thanks’":"Saved for ‘Not now’";return e.jsx("div",{className:"pointer-events-none fixed inset-x-0 bottom-4 z-40 flex justify-center px-4 sm:px-0",children:e.jsxs("div",{className:"pointer-events-auto inline-flex items-center gap-3 rounded-md border border-border bg-background/95 px-3 py-2 text-[12px] text-foreground shadow-lg backdrop-blur",children:[e.jsx("span",{children:t}),e.jsx("button",{type:"button",onClick:fn,className:"text-xs font-semibold uppercase tracking-[0.14em] text-primary hover:text-primary/80",children:"Undo"})]})})},yn=()=>Ke?e.jsx("div",{className:"pointer-events-none absolute inset-x-0 top-2 z-30 flex justify-center px-4 sm:px-0",children:e.jsxs("div",{className:"pointer-events-auto inline-flex max-w-md items-start gap-2 rounded-md border border-border bg-background/95 px-3 py-2 text-xs text-muted-foreground shadow-lg backdrop-blur",children:[e.jsx(Le,{className:"mt-0.5 h-3.5 w-3.5 text-primary"}),e.jsx("span",{children:Ke})]})}):null,Nt=typeof n?.imdbRating=="number"&&!Number.isNaN(n.imdbRating)?n.imdbRating:typeof l?.imdb_rating=="number"&&!Number.isNaN(l.imdb_rating)?l.imdb_rating:R(l?.imdb_rating),_t=typeof n?.rtTomatoMeter=="number"&&!Number.isNaN(n.rtTomatoMeter)?n.rtTomatoMeter:typeof l?.rt_tomato_pct=="number"&&!Number.isNaN(l.rt_tomato_pct)?l.rt_tomato_pct:R(l?.rt_tomato_pct),se=n?(()=>{const t=[];n.year&&t.push(String(n.year));const r=(ct??n.type)==="series"?"Series":"Movie";return t.push(r),Nt!=null&&t.push(`IMDb ${Nt.toFixed(1)}`),_t!=null&&t.push(`RT ${_t}%`),typeof n.runtimeMinutes=="number"&&n.runtimeMinutes>0&&t.push(`${n.runtimeMinutes} min`),t.join(" · ")})():"",vn=n?n.why?n.why:n.friendLikesCount&&n.friendLikesCount>=3?"Friends love this":null:null,jn=t=>{if(typeof window<"u"&&window.matchMedia&&window.matchMedia("(pointer: coarse)").matches||q)return;const r=B.current;if(!r)return;const i=r.getBoundingClientRect(),a=(t.clientX-i.left)/i.width,c=(t.clientY-i.top)/i.height;de.current={x:(a-.5)*2,y:(c-.5)*2},ne(P.current)},Nn=()=>{q||(de.current={x:0,y:0},ne(P.current,!0))};return e.jsxs("div",{className:"relative flex flex-1 min-h-0 flex-col gap-3 overflow-hidden overscroll-none h-[calc(100dvh-(5.5rem+env(safe-area-inset-bottom)))] sm:h-[calc(100dvh-(6rem+env(safe-area-inset-bottom)))]",children:[e.jsx(Pn,{title:"Swipe",actions:e.jsxs(Xn,{children:[e.jsx(qn,{asChild:!0,children:e.jsx("button",{type:"button",className:"inline-flex h-9 w-9 items-center justify-center rounded-full text-foreground hover:bg-muted","aria-label":"Swipe options",children:e.jsx(Bn,{className:"h-5 w-5","aria-hidden":"true"})})}),e.jsxs(Wn,{align:"end",children:[e.jsx(Rt,{onClick:()=>s("/settings"),children:"Settings"}),e.jsx(Rt,{onClick:()=>s("/search"),children:"Find titles"})]})]})}),e.jsx(Un,{message:L,onRetry:fe,isRetrying:pe}),e.jsxs("div",{className:"relative flex flex-1 min-h-0 flex-col overflow-visible",children:[gn(),e.jsxs("div",{className:"relative flex flex-1 min-h-0 items-center justify-center overflow-visible [perspective:1400px]","aria-live":"polite",children:[u&&!n&&!w&&e.jsx(Mn,{}),w&&!u&&e.jsxs("div",{className:"flex h-full w-full flex-col items-center justify-center gap-3 text-center text-sm text-muted-foreground",children:[e.jsx(Hn,{className:"h-8 w-8 text-amber-400"}),e.jsx("p",{children:"We couldn't load your swipe deck."}),e.jsx("button",{type:"button",onClick:()=>x(32),className:"mt-1 rounded-md border border-border px-3 py-1.5 text-[12px] font-semibold text-foreground hover:bg-card/70",children:"Retry"})]}),!u&&!w&&!n&&e.jsxs("div",{className:"flex h-full w-full flex-col items-center justify-center gap-3 text-center text-sm text-muted-foreground",children:[e.jsx(Le,{className:"h-8 w-8 text-primary"}),e.jsx("p",{children:"All caught up. New cards will appear soon."}),e.jsx("button",{type:"button",onClick:()=>x(36),className:"mt-1 rounded-md border border-border px-3 py-1.5 text-[12px] font-semibold text-foreground hover:bg-card/70",children:"Refresh deck"})]}),!u&&n&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{"aria-hidden":"true",className:"pointer-events-none absolute inset-0 mx-auto flex h-[72%] max-h-[480px] w-full max-w-md items-center justify-center rounded-2xl transition-all duration-300 ease-out",style:{transform:`${Ee?"translateY(-40px) scale(0.9)":"translateY(-10px) scale(0.84)"} translateX(${Wt}px)`,opacity:Ee?1:0},children:e.jsx("div",{className:"relative h-full w-full overflow-hidden rounded-2xl border border-border/40 shadow-lg",children:cn&&N.posterUrl?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:N.posterUrl,alt:Fe(N)??N.title,className:"h-full w-full object-cover blur-[7px] brightness-[0.8]",loading:"lazy",draggable:!1,onError:()=>qe(!0)}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-background/0 via-background/30 to-background/90"})]}):e.jsx(Mt,{title:N?.title})})}),e.jsxs("article",{ref:B,role:"group","aria-roledescription":"Movie card","aria-label":Fe(n),className:`relative z-10 mx-auto flex h-[72%] max-h-[480px] w-full max-w-md select-none flex-col overflow-hidden rounded-2xl bg-gradient-to-br from-card/95 via-background/95 to-card/90 shadow-[0_28px_80px_rgba(0,0,0,0.85)] backdrop-blur transform-gpu will-change-transform ${T?"ring-1 ring-primary/40":"border border-border/60"}`,onPointerDown:t=>{t.pointerType==="mouse"&&t.button!==0||xn(t.clientX,t.pointerId,t.target)},onPointerMove:t=>bn(t.clientX),onPointerUp:jt,onPointerCancel:jt,onMouseMove:jn,onMouseLeave:Nn,style:{touchAction:"none"},children:[e.jsx("div",{"aria-hidden":"true",className:"pointer-events-none absolute inset-0 mix-blend-screen opacity-[0.14]"}),e.jsxs("div",{className:`relative overflow-hidden bg-gradient-to-br from-background/90 via-background/85 to-background/95 transition-all duration-300 ease-out ${T?"h-[40%]":"h-[58%]"}`,children:[dn&&n.posterUrl?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:n.posterUrl,alt:Fe(n)??`${n.title} poster`,className:"h-full w-full object-cover",draggable:!1,loading:"lazy",onError:()=>Xe(!0),style:{filter:T?"blur(4px) brightness(0.65)":"none",transform:T?"scale(1.12)":"scale(1)",transition:"filter 260ms cubic-bezier(0.22,0.61,0.36,1), transform 260ms cubic-bezier(0.22,0.61,1)"}}),T&&e.jsx("div",{className:"pointer-events-none absolute left-3 flex items-start",style:{top:"3.4rem"},children:e.jsx("div",{className:"overflow-hidden rounded-2xl border border-border bg-background shadow-[0_14px_40px_rgba(0,0,0,0.85)]",style:{height:"clamp(120px, 22vh, 220px)",aspectRatio:"2 / 3"},children:e.jsx("img",{src:n.posterUrl,alt:n.title,className:"h-full w-full object-cover",draggable:!1})})})]}):e.jsx(Mt,{title:n.title}),e.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-black/10 via-black/40 to-background/95"}),We==="like"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pointer-events-none absolute inset-x-8 bottom-3 flex justify-start",children:e.jsxs("div",{className:"flex items-center gap-2 rounded-md bg-emerald-500/14 px-3 py-1.5 text-xs font-semibold uppercase tracking-[0.14em] text-emerald-200 shadow-md backdrop-blur-sm",children:[e.jsx(At,{className:"h-4 w-4 text-emerald-300"}),e.jsx("span",{children:"Love it"})]})}),e.jsx("div",{className:"pointer-events-none absolute inset-y-8 right-2 w-1 rounded-full bg-gradient-to-b from-emerald-400/0 via-emerald-400/40 to-emerald-400/0"})]}),We==="dislike"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pointer-events-none absolute inset-x-8 bottom-3 flex justify-end",children:e.jsxs("div",{className:"flex items-center gap-2 rounded-md bg-rose-500/14 px-3 py-1.5 text-xs font-semibold uppercase tracking-[0.14em] text-rose-200 shadow-md backdrop-blur-sm",children:[e.jsx(It,{className:"h-4 w-4 text-rose-300"}),e.jsx("span",{children:"No thanks"})]})}),e.jsx("div",{className:"pointer-events-none absolute inset-y-8 left-2 w-1 rounded-full bg-gradient-to-b from-rose-400/0 via-rose-400/40 to-rose-400/0"})]}),e.jsxs("div",{className:"absolute left-3 right-3 top-3 flex flex-wrap items-center justify-between gap-2 text-xs",children:[n?.source==="from-friends"&&e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-md bg-background/80 px-2 py-1 text-xs font-semibold text-foreground shadow-md",children:[e.jsx("span",{className:"h-1.5 w-1.5 rounded-sm bg-primary"}),hn]}),e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-md bg-background/70 px-2 py-1 text-xs font-medium text-muted-foreground/85 shadow-md",children:[e.jsx(Le,{className:"h-3 w-3 text-primary/80"}),v+1," / ",y.length||1]})]})]}),e.jsxs("div",{className:"relative flex flex-1 flex-col bg-gradient-to-b from-background/92 via-background/96 to-background px-4 pb-4 pt-3 backdrop-blur-md",children:[!T&&e.jsxs(e.Fragment,{children:[e.jsx(Yn,{card:n,metaLine:se,highlightLabel:vn}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-3 text-xs text-muted-foreground",children:[Array.isArray(n.friendProfiles)&&n.friendProfiles.length>0&&e.jsxs("div",{className:"inline-flex items-center gap-2",children:[e.jsx(On,{profiles:n.friendProfiles,max:3}),e.jsx("span",{className:"text-xs text-muted-foreground",children:n.friendProfiles.length===1?`Picked by ${n.friendProfiles[0].display_name??n.friendProfiles[0].username??"a friend"}`:`Picked by ${n.friendProfiles.length} friends`})]}),(!Array.isArray(n.friendProfiles)||n.friendProfiles.length===0)&&typeof n.friendLikesCount=="number"&&n.friendLikesCount>0&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(St,{className:"h-4 w-4 text-primary/80"}),n.friendLikesCount===1?"1 friend likes this":`${n.friendLikesCount} friends like this`]}),n.topFriendName&&n.topFriendReviewSnippet&&e.jsxs("button",{type:"button",onClick:()=>ze(t=>!t),className:"inline-flex flex-1 items-start gap-2 rounded-xl border border-border/70 bg-card/80 px-3 py-2 text-left text-foreground shadow-md hover:bg-card",children:[e.jsx(De,{className:"mt-0.5 h-4 w-4 text-primary"}),e.jsx("div",{className:`overflow-hidden transition-all duration-200 ${He?"max-h-32":"max-h-10"}`,children:e.jsxs("span",{className:`block text-xs ${He?"":"line-clamp-2"}`,children:[n.topFriendName,": “",n.topFriendReviewSnippet,"”"]})})]})]})]}),T&&n&&e.jsxs("div",{ref:we,id:"swipe-detail-panel","aria-label":le?"Full details":"Details summary","aria-live":"polite",className:"mt-2 flex flex-1 flex-col text-left text-xs text-muted-foreground",children:[e.jsx("div",{className:"flex min-h-0 flex-1 flex-col overflow-hidden pr-1",children:le?e.jsxs("div",{className:"flex min-h-0 flex-1 flex-col gap-3",children:[e.jsxs("div",{className:"shrink-0",children:[e.jsx("h3",{className:"line-clamp-1 text-[clamp(0.95rem,3.4vw,1.1rem)] font-semibold text-foreground",children:n.title}),se&&e.jsx("p",{className:"mt-0.5 text-[11px] text-muted-foreground/90",children:se})]}),e.jsxs("div",{className:"min-h-0 flex-1 overflow-hidden",children:[e.jsx("div",{className:"grid grid-cols-2 gap-x-3 gap-y-2 rounded-2xl border border-border/70 bg-card/80 px-3 py-2 text-[11px] leading-snug text-muted-foreground",children:(()=>{const t=[];if(pt.length>0&&t.push({label:"Genres",value:pt.slice(0,6).join(", ")}),xt.length>0&&t.push({label:"Languages",value:xt.slice(0,4).join(", ")}),ot&&t.push({label:"Writers",value:ot}),J){const i=J.split(",").map(a=>a.trim()).filter(Boolean).slice(3);i.length>0&&t.push({label:"More cast",value:i.slice(0,8).join(", ")})}return dt&&t.push({label:"Released",value:dt}),at&&t.push({label:"Awards",value:at}),lt&&t.push({label:"Box office",value:lt}),Me&&Tt(Me)&&t.push({label:"IMDb votes",value:String(Tt(Me))}),Ce&&R(Ce)!=null&&t.push({label:"Metascore",value:String(R(Ce))}),Te&&R(Te)!=null&&t.push({label:"TMDB",value:String(R(Te)?.toFixed(1))}),t.slice(0,8).map(r=>e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-[10px] font-semibold uppercase tracking-[0.14em] text-muted-foreground/70",children:r.label}),e.jsx("p",{className:"line-clamp-2",children:r.value})]},r.label))})()}),ce&&e.jsxs("div",{className:"mt-2 rounded-2xl border border-border/70 bg-card/80 px-3 py-2",children:[e.jsx("p",{className:"text-[10px] font-semibold uppercase tracking-[0.14em] text-muted-foreground/70",children:"Overview"}),e.jsx("p",{className:"mt-1 line-clamp-2 text-[11px] leading-relaxed text-muted-foreground/90",children:ce})]})]})]}):e.jsxs("div",{className:"flex min-h-0 flex-1 flex-col gap-3",children:[e.jsxs("div",{className:"shrink-0 space-y-1.5",children:[e.jsx("h3",{className:"line-clamp-2 text-[clamp(1rem,3.8vw,1.25rem)] font-semibold text-foreground",children:n.title}),se&&e.jsx("p",{className:"text-[11px] text-muted-foreground/90",children:se}),e.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 text-[11px] text-muted-foreground/90",children:[A&&e.jsxs("span",{className:"inline-flex items-center gap-1 min-w-0",children:[e.jsx("span",{className:"font-medium text-foreground/90",children:"Genres"}),e.jsx("span",{className:"truncate max-w-[220px]",children:Array.isArray(A)?A.slice(0,3).join(", "):String(A).split(",").map(t=>t.trim()).slice(0,3).join(", ")})]}),mt&&e.jsx("span",{className:"rounded-full bg-card/80 px-2 py-0.5 text-[11px] font-medium text-foreground/90",children:mt}),it&&e.jsx("span",{className:"rounded-full bg-card/80 px-2 py-0.5 text-[11px] text-muted-foreground/90",children:it})]})]}),ce?e.jsxs("div",{className:"min-h-0 flex-1 space-y-1",children:[e.jsx("p",{className:"text-[10px] font-semibold uppercase tracking-[0.16em] text-muted-foreground/70",children:"Overview"}),e.jsx("p",{className:"line-clamp-4 sm:line-clamp-5 md:line-clamp-6 text-[11px] leading-relaxed text-muted-foreground/90",children:ce})]}):e.jsx("div",{className:"min-h-0 flex-1"}),ke||J?e.jsxs("div",{className:"shrink-0 space-y-1 text-[10.5px] text-muted-foreground/90",children:[ke&&e.jsxs("p",{className:"line-clamp-1",children:[e.jsx("span",{className:"font-medium text-foreground/90",children:"Director:"})," ",e.jsx("span",{children:ke})]}),J&&e.jsxs("p",{className:"line-clamp-1",children:[e.jsx("span",{className:"font-medium text-foreground/90",children:"Cast:"})," ",e.jsx("span",{children:J.split(",").map(t=>t.trim()).filter(Boolean).slice(0,4).join(", ")})]})]}):null,e.jsxs("div",{className:"shrink-0 space-y-2",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full bg-card/80 px-2.5 py-1",children:[e.jsx("span",{className:"text-[11px] text-muted-foreground/80",children:"Your rating"}),e.jsx("div",{className:"flex items-center gap-0.5","aria-label":"Your rating",children:Array.from({length:5}).map((t,r)=>{const i=r+1,a=Re!=null&&Re>=i;return e.jsx("button",{type:"button",onClick:()=>on(i),className:"flex h-5 w-5 items-center justify-center rounded-full hover:scale-105 focus-visible:outline-none",children:e.jsx(zn,{className:`h-3.5 w-3.5 ${a?"fill-yellow-400 text-yellow-400":"text-muted-foreground"}`})},i)})})]}),e.jsxs("div",{className:"ml-auto flex flex-wrap items-center gap-1.5",children:[e.jsx("button",{type:"button",onClick:()=>ht(Y),className:`inline-flex items-center rounded-full px-2.5 py-1 text-[11px] font-medium transition-colors ${gt(Y)?"bg-primary/90 text-primary-foreground":"border border-border bg-card/80 text-muted-foreground hover:border-primary/70 hover:text-primary"}`,children:"Watchlist"}),e.jsx("button",{type:"button",onClick:()=>ht(O),className:`inline-flex items-center rounded-full px-2.5 py-1 text-[11px] font-medium transition-colors ${gt(O)?"bg-emerald-500/90 text-primary-foreground":"border border-border bg-card/80 text-muted-foreground hover:border-emerald-400/80 hover:text-emerald-300"}`,children:"Watched"}),e.jsxs("button",{type:"button",onClick:()=>Je(!0),className:"inline-flex items-center gap-1 rounded-full border border-border bg-card/80 px-2.5 py-1 text-[11px] font-medium text-muted-foreground hover:border-primary/70 hover:text-primary",children:[e.jsx(Ut,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Share"})]})]})]}),typeof n.friendLikesCount=="number"&&n.friendLikesCount>0||n.topFriendName&&n.topFriendReviewSnippet?e.jsxs("div",{className:"rounded-2xl bg-card/80 px-3 py-2 text-[11px] text-foreground shadow-md",children:[typeof n.friendLikesCount=="number"&&n.friendLikesCount>0&&e.jsxs("div",{className:"inline-flex items-center gap-1 text-[11px] text-muted-foreground",children:[e.jsx(St,{className:"h-4 w-4 text-primary/80"}),n.friendLikesCount===1?"1 friend likes this":`${n.friendLikesCount} friends like this`]}),n.topFriendName&&n.topFriendReviewSnippet&&e.jsxs("div",{className:"mt-1 inline-flex w-full items-start gap-2 text-left",children:[e.jsx(De,{className:"mt-0.5 h-4 w-4 text-primary"}),e.jsxs("span",{className:"block line-clamp-2 text-[11px]",children:[n.topFriendName,": “",n.topFriendReviewSnippet,"”"]})]})]}):null]})]})}),e.jsx("div",{className:"mt-2 flex shrink-0 justify-end",children:e.jsx("button",{type:"button",onClick:()=>he(t=>!t),"aria-expanded":le,"aria-controls":"swipe-detail-panel",className:"inline-flex items-center gap-1 rounded-full border border-border px-2.5 py-1 text-xs font-medium text-foreground hover:border-primary/70 hover:text-primary",children:e.jsx("span",{children:le?"Collapse":"Full details"})})})]})]})]}),Yt&&e.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center bg-gradient-to-b from-background/70 via-background/50 to-background/80",children:e.jsxs("div",{className:"pointer-events-auto max-w-xs rounded-2xl border border-border bg-background/95 p-4 text-center shadow-lg",children:[e.jsx("p",{className:"text-sm font-semibold text-foreground",children:"Swipe to decide"}),e.jsx("p",{className:"mt-1 text-[12px] text-muted-foreground",children:"Swipe left to pass, right to save what you love."}),e.jsx("button",{type:"button",className:"mt-3 w-full rounded-xl bg-primary px-3 py-2 text-sm font-semibold text-white shadow-md",onClick:()=>{be(!1),typeof window<"u"&&localStorage.setItem(me,"1")},children:"Got it"})]})})]}),yn()]}),e.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-3","aria-label":"Swipe actions",children:[e.jsxs("button",{type:"button",onClick:()=>U("dislike"),disabled:re,className:"flex min-h-[44px] items-center justify-center gap-2 rounded-xl border border-border bg-background px-3 py-3 text-sm font-semibold text-rose-400 shadow-md disabled:cursor-not-allowed disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-rose-300 focus-visible:ring-offset-2 focus-visible:ring-offset-background active:translate-y-[1px] active:scale-[0.99] active:shadow-none transition-all duration-150","aria-label":"No thanks",children:[e.jsx(It,{className:"h-5 w-5"}),e.jsx("span",{className:"hidden sm:inline",children:"No thanks"})]}),e.jsxs("button",{type:"button",onClick:()=>U("skip"),disabled:re,className:"flex min-h-[44px] items-center justify-center gap-2 rounded-xl border border-border bg-background px-3 py-3 text-sm font-semibold text-muted-foreground shadow-md disabled:cursor-not-allowed disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-border focus-visible:ring-offset-2 focus-visible:ring-offset-background active:translate-y-[1px] active:scale-[0.99] active:shadow-none transition-all duration-150","aria-label":"Not now",children:[e.jsx(Zn,{className:"h-5 w-5"}),e.jsx("span",{className:"hidden sm:inline",children:"Not now"})]}),e.jsxs("button",{type:"button",onClick:()=>U("like"),disabled:re,className:"flex min-h-[44px] items-center justify-center gap-2 rounded-xl border border-transparent bg-primary/95 px-3 py-3 text-sm font-semibold text-primary-foreground shadow-md disabled:cursor-not-allowed disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 focus-visible:ring-offset-background active:translate-y-[1px] active:scale-[0.99] active:shadow-none transition-all duration-150","aria-label":"Love it",children:[e.jsx(At,{className:"h-5 w-5"}),e.jsx("span",{className:"hidden sm:inline",children:"Love it"})]})]}),e.jsx(ir,{isOpen:Kt,onClose:()=>Je(!1),activeCard:n,shareUrl:an,onShareExternal:ln}),wn()]})]})},ir=({isOpen:s,onClose:d,activeCard:f,shareUrl:u,onShareExternal:w})=>{const{user:M}=Et(),{data:x=[],isLoading:X}=Tn();if(o.useEffect(()=>{if(!s)return;const b=D=>{D.key==="Escape"&&d()};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[s,d]),!s||!f)return null;const L=`Check this out: ${f.title}

${u}`,fe=b=>{b.target===b.currentTarget&&d()},pe=b=>{(b.key==="Enter"||b.key===" ")&&d()};return e.jsx("div",{role:"button",tabIndex:0,className:"fixed inset-0 z-[9999] flex flex-col justify-end bg-black/55",onClick:fe,onKeyDown:pe,children:e.jsxs("div",{role:"dialog","aria-modal":"true",className:"pointer-events-auto mb-[72px] w-full max-w-md self-center rounded-t-2xl bg-card pb-3 pt-2 shadow-[0_-18px_45px_rgba(0,0,0,0.65)]",onClick:b=>b.stopPropagation(),onKeyDown:b=>b.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-4 pb-2",children:[e.jsx("button",{type:"button",className:"rounded-full p-1 text-muted-foreground hover:bg-background/80",children:e.jsx(Rn,{className:"h-4 w-4"})}),e.jsx("span",{className:"text-sm font-semibold text-foreground",children:"Send to"}),e.jsx("button",{type:"button",onClick:d,className:"rounded-full p-1 text-muted-foreground hover:bg-background/80",children:e.jsx("span",{className:"text-[18px] leading-none",children:"×"})})]}),e.jsxs("section",{className:"border-t border-border px-4 pt-3 pb-2",children:[e.jsx("h2",{className:"mb-2 text-[12px] font-medium uppercase tracking-[0.08em] text-muted-foreground/90",children:"Send to"}),X?e.jsx("div",{className:"flex gap-3 overflow-hidden",children:Array.from({length:4}).map((b,D)=>e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:"h-11 w-11 animate-pulse rounded-full bg-border/50"}),e.jsx("div",{className:"h-2.5 w-12 animate-pulse rounded bg-border/40"})]},D))}):M?x.length===0?e.jsx("p",{className:"text-[12px] text-muted-foreground/80",children:"No conversations yet. Start a chat from a profile or the Messages tab."}):e.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1 pt-0.5",children:x.map(b=>e.jsx(or,{conversation:b,text:L},b.id))}):e.jsx("p",{className:"text-[12px] text-muted-foreground/80",children:"Sign in to share via messages."})]}),e.jsx("section",{className:"border-t border-border px-4 pt-3 pb-3",children:e.jsxs("div",{className:"flex gap-3 overflow-x-auto pb-1 pt-0.5",children:[e.jsx(lr,{shareUrl:u,title:f.title}),e.jsx(dr,{shareUrl:u,title:f.title}),e.jsx(cr,{onShareExternal:w}),e.jsx(ar,{shareUrl:u})]})})]})})},or=({conversation:s,text:d})=>{const f=s.isGroup?null:s.participants?.find(L=>!L.isSelf)??s.participants?.[0],u=f?.displayName??s.title??"Conversation",w=f?.avatarUrl,M=Ln(s.id),x=()=>{M.isPending||M.mutate({text:d})},X=u.split(" ").map(L=>L.charAt(0).toUpperCase()).slice(0,2).join("");return e.jsxs("button",{type:"button",onClick:x,className:"flex w-[72px] flex-col items-center gap-1 text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex h-11 w-11 items-center justify-center overflow-hidden rounded-full bg-muted text-xs text-muted-foreground",children:w?e.jsx("img",{src:w,alt:u,className:"h-full w-full object-cover"}):e.jsx("span",{children:X})}),M.isSuccess&&e.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 flex h-4 w-4 items-center justify-center rounded-full bg-emerald-500",children:e.jsx(De,{className:"h-3 w-3 text-primary-foreground"})})]}),e.jsx("span",{className:"line-clamp-2 max-w-[72px] text-xs text-foreground",children:u})]})},ar=({shareUrl:s})=>{const d=async()=>{if(navigator.clipboard?.writeText)try{await navigator.clipboard.writeText(s)}catch{}};return e.jsxs("button",{type:"button",onClick:d,className:"flex w-[72px] flex-col items-center gap-1 text-center",children:[e.jsx("div",{className:"flex h-11 w-11 items-center justify-center rounded-full bg-primary",children:e.jsx(Kn,{className:"h-4 w-4 text-primary-foreground"})}),e.jsx("span",{className:"line-clamp-2 max-w-[72px] text-xs text-foreground",children:"Copy link"})]})},lr=({shareUrl:s,title:d})=>{const f=()=>{if(typeof window>"u")return;const u=`Check this out: ${d}

${s}`,w=`https://api.whatsapp.com/send?text=${encodeURIComponent(u)}`;window.open(w,"_blank","noopener,noreferrer")};return e.jsxs("button",{type:"button",onClick:f,className:"flex w-[72px] flex-col items-center gap-1 text-center",children:[e.jsx("div",{className:"flex h-11 w-11 items-center justify-center rounded-full bg-primary",children:e.jsx("span",{className:"text-[16px] font-semibold text-white",children:"W"})}),e.jsx("span",{className:"line-clamp-2 max-w-[72px] text-xs text-foreground",children:"WhatsApp"})]})},dr=({shareUrl:s,title:d})=>{const f=()=>{if(typeof window>"u")return;const u=`Check this out: ${d}

${s}`,w=`https://t.me/share/url?url=${encodeURIComponent(s)}&text=${encodeURIComponent(u)}`;window.open(w,"_blank","noopener,noreferrer")};return e.jsxs("button",{type:"button",onClick:f,className:"flex w-[72px] flex-col items-center gap-1 text-center",children:[e.jsx("div",{className:"flex h-11 w-11 items-center justify-center rounded-full bg-primary",children:e.jsx("span",{className:"text-[16px] font-semibold text-white",children:"T"})}),e.jsx("span",{className:"line-clamp-2 max-w-[72px] text-xs text-foreground",children:"Telegram"})]})},cr=({onShareExternal:s})=>{const d=async()=>{await s()};return e.jsxs("button",{type:"button",onClick:d,className:"flex w-[72px] flex-col items-center gap-1 text-center",children:[e.jsx("div",{className:"flex h-11 w-11 items-center justify-center rounded-full border border-border bg-muted",children:e.jsx(Ut,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx("span",{className:"line-clamp-2 max-w-[72px] text-xs text-foreground",children:"More"})]})};export{Ar as default};
